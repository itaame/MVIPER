import{a as bo,b as To,c as Do,d as wo,i as Eo,j as Io,k as Mo}from"./chunk-2UNEVVCW.js";import"./chunk-ERVA5QJS.js";import{a as De}from"./chunk-ESNLOJMT.js";import{a as vo,b as yo}from"./chunk-7ZJ4C3K2.js";import{f as So}from"./chunk-KJ5BZ5CM.js";import{a as ai}from"./chunk-NOPILB5D.js";import"./chunk-UVXAE5YP.js";import{a as j,c as Y,d as zi,e as xo}from"./chunk-J6RUEXVW.js";import{$b as On,$c as Le,$e as re,A as mn,Aa as a,Ab as W,Ac as K,Af as J,B as $e,Ba as u,Bc as _e,Be as jn,Bf as Kn,Bg as vt,Ca as y,Cb as Sn,Cc as it,Ce as Ut,Cg as mo,Da as x,Dc as Bn,Dg as so,E as We,Ea as qe,Eb as pe,Ec as te,Ef as He,Eg as co,F as Rt,Fa as I,Fb as Ft,Fc as xe,Fg as po,G as sn,Ga as v,Gb as ue,Gc as Ce,Gf as _t,Gg as ni,H as Ke,Ha as s,Hb as ee,He as Gt,I as $,Ia as Et,Ib as Vt,Ic as qn,Ie as pt,J as cn,Ja as It,Jc as Bt,K as dn,Kc as fe,Ke as ut,La as ye,Lf as M,Lg as ge,M as pn,Ma as U,N as S,Na as F,Nb as bn,Nc as he,Nf as Te,O as b,Oa as V,Ob as Tn,Of as Jn,Pb as Dn,Pf as Xn,Qb as wn,Qe as Ae,Qf as Zn,R as Ai,Ra as k,Rb as En,Rf as eo,Rg as uo,Sa as l,Sb as In,Sf as to,T as Je,Ta as w,Tb as Mn,Tf as io,Tg as oi,Ua as T,Ub as kn,Ue as Pe,Uf as Ne,V as X,Vb as Ln,Ve as Wt,W as Dt,Wb as Rn,We as ie,Wf as Ct,Wg as _o,X as un,Xa as Oi,Xb as Ni,Xc as qt,Xe as ne,Y as wt,Ya as Ht,Yb as $t,Yc as Se,Ye as oe,Za as B,Zb as An,Zc as zt,_a as Z,_b as Pn,_c as jt,_e as ae,_f as no,a as Li,ag as ft,b as Ri,ba as m,bb as C,bd as nt,bf as le,bh as Co,c as on,ca as Xe,cb as h,cd as ot,cf as me,cg as ei,ch as fo,da as f,db as Mt,e as Tt,ea as _n,eb as Nt,ec as Fi,ef as se,eg as oo,f as P,fc as Vi,ff as ce,ga as D,gb as Ze,gc as $i,gh as ho,ha as At,hb as et,hc as ze,hd as zn,hf as de,i as an,ia as ke,ib as hn,ic as je,id as at,if as be,ih as L,ja as Pt,jc as Qi,jd as Re,ka as Qe,kc as Bi,kg as ht,la as Pi,lc as qi,lh as go,m as rn,ma as c,mb as gn,mf as Kt,mg as gt,nc as Hn,nf as Jt,ng as ti,oc as Nn,of as Xt,oh as E,pa as Be,pb as Hi,pc as Fn,pf as Oe,pg as ii,ph as yt,qa as d,qb as G,qc as Vn,qf as Yn,qh as ji,ra as Ot,rc as Qt,rf as Un,rh as Yi,sa as O,t as ln,ta as Cn,te as rt,tf as Ee,ua as fn,ue as Yt,ug as ao,va as _,vb as vn,ve as lt,vf as Zt,wa as Q,wb as yn,wc as $n,we as mt,wg as ro,xa as R,xb as xn,xe as st,ya as A,yc as tt,ye as ct,yf as Gn,yg as lo,z as Ge,za as o,zc as Qn,ze as dt,zf as Wn}from"./chunk-MTJQDUEX.js";var Lo=(t,i)=>$(Ui).canActivate(t,i);var Ui=class t{constructor(i,e){this.authService=i;this.router=e}canActivate(i,e){return this.authService.getUser().hasSystemPrivilege("ControlCommandQueue")?!0:(this.router.navigate(["/403"],{queryParams:{page:e.url}}),!1)}canActivateChild(i,e){return this.canActivate(i,e)}static{this.\u0275fac=function(e){return new(e||t)(Ke(yt),Ke(ue))}}static{this.\u0275prov=We({token:t,factory:t.\u0275fac,providedIn:"root"})}};var Wo=()=>({matrixParams:"exact",paths:"exact",queryParams:"ignored"}),Ro=t=>({c:t}),xt=class t{constructor(i){this.yamcs=i}static{this.\u0275fac=function(e){return new(e||t)(f(L))}}static{this.\u0275cmp=D({type:t,selectors:[["app-clearances-page-tabs"]],decls:10,vars:12,consts:[["rla","routerLinkActive"],["rlb","routerLinkActive"],["tabPanel",""],["mat-tab-nav-bar","",1,"secondary",3,"mat-stretch-tabs","tabPanel"],["mat-tab-link","","routerLink","/commanding/clearances","routerLinkActive","",3,"routerLinkActiveOptions","active","queryParams"],["mat-tab-link","","routerLink","/commanding/clearances/log","routerLinkActive","",3,"active","queryParams"]],template:function(e,n){if(e&1&&(o(0,"nav",3)(1,"a",4,0),l(3," Clearances "),a(),o(4,"a",5,1),l(6," Action log "),a()(),o(7,"mat-tab-nav-panel",null,2),u(9,"router-outlet"),a()),e&2){let r=k(2),p=k(5),g=k(8);d("mat-stretch-tabs",!1)("tabPanel",g),m(),d("routerLinkActiveOptions",Ht(7,Wo))("active",r.isActive)("queryParams",B(8,Ro,n.yamcs.context)),m(3),d("active",p.isActive)("queryParams",B(10,Ro,n.yamcs.context))}},dependencies:[E,Ft,ee,Vt,Kt,Xt,Jt],styles:[".mat-mdc-tab-link[_ngcontent-%COMP%]{height:36px;min-width:0;font-size:13px}"],changeDetection:0})}};function Ko(t,i){if(t&1){let e=I();u(0,"ya-date-time-input",14)(1,"ya-date-time-input",15),o(2,"ya-button",16),v("click",function(){S(e);let r=s();return b(r.applyCustomDates())}),l(3,"Apply"),a()}if(t&2){let e=s();m(2),d("disabled",e.filterForm.invalid)}}function Jo(t,i){if(t&1){let e=I();o(0,"ya-button",17),v("click",function(){S(e);let r=s();return b(r.jumpToNow())}),l(1,"Jump to now"),a()}}function Xo(t,i){t&1&&(o(0,"th",18),l(1,"Time"),a())}function Zo(t,i){if(t&1&&(o(0,"td",19),l(1),C(2,"datetime"),a()),t&2){let e=i.$implicit;m(),w(h(2,1,e.time))}}function ea(t,i){t&1&&(o(0,"th",18),l(1,"User"),a())}function ta(t,i){if(t&1&&(o(0,"td",19),l(1),a()),t&2){let e=i.$implicit;m(),w(e.user||"-")}}function ia(t,i){t&1&&(o(0,"th",18),l(1,"Action"),a())}function na(t,i){if(t&1&&(o(0,"td",19),u(1,"ya-action-log-summary",20),a()),t&2){let e=i.$implicit;m(),d("text",e.summary)}}function oa(t,i){t&1&&u(0,"th",21)}function aa(t,i){t&1&&u(0,"td",19)}function ra(t,i){t&1&&u(0,"tr",22)}function la(t,i){t&1&&u(0,"tr",23)}var ri=class t{constructor(i,e,n,r,p){this.yamcs=i;this.messageService=e;this.router=n;this.route=r;this.interval=X();this.customStart=X();this.customStop=X();this.filterForm=new it({interval:new te("NO_LIMIT"),customStart:new te(null),customStop:new te(null)});this.displayedColumns=["time","user","summary","actions"];this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}];this.dataSource=new be;p.setTitle("Clearances")}ngOnInit(){this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(i=>{if(i==="CUSTOM"){let e=new Date,n=this.validStart||e,r=this.validStop||e;this.filterForm.get("customStart").setValue(M.toISOString(n)),this.filterForm.get("customStop").setValue(M.toISOString(r))}else i==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=i,this.loadData()):i&&(this.validStop=new Date,this.validStart=M.subtractDuration(this.validStop,i),this.appliedInterval=i,this.loadData())})}initializeOptions(){if(this.interval())if(this.appliedInterval=this.interval(),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let i=this.customStart();this.filterForm.get("customStart").setValue(i),this.validStart=M.toDate(i);let e=this.customStop();this.filterForm.get("customStop").setValue(e),this.validStop=M.toDate(e)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=new Date,this.validStart=M.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval="NO_LIMIT",this.validStop=null,this.validStart=null}jumpToNow(){this.filterForm.get("interval").setValue("NO_LIMIT")}applyCustomDates(){let{controls:i}=this.filterForm;this.validStart=M.toDate(i.customStart.value),this.validStop=M.toDate(i.customStop.value),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();let i={service:"ClearanceApi"};this.validStart&&(i.start=this.validStart.toISOString()),this.validStop&&(i.stop=this.validStop.toISOString()),this.yamcs.yamcsClient.getAuditRecords("_global",i).then(e=>this.dataSource.data=e.records||[]).catch(e=>this.messageService.showError(e))}updateURL(){let{controls:i}=this.filterForm;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?i.customStart.value:null,customStop:this.appliedInterval==="CUSTOM"?i.customStop.value:null},queryParamsHandling:"merge"})}static{this.\u0275fac=function(e){return new(e||t)(f(L),f(Oe),f(ue),f(pe),f(W))}}static{this.\u0275cmp=D({type:t,selectors:[["app-clearances-action-log-tab"]],inputs:{interval:[1,"interval"],customStart:[1,"customStart"],customStop:[1,"customStop"]},decls:25,vars:7,consts:[[1,"panel-content"],[2,"margin-top","16px",3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","time"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","user"],["matColumnDef","summary"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["formControlName","customStart"],["formControlName","customStop"],[3,"click","disabled"],[3,"click"],["mat-header-cell",""],["mat-cell",""],[3,"text"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,n){e&1&&(o(0,"app-instance-page")(1,"app-instance-toolbar"),l(2,"Clearances"),a(),o(3,"div",0),u(4,"app-clearances-page-tabs"),o(5,"form",1)(6,"div",2),u(7,"ya-select",3),c(8,Ko,4,1)(9,Jo,2,0,"ya-button"),a()(),o(10,"table",4),y(11,5),c(12,Xo,2,0,"th",6)(13,Zo,3,3,"td",7),x(),y(14,8),c(15,ea,2,0,"th",6)(16,ta,2,1,"td",7),x(),y(17,9),c(18,ia,2,0,"th",6)(19,na,2,1,"td",7),x(),y(20,10),c(21,oa,1,0,"th",11)(22,aa,1,0,"td",7),x(),c(23,ra,1,0,"tr",12)(24,la,1,0,"tr",13),a()()()),e&2&&(m(5),d("formGroup",n.filterForm),m(2),d("options",n.intervalOptions),m(),_(n.filterForm.value.interval==="CUSTOM"?8:-1),m(),_(n.filterForm.value.interval!=="CUSTOM"?9:-1),m(),d("dataSource",n.dataSource),m(13),d("matHeaderRowDef",n.displayedColumns),m(),d("matRowDefColumns",n.displayedColumns))},dependencies:[xt,Y,j,E,Ce,K,_e,fe,he,ie,oe,me,ae,ne,se,re,le,ce,de,Zt,J,Te,Ne,ge],encapsulation:2,changeDetection:0})}};var Ao=(t,i)=>$(Gi).canActivate(t,i);var Gi=class t{constructor(i,e){this.router=e;this.config=i.getConfig()}canActivate(i,e){return this.config.commandClearanceEnabled}canActivateChild(i,e){return this.canActivate(i,e)}static{this.\u0275fac=function(e){return new(e||t)(Ke(_t),Ke(ue))}}static{this.\u0275prov=We({token:t,factory:t.\u0275fac,providedIn:"root"})}};var li=class t{constructor(i,e,n){this.dialogRef=i;this.data=n;if(this.form=e.group({level:new xe(null,[tt.required])}),n.clearance){let r=n.clearance;this.form.setValue({level:r.level||"DISABLED"})}}confirm(){this.dialogRef.close({level:this.form.value.level==="DISABLED"?void 0:this.form.value.level})}static{this.\u0275fac=function(e){return new(e||t)(f(rt),f(qt),f(Yt))}}static{this.\u0275cmp=D({type:t,selectors:[["app-change-level-dialog"]],decls:31,vars:8,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["type","radio","formControlName","level","value","DISABLED"],[2,"font-weight","normal"],["type","radio","formControlName","level","value","NONE"],["level","NONE",3,"grayscale"],["type","radio","formControlName","level","value","WATCH"],["level","WATCH",3,"grayscale"],["type","radio","formControlName","level","value","WARNING"],["level","WARNING",3,"grayscale"],["type","radio","formControlName","level","value","DISTRESS"],["level","DISTRESS",3,"grayscale"],["type","radio","formControlName","level","value","CRITICAL"],["level","CRITICAL",3,"grayscale"],["type","radio","formControlName","level","value","SEVERE"],["level","SEVERE",3,"grayscale"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,n){e&1&&(o(0,"h2",0),l(1,"Command clearance"),a(),o(2,"mat-dialog-content")(3,"form",1)(4,"label"),u(5,"input",2),o(6,"span",3),l(7,"No clearance"),a()(),o(8,"label"),u(9,"input",4)(10,"app-significance-level",5),a(),o(11,"label"),u(12,"input",6)(13,"app-significance-level",7),a(),o(14,"label"),u(15,"input",8)(16,"app-significance-level",9),a(),o(17,"label"),u(18,"input",10)(19,"app-significance-level",11),a(),o(20,"label"),u(21,"input",12)(22,"app-significance-level",13),a(),o(23,"label"),u(24,"input",14)(25,"app-significance-level",15),a()()(),o(26,"mat-dialog-actions",16)(27,"ya-button",17),l(28,"CANCEL"),a(),o(29,"ya-button",18),v("click",function(){return n.confirm()}),l(30," SAVE CHANGES "),a()()),e&2&&(m(3),d("formGroup",n.form),m(7),d("grayscale",!0),m(3),d("grayscale",!0),m(3),d("grayscale",!0),m(3),d("grayscale",!0),m(3),d("grayscale",!0),m(3),d("grayscale",!0),m(4),d("disabled",!n.form.valid))},dependencies:[E,Ce,$n,qn,K,_e,fe,he,mt,st,dt,ct,J,De],styles:["[_ngcontent-%COMP%]:focus{outline:none}"]})}};function ca(t,i){if(t&1){let e=I();o(0,"th",18)(1,"input",19),v("change",function(r){S(e);let p=s(2);return b(r?p.masterToggle():null)}),a()()}if(t&2){let e=s(2);m(),d("checked",e.selection.hasValue()&&e.isAllSelected())}}function da(t,i){if(t&1){let e=I();o(0,"td",20)(1,"input",21),v("click",function(r){return S(e),b(r.stopPropagation())})("change",function(r){let p=S(e).$implicit,g=s(2);return b(r?g.selection.toggle(p):null)}),a()()}if(t&2){let e=i.$implicit,n=s(2);m(),d("checked",n.selection.isSelected(e))}}function pa(t,i){t&1&&(o(0,"th",22),l(1,"Username"),a())}function ua(t,i){if(t&1&&(o(0,"td",23),l(1),a()),t&2){let e=i.$implicit;m(),T(" ",e.username," ")}}function _a(t,i){t&1&&(o(0,"th",22),l(1,"May Command"),a())}function Ca(t,i){if(t&1&&(o(0,"td",23),l(1),a()),t&2){let e=i.$implicit;m(),T(" ",e.hasCommandPrivileges?"Yes":"-"," ")}}function fa(t,i){t&1&&(o(0,"th",22),l(1,"Clearance Level"),a())}function ha(t,i){t&1&&l(0," No clearance ")}function ga(t,i){if(t&1&&u(0,"app-significance-level",24),t&2){let e=s().$implicit;d("level",e.level)("grayscale",!0)}}function va(t,i){if(t&1&&(o(0,"td",23),c(1,ha,1,0)(2,ga,1,2,"app-significance-level",24),a()),t&2){let e=i.$implicit;m(),_(e.level?2:1)}}function ya(t,i){t&1&&(o(0,"th",22),l(1,"Issued"),a())}function xa(t,i){if(t&1&&l(0),t&2){let e=s().$implicit;T(" by ",e.issuedBy," ")}}function Sa(t,i){if(t&1&&(o(0,"td",23),l(1),C(2,"datetime"),c(3,xa,1,1),a()),t&2){let e=i.$implicit;m(),T(" ",h(2,2,e.issueTime)||"-"," "),m(2),_(e.issuedBy?3:-1)}}function ba(t,i){t&1&&u(0,"th",25)}function Ta(t,i){t&1&&u(0,"td",26)}function Da(t,i){t&1&&u(0,"tr",27)}function wa(t,i){if(t&1){let e=I();o(0,"tr",28),v("click",function(){let r=S(e).$implicit,p=s(2);return b(p.toggleOne(r))}),a()}if(t&2){let e=i.$implicit,n=s(2);O("selected",n.selection.isSelected(e))}}function Ea(t,i){if(t&1&&(o(0,"table",2),y(1,4),c(2,ca,2,1,"th",5)(3,da,2,1,"td",6),x(),y(4,7),c(5,pa,2,0,"th",8)(6,ua,2,1,"td",9),x(),y(7,10),c(8,_a,2,0,"th",8)(9,Ca,2,1,"td",9),x(),y(10,11),c(11,fa,2,0,"th",8)(12,va,3,1,"td",9),x(),y(13,12),c(14,ya,2,0,"th",8)(15,Sa,4,4,"td",9),x(),y(16,13),c(17,ba,1,0,"th",14)(18,Ta,1,0,"td",15),x(),c(19,Da,1,0,"tr",16)(20,wa,1,2,"tr",17),a()),t&2){let e=s();d("dataSource",e.dataSource),m(19),d("matHeaderRowDef",e.displayedColumns),m(),d("matRowDefColumns",e.displayedColumns)}}var mi=class t{constructor(i,e,n){this.yamcs=i;this.dialog=n;this.displayedColumns=["select","username","hasCommandPrivileges","level","issued","actions"];this.dataSource=new be;this.selection=new Qt(!0,[]);e.setTitle("Clearances"),this.refresh()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}isAllSelected(){let i=this.selection.selected.length,e=this.dataSource.filteredData.length;return i===e&&e>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.filteredData.forEach(i=>this.selection.select(i))}toggleOne(i){(!this.selection.isSelected(i)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(i)}refresh(){this.selection.clear(),this.yamcs.yamcsClient.getClearances().then(i=>{this.dataSource.data=i.clearances||[]})}isGroupChangeLevelEnabled(){return!this.selection.isEmpty()}openChangeLevelDialog(){let i;this.selection.selected.length===1&&(i=this.selection.selected[0]),this.dialog.open(li,{data:{clearance:i},width:"400px"}).afterClosed().subscribe(n=>{if(n){let r=[];if(n.level)for(let p of this.selection.selected)r.push(this.yamcs.yamcsClient.changeClearance(p.username,{level:n.level}));else for(let p of this.selection.selected)r.push(this.yamcs.yamcsClient.deleteClearance(p.username));r.length&&Promise.all(r).then(()=>this.refresh())}})}static{this.\u0275fac=function(e){return new(e||t)(f(L),f(W),f(lt))}}static{this.\u0275cmp=D({type:t,selectors:[["ng-component"]],viewQuery:function(e,n){if(e&1&&(U(Pe,5),U(Ae,5)),e&2){let r;F(r=V())&&(n.sort=r.first),F(r=V())&&(n.paginator=r.first)}},decls:15,vars:5,consts:[["icon","how_to_reg",3,"clicked","disabled"],[1,"panel-content"],["mat-table","","matSort","","matSortActive","username","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table","expand",2,"margin-top","16px",3,"dataSource"],[3,"pageSize","hidePageSize","showFirstLastButtons"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",4,"cdkCellDef"],["matColumnDef","username"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","hasCommandPrivileges"],["matColumnDef","level"],["matColumnDef","issued"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","expand",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"checkbox"],["type","checkbox",3,"change","checked"],["mat-cell","",1,"checkbox"],["type","checkbox",3,"click","change","checked"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[3,"level","grayscale"],["mat-header-cell",""],["mat-cell","",1,"expand"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,n){e&1&&(o(0,"app-instance-page")(1,"app-instance-toolbar"),l(2," Clearances "),o(3,"ya-help")(4,"p"),l(5," Clearances allow central control over the level of commands that users are able to send. "),a(),o(6,"p"),l(7," Clearance works in addition to regular permission checks. So if a user does anyway not have authorization to send certain commands, giving this user clearance will not change this fact. "),a()(),l(8," \xA0\xA0\xA0 "),o(9,"ya-page-button",0),v("clicked",function(){return n.openChangeLevelDialog()}),l(10," Change level "),a()(),o(11,"div",1),u(12,"app-clearances-page-tabs"),c(13,Ea,21,3,"table",2),u(14,"mat-paginator",3),a()()),e&2&&(m(9),d("disabled",!n.isGroupChangeLevelEnabled()),m(4),_(n.dataSource?13:-1),m(),d("pageSize",100)("hidePageSize",!0)("showFirstLastButtons",!0))},dependencies:[xt,Y,j,E,Gt,pt,ut,Ae,Pe,Wt,ie,oe,me,ae,ne,se,re,le,ce,de,ft,gt,ge,De],encapsulation:2,changeDetection:0})}};var Ia=(t,i)=>i.name;function Ma(t,i){if(t&1&&(o(0,"tr")(1,"td",1),l(2),a(),o(3,"td",2),u(4,"ya-value",3),a()()),t&2){let e=i.$implicit;m(2),w(e.name),m(2),d("value",e.value)}}var bt=class t{constructor(){this.nomargin=!1}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=D({type:t,selectors:[["app-command-arguments"]],hostVars:2,hostBindings:function(e,n){e&2&&O("nomargin",n.nomargin)},inputs:{command:"command",nomargin:"nomargin"},decls:3,vars:0,consts:[[1,"args"],["width","1",1,"key"],[1,"value"],[3,"value"]],template:function(e,n){e&1&&(o(0,"table",0),R(1,Ma,5,2,"tr",null,Ia),a()),e&2&&(m(),A(n.command.userAssignments))},dependencies:[E,mo],styles:[".args[_ngcontent-%COMP%]{margin:0 0 0 10px}.args[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%]{min-width:80px;white-space:nowrap;vertical-align:top}.args[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:gray;padding-left:10px}.nomargin[_nghost-%COMP%]   .args[_ngcontent-%COMP%], .nomargin[_nghost-%COMP%]   .args[_ngcontent-%COMP%]   td.key[_ngcontent-%COMP%]:first-child{margin-left:0!important;padding-left:0!important}.nomargin[_nghost-%COMP%]   .args[_ngcontent-%COMP%]{border-spacing:0}"],changeDetection:0})}};var ka=/yamcs<([^>]+)>_/g,si=class t{transform(i){if(!i||!i.startsWith("yamcs<"))return i;let e,n=[];for(;e=ka.exec(i);)n.push(e[1]);return n.length?n[n.length-1]:i}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275pipe=Pt({name:"cascadingPrefix",type:t,pure:!0})}};var Ra=(t,i)=>i.key,Aa=(t,i)=>i.name;function Pa(t,i){if(t&1){let e=I();o(0,"div",2),l(1," Unprocessed binary "),o(2,"ya-more",7)(3,"button",8),v("click",function(){S(e);let r=s();return b(r.copyHex(r.command.unprocessedBinary))}),l(4,"Copy hex"),a(),o(5,"button",8),v("click",function(){S(e);let r=s();return b(r.copyBinary(r.command.unprocessedBinary))}),l(6,"Copy binary"),a()()(),o(7,"div",9),u(8,"app-hex",10),a(),o(9,"div",11)(10,"pre"),l(11),C(12,"hexDump"),a()()}if(t&2){let e=s();m(8),d("base64String",e.command.unprocessedBinary),m(3),w(h(12,2,e.command.unprocessedBinary)||"-")}}function Oa(t,i){if(t&1){let e=I();o(0,"div",2),l(1," Binary "),o(2,"ya-more",7)(3,"button",8),v("click",function(){S(e);let r=s();return b(r.copyHex(r.command.binary))}),l(4,"Copy hex"),a(),o(5,"button",8),v("click",function(){S(e);let r=s();return b(r.copyBinary(r.command.binary))}),l(6,"Copy binary"),a()()(),o(7,"div",9),u(8,"app-hex",10),a(),o(9,"div",11)(10,"pre"),l(11),C(12,"hexDump"),a()()}if(t&2){let e=s();m(8),d("base64String",e.command.binary),m(3),w(h(12,2,e.command.binary)||"-")}}function Ha(t,i){if(t&1&&l(0),t&2){let e=s();T(" @",e.command.origin," ")}}function Na(t,i){if(t&1&&(o(0,"div",2),l(1,"Queue"),a(),o(2,"div",1),l(3),a()),t&2){let e=s();m(3),T(" ",e.command.queue||"-"," ")}}function Fa(t,i){if(t&1&&(u(0,"mat-divider",5),o(1,"div",0),l(2,"Comment"),a(),o(3,"div",1),l(4),a()),t&2){let e=s();m(4),T(" ",e.command.comment," ")}}function Va(t,i){if(t&1){let e=I();o(0,"ya-more",7)(1,"button",8),v("click",function(){S(e);let r=s().$implicit,p=s(2);return b(p.copyHex(r.value.binaryValue))}),l(2,"Copy hex"),a(),o(3,"button",8),v("click",function(){S(e);let r=s().$implicit,p=s(2);return b(p.copyBinary(r.value.binaryValue))}),l(4,"Copy binary"),a()()}}function $a(t,i){if(t&1&&(o(0,"div",9),u(1,"app-hex",10),a(),o(2,"div",11)(3,"pre"),l(4),C(5,"hexDump"),a()()),t&2){let e=s().$implicit;m(),d("base64String",e.value.binaryValue),m(3),w(h(5,2,e.value.binaryValue)||"-")}}function Qa(t,i){if(t&1&&(o(0,"div",1),l(1),C(2,"value"),a()),t&2){let e=s().$implicit;m(),T(" ",h(2,1,e.value)," ")}}function Ba(t,i){if(t&1&&(o(0,"div",2),l(1),c(2,Va,5,0,"ya-more",7),a(),c(3,$a,6,4)(4,Qa,3,3,"div",1)),t&2){let e,n=i.$implicit,r=i.$index;O("first",r===0),m(),T(" ",n.name," "),m(),_(n.value.type==="BINARY"?2:-1),m(),_((e=n.value.type)==="BINARY"?3:4)}}function qa(t,i){if(t&1&&(u(0,"mat-divider",5),R(1,Ba,5,5,null,null,Aa)),t&2){let e=s();m(),A(e.command.extra)}}function za(t,i){if(t&1&&(o(0,"div",2),l(1,"Extra acknowledgments"),a(),o(2,"div",1),u(3,"app-extra-acknowledgments-table",6),a()),t&2){let e=s();m(3),d("command",e.command)("showIcons",e.showIcons)}}function ja(t,i){if(t&1){let e=I();o(0,"ya-more",7)(1,"button",8),v("click",function(){S(e);let r=s(),p=s();return b(p.copyHex(r.binaryValue))}),l(2,"Copy hex"),a(),o(3,"button",8),v("click",function(){S(e);let r=s(),p=s();return b(p.copyBinary(r.binaryValue))}),l(4,"Copy binary"),a()()}}function Ya(t,i){if(t&1&&(o(0,"div",9),u(1,"app-hex",10),a(),o(2,"div",11)(3,"pre"),l(4),C(5,"hexDump"),a()()),t&2){let e=s();m(),d("base64String",e.binaryValue),m(3),w(h(5,2,e.binaryValue)||"-")}}function Ua(t,i){if(t&1&&(o(0,"div",1)(1,"pre",12),l(2),a()()),t&2){let e=s();m(2),w(e.stringValue)}}function Ga(t,i){if(t&1&&(o(0,"div",1),l(1),C(2,"value"),a()),t&2){let e=s();m(),T(" ",h(2,1,e)," ")}}function Wa(t,i){if(t&1&&(u(0,"mat-divider",5),o(1,"div",0),l(2," Return value "),c(3,ja,5,0,"ya-more",7),a(),c(4,Ya,6,4)(5,Ua,3,1,"div",1)(6,Ga,3,3,"div",1)),t&2){let e,n=i;m(3),_(n.type==="BINARY"?3:-1),m(),_((e=n.type)==="BINARY"?4:e==="STRING"?5:6)}}function Ka(t,i){t&1&&l(0," SUCCESS ")}function Ja(t,i){if(t&1&&l(0),t&2){let e=s();T(" FAILURE: ",e.command.completed==null?null:e.command.completed.message," ")}}function Xa(t,i){t&1&&l(0," - ")}function Za(t,i){if(t&1&&(o(0,"div",2),l(1),C(2,"cascadingPrefix"),a(),o(3,"div",1),u(4,"app-extra-acknowledgments-table",6),a()),t&2){let e=s().$implicit,n=s();m(),T("",h(2,3,e.key)," extra acknowledgments"),m(3),d("command",e.value)("showIcons",n.showIcons)}}function er(t,i){t&1&&l(0," SUCCESS ")}function tr(t,i){if(t&1&&l(0),t&2){let e=s().$implicit;T(" FAILURE: ",e.value.completed==null?null:e.value.completed.message," ")}}function ir(t,i){t&1&&l(0," - ")}function nr(t,i){if(t&1&&(u(0,"mat-divider",5),o(1,"div",0),l(2),C(3,"cascadingPrefix"),a(),o(4,"div",1),u(5,"app-yamcs-acknowledgments-table",6),a(),c(6,Za,5,5),o(7,"div",2),l(8),C(9,"cascadingPrefix"),a(),o(10,"div",1),c(11,er,1,0)(12,tr,1,1)(13,ir,1,0),a()),t&2){let e=i.$implicit,n=s();m(2),T(" ",h(3,8,e.key)," acknowledgments "),m(3),d("command",e.value)("showIcons",n.showIcons),m(),_(e.value.extraAcks.length?6:-1),m(2),T("",h(9,10,e.key)," completion"),m(3),_((e.value.completed==null?null:e.value.completed.status)==="OK"?11:-1),m(),_((e.value.completed==null?null:e.value.completed.status)==="NOK"?12:-1),m(),_(e.value.completed?-1:13)}}var we=class t{constructor(i){this.clipboard=i;this.showIcons=!0}copyHex(i){let e=M.convertBase64ToHex(i);this.clipboard.copy(e)}copyBinary(i){let e=window.atob(i);this.clipboard.copy(e)}static{this.\u0275fac=function(e){return new(e||t)(f(Ut))}}static{this.\u0275cmp=D({type:t,selectors:[["app-command-detail2"]],inputs:{command:"command",showIcons:"showIcons"},decls:41,vars:22,consts:[[1,"block-title",2,"padding-top","0"],[1,"block"],[1,"block-title"],[1,"block","command-text"],[3,"command"],[2,"margin-top","1em","margin-bottom","1em"],[3,"command","showIcons"],["icon","more_horiz"],["mat-menu-item","",3,"click"],[1,"block","no-print",2,"margin-top","4px"],[3,"base64String"],[1,"block","print-only"],[2,"margin","0","line-height","1em"]],template:function(e,n){if(e&1&&(o(0,"div",0),l(1,"ID"),a(),o(2,"div",1),l(3),a(),o(4,"div",2),l(5,"Command"),a(),o(6,"div",3),l(7),u(8,"app-command-arguments",4),a(),c(9,Pa,13,4)(10,Oa,13,4),u(11,"mat-divider",5),o(12,"div",0),l(13,"Time"),a(),o(14,"div",1),l(15),C(16,"datetime"),a(),o(17,"div",2),l(18,"Issuer"),a(),o(19,"div",1),l(20),c(21,Ha,1,1),a(),c(22,Na,4,1)(23,Fa,5,1)(24,qa,3,0),u(25,"mat-divider",5),o(26,"div",0),l(27,"Yamcs acknowledgments"),a(),o(28,"div",1),u(29,"app-yamcs-acknowledgments-table",6),a(),c(30,za,4,2)(31,Wa,7,2),o(32,"div",2),l(33,"Completion"),a(),o(34,"div",1),c(35,Ka,1,0)(36,Ja,1,1)(37,Xa,1,0),a(),R(38,nr,14,12,null,null,Ra),C(40,"keyvalue")),e&2){let r;m(3),T(" ",n.command.id,`
`),m(4),T(" ",n.command.commandName," "),m(),d("command",n.command),m(),_(n.command.unprocessedBinary&&n.command.unprocessedBinary!==n.command.binary?9:-1),m(),_(n.command.binary?10:-1),m(5),T(" ",h(16,18,n.command.generationTime),`
`),m(5),T(" ",n.command.username," "),m(),_(n.command.origin?21:-1),m(),_(n.command.queue?22:-1),m(),_(n.command.comment?23:-1),m(),_(n.command.extra.length?24:-1),m(5),d("command",n.command)("showIcons",n.showIcons),m(),_(n.command.extraAcks.length?30:-1),m(),_((r=n.command.completed==null?null:n.command.completed.returnValue)?31:-1,r),m(4),_((n.command.completed==null?null:n.command.completed.status)==="OK"?35:-1),m(),_((n.command.completed==null?null:n.command.completed.status)==="NOK"?36:-1),m(),_(n.command.completed?-1:37),m(),A(h(40,20,n.command.cascadedRecordsByPrefix))}},dependencies:[si,bt,To,ai,E,vn,Re,Le,ht,ge,oi,vt,wo],styles:[".block-title.first[_ngcontent-%COMP%]{padding-top:0}"],changeDetection:0})}};function or(t,i){if(t&1&&u(0,"app-command-detail2",0)(1,"div",1),t&2){let e=i.$implicit;d("command",e)("showIcons",!1)}}var ci=class t{static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=D({type:t,selectors:[["app-command-history-printable"]],inputs:{pageTitle:"pageTitle",data:"data"},decls:2,vars:0,consts:[[3,"command","showIcons"],[2,"page-break-after","always"]],template:function(e,n){e&1&&R(0,or,2,2,null,null,Q),e&2&&A(n.data)},dependencies:[we,E],encapsulation:2,changeDetection:0})}};var di=class t{constructor(i,e,n){this.dialogRef=i;this.yamcs=e;this.data=n;this.delimiterOptions=[{id:"COMMA",label:"Comma"},{id:"SEMICOLON",label:"Semicolon"},{id:"TAB",label:"Tab"}];this.downloadURL$=new P(null);this.form=new Bn({start:new xe(null),stop:new xe(null),delimiter:new xe(null,tt.required)});this.form.setValue({start:n.start?M.toISOString(n.start):"",stop:n.stop?M.toISOString(n.stop):"",delimiter:"TAB"}),this.formChangeSubscription=this.form.valueChanges.subscribe(()=>{this.updateURL()}),this.updateURL()}closeDialog(){this.dialogRef.close(!0)}updateURL(){if(this.form.valid){let i={delimiter:this.form.value.delimiter};this.form.value.start&&(i.start=M.toISOString(this.form.value.start)),this.form.value.stop&&(i.stop=M.toISOString(this.form.value.stop));let e=this.yamcs.yamcsClient.getCommandsDownloadURL(this.yamcs.instance,i);this.downloadURL$.next(e)}else this.downloadURL$.next(null)}ngOnDestroy(){this.formChangeSubscription?.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(f(rt),f(L),f(Yt))}}static{this.\u0275cmp=D({type:t,selectors:[["ng-component"]],decls:22,vars:6,consts:[["mat-dialog-title",""],[1,"ya-form"],[3,"formGroup"],["formControlName","start"],["formControlName","stop"],["formControlName","delimiter",3,"options"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","link","disabled"]],template:function(e,n){e&1&&(o(0,"h2",0),l(1,"Export commands"),a(),o(2,"mat-dialog-content",1)(3,"form",2)(4,"label"),l(5," Start "),u(6,"ya-date-time-input",3),a(),u(7,"br"),o(8,"label"),l(9," Stop "),u(10,"ya-date-time-input",4),a(),u(11,"br"),o(12,"label"),l(13," CSV column delimiter "),u(14,"br")(15,"ya-select",5),a()()(),o(16,"mat-dialog-actions",6)(17,"ya-button",7),l(18,"CANCEL"),a(),o(19,"ya-download-button",8),C(20,"async"),v("click",function(){return n.closeDialog()}),l(21," DOWNLOAD "),a()()),e&2&&(m(3),d("formGroup",n.form),m(12),d("options",n.delimiterOptions),m(4),d("link",h(20,4,n.downloadURL$))("disabled",!n.form.valid))},dependencies:[E,G,Ce,K,_e,fe,he,mt,st,dt,ct,J,Te,eo,Ne],encapsulation:2})}};var pi=class t{constructor(i){this.yamcs=i}transform(i){if(!i)return null;let e=this.yamcs.instance;return this.yamcs.yamcsClient.getCommandDownloadURL(e,i.id)}static{this.\u0275fac=function(e){return new(e||t)(f(L,16))}}static{this.\u0275pipe=Pt({name:"commandDownloadLink",type:t,pure:!0})}};var ui=class{constructor(i){this.watermarkObserver=i;this.dirty=!1;this.archiveRecords=[];this.bufferSize=500;this.bufferWatermark=400;this.pointer=0;this.alreadyWarned=!1;this.realtimeBuffer=Array(this.bufferSize).fill(void 0)}addArchiveData(i){this.archiveRecords=this.archiveRecords.concat(i),this.dirty=!0}addRealtimeCommand(i){this.pointer<this.bufferSize&&(this.realtimeBuffer[this.pointer]=i,this.pointer>=this.bufferWatermark&&this.watermarkObserver&&!this.alreadyWarned&&(this.alreadyWarned=!0,this.watermarkObserver()),this.pointer=this.pointer+1),this.dirty=!0}reset(){this.archiveRecords=[],this.realtimeBuffer.fill(void 0),this.pointer=0,this.alreadyWarned=!1,this.dirty=!0}snapshot(){let i=[...this.archiveRecords];return this.realtimeBuffer.map(e=>{if(!e)return;let n=i.findIndex(r=>r.id==e.id);n===-1?i.push(new Ee(e)):i[n]=i[n].mergeEntry(e)}),i.sort((e,n)=>{let r=-e.generationTime.localeCompare(n.generationTime);return r===0&&(r=-e.origin.localeCompare(n.origin)),r!==0?r:n.sequenceNumber-e.sequenceNumber}),i}compact(i){let e=this.snapshot();e.length=Math.min(i,e.length),this.reset(),this.archiveRecords=e,this.dirty=!0}};var _i=class extends Vn{constructor(e,n){super();this.yamcs=e;this.pageSize=100;this.blockHasMore=!1;this.records$=new P([]);this.loading$=new P(!1);this.streaming$=new P(!1);this.namespaces$=new P([]);this.syncSubscription=n.sync(()=>{this.buffer.dirty&&!this.loading$.getValue()&&(this.emitCommands(),this.buffer.dirty=!1)}),this.buffer=new ui(()=>{this.blockHasMore=!0,this.buffer.compact(500)})}connect(){return this.records$}emitCommands(){this.records$.next(this.buffer.snapshot())}loadEntries(e){return this.loading$.next(!0),this.loadPage(Ri(Li({},e),{limit:this.pageSize})).then(n=>{this.buffer.reset(),this.blockHasMore=!1,this.buffer.addArchiveData(n.map(r=>new Ee(r))),this.emitCommands()}).finally(()=>{this.loading$.next(!1)})}hasMore(){return!!this.continuationToken&&!this.blockHasMore}async loadPage(e){return this.yamcs.yamcsClient.getCommandHistoryEntries(this.yamcs.instance,e).then(n=>{this.continuationToken=n.continuationToken;var r=n.commands||[];for(let p of r)this.updateNamespaces(p);return r})}async loadMoreData(e){if(this.continuationToken)return this.loadPage(Ri(Li({},e),{next:this.continuationToken,limit:this.pageSize})).then(n=>{let r=n.map(p=>new Ee(p));this.buffer.addArchiveData(r),this.emitCommands()})}startStreaming(){this.streaming$.next(!0),this.realtimeSubscription=this.yamcs.yamcsClient.createCommandSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor},e=>{this.loading$.getValue()||(this.updateNamespaces(e),this.buffer.addRealtimeCommand(e))})}updateNamespaces(e){let n=this.namespaces$.value;if(e.aliases)for(let r in e.aliases)n.indexOf(r)===-1&&(n.push(r),n.sort(),this.namespaces$.next([...n]))}stopStreaming(){this.realtimeSubscription?.cancel(),this.streaming$.next(!1)}disconnect(){this.syncSubscription?.unsubscribe(),this.records$.complete(),this.loading$.complete(),this.streaming$.complete(),this.namespaces$.complete()}isEmpty(){return!this.records$.getValue().length}};var Ho=(t,i)=>({c:t,template:i}),rr=()=>["detail"],lr=t=>["/commanding/history",t],mr=t=>({c:t});function sr(t,i){if(t&1){let e=I();o(0,"ya-page-button",9),v("clicked",function(){S(e);let r=s();return b(r.startStreaming())}),l(1," Start streaming "),a()}}function cr(t,i){if(t&1){let e=I();o(0,"ya-page-button",10),v("clicked",function(){S(e);let r=s();return b(r.stopStreaming())}),l(1," Stop streaming "),a()}}function dr(t,i){if(t&1&&(u(0,"br")(1,"mat-divider")(2,"br"),o(3,"ya-button",13),l(4," Resend "),a()),t&2){let e=s(),n=s();m(3),d("routerLink","/commanding/send"+(e==null?null:e.commandName))("queryParams",Z(2,Ho,n.yamcs.context,e==null?null:e.id))}}function pr(t,i){if(t&1&&(o(0,"ya-detail-toolbar"),l(1,"Command detail"),a(),o(2,"div",11),u(3,"app-command-detail2",12),c(4,dr,5,5),o(5,"p"),l(6,"\xA0"),a()()),t&2){let e=s();m(3),d("command",i),m(),_(e.showResend()?4:-1)}}function ur(t,i){t&1&&(o(0,"ya-detail-toolbar"),l(1,"Select a command"),a())}function _r(t,i){if(t&1&&(o(0,"ya-button",19),C(1,"async"),l(2," Export "),a()),t&2){let e;s();let n=k(9),r=s();d("matMenuTriggerFor",n)("disabled",!((e=h(1,2,r.dataSource.records$))!=null&&e.length))}}function Cr(t,i){if(t&1&&u(0,"ya-option",25),t&2){let e=i.$implicit;d("id",e)("label",e)}}function fr(t,i){if(t&1){let e=I();u(0,"ya-date-time-input",70)(1,"ya-date-time-input",71),o(2,"ya-button",69),v("click",function(){S(e);let r=s(2);return b(r.applyCustomDates())}),l(3," Apply "),a()}if(t&2){let e=s(2);m(2),d("disabled",e.filterForm.invalid)}}function hr(t,i){if(t&1){let e=I();o(0,"ya-button",72),v("click",function(){S(e);let r=s(2);return b(r.jumpToNow())}),l(1,"Jump to now"),a()}}function gr(t,i){t&1&&u(0,"ya-dots")}function vr(t,i){t&1&&(o(0,"div",32),l(1," Listening for commands "),u(2,"ya-dots",73),a())}function yr(t,i){if(t&1&&(o(0,"span"),l(1," Showing entries from "),o(2,"b"),l(3,"the last hour"),a(),l(4," ending at "),o(5,"b"),l(6),C(7,"datetime"),a(),l(8," (Mission Time) "),a()),t&2){let e=s(2);m(6),w(h(7,1,e.validStop))}}function xr(t,i){if(t&1&&(o(0,"span"),l(1," Showing entries from "),o(2,"b"),l(3,"the last 6 hours"),a(),l(4," ending at "),o(5,"b"),l(6),C(7,"datetime"),a(),l(8," (Mission Time) "),a()),t&2){let e=s(2);m(6),w(h(7,1,e.validStop))}}function Sr(t,i){if(t&1&&(o(0,"span"),l(1," Showing entries from "),o(2,"b"),l(3,"the last 24 hours"),a(),l(4," ending at "),o(5,"b"),l(6),C(7,"datetime"),a(),l(8," (Mission Time) "),a()),t&2){let e=s(2);m(6),w(h(7,1,e.validStop))}}function br(t,i){t&1&&(o(0,"span"),l(1," Showing entries from "),o(2,"b"),l(3,"all time"),a()())}function Tr(t,i){if(t&1&&(o(0,"span"),l(1," Showing entries from "),o(2,"b"),l(3),C(4,"datetime"),a(),l(5," to "),o(6,"b"),l(7),C(8,"datetime"),a(),l(9," (Mission Time) "),a()),t&2){let e=s(2);m(3),w(h(4,2,e.validStart)),m(4),w(h(8,4,e.validStop))}}function Dr(t,i){t&1&&(o(0,"th",74),l(1,"ID"),a())}function wr(t,i){if(t&1&&(o(0,"td",75)(1,"a",13),l(2),a()()),t&2){let e=i.$implicit,n=s(2);m(),d("routerLink",B(3,lr,e.id))("queryParams",B(5,mr,n.yamcs.context)),m(),T(" ",e.id," ")}}function Er(t,i){t&1&&(o(0,"th",74),l(1,"Time"),a())}function Ir(t,i){if(t&1&&(o(0,"td",75),l(1),C(2,"datetime"),a()),t&2){let e=i.$implicit;m(),T(" ",h(2,1,e.generationTime)," ")}}function Mr(t,i){t&1&&(o(0,"th",76)(1,"mat-icon",77),l(2,"comment"),a()())}function kr(t,i){if(t&1&&(o(0,"mat-icon",79),l(1,"comment"),a()),t&2){let e=s().$implicit;d("matTooltip",e.comment)}}function Lr(t,i){t&1&&l(0," - ")}function Rr(t,i){if(t&1&&(o(0,"td",78),c(1,kr,2,1,"mat-icon",79)(2,Lr,1,0),a()),t&2){let e=i.$implicit;m(),_(e.comment?1:-1),m(),_(e.comment?-1:2)}}function Ar(t,i){t&1&&(o(0,"th",74),l(1,"Command"),a())}function Pr(t,i){if(t&1&&(o(0,"td",75),u(1,"ya-highlight",80),a()),t&2){let e=i.$implicit,n=s(2);m(),d("text",e.commandName)("term",n.filterForm.value.filter)}}function Or(t,i){if(t&1&&(o(0,"th",74),l(1),a()),t&2){let e=s().$implicit;m(),T(" ",e.label," ")}}function Hr(t,i){if(t&1&&u(0,"ya-highlight",80),t&2){let e=s(4);d("text",i)("term",e.filterForm.value.filter)}}function Nr(t,i){t&1&&l(0," - ")}function Fr(t,i){if(t&1&&(o(0,"td",75),c(1,Hr,1,2,"ya-highlight",80),C(2,"alias"),c(3,Nr,1,0),a()),t&2){let e,n=i.$implicit,r=s().$implicit;m(),_((e=Mt(2,1,n,r.id))?1:3,e)}}function Vr(t,i){if(t&1&&(y(0,46),c(1,Or,2,1,"th",39)(2,Fr,4,4,"td",40),x()),t&2){let e=i.$implicit;d("matColumnDef",e.id)}}function $r(t,i){t&1&&(o(0,"th",74),l(1,"Issuer"),a())}function Qr(t,i){if(t&1&&(o(0,"span"),l(1),a()),t&2){let e=s().$implicit;m(),T("@",e.origin,"")}}function Br(t,i){if(t&1&&(o(0,"td",75),l(1),c(2,Qr,2,1,"span"),a()),t&2){let e=i.$implicit;m(),T(" ",e.username," "),m(),_(e.origin?2:-1)}}function qr(t,i){t&1&&(o(0,"th",74),l(1,"Queue"),a())}function zr(t,i){if(t&1&&(o(0,"td",75),l(1),a()),t&2){let e=i.$implicit;m(),T(" ",e.queue||"-"," ")}}function jr(t,i){t&1&&(o(0,"th",74),l(1,"Sequence number"),a())}function Yr(t,i){if(t&1&&(o(0,"td",75),l(1),a()),t&2){let e=i.$implicit;m(),T(" ",e.sequenceNumber," ")}}function Ur(t,i){t&1&&(o(0,"th",81),l(1," Q "),a())}function Gr(t,i){if(t&1&&(o(0,"td",82)(1,"div",83),u(2,"app-acknowledgment-icon",84),a()()),t&2){let e=i.$implicit;m(2),d("ack",e.queued)}}function Wr(t,i){t&1&&(o(0,"th",85),l(1," R "),a())}function Kr(t,i){if(t&1&&u(0,"app-transmission-constraints-icon",12),t&2){let e=s().$implicit;d("command",e)}}function Jr(t,i){if(t&1&&u(0,"app-acknowledgment-icon",84),t&2){let e=s().$implicit;d("ack",e.released)}}function Xr(t,i){if(t&1&&(o(0,"td",82)(1,"div",83),c(2,Kr,1,1,"app-transmission-constraints-icon",12)(3,Jr,1,1,"app-acknowledgment-icon",84),a()()),t&2){let e=i.$implicit;m(2),_(e.released?-1:2),m(),_(e.released?3:-1)}}function Zr(t,i){t&1&&(o(0,"th",86),l(1," S "),a())}function el(t,i){if(t&1&&(o(0,"td",82)(1,"div",83),u(2,"app-acknowledgment-icon",84),a()()),t&2){let e=i.$implicit;m(2),d("ack",e.sent)}}function tl(t,i){t&1&&(o(0,"th",87),l(1,"Acks"),a())}function il(t,i){if(t&1&&u(0,"app-acknowledgment-icon",84),t&2){let e=i.$implicit;d("ack",e)}}function nl(t,i){t&1&&l(0," - ")}function ol(t,i){if(t&1&&(o(0,"td",88)(1,"div",83),R(2,il,1,1,"app-acknowledgment-icon",84,Q),a(),c(4,nl,1,0),a()),t&2){let e=i.$implicit;m(2),A(e.extraAcks),m(2),_(e.extraAcks.length?-1:4)}}function al(t,i){t&1&&(o(0,"th",89),l(1,"Completion"),a())}function rl(t,i){t&1&&l(0," SUCCESS ")}function ll(t,i){if(t&1&&(o(0,"span",91),l(1,"FAILURE"),a()),t&2){let e=s().$implicit;d("matTooltip",e.completed==null?null:e.completed.message)}}function ml(t,i){t&1&&l(0," - ")}function sl(t,i){if(t&1&&(o(0,"td",90),c(1,rl,1,0)(2,ll,2,1,"span",91)(3,ml,1,0),a()),t&2){let e=i.$implicit;m(),_((e.completed==null?null:e.completed.status)==="OK"?1:-1),m(),_((e.completed==null?null:e.completed.status)==="NOK"?2:-1),m(),_(e.completed?-1:3)}}function cl(t,i){t&1&&u(0,"th",92)}function dl(t,i){if(t&1&&(o(0,"button",94),l(1," Resend "),a(),u(2,"mat-divider")),t&2){let e=s().$implicit,n=s(2);d("routerLink","/commanding/send"+e.commandName)("queryParams",Z(2,Ho,n.yamcs.context,e.id))}}function pl(t,i){if(t&1&&(u(0,"mat-divider"),o(1,"ya-download-menu-item",95),C(2,"commandDownloadLink"),l(3," Download "),a()),t&2){let e=s().$implicit;m(),d("link",h(2,1,e))}}function ul(t,i){if(t&1){let e=I();o(0,"td",75)(1,"ya-more"),c(2,dl,3,5),o(3,"button",93),v("click",function(){let r=S(e).$implicit,p=s(2);return b(p.copyHex(r))}),l(4,"Copy hex"),a(),o(5,"button",93),v("click",function(){let r=S(e).$implicit,p=s(2);return b(p.copyBinary(r))}),l(6,"Copy binary"),a(),c(7,pl,4,3),a()()}if(t&2){let e=s(2);m(2),_(e.showResend()?2:-1),m(5),_(e.showCommandExports()?7:-1)}}function _l(t,i){if(t&1&&u(0,"app-command-arguments",100),t&2){let e=s(2).$implicit;d("command",e)("nomargin",!0)}}function Cl(t,i){t&1&&l(0," - ")}function fl(t,i){if(t&1&&(o(0,"div",97)(1,"div",98),l(2,"Arguments"),a(),o(3,"div",99),c(4,_l,1,2,"app-command-arguments",100)(5,Cl,1,0),a()()),t&2){let e=s().$implicit;m(4),_(e.userAssignments.length?4:-1),m(),_(e.userAssignments.length?-1:5)}}function hl(t,i){if(t&1&&(o(0,"div",101),u(1,"app-hex",102),a(),o(2,"div",103)(3,"pre",104),l(4),C(5,"hexDump"),a()()),t&2){let e=s();m(),d("base64String",e.binaryValue),m(3),w(h(5,2,e.binaryValue)||"-")}}function gl(t,i){if(t&1&&(o(0,"div",99)(1,"pre",105),l(2),a()()),t&2){let e=s();m(2),w(e.stringValue)}}function vl(t,i){if(t&1&&(o(0,"div",99),l(1),C(2,"value"),a()),t&2){let e=s();m(),T(" ",h(2,1,e)," ")}}function yl(t,i){if(t&1&&c(0,hl,6,4)(1,gl,3,1,"div",99)(2,vl,3,3,"div",99),t&2){let e;_((e=i.type)==="BINARY"?0:e==="STRING"?1:2)}}function xl(t,i){t&1&&l(0," - ")}function Sl(t,i){if(t&1&&(o(0,"div")(1,"div",98),l(2,"Return value"),a(),c(3,yl,3,1)(4,xl,1,0),a()),t&2){let e,n=s().$implicit;m(3),_((e=n.completed==null?null:n.completed.returnValue)?3:-1,e),m(),_(n.completed!=null&&n.completed.returnValue?-1:4)}}function bl(t,i){if(t&1&&(o(0,"td",75),C(1,"async"),o(2,"div",96),c(3,fl,6,2,"div",97)(4,Sl,5,2,"div"),u(5,"div",18),a()()),t&2){let e;s();let n=k(5),r=k(34),p=k(38);Be("colspan",(e=h(1,3,n.displayedColumns$))==null?null:e.length),m(3),_(r.checked?3:-1),m(),_(p.checked?4:-1)}}function Tl(t,i){t&1&&u(0,"tr",106)}function Dl(t,i){if(t&1){let e=I();o(0,"tr",107),C(1,"async"),v("click",function(){let r=S(e).$implicit,p=s(2);return b(p.selectRecord(r))}),a()}if(t&2){let e=i.$implicit;s();let n=k(34),r=k(38),p=s();O("expanded",n.checked||r.checked)("selected",h(1,8,p.selectedRecord$)===e)("success",(e.completed==null?null:e.completed.status)==="OK")("failed",(e.completed==null?null:e.completed.status)==="NOK")}}function wl(t,i){if(t&1){let e=I();o(0,"tr",108),v("click",function(){let r=S(e).$implicit,p=s(2);return b(p.selectRecord(r))}),a()}if(t&2){s();let e=k(34),n=k(38);O("expanded",e.checked||n.checked)}}function El(t,i){if(t&1){let e=I();o(0,"div",8)(1,"form",14)(2,"div",15),u(3,"ya-search-filter",16)(4,"ya-column-chooser",17,0)(6,"div",18),c(7,_r,3,4,"ya-button",19),o(8,"mat-menu",20,1)(10,"button",21),v("click",function(){S(e);let r=s();return b(r.printReport())}),l(11," Printer-friendly "),a(),o(12,"button",22),v("click",function(){S(e);let r=s();return b(r.exportCsv())}),l(13," CSV format "),a()()(),o(14,"div",15)(15,"ya-select",23),u(16,"ya-option",24),R(17,Cr,1,2,"ya-option",25,Q),a(),o(19,"ya-select",26),u(20,"ya-option",27)(21,"ya-option",28)(22,"ya-option",29)(23,"ya-option",30)(24,"ya-option",31),a(),c(25,fr,4,1)(26,hr,2,0,"ya-button")(27,gr,1,0,"ya-dots"),C(28,"async"),c(29,vr,3,0,"div",32),C(30,"async"),a()(),o(31,"div",33)(32,"div",34)(33,"ya-table-toggle",35,2),l(35,"Arguments"),a(),l(36," \xA0\xA0 "),o(37,"ya-table-toggle",36,3),l(39,"Return value"),a()(),c(40,yr,9,3,"span")(41,xr,9,3,"span")(42,Sr,9,3,"span")(43,br,4,0,"span")(44,Tr,10,6,"span"),a(),o(45,"table",37),y(46,38),c(47,Dr,2,0,"th",39)(48,wr,3,7,"td",40),x(),y(49,41),c(50,Er,2,0,"th",39)(51,Ir,3,3,"td",40),x(),y(52,42),c(53,Mr,3,0,"th",43)(54,Rr,3,2,"td",44),x(),y(55,45),c(56,Ar,2,0,"th",39)(57,Pr,2,2,"td",40),x(),R(58,Vr,3,1,"ng-container",46,Q),C(60,"async"),y(61,47),c(62,$r,2,0,"th",39)(63,Br,3,2,"td",40),x(),y(64,48),c(65,qr,2,0,"th",39)(66,zr,2,1,"td",40),x(),y(67,49),c(68,jr,2,0,"th",39)(69,Yr,2,1,"td",40),x(),y(70,50),c(71,Ur,2,0,"th",51)(72,Gr,3,1,"td",52),x(),y(73,53),c(74,Wr,2,0,"th",54)(75,Xr,4,2,"td",52),x(),y(76,55),c(77,Zr,2,0,"th",56)(78,el,3,1,"td",52),x(),y(79,57),c(80,tl,2,0,"th",58)(81,ol,5,1,"td",59),x(),y(82,60),c(83,al,2,0,"th",61)(84,sl,4,3,"td",62),x(),y(85,63),c(86,cl,1,0,"th",64)(87,ul,8,2,"td",40),x(),y(88,65),c(89,bl,6,5,"td",40),x(),c(90,Tl,1,0,"tr",66),C(91,"async"),c(92,Dl,2,10,"tr",67),C(93,"async"),c(94,wl,1,2,"tr",68),a(),o(95,"mat-toolbar"),u(96,"span",18),o(97,"ya-button",69),v("click",function(){S(e);let r=s();return b(r.loadMoreData())}),l(98," Load more "),a(),u(99,"span",18),a()()}if(t&2){let e,n=k(5),r=s();m(),d("formGroup",r.filterForm),m(3),d("columns",r.columns),m(3),_(r.showCommandExports()?7:-1),m(10),A(r.config.queueNames),m(8),_(r.filterForm.value.interval==="CUSTOM"?25:-1),m(),_(r.filterForm.value.interval!=="CUSTOM"?26:-1),m(),_(h(28,13,r.dataSource.loading$)?27:-1),m(2),_(h(30,15,r.dataSource.streaming$)?29:-1),m(11),_((e=r.appliedInterval)==="PT1H"?40:e==="PT6H"?41:e==="P1D"?42:e==="NO_LIMIT"?43:e==="CUSTOM"?44:-1),m(5),d("dataSource",r.dataSource),m(13),A(h(60,17,r.aliasColumns$)),m(32),d("matHeaderRowDef",h(91,19,n.displayedColumns$)),m(2),d("matRowDefColumns",h(93,21,n.displayedColumns$)),m(2),d("matRowDefColumns",Ht(23,rr)),m(3),d("disabled",!r.dataSource.hasMore())}}var Lt="PT1H",Ci=class t extends Un{constructor(e,n,r,p,g,N,Me){super();this.yamcs=e;this.route=p;this.printService=g;this.clipboard=N;this.dialog=Me;this.selectedRecord$=new P(null);this.filterForm=new it({filter:new te(null),queue:new te(null),interval:new te(Lt),customStart:new te(null),customStop:new te(null)});this.columns=[{id:"commandId",label:"ID",alwaysVisible:!0},{id:"generationTime",label:"Time",alwaysVisible:!0},{id:"comment",label:"Comment",visible:!0},{id:"command",label:"Command",alwaysVisible:!0},{id:"issuer",label:"Issuer"},{id:"queue",label:"Queue"},{id:"queued",label:"Queued",visible:!0},{id:"released",label:"Released",visible:!0},{id:"sent",label:"Sent",visible:!0},{id:"acknowledgments",label:"Extra acknowledgments",visible:!0},{id:"completion",label:"Completion",visible:!0},{id:"actions",label:"",alwaysVisible:!0}];this.aliasColumns$=new P([]);this.subscriptions=[];this.setTitle("Command history"),this.config=n.getConfig(),this.user=r.getUser(),this.dataSource=new _i(this.yamcs,this.synchronizer)}ngOnInit(){this.initializeOptions(),this.loadData(),this.filterForm.get("filter").valueChanges.pipe(ln(400)).forEach(e=>{this.loadData()}),this.filterForm.get("queue").valueChanges.forEach(e=>{this.loadData()}),this.filterForm.get("interval").valueChanges.forEach(e=>{if(e==="CUSTOM"){let n=this.validStart||this.yamcs.getMissionTime(),r=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(M.toISOString(n)),this.filterForm.get("customStop").setValue(M.toISOString(r))}else e==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=e,this.loadData()):e&&(this.validStop=this.yamcs.getMissionTime(),this.validStart=M.subtractDuration(this.validStop,e),this.appliedInterval=e,this.loadData())})}ngAfterViewInit(){this.subscriptions.push(this.dataSource.namespaces$.subscribe(e=>{for(let p of this.aliasColumns$.value){let g=this.columns.indexOf(p);g!==-1&&this.columns.splice(g,1)}let n=[];for(let p of e){let g={id:p,label:p,alwaysVisible:!0};n.push(g)}let r=this.columns.findIndex(p=>p.id==="command");this.columns.splice(r+1,0,...n),this.aliasColumns$.next(n),this.columnChooser.recalculate(this.columns)}))}initializeOptions(){let e=this.route.snapshot.queryParamMap;if(e.has("filter")){let n=e.get("filter");this.filterForm.get("filter").setValue(n)}if(e.has("queue")){let n=e.get("queue");this.filterForm.get("queue").setValue(n)}if(e.has("interval"))if(this.appliedInterval=e.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let n=e.get("customStart");this.filterForm.get("customStart").setValue(n),this.validStart=new Date(n);let r=e.get("customStop");this.filterForm.get("customStop").setValue(r),this.validStop=new Date(r)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=M.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=Lt,this.validStop=this.yamcs.getMissionTime(),this.validStart=M.subtractDuration(this.validStop,Lt)}jumpToNow(){let e=this.filterForm.value.interval;e==="NO_LIMIT"?this.filterForm.get("interval").setValue(Lt):e==="CUSTOM"?this.filterForm.get("interval").setValue(Lt):e&&(this.validStop=this.yamcs.getMissionTime(),this.validStart=M.subtractDuration(this.validStop,e),this.loadData())}startStreaming(){this.filterForm.get("interval").setValue("NO_LIMIT"),this.dataSource.startStreaming()}stopStreaming(){this.dataSource.stopStreaming()}applyCustomDates(){this.validStart=M.toDate(this.filterForm.value.customStart),this.validStop=M.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){let{controls:e}=this.filterForm;this.updateURL();let n={};this.validStart&&(n.start=this.validStart.toISOString()),this.validStop&&(n.stop=this.validStop.toISOString());let r=e.filter.value;r&&(n.q=r);let p=e.queue.value;p&&(n.queue=p),this.dataSource.loadEntries(n).catch(g=>this.messageService.showError(g))}loadMoreData(){let{controls:e}=this.filterForm,n={};this.validStart&&(n.start=this.validStart.toISOString());let r=e.filter.value;r&&(n.q=r);let p=e.queue.value;p&&(n.queue=p),this.dataSource.loadMoreData(n).catch(g=>this.messageService.showError(g))}showResend(){return this.config.tc&&this.user.hasAnyObjectPrivilegeOfType("Command")}showCommandExports(){return this.config.commandExports}updateURL(){let{controls:e}=this.filterForm;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:e.filter.value||null,queue:e.queue.value||null,interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?e.customStart.value:null,customStop:this.appliedInterval==="CUSTOM"?e.customStop.value:null},queryParamsHandling:"merge"})}copyHex(e){let n=M.convertBase64ToHex(e.binary);this.clipboard.copy(n)}copyBinary(e){let n=window.atob(e.binary);this.clipboard.copy(n)}selectRecord(e){this.selectedRecord$.next(e),this.openDetailPane()}printReport(){let e=this.dataSource.records$.value.slice().reverse();this.printService.printComponent(ci,"Command Report",e)}exportCsv(){this.dialog.open(di,{width:"400px",data:{start:this.validStart,stop:this.validStop,q:this.filterForm.controls.filter.value}})}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}static{this.\u0275fac=function(n){return new(n||t)(f(L),f(_t),f(yt),f(pe),f(ho),f(Ut),f(lt))}}static{this.\u0275cmp=D({type:t,selectors:[["ng-component"]],viewQuery:function(n,r){if(n&1&&U(He,5),n&2){let p;F(p=V())&&(r.columnChooser=p.first)}},features:[Qe],decls:14,vars:10,consts:[["columnChooser",""],["exportMenu","matMenu"],["args",""],["rv",""],["icon","play_arrow"],["matTooltip","Pause streaming commands","icon","pause"],["matTooltip","Jump to now","color","primary","icon","refresh",3,"clicked"],[1,"table-wrapper"],[1,"panel-content"],["icon","play_arrow",3,"clicked"],["matTooltip","Pause streaming commands","icon","pause",3,"clicked"],[2,"padding","0 16px"],[3,"command"],[3,"routerLink","queryParams"],[3,"formGroup"],[1,"filter-bar"],["formControlName","filter","placeholder","Filter by text search"],["preferenceKey","cmdhist",3,"columns"],[2,"flex","1 1 auto"],["appearance","primary","dropdown","true","icon","download",1,"no-margin",3,"matMenuTriggerFor","disabled"],["overlapTrigger","false","xPosition","before",1,"ya-menu"],["mat-menu-item","","matTooltip","Print preview with one page per command","matTooltipPosition","right",3,"click"],["mat-menu-item","","matTooltip","Command table, one row per command","matTooltipPosition","right",3,"click"],["formControlName","queue"],["id","","label","Any queue"],[3,"id","label"],["icon","access_time","formControlName","interval"],["id","PT1H","label","Last hour"],["id","PT6H","label","Last 6 hours"],["id","P1D","label","Last 24 hours"],["id","NO_LIMIT","label","No limit"],["id","CUSTOM","label","Custom","group","true"],[2,"text-align","right","flex","1 1 150px"],[1,"table-status"],[1,"toggles"],["preferenceKey","cmdhist.arguments"],["preferenceKey","cmdhist.returnValue"],["mat-table","","multiTemplateDataRows","",1,"ya-data-table","expand","nohover",3,"dataSource"],["matColumnDef","commandId"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","generationTime"],["matColumnDef","comment"],["mat-header-cell","","class","iconcol",4,"matHeaderCellDef"],["mat-cell","","class","iconcol",4,"matCellDef"],["matColumnDef","command"],[3,"matColumnDef"],["matColumnDef","issuer"],["matColumnDef","queue"],["matColumnDef","sequenceNumber"],["matColumnDef","queued"],["mat-header-cell","","class","iconcol dense","style","text-align: center","matTooltip","Command queued",4,"matHeaderCellDef"],["mat-cell","","class","iconcol dense","style","text-align: center",4,"matCellDef"],["matColumnDef","released"],["mat-header-cell","","class","iconcol dense","style","text-align: center","matTooltip","Command released",4,"matHeaderCellDef"],["matColumnDef","sent"],["mat-header-cell","","class","iconcol dense","style","text-align: center","matTooltip","Command sent",4,"matHeaderCellDef"],["matColumnDef","acknowledgments"],["mat-header-cell","","class","dense",4,"matHeaderCellDef"],["mat-cell","","class","dense",4,"matCellDef"],["matColumnDef","completion"],["mat-header-cell","","style","padding-left: 8px",4,"matHeaderCellDef"],["mat-cell","","class","completion","style","text-align: center; padding-left: 8px",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["matColumnDef","detail"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","item-row",3,"expanded","selected","success","failed","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","item-detail",3,"expanded","click",4,"matRowDef","matRowDefColumns"],[3,"click","disabled"],["formControlName","customStart"],["formControlName","customStop"],[3,"click"],["fontSize","16px"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"iconcol"],["matTooltip","Comment",1,"icon16"],["mat-cell","",1,"iconcol"],[1,"icon16",3,"matTooltip"],[3,"text","term"],["mat-header-cell","","matTooltip","Command queued",1,"iconcol","dense",2,"text-align","center"],["mat-cell","",1,"iconcol","dense",2,"text-align","center"],[2,"display","flex","align-items","center"],[3,"ack"],["mat-header-cell","","matTooltip","Command released",1,"iconcol","dense",2,"text-align","center"],["mat-header-cell","","matTooltip","Command sent",1,"iconcol","dense",2,"text-align","center"],["mat-header-cell","",1,"dense"],["mat-cell","",1,"dense"],["mat-header-cell","",2,"padding-left","8px"],["mat-cell","",1,"completion",2,"text-align","center","padding-left","8px"],[3,"matTooltip"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"routerLink","queryParams"],[3,"link"],[2,"display","flex"],[2,"min-width","300px"],[1,"block-title",2,"padding-top","0"],[1,"block"],[3,"command","nomargin"],[1,"block","no-print",2,"margin-top","4px"],[3,"base64String"],[1,"block","print-only"],[2,"margin","0","line-height","1em"],[2,"margin","0","margin-top","4px","line-height","1em"],["mat-header-row",""],["mat-row","",1,"item-row",3,"click"],["mat-row","",1,"item-detail",3,"click"]],template:function(n,r){if(n&1&&(o(0,"app-instance-page")(1,"app-instance-toolbar"),l(2," Command history \xA0\xA0\xA0 "),c(3,sr,2,0,"ya-page-button",4),C(4,"async"),c(5,cr,2,0,"ya-page-button",5),C(6,"async"),o(7,"ya-page-icon-button",6),v("clicked",function(){return r.jumpToNow()}),a()(),o(8,"ya-detail-pane"),c(9,pr,7,2),C(10,"async"),c(11,ur,2,0,"ya-detail-toolbar"),a(),o(12,"div",7),c(13,El,100,24,"div",8),a()()),n&2){let p;m(3),_(h(4,4,r.dataSource.streaming$)?-1:3),m(2),_(h(6,6,r.dataSource.streaming$)?5:-1),m(4),_((p=h(10,8,r.selectedRecord$))?9:11,p),m(4),_(r.dataSource?13:-1)}},dependencies:[bo,bt,we,pi,ai,Y,j,E,G,Ce,K,_e,fe,he,ee,Se,Re,nt,Le,ot,ie,oe,me,ae,ne,se,re,le,ce,de,at,jt,J,He,Te,Jn,Xn,Zn,to,ei,ht,io,gt,ti,ii,Ne,ro,ni,ge,oi,vt,Do],styles:[".table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}.table-status[_ngcontent-%COMP%]{background-color:var(--y-background-color);height:24px;line-height:24px;font-size:12px;padding-left:6px}.table-status[_ngcontent-%COMP%]   .toggles[_ngcontent-%COMP%]{float:right;height:24px;line-height:24px;font-size:12px;padding-right:6px}.mat-mdc-row[_ngcontent-%COMP%]{cursor:pointer}tr.failed[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], tr.failed[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:red}tr.success[_ngcontent-%COMP%]   td.completion[_ngcontent-%COMP%]{background-color:#e6ffed;color:#00c752}tr.failed[_ngcontent-%COMP%]   td.completion[_ngcontent-%COMP%]{background-color:#ffeef0;color:red}th.dense[_ngcontent-%COMP%], td.dense[_ngcontent-%COMP%]{width:1px;white-space:nowrap;padding-left:12px;padding-right:12px}tr.item-row.expanded[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:none}tr.item-detail[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-left:40px!important}tr.item-detail[_ngcontent-%COMP%]:not(.expanded){display:none}tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{cursor:pointer}"],changeDetection:0})}};var Il=t=>({c:t});function Ml(t,i){if(t&1&&(o(0,"app-instance-page")(1,"app-instance-toolbar"),u(2,"ya-page-icon-button",0),l(3),a(),o(4,"div",1),u(5,"app-command-detail2",2),a()()),t&2){let e=i,n=s();m(2),d("queryParams",B(3,Il,n.yamcs.context)),m(),T(" Command history / ",e.id," "),m(2),d("command",e)}}var fi=class t{constructor(i,e){this.yamcs=e;this.command$=new P(null);let n=i.snapshot.paramMap.get("commandId");e.yamcsClient.getCommandHistoryEntry(e.instance,n).then(r=>{this.mergeEntry(r),this.commandSubscription=e.yamcsClient.createCommandSubscription({instance:e.instance,processor:e.processor,ignorePastCommands:!1},p=>{p.id===n&&this.mergeEntry(p)})})}mergeEntry(i){let e=this.command$.value;if(e){let n=e.mergeEntry(i);this.command$.next(n)}else this.command$.next(new Ee(i))}ngOnDestroy(){this.commandSubscription?.cancel()}static{this.\u0275fac=function(e){return new(e||t)(f(pe),f(L))}}static{this.\u0275cmp=D({type:t,selectors:[["ng-component"]],decls:2,vars:3,consts:[["routerLink","..","icon","arrow_back",3,"queryParams"],[1,"panel-content"],[3,"command"]],template:function(e,n){if(e&1&&(c(0,Ml,6,5,"app-instance-page"),C(1,"async")),e&2){let r;_((r=h(1,1,n.command$))?0:-1,r)}},dependencies:[we,Y,j,E,G,ee,ti],encapsulation:2,changeDetection:0})}};var Ve=class t{static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=D({type:t,selectors:[["app-send-command-wizard-step"]],inputs:{step:"step"},decls:11,vars:6,consts:[[1,"sub"]],template:function(e,n){e&1&&(o(0,"mat-toolbar",0)(1,"mat-toolbar-row")(2,"span")(3,"span"),l(4,"1. Select command"),a(),l(5," \xA0\xA0\xA0\xA0\xA0\xA0\xA0 "),o(6,"span"),l(7,"2. Configure command"),a(),l(8," \xA0\xA0\xA0\xA0\xA0\xA0\xA0 "),o(9,"span"),l(10,"3. View report"),a()()()()),e&2&&(m(3),O("active",n.step==1),m(3),O("active",n.step==2),m(3),O("active",n.step==3))},dependencies:[E,at,zn],styles:["span[_ngcontent-%COMP%]{cursor:default}span[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{opacity:.3}span[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{opacity:1}mat-toolbar.sub[_ngcontent-%COMP%]{border-bottom:1px solid #d3d3d3;background-color:#fff;font-size:12px}.mat-toolbar-row[_ngcontent-%COMP%]{height:32px;padding:0 24px}.mat-toolbar-multiple-rows[_ngcontent-%COMP%]{min-height:32px}"],changeDetection:0})}};var kl=t=>({c:t}),Ll=(t,i)=>({c:t,template:i});function Rl(t,i){if(t&1&&(o(0,"div",1),u(1,"app-command-detail2",2),y(2),u(3,"br")(4,"mat-divider")(5,"br"),o(6,"ya-button",3),l(7," Send another command "),a(),l(8," \xA0\xA0 "),o(9,"ya-button",4),l(10," Resend this command "),a(),x(),a()),t&2){let e=i,n=s();m(),d("command",e),m(5),d("queryParams",B(4,kl,n.yamcs.context)),m(3),d("routerLink","/commanding/send"+e.commandName)("queryParams",Z(6,Ll,n.yamcs.context,e.id))}}var hi=class t{constructor(i,e){this.yamcs=i;this.title=e;this.qualifiedName=X.required({alias:"command"});this.commandId=X.required();this.command$=new P(null)}ngOnInit(){this.title.setTitle(this.qualifiedName());let i=this.commandId();this.commandSubscription=this.yamcs.yamcsClient.createCommandSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,ignorePastCommands:!1},e=>{e.id===i&&this.mergeEntry(e,!1)}),this.commandSubscription.addReplyListener(()=>{this.yamcs.yamcsClient.getCommandHistoryEntry(this.yamcs.instance,i).then(e=>{this.mergeEntry(e,!0)})})}mergeEntry(i,e){let n=this.command$.value;if(n){let r=n.mergeEntry(i,e);this.command$.next(r)}else this.command$.next(new Ee(i))}ngOnDestroy(){this.commandSubscription?.cancel()}static{this.\u0275fac=function(e){return new(e||t)(f(L),f(W))}}static{this.\u0275cmp=D({type:t,selectors:[["ng-component"]],inputs:{qualifiedName:[1,"command","qualifiedName"],commandId:[1,"commandId"]},decls:6,vars:3,consts:[["step","3"],[1,"panel-content"],[3,"command"],["routerLink","/commanding/send",3,"queryParams"],[3,"routerLink","queryParams"]],template:function(e,n){if(e&1&&(o(0,"app-instance-page")(1,"app-instance-toolbar"),l(2,"Send a command"),a(),u(3,"app-send-command-wizard-step",0),c(4,Rl,11,9,"div",1),C(5,"async"),a()),e&2){let r;m(4),_((r=h(5,1,n.command$))?4:-1,r)}},dependencies:[we,Y,j,Ve,E,G,ee,Re,J],encapsulation:2,changeDetection:0})}};var Hl=["*"];function Nl(t,i){t&1&&It(0)}var Xi=(()=>{class t{_elementRef=$(Dt);constructor(){}focus(){this._elementRef.nativeElement.focus()}static \u0275fac=function(n){return new(n||t)};static \u0275dir=ke({type:t,selectors:[["","cdkStepHeader",""]],hostAttrs:["role","tab"]})}return t})(),Zi=(()=>{class t{template=$(Xe);constructor(){}static \u0275fac=function(n){return new(n||t)};static \u0275dir=ke({type:t,selectors:[["","cdkStepLabel",""]]})}return t})();var Ie={NUMBER:"number",EDIT:"edit",DONE:"done",ERROR:"error"},Fl=new sn("STEPPER_GLOBAL_OPTIONS"),gi=(()=>{class t{_stepperOptions;_stepper=$(vi);_displayDefaultIndicatorType;stepLabel;_childForms;content;stepControl;interacted=!1;interactedStream=new Je;label;errorMessage;ariaLabel;ariaLabelledby;state;editable=!0;optional=!1;get completed(){return this._completedOverride==null?this._getDefaultCompleted():this._completedOverride}set completed(e){this._completedOverride=e}_completedOverride=null;_getDefaultCompleted(){return this.stepControl?this.stepControl.valid&&this.interacted:this.interacted}get hasError(){return this._customError==null?this._getDefaultError():this._customError}set hasError(e){this._customError=e}_customError=null;_getDefaultError(){return this.stepControl&&this.stepControl.invalid&&this.interacted}constructor(){let e=$(Fl,{optional:!0});this._stepperOptions=e||{},this._displayDefaultIndicatorType=this._stepperOptions.displayDefaultIndicatorType!==!1}select(){this._stepper.selected=this}reset(){this.interacted=!1,this._completedOverride!=null&&(this._completedOverride=!1),this._customError!=null&&(this._customError=!1),this.stepControl&&(this._childForms?.forEach(e=>e.resetForm?.()),this.stepControl.reset())}ngOnChanges(){this._stepper._stateChanged()}_markAsInteracted(){this.interacted||(this.interacted=!0,this.interactedStream.emit(this))}_showError(){return this._stepperOptions.showError??this._customError!=null}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=D({type:t,selectors:[["cdk-step"]],contentQueries:function(n,r,p){if(n&1&&(ye(p,Zi,5),ye(p,Qn,5)),n&2){let g;F(g=V())&&(r.stepLabel=g.first),F(g=V())&&(r._childForms=g)}},viewQuery:function(n,r){if(n&1&&U(Xe,7),n&2){let p;F(p=V())&&(r.content=p.first)}},inputs:{stepControl:"stepControl",label:"label",errorMessage:"errorMessage",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],state:"state",editable:[2,"editable","editable",et],optional:[2,"optional","optional",et],completed:[2,"completed","completed",et],hasError:[2,"hasError","hasError",et]},outputs:{interactedStream:"interacted"},exportAs:["cdkStep"],features:[Pi,pn],ngContentSelectors:Hl,decls:1,vars:0,template:function(n,r){n&1&&(Et(),c(0,Nl,1,0,"ng-template"))},encapsulation:2,changeDetection:0})}return t})(),vi=(()=>{class t{_dir=$(Ln,{optional:!0});_changeDetectorRef=$(Ze);_elementRef=$(Dt);_destroyed=new Tt;_keyManager;_steps;steps=new wt;_stepHeader;_sortedHeaders=new wt;linear=!1;get selectedIndex(){return this._selectedIndex}set selectedIndex(e){this.steps&&this._steps?(this._isValidIndex(e),this.selected?._markAsInteracted(),this._selectedIndex!==e&&!this._anyControlsInvalidOrPending(e)&&(e>=this._selectedIndex||this.steps.toArray()[e].editable)&&this._updateSelectedItemIndex(e)):this._selectedIndex=e}_selectedIndex=0;get selected(){return this.steps?this.steps.toArray()[this.selectedIndex]:void 0}set selected(e){this.selectedIndex=e&&this.steps?this.steps.toArray().indexOf(e):-1}selectionChange=new Je;selectedIndexChange=new Je;_groupId=$(kn).getId("cdk-stepper-");get orientation(){return this._orientation}set orientation(e){this._orientation=e,this._keyManager&&this._keyManager.withVerticalOrientation(e==="vertical")}_orientation="horizontal";constructor(){}ngAfterContentInit(){this._steps.changes.pipe(Ge(this._steps),$e(this._destroyed)).subscribe(e=>{this.steps.reset(e.filter(n=>n._stepper===this)),this.steps.notifyOnChanges()})}ngAfterViewInit(){this._stepHeader.changes.pipe(Ge(this._stepHeader),$e(this._destroyed)).subscribe(e=>{this._sortedHeaders.reset(e.toArray().sort((n,r)=>n._elementRef.nativeElement.compareDocumentPosition(r._elementRef.nativeElement)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)),this._sortedHeaders.notifyOnChanges()}),this._keyManager=new In(this._sortedHeaders).withWrap().withHomeAndEnd().withVerticalOrientation(this._orientation==="vertical"),(this._dir?this._dir.change:an()).pipe(Ge(this._layoutDirection()),$e(this._destroyed)).subscribe(e=>this._keyManager.withHorizontalOrientation(e)),this._keyManager.updateActiveItem(this._selectedIndex),this.steps.changes.subscribe(()=>{this.selected||(this._selectedIndex=Math.max(this._selectedIndex-1,0))}),this._isValidIndex(this._selectedIndex)||(this._selectedIndex=0)}ngOnDestroy(){this._keyManager?.destroy(),this.steps.destroy(),this._sortedHeaders.destroy(),this._destroyed.next(),this._destroyed.complete()}next(){this.selectedIndex=Math.min(this._selectedIndex+1,this.steps.length-1)}previous(){this.selectedIndex=Math.max(this._selectedIndex-1,0)}reset(){this._updateSelectedItemIndex(0),this.steps.forEach(e=>e.reset()),this._stateChanged()}_getStepLabelId(e){return`${this._groupId}-label-${e}`}_getStepContentId(e){return`${this._groupId}-content-${e}`}_stateChanged(){this._changeDetectorRef.markForCheck()}_getAnimationDirection(e){let n=e-this._selectedIndex;return n<0?this._layoutDirection()==="rtl"?"next":"previous":n>0?this._layoutDirection()==="rtl"?"previous":"next":"current"}_getIndicatorType(e,n=Ie.NUMBER){let r=this.steps.toArray()[e],p=this._isCurrentStep(e);return r._displayDefaultIndicatorType?this._getDefaultIndicatorLogic(r,p):this._getGuidelineLogic(r,p,n)}_getDefaultIndicatorLogic(e,n){return e._showError()&&e.hasError&&!n?Ie.ERROR:!e.completed||n?Ie.NUMBER:e.editable?Ie.EDIT:Ie.DONE}_getGuidelineLogic(e,n,r=Ie.NUMBER){return e._showError()&&e.hasError&&!n?Ie.ERROR:e.completed&&!n?Ie.DONE:e.completed&&n?r:e.editable&&n?Ie.EDIT:r}_isCurrentStep(e){return this._selectedIndex===e}_getFocusIndex(){return this._keyManager?this._keyManager.activeItemIndex:this._selectedIndex}_updateSelectedItemIndex(e){let n=this.steps.toArray();this.selectionChange.emit({selectedIndex:e,previouslySelectedIndex:this._selectedIndex,selectedStep:n[e],previouslySelectedStep:n[this._selectedIndex]}),this._containsFocus()?this._keyManager.setActiveItem(e):this._keyManager.updateActiveItem(e),this._selectedIndex=e,this.selectedIndexChange.emit(this._selectedIndex),this._stateChanged()}_onKeydown(e){let n=En(e),r=e.keyCode,p=this._keyManager;p.activeItemIndex!=null&&!n&&(r===32||r===13)?(this.selectedIndex=p.activeItemIndex,e.preventDefault()):p.setFocusOrigin("keyboard").onKeydown(e)}_anyControlsInvalidOrPending(e){return this.linear&&e>=0?this.steps.toArray().slice(0,e).some(n=>{let r=n.stepControl;return(r?r.invalid||r.pending||!n.interacted:!n.completed)&&!n.optional&&!n._completedOverride}):!1}_layoutDirection(){return this._dir&&this._dir.value==="rtl"?"rtl":"ltr"}_containsFocus(){let e=this._elementRef.nativeElement,n=Tn();return e===n||e.contains(n)}_isValidIndex(e){return e>-1&&(!this.steps||e<this.steps.length)}static \u0275fac=function(n){return new(n||t)};static \u0275dir=ke({type:t,selectors:[["","cdkStepper",""]],contentQueries:function(n,r,p){if(n&1&&(ye(p,gi,5),ye(p,Xi,5)),n&2){let g;F(g=V())&&(r._steps=g),F(g=V())&&(r._stepHeader=g)}},inputs:{linear:[2,"linear","linear",et],selectedIndex:[2,"selectedIndex","selectedIndex",hn],selected:"selected",orientation:"orientation"},outputs:{selectionChange:"selectionChange",selectedIndexChange:"selectedIndexChange"},exportAs:["cdkStepper"],features:[Pi]})}return t})();var No=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=At({type:t});static \u0275inj=Rt({imports:[Rn]})}return t})();function Vl(t,i){if(t&1&&qe(0,2),t&2){let e=s();d("ngTemplateOutlet",e.iconOverrides[e.state])("ngTemplateOutletContext",e._getIconContext())}}function $l(t,i){if(t&1&&(o(0,"span",7),l(1),a()),t&2){let e=s(2);m(),w(e._getDefaultTextForState(e.state))}}function Ql(t,i){if(t&1&&(o(0,"span",8),l(1),a()),t&2){let e=s(3);m(),w(e._intl.completedLabel)}}function Bl(t,i){if(t&1&&(o(0,"span",8),l(1),a()),t&2){let e=s(3);m(),w(e._intl.editableLabel)}}function ql(t,i){if(t&1&&(c(0,Ql,2,1,"span",8)(1,Bl,2,1,"span",8),o(2,"mat-icon",7),l(3),a()),t&2){let e=s(2);_(e.state==="done"?0:e.state==="edit"?1:-1),m(3),w(e._getDefaultTextForState(e.state))}}function zl(t,i){if(t&1&&c(0,$l,2,1,"span",7)(1,ql,4,2),t&2){let e,n=s();_((e=n.state)==="number"?0:1)}}function jl(t,i){t&1&&(o(0,"div",4),qe(1,9),a()),t&2&&(m(),d("ngTemplateOutlet",i.template))}function Yl(t,i){if(t&1&&(o(0,"div",4),l(1),a()),t&2){let e=s();m(),w(e.label)}}function Ul(t,i){if(t&1&&(o(0,"div",5),l(1),a()),t&2){let e=s();m(),w(e._intl.optionalLabel)}}function Gl(t,i){if(t&1&&(o(0,"div",6),l(1),a()),t&2){let e=s();m(),w(e.errorMessage)}}var Vo=["*"];function Wl(t,i){}function Kl(t,i){if(t&1&&(It(0),c(1,Wl,0,0,"ng-template",0)),t&2){let e=s();m(),d("cdkPortalOutlet",e._portal)}}var $o=(t,i)=>({step:t,i}),Qo=t=>({animationDuration:t}),Bo=(t,i)=>({value:t,params:i});function Jl(t,i){t&1&&It(0)}function Xl(t,i){t&1&&u(0,"div",6)}function Zl(t,i){if(t&1&&(qe(0,5),c(1,Xl,1,0,"div",6)),t&2){let e=i.$implicit,n=i.$index,r=i.$count;s(2);let p=k(4);d("ngTemplateOutlet",p)("ngTemplateOutletContext",Z(3,$o,e,n)),m(),_(n!==r-1?1:-1)}}function em(t,i){if(t&1){let e=I();o(0,"div",7),v("@horizontalStepTransition.done",function(r){S(e);let p=s(2);return b(p._animationDone.next(r))}),qe(1,8),a()}if(t&2){let e=i.$implicit,n=i.$index,r=s(2);O("mat-horizontal-stepper-content-inactive",r.selectedIndex!==n),d("@horizontalStepTransition",Z(8,Bo,r._getAnimationDirection(n),B(6,Qo,r._getAnimationDuration())))("id",r._getStepContentId(n)),Be("aria-labelledby",r._getStepLabelId(n)),m(),d("ngTemplateOutlet",e.content)}}function tm(t,i){if(t&1&&(o(0,"div",1)(1,"div",2),R(2,Zl,2,6,null,null,Q),a(),o(4,"div",3),R(5,em,2,11,"div",4,Q),a()()),t&2){let e=s();m(2),A(e.steps),m(3),A(e.steps)}}function im(t,i){if(t&1){let e=I();o(0,"div",9),qe(1,5),o(2,"div",10)(3,"div",11),v("@verticalStepTransition.done",function(r){S(e);let p=s(2);return b(p._animationDone.next(r))}),o(4,"div",12),qe(5,8),a()()()()}if(t&2){let e=i.$implicit,n=i.$index,r=i.$count,p=s(2),g=k(4);m(),d("ngTemplateOutlet",g)("ngTemplateOutletContext",Z(10,$o,e,n)),m(),O("mat-stepper-vertical-line",n!==r-1),m(),O("mat-vertical-stepper-content-inactive",p.selectedIndex!==n),d("@verticalStepTransition",Z(15,Bo,p._getAnimationDirection(n),B(13,Qo,p._getAnimationDuration())))("id",p._getStepContentId(n)),Be("aria-labelledby",p._getStepLabelId(n)),m(2),d("ngTemplateOutlet",e.content)}}function nm(t,i){if(t&1&&R(0,im,6,18,"div",9,Q),t&2){let e=s();A(e.steps)}}function om(t,i){if(t&1){let e=I();o(0,"mat-step-header",13),v("click",function(){let r=S(e).step;return b(r.select())})("keydown",function(r){S(e);let p=s();return b(p._onKeydown(r))}),a()}if(t&2){let e=i.step,n=i.i,r=s();O("mat-horizontal-stepper-header",r.orientation==="horizontal")("mat-vertical-stepper-header",r.orientation==="vertical"),d("tabIndex",r._getFocusIndex()===n?0:-1)("id",r._getStepLabelId(n))("index",n)("state",r._getIndicatorType(n,e.state))("label",e.stepLabel||e.label)("selected",r.selectedIndex===n)("active",r._stepIsNavigable(n,e))("optional",e.optional)("errorMessage",e.errorMessage)("iconOverrides",r._iconOverrides)("disableRipple",r.disableRipple||!r._stepIsNavigable(n,e))("color",e.color||r.color),Be("aria-posinset",n+1)("aria-setsize",r.steps.length)("aria-controls",r._getStepContentId(n))("aria-selected",r.selectedIndex==n)("aria-label",e.ariaLabel||null)("aria-labelledby",!e.ariaLabel&&e.ariaLabelledby?e.ariaLabelledby:null)("aria-disabled",r._stepIsNavigable(n,e)?null:!0)}}var en=(()=>{class t extends Zi{static \u0275fac=(()=>{let e;return function(r){return(e||(e=Ai(t)))(r||t)}})();static \u0275dir=ke({type:t,selectors:[["","matStepLabel",""]],features:[Qe]})}return t})(),yi=(()=>{class t{changes=new Tt;optionalLabel="Optional";completedLabel="Completed";editableLabel="Editable";static \u0275fac=function(n){return new(n||t)};static \u0275prov=We({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function am(t){return t||new yi}var rm={provide:yi,deps:[[new cn,new dn,yi]],useFactory:am},tn=(()=>{class t extends Xi{_intl=$(yi);_focusMonitor=$(Mn);_intlSubscription;state;label;errorMessage;iconOverrides;index;selected;active;optional;disableRipple;color;constructor(){super();let e=$(Dn);e.load(An),e.load(wn);let n=$(Ze);this._intlSubscription=this._intl.changes.subscribe(()=>n.markForCheck())}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._intlSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._elementRef)}focus(e,n){e?this._focusMonitor.focusVia(this._elementRef,e,n):this._elementRef.nativeElement.focus(n)}_stringLabel(){return this.label instanceof en?null:this.label}_templateLabel(){return this.label instanceof en?this.label:null}_getHostElement(){return this._elementRef.nativeElement}_getIconContext(){return{index:this.index,active:this.active,optional:this.optional}}_getDefaultTextForState(e){return e=="number"?`${this.index+1}`:e=="edit"?"create":e=="error"?"warning":e}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=D({type:t,selectors:[["mat-step-header"]],hostAttrs:["role","tab",1,"mat-step-header"],hostVars:2,hostBindings:function(n,r){n&2&&Cn("mat-"+(r.color||"primary"))},inputs:{state:"state",label:"label",errorMessage:"errorMessage",iconOverrides:"iconOverrides",index:"index",selected:"selected",active:"active",optional:"optional",disableRipple:"disableRipple",color:"color"},features:[Qe],decls:10,vars:17,consts:[["matRipple","",1,"mat-step-header-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-step-icon-content"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mat-step-label"],[1,"mat-step-text-label"],[1,"mat-step-optional"],[1,"mat-step-sub-label-error"],["aria-hidden","true"],[1,"cdk-visually-hidden"],[3,"ngTemplateOutlet"]],template:function(n,r){if(n&1&&(u(0,"div",0),o(1,"div")(2,"div",1),c(3,Vl,1,2,"ng-container",2)(4,zl,2,1),a()(),o(5,"div",3),c(6,jl,2,1,"div",4)(7,Yl,2,1,"div",4)(8,Ul,2,1,"div",5)(9,Gl,2,1,"div",6),a()),n&2){let p;d("matRippleTrigger",r._getHostElement())("matRippleDisabled",r.disableRipple),m(),fn("mat-step-icon-state-",r.state," mat-step-icon"),O("mat-step-icon-selected",r.selected),m(2),_(r.iconOverrides&&r.iconOverrides[r.state]?3:4),m(2),O("mat-step-label-active",r.active)("mat-step-label-selected",r.selected)("mat-step-label-error",r.state=="error"),m(),_((p=r._templateLabel())?6:r._stringLabel()?7:-1,p),m(2),_(r.optional&&r.state!="error"?8:-1),m(),_(r.state==="error"?9:-1)}},dependencies:[Pn,Hi,Se],styles:['.mat-step-header{overflow:hidden;outline:none;cursor:pointer;position:relative;box-sizing:content-box;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-step-header:focus .mat-focus-indicator::before{content:""}.mat-step-header:hover[aria-disabled=true]{cursor:default}.mat-step-header:hover:not([aria-disabled]),.mat-step-header:hover[aria-disabled=false]{background-color:var(--mat-stepper-header-hover-state-layer-color, color-mix(in srgb, var(--mat-sys-inverse-surface) calc(var(--mat-sys-hover-state-layer-opacity) * 100%), transparent));border-radius:var(--mat-stepper-header-hover-state-layer-shape, var(--mat-sys-corner-medium))}.mat-step-header.cdk-keyboard-focused,.mat-step-header.cdk-program-focused{background-color:var(--mat-stepper-header-focus-state-layer-color, color-mix(in srgb, var(--mat-sys-inverse-surface) calc(var(--mat-sys-focus-state-layer-opacity) * 100%), transparent));border-radius:var(--mat-stepper-header-focus-state-layer-shape, var(--mat-sys-corner-medium))}@media(hover: none){.mat-step-header:hover{background:none}}@media(forced-colors: active){.mat-step-header{outline:solid 1px}.mat-step-header[aria-selected=true] .mat-step-label{text-decoration:underline}.mat-step-header[aria-disabled=true]{outline-color:GrayText}.mat-step-header[aria-disabled=true] .mat-step-label,.mat-step-header[aria-disabled=true] .mat-step-icon,.mat-step-header[aria-disabled=true] .mat-step-optional{color:GrayText}}.mat-step-optional{font-size:12px;color:var(--mat-stepper-header-optional-label-text-color, var(--mat-sys-on-surface-variant))}.mat-step-sub-label-error{font-size:12px;font-weight:normal}.mat-step-icon{border-radius:50%;height:24px;width:24px;flex-shrink:0;position:relative;color:var(--mat-stepper-header-icon-foreground-color, var(--mat-sys-surface));background-color:var(--mat-stepper-header-icon-background-color, var(--mat-sys-on-surface-variant))}.mat-step-icon-content{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);display:flex}.mat-step-icon .mat-icon{font-size:16px;height:16px;width:16px}.mat-step-icon-state-error{background-color:var(--mat-stepper-header-error-state-icon-background-color, transparent);color:var(--mat-stepper-header-error-state-icon-foreground-color, var(--mat-sys-error))}.mat-step-icon-state-error .mat-icon{font-size:24px;height:24px;width:24px}.mat-step-label{display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;min-width:50px;vertical-align:middle;font-family:var(--mat-stepper-header-label-text-font, var(--mat-sys-title-small-font));font-size:var(--mat-stepper-header-label-text-size, var(--mat-sys-title-small-size));font-weight:var(--mat-stepper-header-label-text-weight, var(--mat-sys-title-small-weight));color:var(--mat-stepper-header-label-text-color, var(--mat-sys-on-surface-variant))}.mat-step-label.mat-step-label-active{color:var(--mat-stepper-header-selected-state-label-text-color, var(--mat-sys-on-surface-variant))}.mat-step-label.mat-step-label-error{color:var(--mat-stepper-header-error-state-label-text-color, var(--mat-sys-error));font-size:var(--mat-stepper-header-error-state-label-text-size, var(--mat-sys-title-small-size))}.mat-step-label.mat-step-label-selected{font-size:var(--mat-stepper-header-selected-state-label-text-size, var(--mat-sys-title-small-size));font-weight:var(--mat-stepper-header-selected-state-label-text-weight, var(--mat-sys-title-small-weight))}.mat-step-text-label{text-overflow:ellipsis;overflow:hidden}.mat-step-header .mat-step-header-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-step-icon-selected{background-color:var(--mat-stepper-header-selected-state-icon-background-color, var(--mat-sys-primary));color:var(--mat-stepper-header-selected-state-icon-foreground-color, var(--mat-sys-on-primary))}.mat-step-icon-state-done{background-color:var(--mat-stepper-header-done-state-icon-background-color);color:var(--mat-stepper-header-done-state-icon-foreground-color)}.mat-step-icon-state-edit{background-color:var(--mat-stepper-header-edit-state-icon-background-color, var(--mat-sys-primary));color:var(--mat-stepper-header-edit-state-icon-foreground-color, var(--mat-sys-on-primary))}'],encapsulation:2,changeDetection:0})}return t})(),qo="500ms",zo="225ms",Fo={horizontalStepTransition:Fi("horizontalStepTransition",[je("previous",ze({transform:"translate3d(-100%, 0, 0)",visibility:"hidden"})),je("current",ze({transform:"none",visibility:"inherit"})),je("next",ze({transform:"translate3d(100%, 0, 0)",visibility:"hidden"})),Qi("* => *",$i([Vi("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)"),qi("@*",Bi(),{optional:!0})]),{params:{animationDuration:qo}})]),verticalStepTransition:Fi("verticalStepTransition",[je("previous",ze({height:"0px",visibility:"hidden"})),je("next",ze({height:"0px",visibility:"hidden"})),je("current",ze({height:"*",visibility:"inherit"})),Qi("* <=> current",$i([Vi("{{animationDuration}} cubic-bezier(0.4, 0.0, 0.2, 1)"),qi("@*",Bi(),{optional:!0})]),{params:{animationDuration:zo}})])},lm=(()=>{class t{templateRef=$(Xe);name;constructor(){}static \u0275fac=function(n){return new(n||t)};static \u0275dir=ke({type:t,selectors:[["ng-template","matStepperIcon",""]],inputs:{name:[0,"matStepperIcon","name"]}})}return t})(),mm=(()=>{class t{_template=$(Xe);constructor(){}static \u0275fac=function(n){return new(n||t)};static \u0275dir=ke({type:t,selectors:[["ng-template","matStepContent",""]]})}return t})(),sm=(()=>{class t extends gi{_errorStateMatcher=$($t,{skipSelf:!0});_viewContainerRef=$(_n);_isSelected=on.EMPTY;stepLabel=void 0;color;_lazyContent;_portal;ngAfterContentInit(){this._isSelected=this._stepper.steps.changes.pipe(mn(()=>this._stepper.selectionChange.pipe(rn(e=>e.selectedStep===this),Ge(this._stepper.selected===this)))).subscribe(e=>{e&&this._lazyContent&&!this._portal&&(this._portal=new Hn(this._lazyContent._template,this._viewContainerRef))})}ngOnDestroy(){this._isSelected.unsubscribe()}isErrorState(e,n){let r=this._errorStateMatcher.isErrorState(e,n),p=!!(e&&e.invalid&&this.interacted);return r||p}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Ai(t)))(r||t)}})();static \u0275cmp=D({type:t,selectors:[["mat-step"]],contentQueries:function(n,r,p){if(n&1&&(ye(p,en,5),ye(p,mm,5)),n&2){let g;F(g=V())&&(r.stepLabel=g.first),F(g=V())&&(r._lazyContent=g.first)}},hostAttrs:["hidden",""],inputs:{color:"color"},exportAs:["matStep"],features:[Oi([{provide:$t,useExisting:t},{provide:gi,useExisting:t}]),Qe],ngContentSelectors:Vo,decls:1,vars:0,consts:[[3,"cdkPortalOutlet"]],template:function(n,r){n&1&&(Et(),c(0,Kl,2,1,"ng-template"))},dependencies:[Nn],encapsulation:2,changeDetection:0})}return t})(),cm=(()=>{class t extends vi{_stepHeader=void 0;_steps=void 0;steps=new wt;_icons;animationDone=new Je;disableRipple;color;labelPosition="end";headerPosition="top";_iconOverrides={};_animationDone=new Tt;get animationDuration(){return this._animationDuration}set animationDuration(e){this._animationDuration=/^\d+$/.test(e)?e+"ms":e}_animationDuration="";_isServer=!$(bn).isBrowser;constructor(){super();let n=$(Dt).nativeElement.nodeName.toLowerCase();this.orientation=n==="mat-vertical-stepper"?"vertical":"horizontal"}ngAfterContentInit(){super.ngAfterContentInit(),this._icons.forEach(({name:e,templateRef:n})=>this._iconOverrides[e]=n),this.steps.changes.pipe($e(this._destroyed)).subscribe(()=>{this._stateChanged()}),this._animationDone.pipe($e(this._destroyed)).subscribe(e=>{e.toState==="current"&&this.animationDone.emit()})}_stepIsNavigable(e,n){return n.completed||this.selectedIndex===e||!this.linear}_getAnimationDuration(){return this.animationDuration?this.animationDuration:this.orientation==="horizontal"?qo:zo}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=D({type:t,selectors:[["mat-stepper"],["mat-vertical-stepper"],["mat-horizontal-stepper"],["","matStepper",""]],contentQueries:function(n,r,p){if(n&1&&(ye(p,sm,5),ye(p,lm,5)),n&2){let g;F(g=V())&&(r._steps=g),F(g=V())&&(r._icons=g)}},viewQuery:function(n,r){if(n&1&&U(tn,5),n&2){let p;F(p=V())&&(r._stepHeader=p)}},hostAttrs:["role","tablist"],hostVars:11,hostBindings:function(n,r){n&2&&(Be("aria-orientation",r.orientation),O("mat-stepper-horizontal",r.orientation==="horizontal")("mat-stepper-vertical",r.orientation==="vertical")("mat-stepper-label-position-end",r.orientation==="horizontal"&&r.labelPosition=="end")("mat-stepper-label-position-bottom",r.orientation==="horizontal"&&r.labelPosition=="bottom")("mat-stepper-header-position-bottom",r.headerPosition==="bottom"))},inputs:{disableRipple:"disableRipple",color:"color",labelPosition:"labelPosition",headerPosition:"headerPosition",animationDuration:"animationDuration"},outputs:{animationDone:"animationDone"},exportAs:["matStepper","matVerticalStepper","matHorizontalStepper"],features:[Oi([{provide:vi,useExisting:t}]),Qe],ngContentSelectors:Vo,decls:5,vars:2,consts:[["stepTemplate",""],[1,"mat-horizontal-stepper-wrapper"],[1,"mat-horizontal-stepper-header-container"],[1,"mat-horizontal-content-container"],["role","tabpanel",1,"mat-horizontal-stepper-content",3,"id","mat-horizontal-stepper-content-inactive"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mat-stepper-horizontal-line"],["role","tabpanel",1,"mat-horizontal-stepper-content",3,"id"],[3,"ngTemplateOutlet"],[1,"mat-step"],[1,"mat-vertical-content-container"],["role","tabpanel",1,"mat-vertical-stepper-content",3,"id"],[1,"mat-vertical-content"],[3,"click","keydown","tabIndex","id","index","state","label","selected","active","optional","errorMessage","iconOverrides","disableRipple","color"]],template:function(n,r){if(n&1&&(Et(),c(0,Jl,1,0)(1,tm,7,0,"div",1)(2,nm,2,0)(3,om,1,23,"ng-template",null,0,Nt)),n&2){let p;_(r._isServer?0:-1),m(),_((p=r.orientation)==="horizontal"?1:p==="vertical"?2:-1)}},dependencies:[Hi,tn],styles:['.mat-stepper-vertical,.mat-stepper-horizontal{display:block;font-family:var(--mat-stepper-container-text-font, var(--mat-sys-body-medium-font));background:var(--mat-stepper-container-color, var(--mat-sys-surface))}.mat-horizontal-stepper-header-container{white-space:nowrap;display:flex;align-items:center}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header-container{align-items:flex-start}.mat-stepper-header-position-bottom .mat-horizontal-stepper-header-container{order:1}.mat-stepper-horizontal-line{border-top-width:1px;border-top-style:solid;flex:auto;height:0;margin:0 -16px;min-width:32px;border-top-color:var(--mat-stepper-line-color, var(--mat-sys-outline))}.mat-stepper-label-position-bottom .mat-stepper-horizontal-line{margin:0;min-width:0;position:relative;top:calc(calc((var(--mat-stepper-header-height, 72px) - 24px) / 2) + 12px)}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::before,.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::after,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::after{border-top-width:1px;border-top-style:solid;content:"";display:inline-block;height:0;position:absolute;width:calc(50% - 20px)}.mat-horizontal-stepper-header{display:flex;height:72px;overflow:hidden;align-items:center;padding:0 24px;height:var(--mat-stepper-header-height, 72px)}.mat-horizontal-stepper-header .mat-step-icon{margin-right:8px;flex:none}[dir=rtl] .mat-horizontal-stepper-header .mat-step-icon{margin-right:0;margin-left:8px}.mat-horizontal-stepper-header::before,.mat-horizontal-stepper-header::after{border-top-color:var(--mat-stepper-line-color, var(--mat-sys-outline))}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header{padding:calc((var(--mat-stepper-header-height, 72px) - 24px) / 2) 24px}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header::before,.mat-stepper-label-position-bottom .mat-horizontal-stepper-header::after{top:calc(calc((var(--mat-stepper-header-height, 72px) - 24px) / 2) + 12px)}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header{box-sizing:border-box;flex-direction:column;height:auto}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::after,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::after{right:0}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::before{left:0}[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:last-child::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:first-child::after{display:none}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header .mat-step-icon{margin-right:0;margin-left:0}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header .mat-step-label{padding:16px 0 0 0;text-align:center;width:100%}.mat-vertical-stepper-header{display:flex;align-items:center;height:24px;padding:calc((var(--mat-stepper-header-height, 72px) - 24px) / 2) 24px}.mat-vertical-stepper-header .mat-step-icon{margin-right:12px}[dir=rtl] .mat-vertical-stepper-header .mat-step-icon{margin-right:0;margin-left:12px}.mat-horizontal-stepper-wrapper{display:flex;flex-direction:column}.mat-horizontal-stepper-content{outline:0}.mat-horizontal-stepper-content.mat-horizontal-stepper-content-inactive{height:0;overflow:hidden}.mat-horizontal-stepper-content:not(.mat-horizontal-stepper-content-inactive){visibility:inherit !important}.mat-horizontal-content-container{overflow:hidden;padding:0 24px 24px 24px}@media(forced-colors: active){.mat-horizontal-content-container{outline:solid 1px}}.mat-stepper-header-position-bottom .mat-horizontal-content-container{padding:24px 24px 0 24px}.mat-vertical-content-container{margin-left:36px;border:0;position:relative}@media(forced-colors: active){.mat-vertical-content-container{outline:solid 1px}}[dir=rtl] .mat-vertical-content-container{margin-left:0;margin-right:36px}.mat-stepper-vertical-line::before{content:"";position:absolute;left:0;border-left-width:1px;border-left-style:solid;border-left-color:var(--mat-stepper-line-color, var(--mat-sys-outline));top:calc(8px - calc((var(--mat-stepper-header-height, 72px) - 24px) / 2));bottom:calc(8px - calc((var(--mat-stepper-header-height, 72px) - 24px) / 2))}[dir=rtl] .mat-stepper-vertical-line::before{left:auto;right:0}.mat-vertical-stepper-content{overflow:hidden;outline:0}.mat-vertical-stepper-content:not(.mat-vertical-stepper-content-inactive){visibility:inherit !important}.mat-vertical-content{padding:0 24px 24px 24px}.mat-step:last-child .mat-vertical-content-container{border:none}'],encapsulation:2,data:{animation:[Fo.horizontalStepTransition,Fo.verticalStepTransition]},changeDetection:0})}return t})();var jo=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=At({type:t});static \u0275inj=Rt({providers:[rm,$t],imports:[Ni,Fn,No,zt,On,cm,tn,Ni]})}return t})();var xi=class t{constructor(i,e){this.dialogRef=i;this.form=e.group({executionTime:["",[tt.required]],tags:[[],[]]})}schedule(){this.dialogRef.close(this.form.value)}static{this.\u0275fac=function(e){return new(e||t)(f(rt),f(qt))}}static{this.\u0275cmp=D({type:t,selectors:[["app-schedule-command-dialog"]],decls:26,vars:4,consts:[["mat-dialog-title",""],[1,"hint"],[1,"ya-form",3,"formGroup"],[1,"label"],["formControlName","executionTime",3,"showMillis","showNow"],[1,"half-break"],["dialogTitle","Timeline Tags"],["formControlName","tags"],["align","end"],[2,"flex","1 1 auto"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,n){e&1&&(o(0,"h2",0),l(1,"Send later"),a(),o(2,"mat-dialog-content")(3,"div",1)(4,"p"),l(5,"This command will be submitted to the Yamcs Timeline, for execution at a later time."),a()(),o(6,"form",2)(7,"div",3),l(8," Execution time "),u(9,"br")(10,"ya-date-time-input",4),a(),u(11,"hr",5),o(12,"div",3),l(13," Timeline tags "),o(14,"span",1),l(15,"(optional)"),a(),o(16,"ya-help",6),l(17," Tags allow to categorise items per band. Bands only show items for which one of the tags is matching. "),a(),u(18,"br")(19,"ya-tag-select",7),a()()(),o(20,"mat-dialog-actions",8),u(21,"div",9),o(22,"ya-button",10),l(23,"CANCEL"),a(),o(24,"ya-button",11),v("click",function(){return n.schedule()}),l(25,"SCHEDULE"),a()()),e&2&&(m(6),d("formGroup",n.form),m(4),d("showMillis",!0)("showNow",!0),m(14),d("disabled",!n.form.valid))},dependencies:[E,Ce,K,_e,fe,he,mt,st,dt,ct,J,Te,ft,lo],encapsulation:2,changeDetection:0})}};function dm(t,i){t&1&&(o(0,"span",4),l(1,"satisfied"),a())}function pm(t,i){t&1&&(o(0,"span",5),l(1,"not satisfied"),a())}function um(t,i){if(t&1&&(o(0,"tr")(1,"td"),l(2),a(),o(3,"td",3),l(4),C(5,"millisDuration"),a(),o(6,"td",3),c(7,dm,2,0,"span",4)(8,pm,2,0,"span",5),u(9,"app-live-expression",6,0),a()()),t&2){let e=i.$implicit,n=k(10);m(2),w(e.expression),m(2),w(h(5,7,e.timeout)||"-"),m(3),_(n.result()===!0?7:-1),m(),_(n.result()===!1?8:-1),m(),Ot("display","none"),d("expression",e.expression)}}function _m(t,i){t&1&&(o(0,"p"),l(1," Constraints are evaluated after the command is released from the assigned queue. The following is an indication of the current constraint state. "),a(),o(2,"table",1)(3,"tr")(4,"th",2),l(5,"Constraint"),a(),o(6,"th"),l(7,"Timeout"),a(),o(8,"th"),l(9,"Live evaluation"),a()(),R(10,um,11,9,"tr",null,Q),a()),t&2&&(m(10),A(i.constraint))}var Si=class t{constructor(){this.command=X(null)}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=D({type:t,selectors:[["app-command-constraints"]],inputs:{command:[1,"command"]},decls:1,vars:1,consts:[["expr",""],["yaDataTable",""],[1,"expand"],[2,"white-space","nowrap"],[1,"evaluation","valid"],[1,"evaluation","invalid"],[3,"expression"]],template:function(e,n){if(e&1&&c(0,_m,12,0),e&2){let r;_((r=n.command())?0:-1,r)}},dependencies:[Io,_o,E,co],styles:[".evaluation[_ngcontent-%COMP%]{font-family:Roboto Mono,monospace;background-color:#ffeef0;color:red;padding-left:2px;padding-right:2px}.evaluation.valid[_ngcontent-%COMP%]{background-color:#e6ffed;color:#00c752}th[_ngcontent-%COMP%]{white-space:nowrap}p[_ngcontent-%COMP%]{color:#000000a7}"],changeDetection:0})}};var bi=class{constructor(i){this.entry=i}getAssignment(i){if(this.entry.assignments){for(let e of this.entry.assignments)if(e.name===i)return e.value}}getOption(i,e){for(let n of this.entry.attr||[])if(n.name===i)switch(e){case"BOOLEAN":return this.getBooleanOption(n.value);case"NUMBER":return this.getNumberOption(n.value);case"STRING":return this.getStringOption(n.value);case"TIMESTAMP":return this.getTimestampOption(n.value)}}getBooleanOption(i){if(i.type==="BOOLEAN")return i}getNumberOption(i){switch(i.type){case"SINT32":case"UINT32":case"SINT64":case"UINT64":return i}}getStringOption(i){if(i.type==="STRING")return i}getTimestampOption(i){if(i.type==="TIMESTAMP")return i}getComment(){}getStream(){}getAdvancementParams(){}};var Cm=["commandForm"];function fm(t,i){if(t&1&&(o(0,"dt"),l(1),a(),o(2,"dd"),l(3),a()),t&2){let e=i.$implicit;m(),w(e.namespace),m(2),w(e.name)}}function hm(t,i){if(t&1&&(o(0,"dt"),l(1,"Description"),a(),o(2,"dd"),u(3,"app-markdown",12),a()),t&2){let e=s(2);m(3),d("text",e.longDescription)}}function gm(t,i){if(t&1&&(o(0,"dt"),l(1,"Description"),a(),o(2,"dd"),l(3),a()),t&2){let e=s(2);m(3),T(" ",e.shortDescription||"-"," ")}}function vm(t,i){if(t&1&&c(0,hm,4,1)(1,gm,4,1),t&2){let e=s();_(e.longDescription?0:-1),m(),_(e.longDescription?-1:1)}}function ym(t,i){if(t&1&&(u(0,"app-significance-level",13),l(1)),t&2){let e=i;d("level",e.consequenceLevel),m(),T(" \xA0\xA0",e.reasonForWarning," ")}}function xm(t,i){t&1&&l(0," - ")}function Sm(t,i){if(t&1&&(o(0,"dl",4)(1,"dt"),l(2,"Command"),a(),o(3,"dd"),l(4),C(5,"shortName"),a(),o(6,"dt"),l(7,"System"),a(),o(8,"dd"),l(9),C(10,"spaceSystemName"),a(),R(11,fm,4,2,null,null,Q),c(13,vm,2,2),o(14,"dt"),l(15,"Significance"),a(),o(16,"dd"),c(17,ym,2,2)(18,xm,1,0),a()()),t&2){let e,n=i;m(4),w(h(5,4,n.qualifiedName)),m(5),w(h(10,6,n.qualifiedName)||"-"),m(2),A(n.alias),m(2),_(n.longDescription||n.shortDescription?13:-1),m(4),_((e=n==null?null:n.effectiveSignificance)?17:18,e)}}function bm(t,i){t&1&&(o(0,"ya-warning-message"),l(1,"You're not cleared to send this command"),a())}function Tm(t,i){if(t&1&&(o(0,"mat-slide-toggle",14),l(1,"Arm"),a(),u(2,"div",15)),t&2){let e=s();d("formControl",e.armControl)}}function Dm(t,i){if(t&1){let e=I();l(0," \xA0 "),u(1,"ya-icon-action",16),C(2,"async"),C(3,"async"),o(4,"mat-menu",17,1)(6,"button",18),v("click",function(){S(e);let r=s();return b(r.sendCommand())}),l(7,"Send now"),a(),o(8,"button",18),v("click",function(){S(e);let r=s();return b(r.openScheduleCommandDialog())}),l(9,"Send later..."),a()()}if(t&2){let e=k(5),n=s(),r=k(9);m(),d("matMenuTriggerFor",n.config.twoStageCommanding&&!n.armControl.value||!h(2,4,n.cleared$)||!r.form.valid?null:e)("padding",!1)("disabled",n.config.twoStageCommanding&&!n.armControl.value||!h(3,6,n.cleared$)||!r.form.valid),m(3),d("overlapTrigger",!1)}}var Ti=class t{constructor(i,e,n,r,p,g,N,Me,nn){this.route=i;this.router=e;this.title=n;this.messageService=r;this.yamcs=p;this.location=g;this.authService=Me;this.dialog=nn;this.qualifiedName=X.required({alias:"command"});this.command=un(null);this.templateProvider$=new P(null);this.cleared$=new P(!0);this.armControl=new xe;this.config=N.getConfig()}ngOnInit(){this.title.setTitle(`Send a command: ${this.qualifiedName()}`);let i=[this.yamcs.yamcsClient.getCommand(this.yamcs.instance,this.qualifiedName())],e=this.route.snapshot.queryParamMap.get("template");if(e){let n=this.yamcs.yamcsClient.getCommandHistoryEntry(this.yamcs.instance,e);i.push(n)}Promise.all(i).then(n=>{let r=n[0],p;n.length>1&&(p=n[1]),this.command.set(r),p?this.templateProvider$.next(new bi(p)):this.templateProvider$.next(null),this.config.commandClearanceEnabled&&(this.connectionInfoSubscription=this.yamcs.clearance$.subscribe(g=>{let N=r.effectiveSignificance;this.cleared$.next(this.isCleared(g,N?.consequenceLevel))}))})}ngAfterViewInit(){this.config.twoStageCommanding&&(this.commandForm.form.valueChanges.subscribe(()=>{this.armControl.setValue(!1)}),this.commandForm.form.statusChanges.subscribe(()=>{this.commandForm.form.valid?this.armControl.enable():this.armControl.disable()}))}goBack(){this.location.back()}sendCommand(){this.armControl.setValue(!1);let i=this.qualifiedName(),e=this.commandForm.getResult();this.yamcs.yamcsClient.issueCommand(this.yamcs.instance,this.yamcs.processor,i,{args:e.args,stream:e.stream,comment:e.comment,extra:e.extra}).then(n=>{this.router.navigate(["/commanding/send"+i,"-","report",n.id],{queryParams:{c:this.yamcs.context}})}).catch(n=>{this.messageService.showError(n)})}showSchedule(){let i=this.yamcs.connectionInfo$.value?.instance?.capabilities||[];return i.indexOf("timeline")!==-1&&i.indexOf("activities")!==-1&&this.authService.getUser().hasSystemPrivilege("ControlTimeline")}openScheduleCommandDialog(){this.dialog.open(xi,{width:"600px"}).afterClosed().subscribe(i=>{if(i){this.armControl.setValue(!1);let e=this.qualifiedName(),n=this.commandForm.getResult(!0),r={type:"ACTIVITY",duration:"0s",name:e,start:i.executionTime,tags:i.tags,activityDefinition:{type:"COMMAND",args:{processor:this.yamcs.processor,command:e,args:n.args,extra:n.extra,stream:n.stream}}};this.yamcs.yamcsClient.createTimelineItem(this.yamcs.instance,r).then(()=>{this.messageService.showInfo("Command scheduled"),this.router.navigateByUrl(`/commanding/send?c=${this.yamcs.context}`)}).catch(p=>this.messageService.showError(p))}})}isCleared(i,e){if(!i)return!1;switch(i.level){case"SEVERE":if(e==="SEVERE")return!0;case"CRITICAL":if(e==="CRITICAL")return!0;case"DISTRESS":if(e==="DISTRESS")return!0;case"WARNING":if(e==="WARNING")return!0;case"WATCH":if(e==="WATCH")return!0;case"NONE":if(e==="NONE"||!e)return!0}return!1}ngOnDestroy(){this.connectionInfoSubscription?.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(f(pe),f(ue),f(W),f(Oe),f(L),f(gn),f(_t),f(yt),f(lt))}}static{this.\u0275cmp=D({type:t,selectors:[["ng-component"]],viewQuery:function(e,n){if(e&1&&U(Cm,5),e&2){let r;F(r=V())&&(n.commandForm=r.first)}},inputs:{qualifiedName:[1,"command","qualifiedName"]},decls:25,vars:16,consts:[["commandForm",""],["sendMenu","matMenu"],["step","2"],[1,"form-content"],[1,"dl-horizontal","no-lead"],[3,"command","templateProvider"],["head",""],["label","Constraints",3,"expanded","visible"],[3,"command"],[3,"click"],[2,"flex","1 1 auto"],["appearance","primary","icon","send",3,"click","disabled"],[3,"text"],[3,"level"],["color","primary",3,"formControl"],[2,"width","20px"],["icon","arrow_drop_down",2,"line-height","12px",3,"matMenuTriggerFor","padding","disabled"],[1,"ya-menu",3,"overlapTrigger"],["mat-menu-item","",3,"click"]],template:function(e,n){if(e&1){let r=I();o(0,"app-instance-page")(1,"app-instance-toolbar"),l(2,"Send a command"),a(),u(3,"app-send-command-wizard-step",2),o(4,"div",3),c(5,Sm,19,8,"dl",4)(6,bm,2,0,"ya-warning-message"),C(7,"async"),o(8,"app-command-form",5,0),C(10,"async"),y(11,6),o(12,"ya-stepper-step",7),u(13,"app-command-constraints",8),a(),x(),a(),o(14,"p"),l(15,"\xA0"),a(),o(16,"mat-toolbar")(17,"ya-button",9),v("click",function(){return S(r),b(n.goBack())}),l(18,"Cancel"),a(),u(19,"span",10),c(20,Tm,3,1),o(21,"ya-button",11),C(22,"async"),v("click",function(){return S(r),b(n.sendCommand())}),l(23," Send "),a(),c(24,Dm,10,8),a()()()}if(e&2){let r,p,g=k(9);m(5),_((r=n.command())?5:-1,r),m(),_(h(7,10,n.cleared$)?-1:6),m(2),d("command",n.command())("templateProvider",h(10,12,n.templateProvider$)),m(4),d("expanded",!0)("visible",!!((p=n.command())!=null&&p.constraint)),m(),d("command",n.command()),m(7),_(n.config.twoStageCommanding?20:-1),m(),d("disabled",n.config.twoStageCommanding&&!n.armControl.value||!h(22,14,n.cleared$)||!g.form.valid),m(3),_(n.showSchedule()?24:-1)}},dependencies:[Si,Eo,j,Y,So,zt,jo,Ve,De,E,G,K,Bt,nt,Le,ot,jn,at,J,Kn,ao,so,Co,fo],encapsulation:2,changeDetection:0})}};var wm=["top"],Yo=t=>({c:t}),Em=(t,i)=>({c:t,system:i});function Im(t,i){if(t&1&&u(0,"ya-breadcrumb",11),t&2){let e=i.$implicit;d("link",e.route)("queryParams",e.queryParams)("label",e.name)}}function Mm(t,i){if(t&1&&(o(0,"div",4)(1,"ya-breadcrumb-trail"),u(2,"ya-breadcrumb",10),R(3,Im,1,3,"ya-breadcrumb",11,Q),a()()),t&2){let e=s(),n=s(2);m(2),d("queryParams",B(1,Yo,n.yamcs.context)),m(),A(e)}}function km(t,i){t&1&&c(0,Mm,5,3,"div",4),t&2&&_(i.length?0:-1)}function Lm(t,i){t&1&&(o(0,"th",25),l(1,"Significance"),a())}function Rm(t,i){t&1&&u(0,"app-significance-level",27),t&2&&d("level",i.consequenceLevel)}function Am(t,i){t&1&&l(0," - ")}function Pm(t,i){if(t&1&&(o(0,"td",26),c(1,Rm,1,1,"app-significance-level",27)(2,Am,1,0),a()),t&2){let e,n=i.$implicit;m(),_((e=n.command==null?null:n.command.effectiveSignificance)?1:2,e)}}function Om(t,i){t&1&&(o(0,"th",25),l(1,"Name"),a())}function Hm(t,i){if(t&1&&(o(0,"mat-icon",29),l(1,"folder"),a(),o(2,"a",30),l(3),C(4,"filename"),a()),t&2){let e=s().$implicit,n=s(3);m(2),d("queryParams",Z(4,Em,n.yamcs.context,e.name)),m(),T("",h(4,2,e.name),"/ ")}}function Nm(t,i){if(t&1&&u(0,"ya-highlight",32),t&2){let e=s(2).$implicit,n=s(3);d("text",e.command.qualifiedName)("term",n.filterControl.value)}}function Fm(t,i){if(t&1&&(u(0,"ya-highlight",32),C(1,"slice")),t&2){let e=s(2).$implicit,n=s(3);d("text",Mt(1,2,e.command.qualifiedName,n.system.length+1))("term",n.filterControl.value)}}function Vm(t,i){if(t&1&&(o(0,"mat-icon",29),l(1,"rss_feed"),a(),o(2,"a",31),c(3,Nm,1,2,"ya-highlight",32)(4,Fm,2,5,"ya-highlight",32),a()),t&2){let e=s().$implicit,n=s(3);m(2),d("routerLink","/commanding/send"+e.command.qualifiedName)("queryParams",B(4,Yo,n.yamcs.context)),m(),_(n.system?-1:3),m(),_(n.system?4:-1)}}function $m(t,i){if(t&1&&(o(0,"td",28),c(1,Hm,5,7)(2,Vm,5,6),a()),t&2){let e=i.$implicit;m(),_(e.system?1:-1),m(),_(e.command?2:-1)}}function Qm(t,i){t&1&&(o(0,"th",25),l(1,"Description"),a())}function Bm(t,i){if(t&1&&l(0),t&2){let e=s().$implicit;T(" ",e.system.shortDescription||"-"," ")}}function qm(t,i){if(t&1&&u(0,"ya-highlight",32),t&2){let e=s(5);d("text",i)("term",e.filterControl.value)}}function zm(t,i){t&1&&l(0," - ")}function jm(t,i){if(t&1&&c(0,qm,1,2,"ya-highlight",32)(1,zm,1,0),t&2){let e,n=s().$implicit;_((e=n.command==null?null:n.command.shortDescription)?0:1,e)}}function Ym(t,i){if(t&1&&(o(0,"td",33),c(1,Bm,1,1)(2,jm,2,1),a()),t&2){let e=i.$implicit;m(),_(e.system?1:-1),m(),_(e.command?2:-1)}}function Um(t,i){if(t&1&&(o(0,"th",25),l(1),a()),t&2){let e=s().$implicit;m(),T(" ",e.label," ")}}function Gm(t,i){if(t&1&&u(0,"ya-highlight",32),t&2){let e=s(5);d("text",i)("term",e.filterControl.value)}}function Wm(t,i){t&1&&l(0," - ")}function Km(t,i){if(t&1&&(o(0,"td",26),c(1,Gm,1,2,"ya-highlight",32),C(2,"alias"),c(3,Wm,1,0),a()),t&2){let e,n=i.$implicit,r=s().$implicit;m(),_((e=Mt(2,1,n.command,r.id))?1:3,e)}}function Jm(t,i){if(t&1&&(y(0,20),c(1,Um,2,1,"th",13)(2,Km,4,4,"td",14),x()),t&2){let e=i.$implicit;d("matColumnDef",e.id)}}function Xm(t,i){t&1&&u(0,"th",34)}function Zm(t,i){t&1&&u(0,"td",26)}function es(t,i){t&1&&u(0,"tr",35)}function ts(t,i){if(t&1&&u(0,"tr",36),t&2){let e=i.$implicit,n=s(3);O("selected",n.selection.isSelected(e))}}function is(t,i){if(t&1&&(o(0,"table",7),y(1,12),c(2,Lm,2,0,"th",13)(3,Pm,3,1,"td",14),x(),y(4,15),c(5,Om,2,0,"th",16)(6,$m,3,2,"td",17),x(),y(7,18),c(8,Qm,2,0,"th",13)(9,Ym,3,2,"td",19),x(),R(10,Jm,3,1,"ng-container",20,Q),C(12,"async"),y(13,21),c(14,Xm,1,0,"th",22)(15,Zm,1,0,"td",14),x(),c(16,es,1,0,"tr",23),C(17,"async"),c(18,ts,1,2,"tr",24),C(19,"async"),a()),t&2){s();let e=k(7),n=s();d("dataSource",n.dataSource),m(10),A(h(12,3,n.aliasColumns$)),m(6),d("matHeaderRowDef",h(17,5,e.displayedColumns$)),m(2),d("matRowDefColumns",h(19,7,e.displayedColumns$))}}function ns(t,i){t&1&&l(0," replay ")}function os(t,i){if(t&1&&(o(0,"ya-empty-message",9)(1,"p"),l(2," You are connected to the "),c(3,ns,1,0),l(4," processor "),o(5,"strong"),l(6),a(),l(7,". "),a(),o(8,"p"),l(9,"This processor does not support commanding."),a()()),t&2){let e=s();m(3),_(e.processor!=null&&e.processor.replay?3:-1),m(3),w(e.processor==null?null:e.processor.name)}}function as(t,i){if(t&1){let e=I();o(0,"div",3)(1,"div"),c(2,km,1,1),C(3,"async"),o(4,"div",4)(5,"ya-search-filter",5),v("onArrowDown",function(){S(e);let r=s();return b(r.selectNext())})("onArrowUp",function(){S(e);let r=s();return b(r.selectPrevious())})("onEnter",function(){S(e);let r=s();return b(r.applySelection())}),a(),u(6,"ya-column-chooser",6,1),a(),c(8,is,20,9,"table",7),u(9,"mat-paginator",8),C(10,"async"),a(),c(11,os,10,2,"ya-empty-message",9),a()}if(t&2){let e,n=i,r=s();m(),O("noDisplay",!(n.processor!=null&&n.processor.hasCommanding)),m(),_((e=h(3,11,r.breadcrumb$))?2:-1,e),m(3),d("formControl",r.filterControl),m(),d("columns",r.columns),m(2),_(r.dataSource?8:-1),m(),d("pageSize",r.pageSize)("hidePageSize",!0)("showFirstLastButtons",!0)("length",h(10,13,r.dataSource.totalSize$)),m(2),_(n.processor!=null&&n.processor.hasCommanding?-1:11)}}var Di=class t{constructor(i,e,n,r){this.yamcs=e;this.route=n;this.router=r;this.pageSize=100;this.system=null;this.breadcrumb$=new P([]);this.filterControl=new xe;this.columns=[{id:"name",label:"Name",alwaysVisible:!0},{id:"significance",label:"Significance",visible:!0},{id:"shortDescription",label:"Description"},{id:"actions",label:"",alwaysVisible:!0}];this.aliasColumns$=new P([]);this.selection=new Qt(!1);i.setTitle("Send a command"),this.connectionInfo$=e.connectionInfo$,this.dataSource=new Mo(e)}ngAfterViewInit(){this.filterControl.setValue(this.route.snapshot.queryParamMap.get("filter")),this.changeSystem(this.route.snapshot.queryParamMap),this.queryParamMapSubscription=this.route.queryParamMap.subscribe(i=>{i.get("system")!==this.system&&this.changeSystem(i)}),this.filterControl.valueChanges.subscribe(()=>{this.paginator.pageIndex=0,this.updateDataSource()}),this.paginator.page.subscribe(()=>{this.updateDataSource(),this.top.nativeElement.scrollIntoView()})}changeSystem(i){this.system=i.get("system"),this.updateBrowsePath(),i.has("page")?this.paginator.pageIndex=Number(i.get("page")):this.paginator.pageIndex=0,this.updateDataSource()}updateDataSource(){this.updateURL();let i={system:this.system||"/",noAbstract:!0,details:!0,pos:this.paginator.pageIndex*this.pageSize,limit:this.pageSize,fields:["name","qualifiedName","alias","effectiveSignificance","shortDescription"]},e=this.filterControl.value;e&&(i.q=e.toLowerCase()),this.dataSource.loadCommands(i).then(()=>{this.selection.clear(),this.updateBrowsePath();for(let r of this.aliasColumns$.value){let p=this.columns.indexOf(r);p!==-1&&this.columns.splice(p,1)}let n=[];for(let r of this.dataSource.getAliasNamespaces()){let p={id:r,label:r,alwaysVisible:!0};n.push(p)}this.columns.splice(1,0,...n),this.aliasColumns$.next(n),this.columnChooser.recalculate(this.columns)})}updateURL(){let i=this.filterControl.value;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{page:this.paginator.pageIndex||null,filter:i||null,system:this.system||null},queryParamsHandling:"merge"})}updateBrowsePath(){let i=[],e="";if(this.system)for(let n of this.system.slice(1).split("/"))e+="/"+n,i.push({name:n,route:"/commanding/send",queryParams:{system:e,c:this.yamcs.context}});this.breadcrumb$.next(i)}selectNext(){let i=this.dataSource.items$.value,e=0;if(this.selection.hasValue()){let n=this.selection.selected[0];i.indexOf(n)!==-1&&(e=Math.min(i.indexOf(n)+1,i.length-1))}this.selection.select(i[e])}selectPrevious(){let i=this.dataSource.items$.value,e=0;if(this.selection.hasValue()){let n=this.selection.selected[0];i.indexOf(n)!==-1&&(e=Math.max(i.indexOf(n)-1,0))}this.selection.select(i[e])}applySelection(){if(this.selection.hasValue()){let i=this.selection.selected[0],e=this.dataSource.items$.value;i.command&&e.indexOf(i)!==-1&&this.router.navigate(["/commanding/send"+i.command?.qualifiedName],{queryParams:{c:this.yamcs.context}})}}ngOnDestroy(){this.queryParamMapSubscription?.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(f(W),f(L),f(pe),f(ue))}}static{this.\u0275cmp=D({type:t,selectors:[["ng-component"]],viewQuery:function(e,n){if(e&1&&(U(wm,7),U(Ae,5),U(He,5)),e&2){let r;F(r=V())&&(n.top=r.first),F(r=V())&&(n.paginator=r.first),F(r=V())&&(n.columnChooser=r.first)}},decls:8,vars:3,consts:[["top",""],["columnChooser",""],["step","1"],[1,"panel-content"],[1,"filter-bar"],["placeholder","Search by name","icon","search",3,"onArrowDown","onArrowUp","onEnter","formControl"],["preferenceKey","sendCommand",3,"columns"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],[3,"pageSize","hidePageSize","showFirstLastButtons","length"],["headerTitle","Send a command"],["link","/commanding/send","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label"],["matColumnDef","significance"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","","class","primary-td",4,"matCellDef"],["matColumnDef","shortDescription"],["mat-cell","","class","wrap400",4,"matCellDef"],[3,"matColumnDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"level"],["mat-cell","",1,"primary-td"],[1,"icon12",2,"vertical-align","middle"],["routerLink","/commanding/send",3,"queryParams"],[3,"routerLink","queryParams"],[3,"text","term"],["mat-cell","",1,"wrap400"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,n){if(e&1&&(o(0,"app-instance-page")(1,"app-instance-toolbar"),l(2," Send a command "),a(),u(3,"span",null,0)(5,"app-send-command-wizard-step",2),c(6,as,12,15,"div",3),C(7,"async"),a()),e&2){let r;m(6),_((r=h(7,1,n.connectionInfo$))?6:-1,r)}},dependencies:[Y,j,Ve,E,G,xn,K,Bt,ee,pt,ut,Se,Ae,ie,oe,me,ae,ne,se,re,le,ce,de,Wn,Gn,He,Ct,ei,ii,ni,uo,De],styles:[".pullRight[_ngcontent-%COMP%]{float:right}.primary-td[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:7px}"],changeDetection:0})}};function rs(t,i){t&1&&(o(0,"th",17),l(1,"Time"),a())}function ls(t,i){if(t&1&&(o(0,"td",18),l(1),C(2,"datetime"),a()),t&2){let e=i.$implicit;m(),T(" ",h(2,1,e.generationTime)," ")}}function ms(t,i){t&1&&(o(0,"th",19)(1,"mat-icon",20),l(2,"comment"),a()())}function ss(t,i){if(t&1&&(o(0,"mat-icon",22),l(1,"comment"),a()),t&2){let e=s().$implicit;d("matTooltip",e.comment)}}function cs(t,i){t&1&&l(0," - ")}function ds(t,i){if(t&1&&(o(0,"td",21),c(1,ss,2,1,"mat-icon",22)(2,cs,1,0),a()),t&2){let e=i.$implicit;m(),_(e.comment?1:-1),m(),_(e.comment?-1:2)}}function ps(t,i){t&1&&(o(0,"th",17),l(1,"Command"),a())}function us(t,i){if(t&1&&(o(0,"td",18),l(1),a()),t&2){let e=i.$implicit;m(),T(" ",e.commandName||"-"," ")}}function _s(t,i){t&1&&(o(0,"th",17),l(1,"Queue"),a())}function Cs(t,i){if(t&1&&(o(0,"td",18),l(1),a()),t&2){let e=i.$implicit;m(),T(" ",e.queueName||"-"," ")}}function fs(t,i){t&1&&(o(0,"th",17),l(1,"Issuer"),a())}function hs(t,i){if(t&1&&(o(0,"span"),l(1),a()),t&2){let e=s().$implicit;m(),T("@",e.origin,"")}}function gs(t,i){if(t&1&&(o(0,"td",18),l(1),c(2,hs,2,1,"span"),a()),t&2){let e=i.$implicit;m(),T(" ",e.username," "),m(),_(e.origin?2:-1)}}function vs(t,i){t&1&&(o(0,"th",17),l(1,"Source"),a())}function ys(t,i){if(t&1&&(o(0,"td",18),l(1),a()),t&2){let e=i.$implicit;m(),T(" ",e.origin||"-"," ")}}function xs(t,i){t&1&&(o(0,"th",23),l(1,"Command"),a())}function Ss(t,i){if(t&1&&(o(0,"tr")(1,"td",25),l(2),a(),o(3,"td",26),l(4),C(5,"value"),a()()),t&2){let e=s().$implicit;m(2),w(e.name),m(2),w(h(5,2,e.value))}}function bs(t,i){if(t&1&&c(0,Ss,6,4,"tr"),t&2){let e=i.$implicit;_(e.userInput?0:-1)}}function Ts(t,i){if(t&1&&(o(0,"td",18),l(1),o(2,"table",24),R(3,bs,1,1,null,null,Q),a()()),t&2){let e=i.$implicit;m(),T(" ",e.commandName," "),m(2),A(e.assignments)}}function Ds(t,i){t&1&&(o(0,"th",27),l(1,"Actions"),a())}function ws(t,i){t&1&&(o(0,"span",28)(1,"mat-icon",29),l(2,"cached"),a(),l(3," Checking transmission constraints "),a())}function Es(t,i){if(t&1){let e=I();o(0,"ya-text-action",30),v("click",function(){S(e);let r=s().$implicit,p=s(2);return b(p.acceptEntry(r))}),l(1,"ACCEPT"),a(),o(2,"ya-text-action",31),v("click",function(){S(e);let r=s().$implicit,p=s(2);return b(p.rejectEntry(r))}),l(3,"REJECT"),a()}if(t&2){let e=s().$implicit;d("disabled",e.pendingTransmissionConstraints),m(2),d("disabled",e.pendingTransmissionConstraints)}}function Is(t,i){if(t&1&&(o(0,"td",18),c(1,ws,4,0,"span",28)(2,Es,4,2),a()),t&2){let e=i.$implicit;m(),_(e.pendingTransmissionConstraints?1:-1),m(),_(e.pendingTransmissionConstraints?-1:2)}}function Ms(t,i){t&1&&u(0,"tr",32)}function ks(t,i){t&1&&u(0,"tr",33)}function Ls(t,i){if(t&1&&(o(0,"table",0),y(1,1),c(2,rs,2,0,"th",2)(3,ls,3,3,"td",3),x(),y(4,4),c(5,ms,3,0,"th",5)(6,ds,3,2,"td",6),x(),y(7,7),c(8,ps,2,0,"th",2)(9,us,2,1,"td",3),x(),y(10,8),c(11,_s,2,0,"th",2)(12,Cs,2,1,"td",3),x(),y(13,9),c(14,fs,2,0,"th",2)(15,gs,3,2,"td",3),x(),y(16,10),c(17,vs,2,0,"th",2)(18,ys,2,1,"td",3),x(),y(19,11),c(20,xs,2,0,"th",12)(21,Ts,5,1,"td",3),x(),y(22,13),c(23,Ds,2,0,"th",14)(24,Is,3,2,"td",3),x(),c(25,Ms,1,0,"tr",15)(26,ks,1,0,"tr",16),a()),t&2){let e=s();d("dataSource",e.dataSource),m(25),d("matHeaderRowDef",e.displayedColumns),m(),d("matRowDefColumns",e.displayedColumns)}}var wi=class t{constructor(i){this.yamcs=i;this.dataSource=new be;this.displayedColumns=["generationTime","comment","source","queueName","issuer","actions"]}ngAfterViewInit(){this.dataSource.sort=this.sort,this.cqueues$.subscribe(i=>{let e=[];for(let n of i)n.entries&&e.push(...n.entries);this.dataSource.data=e})}acceptEntry(i){confirm(`Are you sure you want to accept this command?

 ${i.commandName}`)&&this.yamcs.yamcsClient.acceptCommand(i.instance,i.processorName,i.queueName,i.id)}rejectEntry(i){confirm(`Are you sure you want to reject this command?

 ${i.commandName}`)&&this.yamcs.yamcsClient.rejectCommand(i.instance,i.processorName,i.queueName,i.id)}static{this.\u0275fac=function(e){return new(e||t)(f(L))}}static{this.\u0275cmp=D({type:t,selectors:[["app-queued-commands-table"]],viewQuery:function(e,n){if(e&1&&U(Pe,5),e&2){let r;F(r=V())&&(n.sort=r.first)}},inputs:{cqueues$:"cqueues$"},decls:1,vars:1,consts:[["mat-table","","matSort","","matSortActive","generationTime","matSortDirection","asc","matSortDisableClear","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","generationTime"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","comment"],["mat-header-cell","","style","text-align: center",4,"matHeaderCellDef"],["mat-cell","","style","text-align: center",4,"matCellDef"],["matColumnDef","commandName"],["matColumnDef","queueName"],["matColumnDef","issuer"],["matColumnDef","origin"],["matColumnDef","source"],["mat-header-cell","","mat-sort-header","","style","width: 350px",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","",2,"text-align","center"],["matTooltip","Comment"],["mat-cell","",2,"text-align","center"],[3,"matTooltip"],["mat-header-cell","","mat-sort-header","",2,"width","350px"],[1,"args"],["width","1",1,"key"],[1,"value"],["mat-header-cell","",1,"expand"],[2,"color","#999"],[1,"icon16","spin",2,"vertical-align","middle"],["icon","check",3,"click","disabled"],["icon","close",3,"click","disabled"],["mat-header-row",""],["mat-row",""]],template:function(e,n){e&1&&c(0,Ls,27,3,"table",0),e&2&&_(n.dataSource?0:-1)},dependencies:[E,Se,Pe,Wt,ie,oe,me,ae,ne,se,re,le,ce,de,jt,no,ge,vt],styles:[".args[_ngcontent-%COMP%]{margin:0 0 0 10px}.args[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%]{min-width:120px;white-space:nowrap}.args[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:gray;padding-left:10px}.args[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .args[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:none;font-size:10px;line-height:12px;font-family:Roboto Mono,monospace}.spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_yspin 2s infinite linear}@keyframes _ngcontent-%COMP%_yspin{0%{-webkit-transform:rotate(0deg) scaleX(-1);transform:rotate(0) scaleX(-1)}to{-webkit-transform:rotate(359deg) scaleX(-1);transform:rotate(359deg) scaleX(-1)}}"],changeDetection:0})}};function Rs(t,i){if(t&1&&u(0,"app-queued-commands-table",1),t&2){let e=s();d("cqueues$",e.cqueues$)}}function As(t,i){t&1&&l(0,` All queues are empty.
`)}function Ps(t,i){t&1&&l(0," All queues are empty. ")}var Ei=class t{constructor(i){this.cqueues$=new P([]);this.hasEntries$=new P(!1);this.cqueueByName={};i.yamcsClient.getCommandQueues(i.instance,i.processor).then(e=>{for(let n of e)this.cqueueByName[n.name]=n;this.emitChange()}),this.queueEventSubscription=i.yamcsClient.createQueueEventsSubscription({instance:i.instance,processor:i.processor},e=>{let n=this.cqueueByName[e.data.queueName];if(n){if(e.type==="COMMAND_ADDED")n.entries=n.entries||[],n.entries.push(e.data);else if(e.type==="COMMAND_UPDATED"){let r=(n.entries||[]).findIndex(p=>p.id===e.data.id);r!==-1&&(n.entries[r]=e.data)}else if(e.type==="COMMAND_REJECTED")n.entries=n.entries||[],n.entries=n.entries.filter(r=>r.id!==e.data.id);else if(e.type==="COMMAND_SENT")n.entries=n.entries||[],n.entries=n.entries.filter(r=>r.id!==e.data.id);else throw new Error(`Unexpected queue event ${e.type}`);this.emitChange()}else console.warn("Received an event for an unknown queue",e)})}emitChange(){this.cqueues$.next(Object.values(this.cqueueByName));let i=!1;for(let e of this.cqueues$.getValue())if(e.entries&&e.entries.length){i=!0;break}this.hasEntries$.next(i)}ngOnDestroy(){this.queueEventSubscription?.cancel()}static{this.\u0275fac=function(e){return new(e||t)(f(L))}}static{this.\u0275cmp=D({type:t,selectors:[["ng-component"]],decls:5,vars:3,consts:[["empty",""],[3,"cqueues$"]],template:function(e,n){e&1&&(c(0,Rs,1,1,"app-queued-commands-table",1),C(1,"async"),c(2,As,1,0)(3,Ps,1,0,"ng-template",null,0,Nt)),e&2&&_(h(1,1,n.hasEntries$)?0:2)},dependencies:[E,G,wi],encapsulation:2,changeDetection:0})}};function Os(t,i){if(t&1){let e=I();u(0,"ya-date-time-input",13)(1,"ya-date-time-input",14),o(2,"ya-button",15),v("click",function(){S(e);let r=s();return b(r.applyCustomDates())}),l(3,"Apply"),a()}if(t&2){let e=s();m(2),d("disabled",e.filterForm.invalid)}}function Hs(t,i){if(t&1){let e=I();o(0,"ya-button",16),v("click",function(){S(e);let r=s();return b(r.jumpToNow())}),l(1,"Jump to now"),a()}}function Ns(t,i){t&1&&(o(0,"th",17),l(1,"Time"),a())}function Fs(t,i){if(t&1&&(o(0,"td",18),l(1),C(2,"datetime"),a()),t&2){let e=i.$implicit;m(),w(h(2,1,e.time))}}function Vs(t,i){t&1&&(o(0,"th",17),l(1,"User"),a())}function $s(t,i){if(t&1&&(o(0,"td",18),l(1),a()),t&2){let e=i.$implicit;m(),w(e.user||"-")}}function Qs(t,i){t&1&&(o(0,"th",17),l(1,"Action"),a())}function Bs(t,i){if(t&1&&(o(0,"td",18),u(1,"ya-action-log-summary",19),a()),t&2){let e=i.$implicit;m(),d("text",e.summary)}}function qs(t,i){t&1&&u(0,"th",20)}function zs(t,i){t&1&&u(0,"td",18)}function js(t,i){t&1&&u(0,"tr",21)}function Ys(t,i){t&1&&u(0,"tr",22)}var Ii=class t{constructor(i,e,n,r,p){this.yamcs=e;this.messageService=n;this.router=r;this.route=p;this.interval=X();this.customStart=X();this.customStop=X();this.filterForm=new it({interval:new te("NO_LIMIT"),customStart:new te(null),customStop:new te(null)});this.displayedColumns=["time","user","summary","actions"];this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}];this.dataSource=new be;i.setTitle("Queues")}ngOnInit(){this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(i=>{if(i==="CUSTOM"){let e=new Date,n=this.validStart||e,r=this.validStop||e;this.filterForm.get("customStart").setValue(M.toISOString(n)),this.filterForm.get("customStop").setValue(M.toISOString(r))}else i==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=i,this.loadData()):i&&(this.validStop=new Date,this.validStart=M.subtractDuration(this.validStop,i),this.appliedInterval=i,this.loadData())})}initializeOptions(){if(this.interval())if(this.appliedInterval=this.interval(),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let i=this.customStart();this.filterForm.get("customStart").setValue(i),this.validStart=M.toDate(i);let e=this.customStop();this.filterForm.get("customStop").setValue(e),this.validStop=M.toDate(e)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=new Date,this.validStart=M.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval="NO_LIMIT",this.validStop=null,this.validStart=null}jumpToNow(){this.filterForm.get("interval").setValue("NO_LIMIT")}applyCustomDates(){let{controls:i}=this.filterForm;this.validStart=M.toDate(i.customStart.value),this.validStop=M.toDate(i.customStop.value),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();let i={service:"QueuesApi"};this.validStart&&(i.start=this.validStart.toISOString()),this.validStop&&(i.stop=this.validStop.toISOString()),this.yamcs.yamcsClient.getAuditRecords(this.yamcs.instance,i).then(e=>this.dataSource.data=e.records||[]).catch(e=>this.messageService.showError(e))}updateURL(){let{controls:i}=this.filterForm;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?i.customStart.value:null,customStop:this.appliedInterval==="CUSTOM"?i.customStop.value:null},queryParamsHandling:"merge"})}static{this.\u0275fac=function(e){return new(e||t)(f(W),f(L),f(Oe),f(ue),f(pe))}}static{this.\u0275cmp=D({type:t,selectors:[["app-queues-action-log-tab"]],inputs:{interval:[1,"interval"],customStart:[1,"customStart"],customStop:[1,"customStop"]},decls:20,vars:7,consts:[[3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","time"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","user"],["matColumnDef","summary"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["formControlName","customStart"],["formControlName","customStop"],[3,"click","disabled"],[3,"click"],["mat-header-cell",""],["mat-cell",""],[3,"text"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,n){e&1&&(o(0,"form",0)(1,"div",1),u(2,"ya-select",2),c(3,Os,4,1)(4,Hs,2,0,"ya-button"),a()(),o(5,"table",3),y(6,4),c(7,Ns,2,0,"th",5)(8,Fs,3,3,"td",6),x(),y(9,7),c(10,Vs,2,0,"th",5)(11,$s,2,1,"td",6),x(),y(12,8),c(13,Qs,2,0,"th",5)(14,Bs,2,1,"td",6),x(),y(15,9),c(16,qs,1,0,"th",10)(17,zs,1,0,"td",6),x(),c(18,js,1,0,"tr",11)(19,Ys,1,0,"tr",12),a()),e&2&&(d("formGroup",n.filterForm),m(2),d("options",n.intervalOptions),m(),_(n.filterForm.value.interval==="CUSTOM"?3:-1),m(),_(n.filterForm.value.interval!=="CUSTOM"?4:-1),m(),d("dataSource",n.dataSource),m(13),d("matHeaderRowDef",n.displayedColumns),m(),d("matRowDefColumns",n.displayedColumns))},dependencies:[E,Ce,K,_e,fe,he,ie,oe,me,ae,ne,se,re,le,ce,de,Zt,J,Te,Ne,ge],encapsulation:2,changeDetection:0})}};var Uo=t=>({c:t}),Us=(t,i)=>({c:t,queue:i});function Gs(t,i){if(t&1){let e=I();o(0,"th",32)(1,"input",33),v("change",function(r){S(e);let p=s(3);return b(r?p.masterToggle():null)}),a()()}if(t&2){let e=s(3);m(),d("checked",e.selection.hasValue()&&e.isAllSelected())}}function Ws(t,i){if(t&1){let e=I();o(0,"td",34)(1,"input",35),v("click",function(r){return S(e),b(r.stopPropagation())})("change",function(r){let p=S(e).$implicit,g=s(3);return b(r?g.selection.toggle(p):null)}),a()()}if(t&2){let e=i.$implicit,n=s(3);m(),d("checked",n.selection.isSelected(e))}}function Ks(t,i){t&1&&(o(0,"th",36),l(1,"#"),a())}function Js(t,i){if(t&1&&(o(0,"td",37),l(1),a()),t&2){let e=i.$implicit;m(),T(" ",e.order," ")}}function Xs(t,i){t&1&&(o(0,"th",36),l(1,"Queue"),a())}function Zs(t,i){if(t&1&&(o(0,"td",37),l(1),a()),t&2){let e=i.$implicit;m(),T(" ",e.name," ")}}function ec(t,i){t&1&&(o(0,"th",36),l(1,"Issuer"),a())}function tc(t,i){if(t&1&&(o(0,"ya-label",38),l(1),a()),t&2){let e=i.$implicit;m(),w(e)}}function ic(t,i){if(t&1&&(o(0,"ya-label",39),l(1),a()),t&2){let e=i.$implicit;m(),w(e)}}function nc(t,i){t&1&&l(0," any ")}function oc(t,i){if(t&1&&(o(0,"td",37),R(1,tc,2,1,"ya-label",38,Q),R(3,ic,2,1,"ya-label",39,Q),c(5,nc,1,0),a()),t&2){let e=i.$implicit;m(),A(e.groups),m(2),A(e.users),m(2),_(!e.groups&&!e.users?5:-1)}}function ac(t,i){t&1&&(o(0,"th",36),l(1,"Min.\xA0level"),a())}function rc(t,i){if(t&1&&(o(0,"td",37),u(1,"app-significance-level",40),a()),t&2){let e=i.$implicit;m(),d("level",e.minLevel)("grayscale",!0)}}function lc(t,i){t&1&&(o(0,"th",36),l(1,"Name\xA0patterns"),a())}function mc(t,i){t&1&&l(0," any ")}function sc(t,i){if(t&1&&(l(0),u(1,"br")),t&2){let e=i.$implicit;T(" ",e," ")}}function cc(t,i){if(t&1&&(o(0,"td",37),c(1,mc,1,0),R(2,sc,2,1,null,null,Q),a()),t&2){let e=i.$implicit;m(),_(e.tcPatterns?-1:1),m(),A(e.tcPatterns)}}function dc(t,i){t&1&&(o(0,"th",36),l(1,"Action"),a())}function pc(t,i){t&1&&(o(0,"span"),l(1,"ACCEPT"),a())}function uc(t,i){if(t&1&&(o(0,"span"),C(1,"async"),l(2,"HOLD"),a()),t&2){let e=s(4);Ot("visibility",h(1,2,e.visibility$)?"visible":"hidden")}}function _c(t,i){t&1&&(o(0,"span"),l(1,"REJECT"),a())}function Cc(t,i){if(t&1&&(o(0,"td",37),c(1,pc,2,0,"span")(2,uc,3,4,"span",41)(3,_c,2,0,"span"),a()),t&2){let e=i.$implicit;m(),_(e.state==="ENABLED"?1:-1),m(),_(e.state==="BLOCKED"?2:-1),m(),_(e.state==="DISABLED"?3:-1)}}function fc(t,i){t&1&&(o(0,"th",36),l(1,"Pending"),a())}function hc(t,i){if(t&1&&(o(0,"td",42),l(1),C(2,"number"),a()),t&2){let e=i.$implicit;m(),T(" ",h(2,1,(e.entries==null?null:e.entries.length)||0)," ")}}function gc(t,i){t&1&&u(0,"th",43)}function vc(t,i){if(t&1){let e=I();o(0,"td",37)(1,"ya-more")(2,"button",8),v("click",function(){let r=S(e).$implicit,p=s(3);return b(p.enableQueue(r))}),o(3,"mat-icon"),l(4,"check"),a(),l(5," Accept mode "),a(),o(6,"button",8),v("click",function(){let r=S(e).$implicit,p=s(3);return b(p.blockQueue(r))}),o(7,"mat-icon"),l(8,"pause"),a(),l(9," Hold mode "),a(),o(10,"button",8),v("click",function(){let r=S(e).$implicit,p=s(3);return b(p.disableQueue(r))}),o(11,"mat-icon"),l(12,"close"),a(),l(13," Reject mode "),a(),u(14,"mat-divider"),o(15,"a",44),l(16," View command history "),a()()()}if(t&2){let e=i.$implicit,n=s(3);m(15),d("queryParams",Z(1,Us,n.yamcs.context,e.name))}}function yc(t,i){t&1&&u(0,"tr",45)}function xc(t,i){if(t&1){let e=I();o(0,"tr",46),v("click",function(){let r=S(e).$implicit,p=s(3);return b(p.toggleOne(r))}),a()}if(t&2){let e=i.$implicit,n=s(3);O("selected",n.selection.isSelected(e))}}function Sc(t,i){if(t&1&&(o(0,"table",10),y(1,15),c(2,Gs,2,1,"th",16)(3,Ws,2,1,"td",17),x(),y(4,18),c(5,Ks,2,0,"th",19)(6,Js,2,1,"td",20),x(),y(7,21),c(8,Xs,2,0,"th",19)(9,Zs,2,1,"td",20),x(),y(10,22),c(11,ec,2,0,"th",19)(12,oc,6,1,"td",20),x(),y(13,23),c(14,ac,2,0,"th",19)(15,rc,2,2,"td",20),x(),y(16,24),c(17,lc,2,0,"th",19)(18,cc,4,1,"td",20),x(),y(19,25),c(20,dc,2,0,"th",19)(21,Cc,4,3,"td",20),x(),y(22,26),c(23,fc,2,0,"th",19)(24,hc,3,3,"td",27),x(),y(25,28),c(26,gc,1,0,"th",29)(27,vc,17,4,"td",20),x(),c(28,yc,1,0,"tr",30)(29,xc,1,2,"tr",31),a()),t&2){let e=s(2);d("dataSource",e.dataSource)("trackBy",e.tableTrackerFn),m(28),d("matHeaderRowDef",e.displayedColumns),m(),d("matRowDefColumns",e.displayedColumns)}}function bc(t,i){if(t&1&&(c(0,Sc,30,4,"table",10),o(1,"p"),l(2,"\xA0"),a(),o(3,"nav",11)(4,"a",12,1),l(6," Pending "),a(),o(7,"a",13,2),l(9," Action log "),a()(),o(10,"div",14)(11,"mat-tab-nav-panel",null,3),u(13,"router-outlet"),a()()),t&2){let e=k(5),n=k(8),r=k(12),p=s();_(p.dataSource?0:-1),m(3),d("mat-stretch-tabs",!1)("tabPanel",r),m(),d("active",e.isActive)("queryParams",B(7,Uo,p.yamcs.context)),m(3),d("active",n.isActive)("queryParams",B(9,Uo,p.yamcs.context))}}function Tc(t,i){t&1&&l(0," replay ")}function Dc(t,i){if(t&1&&(o(0,"ya-empty-message",47)(1,"p"),l(2," You are connected to the "),c(3,Tc,1,0),l(4," processor "),o(5,"strong"),l(6),a(),l(7," . "),a(),o(8,"p"),l(9,"This processor does not support commanding."),a()()),t&2){let e=i;m(3),_(e.processor!=null&&e.processor.replay?3:-1),m(3),w(e.processor==null?null:e.processor.name)}}function wc(t,i){if(t&1&&(c(0,Dc,10,2,"ya-empty-message",47),C(1,"async")),t&2){let e,n=s();_((e=h(1,1,n.connectionInfo$))?0:-1,e)}}var Mi=class t{constructor(i,e,n,r,p){this.yamcs=i;this.changeDetection=r;this.cqueues$=new P([]);this.dataSource=new be;this.selection=new go((i,e)=>e.name,!0,[]);this.tableTrackerFn=(i,e)=>e.name;this.displayedColumns=["select","order","name","issuer","level","patterns","action","pending","actions"];this.visibility$=new P(!0);this.cqueueByName={};e.setTitle("Queues"),this.connectionInfo$=i.connectionInfo$,i.yamcsClient.getCommandQueues(i.instance,i.processor).then(g=>{for(let N of g)this.cqueueByName[N.name]=N;this.emitChange()}).catch(g=>n.showError(g)),this.syncSubscription=p.syncFast(()=>{this.visibility$.next(!this.visibility$.value)}),this.queueSubscription=i.yamcsClient.createQueueStatisticsSubscription({instance:i.instance,processor:i.processor},g=>{let N=this.cqueueByName[g.name];N&&(g.entries=N.entries,this.cqueueByName[g.name]=g,this.emitChange())}),this.queueEventSubscription=i.yamcsClient.createQueueEventsSubscription({instance:i.instance,processor:i.processor},g=>{let N=this.cqueueByName[g.data.queueName];if(N){if(g.type==="COMMAND_ADDED")N.entries=N.entries||[],N.entries.push(g.data);else if(g.type==="COMMAND_UPDATED"){let Me=(N.entries||[]).findIndex(nn=>nn.id===g.data.id);Me!==-1&&(N.entries[Me]=g.data)}else if(g.type==="COMMAND_REJECTED")N.entries=N.entries||[],N.entries=N.entries.filter(Me=>Me.id!==g.data.id);else if(g.type==="COMMAND_SENT")N.entries=N.entries||[],N.entries=N.entries.filter(Me=>Me.id!==g.data.id);else throw new Error(`Unexpected queue event ${g.type}`);this.emitChange()}else console.warn("Received an event for an unknown queue",g)})}ngAfterViewInit(){this.cqueues$.subscribe(i=>{this.dataSource.data=i,this.selection.matchNewValues(i),this.changeDetection.detectChanges()})}isAllSelected(){let i=this.selection.selected.length,e=this.dataSource.filteredData.length;return i===e&&e>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.filteredData.forEach(i=>this.selection.select(i))}toggleOne(i){(!this.selection.isSelected(i)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(i)}enableSelectedQueues(){for(let i of this.selection.selected)this.enableQueue(i)}enableQueue(i){let e=i.entries?.length||0,n=`Are you sure you want to change the '${i.name}' queue's action to ACCEPT?

`;e===1?n+=`There is ${e} queued command that will be accepted immediately.`:n+=`There are ${e} queued commands that will be accepted immediately.`,!(e&&!confirm(n))&&this.yamcs.yamcsClient.enableCommandQueue(i.instance,i.processorName,i.name)}disableSelectedQueues(){for(let i of this.selection.selected)this.disableQueue(i)}disableQueue(i){let e=i.entries?.length||0,n=`Are you sure you want to change the '${i.name}' queue's action to REJECT?

`;e===1?n+=`There is ${e} queued command that will be rejected immediately.`:n+=`There are ${e} queued commands that will be rejected immediately.`,!(e&&!confirm(n))&&this.yamcs.yamcsClient.disableCommandQueue(i.instance,i.processorName,i.name)}blockSelectedQueues(){for(let i of this.selection.selected)this.blockQueue(i)}blockQueue(i){this.yamcs.yamcsClient.blockCommandQueue(i.instance,i.processorName,i.name)}emitChange(){this.cqueues$.next(Object.values(this.cqueueByName))}ngOnDestroy(){this.syncSubscription?.unsubscribe(),this.queueSubscription?.cancel(),this.queueEventSubscription?.cancel()}static{this.\u0275fac=function(e){return new(e||t)(f(L),f(W),f(Oe),f(Ze),f(Yn))}}static{this.\u0275cmp=D({type:t,selectors:[["ng-component"]],decls:47,vars:5,consts:[["actionMenu","matMenu"],["rla","routerLinkActive"],["rlb","routerLinkActive"],["tabPanel",""],["yaSimpleTable","",2,"width","100%"],["width","1"],["dropdown","true",3,"matMenuTriggerFor","disabled"],[1,"ya-menu"],["mat-menu-item","",3,"click"],[1,"panel-content"],["mat-table","",1,"ya-data-table","expand",3,"dataSource","trackBy"],["mat-tab-nav-bar","",1,"secondary",3,"mat-stretch-tabs","tabPanel"],["mat-tab-link","","routerLink","/commanding/queues/pending","routerLinkActive","",3,"active","queryParams"],["mat-tab-link","","routerLink","/commanding/queues/log","routerLinkActive","",3,"active","queryParams"],[2,"margin-top","16px"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",4,"cdkCellDef"],["matColumnDef","order"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","issuer"],["matColumnDef","level"],["matColumnDef","patterns"],["matColumnDef","action"],["matColumnDef","pending"],["mat-cell","","style","text-align: center",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"checkbox"],["type","checkbox",3,"change","checked"],["mat-cell","",1,"checkbox"],["type","checkbox",3,"click","change","checked"],["mat-header-cell",""],["mat-cell",""],["icon","people"],["icon","person"],[3,"level","grayscale"],[3,"visibility"],["mat-cell","",2,"text-align","center"],["mat-header-cell","",1,"expand"],["mat-menu-item","","routerLink","/commanding/history",3,"queryParams"],["mat-header-row",""],["mat-row","",3,"click"],["headerTitle","Queues"]],template:function(e,n){if(e&1){let r=I();o(0,"app-instance-page")(1,"app-instance-toolbar"),l(2," Queues "),o(3,"ya-help")(4,"p"),l(5," A queue is a temporary holding location for issued commands that are waiting to enter the next stage of processing. "),a(),o(6,"p"),l(7,"Queues are an ordered list. Issued commands are offered to the first matching queue."),a(),o(8,"p"),l(9,"A queue can perform these actions:"),a(),o(10,"table",4)(11,"tr")(12,"th",5),l(13,"ACCEPT"),a(),o(14,"td"),l(15,"The queue accepts and releases commands."),a()(),o(16,"tr")(17,"th"),l(18,"HOLD"),a(),o(19,"td"),l(20," The queue accepts commands but does not release them. These commands may be released manually, or automatically as soon as the queue action changes to ACCEPT. "),a()(),o(21,"tr")(22,"th"),l(23,"REJECT"),a(),o(24,"td"),l(25,"The queue does not accept commands. Matching commands fail immediately."),a()()()(),l(26," \xA0\xA0\xA0 "),o(27,"ya-page-button",6),l(28," Change action "),a(),o(29,"mat-menu",7,0)(31,"button",8),v("click",function(){return S(r),b(n.enableSelectedQueues())}),o(32,"mat-icon"),l(33,"check"),a(),l(34," ACCEPT "),a(),o(35,"button",8),v("click",function(){return S(r),b(n.blockSelectedQueues())}),o(36,"mat-icon"),l(37,"pause"),a(),l(38," HOLD "),a(),o(39,"button",8),v("click",function(){return S(r),b(n.disableSelectedQueues())}),o(40,"mat-icon"),l(41,"close"),a(),l(42," REJECT "),a()()(),o(43,"div",9),c(44,bc,14,11),C(45,"async"),c(46,wc,2,3),a()()}if(e&2){let r,p=k(30);m(27),d("matMenuTriggerFor",p)("disabled",n.selection.isEmpty()),m(17),_(!((r=h(45,3,n.connectionInfo$))==null||r.processor==null)&&r.processor.hasCommanding?44:46)}},dependencies:[Y,j,E,G,yn,Ft,ee,Vt,po,Gt,pt,ut,Se,Re,nt,Le,ot,ie,oe,me,ae,ne,se,re,le,ce,de,Kt,Xt,Jt,Ct,ft,oo,ht,gt,De],encapsulation:2,changeDetection:0})}};var Ec=t=>({c:t}),ki=class t{constructor(i,e){this.yamcs=e;i.setTitle("Command stacks")}static{this.\u0275fac=function(e){return new(e||t)(f(W),f(L))}}static{this.\u0275cmp=D({type:t,selectors:[["app-stacks-page"]],decls:13,vars:3,consts:[[1,"panel-content"],["headerTitle","Notice"],["routerLink","/procedures/stacks",1,"ya-link",3,"queryParams"]],template:function(e,n){e&1&&(o(0,"app-instance-page")(1,"app-instance-toolbar"),l(2,"Command stacks"),a(),o(3,"div",0)(4,"ya-empty-message",1)(5,"p"),l(6," The "),o(7,"strong"),l(8,"Command stacks"),a(),l(9," functionality was moved to "),o(10,"a",2),l(11," Procedures > Stacks "),a(),l(12," . "),a()()()()),e&2&&(m(10),d("queryParams",B(1,Ec,n.yamcs.context)))},dependencies:[j,Y,E,ee,Ct],encapsulation:2,changeDetection:0})}};var Ic=t=>{let i=t,e=t.findIndex(r=>r.path==="-");e!==-1&&(i=t.slice(0,e));let n="/"+i.map(r=>r.path).join("/");return{consumed:i,posParams:{command:new Sn(n,{})}}},wC=[{path:"",canActivate:[ji,zi],canActivateChild:[Yi],runGuardsAndResolvers:"always",component:xo,children:[{path:"clearances",canActivate:[Ao],children:[{path:"",pathMatch:"full",component:mi},{path:"log",component:ri}]},{path:"send",children:[{path:"",pathMatch:"full",component:Di},{matcher:Ic,children:[{path:"",pathMatch:"full",component:Ti},{path:"-/report/:commandId",component:hi}]}]},{path:"history",children:[{path:"",pathMatch:"full",component:Ci},{path:":commandId",component:fi}]},{path:"queues",component:Mi,canActivate:[Lo],children:[{path:"",pathMatch:"full",redirectTo:"pending"},{path:"pending",component:Ei},{path:"log",component:Ii}]},{path:"stacks",component:ki},{path:"ext",canActivate:[ji,zi],canActivateChild:[Yi],runGuardsAndResolvers:"always",children:[{matcher:yo,component:vo}]}]}];export{wC as ROUTES};
