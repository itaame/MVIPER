import{a as gt}from"./chunk-PQPBUCGJ.js";import{a as we,b as mt,e as ct,f as pt,g as dt,i as ut,j as ht,k as be}from"./chunk-UVXAE5YP.js";import{a as it,b as ot,c as nt,d as rt,e as lt}from"./chunk-J6RUEXVW.js";import{Aa as l,Ab as Ve,Ac as B,Af as M,Ba as T,Bc as z,Dc as Le,Eb as Ge,Fa as te,Fc as le,Ga as d,Gb as Fe,Gc as j,Ha as $,Jc as Ue,Kc as L,Lf as y,Lg as tt,Ma as ne,Mf as Qe,N as h,Na as re,Nc as U,Nf as K,O as g,Oa as ae,Rf as Ke,Sa as m,Ua as _e,Va as Ie,W as Be,Xc as me,Yc as qe,_c as Ye,a as Re,ag as Xe,ba as _,bb as S,bc as Oe,cb as R,da as f,db as Ee,f as F,ga as k,ih as X,ma as Z,mc as Ne,mg as Ze,ng as et,oh as A,pf as We,qa as b,qb as se,qf as Je,qh as at,ra as Me,rh as st,sc as $e,t as ke,tc as ze,te as q,ue as Y,va as ee,vc as je,ve as He,wa as Ae,we as H,xa as Pe,xe as W,ya as xe,yc as O,ye as J,za as s,ze as Q}from"./chunk-MTJQDUEX.js";var ce=class c{constructor(t,e,i,o){this.dialogRef=t;this.yamcs=e;this.downloadURL$=new F(null);this.form=i.group({start:[null,O.required],stop:[null,O.required]}),this.form.valueChanges.subscribe(w=>{if(this.form.valid){let v=e.yamcsClient.getPacketsDownloadURL(e.instance,{start:y.toISOString(w.start),stop:y.toISOString(w.stop),format:"raw"});this.downloadURL$.next(v)}else this.downloadURL$.next(null)});let n=o.start,r=o.stop;(!n||!r)&&(r=this.yamcs.getMissionTime(),n=y.subtractDuration(r,"PT1H")),this.form.setValue({start:y.toISOString(n),stop:y.toISOString(r)})}closeDialog(){this.dialogRef.close()}static{this.\u0275fac=function(e){return new(e||c)(f(q),f(X),f(me),f(Y))}}static{this.\u0275cmp=k({type:c,selectors:[["app-download-dump-dialog"]],decls:16,vars:5,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["formControlName","start"],["formControlName","stop"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","link","disabled"]],template:function(e,i){e&1&&(s(0,"h2",0),m(1,"Download Packet Dump"),l(),s(2,"mat-dialog-content")(3,"form",1)(4,"label"),m(5," Start "),T(6,"ya-date-time-input",2),l(),s(7,"label"),m(8," Stop "),T(9,"ya-date-time-input",3),l()()(),s(10,"mat-dialog-actions",4)(11,"ya-button",5),m(12,"CANCEL"),l(),s(13,"ya-download-button",6),S(14,"async"),d("click",function(){return i.closeDialog()}),m(15," DOWNLOAD "),l()()),e&2&&(_(3),b("formGroup",i.form),_(10),b("link",R(14,3,i.downloadURL$))("disabled",!i.form.valid))},dependencies:[A,se,j,B,z,L,U,H,W,Q,J,M,K,Ke],encapsulation:2})}};var ue=class c{constructor(t,e){this.dialogRef=t;this.data=e;this.date=new le(null,[O.required]);this.data.date&&this.date.setValue(y.toISOString(this.data.date))}select(){let t=y.toDate(this.date.value);this.dialogRef.close({date:t})}static{this.\u0275fac=function(e){return new(e||c)(f(q),f(Y))}}static{this.\u0275cmp=k({type:c,selectors:[["app-jump-to-dialog"]],decls:11,vars:2,consts:[["mat-dialog-title",""],[1,"ya-form"],[3,"formControl","showNow"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click"]],template:function(e,i){e&1&&(s(0,"h2",0),m(1,"Jump to date"),l(),s(2,"mat-dialog-content",1)(3,"label"),m(4," Date "),T(5,"ya-date-time-input",2),l()(),s(6,"mat-dialog-actions",3)(7,"ya-button",4),m(8,"CANCEL"),l(),s(9,"ya-button",5),d("click",function(){return i.select()}),m(10,"OK"),l()()),e&2&&(_(5),b("formControl",i.date)("showNow",!0))},dependencies:[A,B,Ue,H,W,Q,J,M,K],encapsulation:2})}};var P=2,x=class extends dt{constructor(t,e,i,o,n){super(t),this.label=e,this.borderWidth=0,this.multiline=!1,this.itemBorderColor="rgba(0, 0, 0, 0.1)",this.itemBorderWidth=1,this.itemCornerRadius=0,this.itemTextOverflow="hide",this.itemTextSize=10,this.itemHeight=14,this.paddingBottom=P,this.paddingTop=P,this.backgroundRGB=i,this.itemBackground=this.backgroundRGB.toCssString(),this.foregroundRGB=o,this.itemTextColor=this.foregroundRGB.toCssString(),this.formatter=n,this.background="white",this.addHeaderMouseEnterListener(r=>{this.background=t.sidebar.hoverOverlayColor}),this.addHeaderMouseLeaveListener(r=>{this.background="white"}),this.addItemClickListener(r=>{let{start:w,stop:v}=r.item;w&&v?this.timeline.setSelection(w,v):this.timeline.clearSelection()})}setupTooltip(t){this.addItemMouseMoveListener(e=>{let{start:i,stop:o,data:n}=e.item,r=n.name+`
`;if(r+=`Start: ${this.formatter.formatDateTime(i,!0)}
`,r+=`Stop : ${this.formatter.formatDateTime(o,!0)}
`,n.count>=0){let w=(o-i)/1e3;r+=`Count: ${n.count}`;let v=n.count/w;v>=1e3?r+=` (${(v/1e3).toFixed(3)} kHz)`:v>1&&(r+=` (${v.toFixed(3)} Hz)`)}else n.description&&(r+=n.description);t.show(r,e.clientX,e.clientY)}),this.addItemMouseLeaveListener(e=>{t.hide()})}loadData(t){let e=[];for(let i of t.records){let o=y.toDate(i.first).getTime(),n=y.toDate(i.last).getTime(),r={start:o,stop:n,data:{name:t.name,count:i.num}};if(i.num>1){let w=(n-o)/1e3,v=i.num/w;v>=1e3?r.label=`${(v/1e3).toFixed(1)} kHz`:v>=.1?r.label=`${v.toFixed(1)} Hz`:r.label="< 0.1 Hz",v>=1?r.background=this.backgroundRGB.toCssString(1):v>=.3?r.background=this.backgroundRGB.toCssString(v):r.background=this.backgroundRGB.toCssString(.3)}e.push(r)}this.items=e}};var D=class{constructor(t,e,i){this.r=t;this.g=e;this.b=i}toCssString(t){if(t===void 0)return`rgb(${this.r},${this.g},${this.b})`;{let e=255-t*(255-this.r),i=255-t*(255-this.g),o=255-t*(255-this.b);return`rgb(${e},${i},${o})`}}};var he=class extends mt{constructor(t){super(t);let e=document.createElement("canvas");e.width=30,e.height=30;let i=e.getContext("2d");i.fillStyle="rgba(148, 0, 211, 0.07)",i.fillRect(0,0,30,30),i.beginPath(),i.moveTo(30,0),i.lineTo(0,30),i.strokeStyle="rgba(221, 221, 221, 0.2)",i.stroke(),this.pattern=i.createPattern(e,"repeat")}drawOverlay(t){if(!this.replayRequest)return;let{start:e,stop:i,endAction:o}=this.replayRequest;if(e&&i){let n=Math.round(this.timeline.positionTime(new Date(e).getTime())),r=Math.round(this.timeline.positionTime(new Date(i).getTime()));if(t.fillRect({x:n+.5,y:0,width:r-n,height:t.ctx.canvas.height,fill:this.pattern}),t.strokePath({color:"rgba(148, 0, 211, 0.3)",lineWidth:1,path:new we(n+.5,0).lineTo(n+.5,t.ctx.canvas.height)}),t.strokePath({color:"rgba(148, 0, 211, 0.3)",lineWidth:1,path:new we(r+.5,0).lineTo(r+.5,t.ctx.canvas.height)}),o==="LOOP"){let{fontFamily:w,textSize:v}=this.timeline;t.fillText({x:r-3,y:0,align:"right",baseline:"top",text:"\u221E",color:"darkviolet",font:`${v}px ${w}`})}}}get replayRequest(){return this._replayRequest}set replayRequest(t){this._replayRequest=t,this.reportMutation()}};var I=class extends pt{constructor(t,e){super(t),this.label=e,this.background="#f5f5f5",this.contentHeight=20}};var ge=class c{constructor(t,e,i,o){this.dialogRef=t;this.yamcs=i;this.data=o;let n=i.getMissionTime(),r;this.data&&(this.data.start&&(n=this.data.start),this.data.stop&&(r=this.data.stop)),this.form=e.group({start:[y.toISOString(n),[O.required]],stop:[r?y.toISOString(r):""]})}submit(){let t={start:y.toISOString(this.form.value.start)};this.form.value.stop&&(t.stop=y.toISOString(this.form.value.stop)),this.dialogRef.close(t)}static{this.\u0275fac=function(e){return new(e||c)(f(q),f(me),f(X),f(Y))}}static{this.\u0275cmp=k({type:c,selectors:[["app-modify-replay-dialog"]],decls:20,vars:2,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["formControlName","start"],[1,"hint"],["formControlName","stop"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,i){e&1&&(s(0,"h2",0),m(1,"Configure replay"),l(),s(2,"mat-dialog-content")(3,"form",1)(4,"label"),m(5," Start time "),T(6,"br")(7,"ya-date-time-input",2),l(),T(8,"br"),s(9,"label"),m(10," Stop time "),s(11,"span",3),m(12,"(optional)"),l(),T(13,"ya-date-time-input",4),l(),T(14,"br"),l()(),s(15,"mat-dialog-actions",5)(16,"ya-button",6),m(17,"CANCEL"),l(),s(18,"ya-button",7),d("click",function(){return i.submit()}),m(19,"SUBMIT"),l()()),e&2&&(_(3),b("formGroup",i.form),_(15),b("disabled",!i.form.valid))},dependencies:[A,j,B,z,L,U,H,W,Q,J,M,K],encapsulation:2})}};var Bt=["tt"],fe=class c{show(t,e,i){let o=this.tt.nativeElement;o.style.left=e+"px",o.style.top=i+"px",o.style.display="block",o.innerText=t}hide(){let t=this.tt.nativeElement;t.style.display="none"}static{this.\u0275fac=function(e){return new(e||c)}}static{this.\u0275cmp=k({type:c,selectors:[["ng-component"]],viewQuery:function(e,i){if(e&1&&ne(Bt,7),e&2){let o;re(o=ae())&&(i.tt=o.first)}},decls:2,vars:0,consts:[["tt",""],[1,"ya-tooltip"]],template:function(e,i){e&1&&T(0,"div",1,0)},styles:[".ya-tooltip[_ngcontent-%COMP%]{position:absolute;display:none;white-space:pre;color:#fff;border-radius:2px;max-width:250px;padding:6px 8px;margin-top:14px;background:#616161e6;font-family:Roboto Mono,monospace;font-size:10px}"]})}};var Mt=["container"];function At(c,t){if(c&1){let e=te();s(0,"ya-page-button",28),d("clicked",function(){let o=h(e),n=$(),r=$();return g(r.enableLoop(n,o.endAction!=="LOOP"))}),m(1),l()}if(c&2){let e=t;b("disabled",!e.start||!e.stop)("icon",e.endAction==="LOOP"?"repeat_on":"repeat"),_(),_e(" Repeat: ",e.endAction==="LOOP"?"on":"off"," ")}}function Pt(c,t){if(c&1&&Z(0,At,2,3,"ya-page-button",27),c&2){let e;ee((e=t.replayRequest)?0:-1,e)}}function xt(c,t){if(c&1){let e=te();s(0,"ya-button",29),S(1,"async"),d("click",function(){h(e);let o=$();return g(o.fitSelection())}),m(2," Fit selection "),l()}if(c&2){let e=$();b("disabled",!R(1,1,e.rangeSelection$))}}function It(c,t){if(c&1){let e=te();s(0,"label",30)(1,"input",31),d("change",function(){h(e);let o=$();return g(o.updateLegend())}),l(),m(2),l()}if(c&2){let e=t.$implicit;Me("background",e.bg)("color",e.fg),_(),b("formControlName",e.id),_(),_e(" ",e.name," ")}}function Et(c,t){if(c&1&&(s(0,"span"),m(1),S(2,"datetime"),S(3,"datetime"),l()),c&2){let e=t;_(),Ie(" ",Ee(2,2,e==null?null:e.start,!1)," \u2013 ",R(3,5,e==null?null:e.stop)," ")}}var ft=new D(141,182,194),yt=new D(70,70,70),vt=new D(255,165,0),_t=new D(173,94,0),wt=new D(255,255,102),bt=new D(28,75,139),Ct=new D(238,232,170),Tt=new D(85,85,85),St=new D(255,222,173),Dt=new D(28,75,139);function ie(c){return"linear-gradient(to right, "+c.toCssString(.3)+" 30%, "+c.toCssString()+")"}var ye=class c{constructor(t,e,i,o,n,r,w,v,ve,C){this.yamcs=e;this.route=i;this.router=o;this.overlay=n;this.dialog=r;this.snackBar=w;this.messageService=v;this.synchronizer=ve;this.formatter=C;this.legendOptions=[{id:"packets",name:"Packets",bg:ie(ft),fg:yt.toCssString(),checked:!0},{id:"parameters",name:"Parameter Groups",bg:ie(St),fg:Dt.toCssString(),checked:!0},{id:"commands",name:"Commands",bg:ie(Ct),fg:Tt.toCssString(),checked:!1},{id:"events",name:"Events",bg:ie(wt),fg:bt.toCssString(),checked:!1}];this.processor$=new F(null);this.rangeSelection$=new F(null);this.viewportRange$=new F(null);this.tool$=new F("hand");this.packetNames=[];this.subscriptions=[];t.setTitle("Archive browser"),(e.connectionInfo$.value?.instance?.capabilities||[]).indexOf("ccsds-completeness")!==-1&&(this.legendOptions=[{id:"completeness",name:"Completeness",bg:ie(vt),fg:_t.toCssString(),checked:!0},...this.legendOptions]),this.processor$.next(e.getProcessor()),e.processor&&(this.processorSubscription=this.yamcs.yamcsClient.createProcessorSubscription({instance:e.instance,processor:e.processor},p=>{this.processor$.next(p)})),this.filterForm=new Le({});let oe=this.route.snapshot.queryParamMap;for(let p of this.legendOptions){let u=p.checked;oe.has(p.id)&&(u=oe.get(p.id)==="true"),this.filterForm.addControl(p.id,new le(u))}let E=new Be(document.body),V=this.overlay.position().flexibleConnectedTo(E).withPositions([{originX:"start",originY:"top",overlayX:"start",overlayY:"top"}]).withPush(!1),G=this.overlay.create({positionStrategy:V}),a=new Ne(fe);this.tooltipInstance=G.attach(a).instance}hideTooltip(){this.tooltipInstance.hide()}ngAfterViewInit(){this.yamcs.yamcsClient.getPacketNames(this.yamcs.instance).then(t=>{this.packetNames=t.packets||[],this.initializeTimeline()})}initializeTimeline(){this.timeline=new ct(this.container.nativeElement),this.timeline.addViewportChangeListener(n=>{this.viewportRange$.next({start:new Date(n.start),stop:new Date(n.stop)})}),this.viewportRange$.pipe(ke(400)).forEach(n=>{this.refreshData();let r={};for(let w of this.legendOptions)r[w.id]=this.filterForm.value[w.id];this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParamsHandling:"merge",queryParams:Re({start:new Date(n.start).toISOString(),stop:new Date(n.stop).toISOString()},r)})}),this.timeline.addViewportDoubleClickListener(n=>{this.yamcs.getProcessor()?.replay&&this.yamcs.yamcsClient.editReplayProcessor(this.yamcs.instance,this.yamcs.processor,{seek:new Date(n.time).toISOString()}).catch(w=>this.messageService.showError(w))});let t=this.route.snapshot.queryParamMap;if(t.get("start")&&t.get("stop")){let n=y.toDate(t.get("start")),r=y.toDate(t.get("stop"));this.timeline.setViewRange(n.getTime(),r.getTime())}else{let n=this.yamcs.getMissionTime();n.setUTCHours(0,0,0,0);let r=new Date(n.getTime());r.setUTCDate(n.getUTCDate()+1),this.timeline.setViewRange(n.getTime(),r.getTime())}let e=new ut(this.timeline);e.time=this.yamcs.getMissionTime().getTime();let i=new he(this.timeline);this.subscriptions.push(this.synchronizer.sync(()=>{e.time=this.yamcs.getMissionTime().getTime();let n=this.processor$.value?.replayRequest;i.replayRequest=n})),new ht(this.timeline),new gt(this.timeline,this.formatter);let o=new be(this.timeline);o.contentHeight=20,o.label="UTC",o.timezone="UTC",o.frozen=!0,o.fullHeight="underlay",this.timeline.addViewportSelectionListener(n=>{n.selection?this.rangeSelection$.next({start:new Date(n.selection.start),stop:new Date(n.selection.stop)}):this.rangeSelection$.next(null)})}fitAll(){let t=[];t.push(this.yamcs.yamcsClient.getPackets(this.yamcs.instance,{limit:1,order:"asc"})),t.push(this.yamcs.yamcsClient.getPackets(this.yamcs.instance,{limit:1,order:"desc"})),Promise.all(t).then(e=>{let i=e[0],o=e[1];if(i.packet?.length&&o.packet?.length){let n=y.toDate(i.packet[0].generationTime),r=y.toDate(o.packet[0].generationTime);this.timeline.setViewRange(n.getTime(),r.getTime())}}).catch(e=>this.messageService.showError(e))}fitSelection(){var t=this.rangeSelection$.value;t&&(this.timeline.setViewRange(t.start.getTime(),t.stop.getTime()),this.timeline.clearSelection())}jumpToToday(){let t=this.yamcs.getMissionTime();t.setUTCHours(0,0,0,0);let e=t.getTime();t.setUTCDate(t.getUTCDate()+1);let i=t.getTime();this.timeline.setViewRange(e,i)}jumpToNow(){let t=this.yamcs.getMissionTime();this.timeline.panTo(t.getTime())}openJumpToDialog(){let t=this.timeline.center;this.dialog.open(ue,{width:"400px",data:{date:new Date(t)}}).afterClosed().subscribe(i=>{i&&this.timeline.panTo(i.date.getTime())})}toggleMove(t){this.timeline.panBy(t),window.clearInterval(this.moveInterval),this.moveInterval=window.setInterval(()=>this.timeline.panBy(t),50)}untoggleMove(){window.clearInterval(this.moveInterval),this.moveInterval=void 0}pageLeft(){let{start:t,stop:e}=this.timeline,i=this.timeline.distanceBetween(t,e);this.timeline.panBy(-i)}pageRight(){let{start:t,stop:e}=this.timeline,i=this.timeline.distanceBetween(t,e);this.timeline.panBy(i)}zoomIn(){this.timeline.zoomIn()}zoomOut(){this.timeline.zoomOut()}setTool(t){this.tool$.next(t),this.timeline.tool=t}replayRange(){let t=this.rangeSelection$.value;if(t){let e=this.processor$.value;e?.replay?this.modifyReplay(e,t):this.startReplay(t)}}startReplay(t){this.dialog.open(ot,{width:"400px",data:{start:t.start,stop:t.stop}}).afterClosed().subscribe(e=>{e&&(this.snackBar.open("Initializing replay...",void 0,{horizontalPosition:"end"}),this.yamcs.yamcsClient.createProcessor(e).then(()=>{this.yamcs.switchContext(this.yamcs.instance,e.name),this.snackBar.open("Joining replay",void 0,{duration:3e3,horizontalPosition:"end"})}).catch(i=>{this.snackBar.open("Failed to initialize replay",void 0,{duration:3e3,horizontalPosition:"end"})}))})}modifyReplay(t,e){this.dialog.open(ge,{width:"400px",data:{start:e.start,stop:e.stop}}).afterClosed().subscribe(i=>{i&&(this.snackBar.open("Updating replay...",void 0,{horizontalPosition:"end"}),this.yamcs.yamcsClient.editReplayProcessor(t.instance,t.name,i).catch(o=>{this.messageService.showError(o)}).finally(()=>this.snackBar.dismiss()))})}enableLoop(t,e){this.yamcs.yamcsClient.editReplayProcessor(t.instance,t.name,{loop:e}).catch(i=>this.messageService.showError(i))}downloadDump(){let t=this.rangeSelection$.value;t&&this.dialog.open(ce,{width:"400px",data:{start:t.start,stop:t.stop}})}updateLegend(){this.refreshData()}refreshData(){let t=this.timeline.stop-this.timeline.start,e=y.clampDate(this.timeline.start-t).toISOString(),i=y.clampDate(this.timeline.stop+t).toISOString(),o=Math.min(Math.floor(t/1e3),2147483647),n=Promise.resolve([]);this.filterForm.value.completeness&&(n=this.yamcs.yamcsClient.streamCompletenessIndex(this.yamcs.instance,{start:e,stop:i,mergeTime:o}).then(C=>this.groupRecordsByName(C)));let r=Promise.resolve([]);this.filterForm.value.packets&&(r=this.yamcs.yamcsClient.streamPacketIndex(this.yamcs.instance,{start:e,stop:i,mergeTime:o}).then(C=>this.groupRecordsByName(C)));let w=Promise.resolve([]);this.filterForm.value.parameters&&(w=this.yamcs.yamcsClient.streamParameterIndex(this.yamcs.instance,{start:e,stop:i,mergeTime:o}).then(C=>this.groupRecordsByName(C)));let v=Promise.resolve([]);this.filterForm.value.commands&&(v=this.yamcs.yamcsClient.streamCommandIndex(this.yamcs.instance,{start:e,stop:i,mergeTime:o}).then(C=>this.groupRecordsByName(C)));let ve=Promise.resolve([]);this.filterForm.value.events&&(ve=this.yamcs.yamcsClient.streamEventIndex(this.yamcs.instance,{start:e,stop:i,mergeTime:o}).then(C=>this.groupRecordsByName(C))),Promise.all([n,r,w,v,ve]).then(C=>{let N=C[0],oe=C[1],E=C[2],V=C[3],G=C[4];for(let a of this.timeline.getBands())a instanceof be||this.timeline.removeChild(a);N.sort((a,p)=>a.name.localeCompare(p.name));for(let a=0;a<N.length;a++){a===0&&new I(this.timeline,"Completeness");let p=N[a],u=new x(this.timeline,p.name,vt,_t,this.formatter);u.borderWidth=a===N.length-1?1:0,u.paddingBottom=a===N.length-1?20:P,u.setupTooltip(this.tooltipInstance),u.loadData(p)}if(this.filterForm.value.packets)for(let a=0;a<this.packetNames.length;a++){a===0&&new I(this.timeline,"Packets");let p=this.packetNames[a],u=new x(this.timeline,p,ft,yt,this.formatter);u.borderWidth=a===this.packetNames.length-1?1:0,u.paddingBottom=a===this.packetNames.length-1?20:P,u.setupTooltip(this.tooltipInstance);let De=oe.find(Rt=>Rt.name===p);De&&u.loadData(De)}E.sort((a,p)=>a.name.localeCompare(p.name));for(let a=0;a<E.length;a++){a===0&&new I(this.timeline,"Parameter Groups");let p=E[a],u=new x(this.timeline,p.name,St,Dt,this.formatter);u.borderWidth=a===E.length-1?1:0,u.paddingBottom=a===E.length-1?20:P,u.setupTooltip(this.tooltipInstance),u.loadData(p)}V.sort((a,p)=>a.name.localeCompare(p.name));for(let a=0;a<V.length;a++){a===0&&new I(this.timeline,"Commands");let p=V[a],u=new x(this.timeline,p.name,Ct,Tt,this.formatter);u.borderWidth=a===V.length-1?1:0,u.paddingBottom=a===V.length-1?30:P,u.setupTooltip(this.tooltipInstance),u.loadData(p)}G.sort((a,p)=>a.name.localeCompare(p.name));for(let a=0;a<G.length;a++){a===0&&new I(this.timeline,"Events");let p=G[a],u=new x(this.timeline,p.name,wt,bt,this.formatter);u.borderWidth=a===G.length-1?1:0,u.paddingBottom=a===G.length-1?20:P,u.setupTooltip(this.tooltipInstance),u.loadData(p)}})}groupRecordsByName(t){let e=new Map;for(let i of t){let o=e.get(i.id.name);o||(o={name:i.id.name,records:[]},e.set(i.id.name,o)),o.records.push(i)}return[...e.values()]}ngOnDestroy(){this.processorSubscription?.cancel(),this.subscriptions.forEach(t=>t.unsubscribe()),this.timeline.disconnect()}static{this.\u0275fac=function(e){return new(e||c)(f(Ve),f(X),f(Ge),f(Fe),f($e),f(He),f(ze),f(We),f(Je),f(Qe))}}static{this.\u0275cmp=k({type:c,selectors:[["ng-component"]],viewQuery:function(e,i){if(e&1&&ne(Mt,7),e&2){let o;re(o=ae())&&(i.container=o.first)}},hostBindings:function(e,i){e&1&&d("mouseleave",function(){return i.hideTooltip()})},decls:58,vars:22,consts:[["container",""],["noscroll","true"],["icon","video_settings",3,"clicked","disabled"],["icon","file_download",3,"clicked","disabled"],["matTooltip","Refresh view","icon","refresh",3,"click"],[2,"height","24px","margin","6px"],[3,"formGroup"],["icon","west",3,"click"],["icon","chevron_left",3,"mousedown","mouseup","mouseleave"],["icon","chevron_right",3,"mousedown","mouseup","mouseleave"],["icon","east",3,"click"],["matTooltip","Show all archive data","icon","fit_screen",3,"click"],["matTooltip","Zoom to selected range","icon","fit_screen",3,"disabled"],["icon","today",3,"click"],["icon","my_location",3,"click"],["icon","directions",3,"click"],["icon","add",3,"click"],["icon","remove",3,"click"],["matTooltip","Use pan tool","icon","pan_tool",3,"click","toggled"],["matTooltip","Use range selection tool","icon","highlight_alt",3,"click","toggled"],[1,"legend","no-select",3,"background","color"],[1,"timeline-container"],[1,"zoom-actions"],[1,"zoom-actions-inner","elevation-z1"],["mat-button","",3,"click"],[1,"separator"],[1,"info"],[3,"disabled","icon"],[3,"clicked","disabled","icon"],["matTooltip","Zoom to selected range","icon","fit_screen",3,"click","disabled"],[1,"legend","no-select"],["type","checkbox",3,"change","formControlName"]],template:function(e,i){if(e&1){let o=te();s(0,"app-instance-page",1)(1,"app-instance-toolbar"),m(2," Archive browser \xA0\xA0\xA0 "),s(3,"ya-page-button",2),S(4,"async"),d("clicked",function(){return h(o),g(i.replayRange())}),m(5," Replay range "),l(),Z(6,Pt,1,1),S(7,"async"),s(8,"ya-page-button",3),S(9,"async"),d("clicked",function(){return h(o),g(i.downloadDump())}),m(10," Download dump "),l(),s(11,"ya-page-icon-button",4),d("click",function(){return h(o),g(i.refreshData())}),l()(),s(12,"div",5)(13,"form",6)(14,"ya-button",7),d("click",function(){return h(o),g(i.pageLeft())}),l(),s(15,"ya-button",8),d("mousedown",function(){return h(o),g(i.toggleMove(-50))})("mouseup",function(){return h(o),g(i.untoggleMove())})("mouseleave",function(){return h(o),g(i.untoggleMove())}),l(),s(16,"ya-button",9),d("mousedown",function(){return h(o),g(i.toggleMove(50))})("mouseup",function(){return h(o),g(i.untoggleMove())})("mouseleave",function(){return h(o),g(i.untoggleMove())}),l(),s(17,"ya-button",10),d("click",function(){return h(o),g(i.pageRight())}),l(),m(18," \xA0 "),s(19,"ya-button",11),d("click",function(){return h(o),g(i.fitAll())}),m(20," Fit all "),l(),Z(21,xt,3,3,"ya-button",12),S(22,"async"),s(23,"ya-button",13),d("click",function(){return h(o),g(i.jumpToToday())}),m(24,"Today"),l(),s(25,"ya-button",14),d("click",function(){return h(o),g(i.jumpToNow())}),l(),s(26,"ya-button",15),d("click",function(){return h(o),g(i.openJumpToDialog())}),m(27,"Jump to..."),l(),m(28," \xA0 "),s(29,"ya-button",16),d("click",function(){return h(o),g(i.zoomIn())}),l(),s(30,"ya-button",17),d("click",function(){return h(o),g(i.zoomOut())}),l(),m(31," \xA0 "),s(32,"ya-button",18),S(33,"async"),d("click",function(){return h(o),g(i.setTool("hand"))}),l(),s(34,"ya-button",19),S(35,"async"),d("click",function(){return h(o),g(i.setTool("range-select"))}),l(),m(36," \xA0\xA0\xA0\xA0 "),Pe(37,It,3,6,"label",20,Ae),l()(),T(39,"div",21,0),s(41,"div",22)(42,"div",23)(43,"button",24),d("click",function(){return h(o),g(i.zoomIn())}),s(44,"mat-icon"),m(45,"add"),l()(),T(46,"span",25),s(47,"button",24),d("click",function(){return h(o),g(i.zoomOut())}),s(48,"mat-icon"),m(49,"remove"),l()()()(),s(50,"div",26),Z(51,Et,4,7,"span"),S(52,"async"),s(53,"ya-help")(54,"p"),m(55," This view allows inspecting the content of the TM Archive, as well as retrieving data as packets. Data is grouped by packet name in bands. For each band, index blocks indicate the presence of data at a particular time range. Note that a single index block does not necessarily mean that there was no gap in the data. When zooming in, more gaps may appear. "),l(),s(56,"p"),m(57,"Pan around by grabbing the canvas."),l()()()()}if(e&2){let o,n;_(3),b("disabled",!R(4,8,i.rangeSelection$)),_(3),ee((o=R(7,10,i.processor$))?6:-1,o),_(2),b("disabled",!R(9,12,i.rangeSelection$)),_(5),b("formGroup",i.filterForm),_(8),ee(R(22,14,i.tool$)==="range-select"?21:-1),_(11),b("toggled",R(33,16,i.tool$)==="hand"),_(2),b("toggled",R(35,18,i.tool$)==="range-select"),_(3),xe(i.legendOptions),_(14),ee((n=R(52,20,i.viewportRange$))?51:-1,n)}},dependencies:[nt,it,A,se,j,je,B,z,L,U,Oe,qe,Ye,M,Xe,Ze,et,tt],styles:[".tooltip[_ngcontent-%COMP%]{position:absolute}.timeline-container[_ngcontent-%COMP%]{line-height:0;border-top:1px solid rgba(0,0,0,.1);position:absolute;inset:36px 0 0}.zoom-actions[_ngcontent-%COMP%]{position:absolute;bottom:35px;left:201px;right:0;margin:0 auto;text-align:center}.zoom-actions-inner[_ngcontent-%COMP%]{display:inline-block;background-color:#fafafa}.zoom-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{line-height:inherit;min-width:0}.zoom-actions[_ngcontent-%COMP%]   .mat-mdc-button[_ngcontent-%COMP%]:not(:disabled){color:#000}.info[_ngcontent-%COMP%]{position:absolute;bottom:35px;right:0;padding:0 16px;background:#fff;opacity:.75;font-size:12px;line-height:12px}label.legend[_ngcontent-%COMP%]{font-size:small;padding:3px 5px;margin-right:10px;border:1px solid rgba(0,0,0,.1)}"],changeDetection:0})}};var go=[{path:"",canActivate:[at,rt],canActivateChild:[st],runGuardsAndResolvers:"always",component:lt,children:[{path:"",pathMatch:"full",component:ye}]}];export{go as ROUTES};
