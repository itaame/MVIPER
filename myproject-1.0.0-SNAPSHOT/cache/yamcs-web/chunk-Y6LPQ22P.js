import{a as Sa,b as ea,c as yl,e as Cl}from"./chunk-ERVA5QJS.js";import{a as ul,b as hl}from"./chunk-7ZJ4C3K2.js";import{a as _l}from"./chunk-CS6YXD3A.js";import{a as Jt}from"./chunk-UBMLYMMH.js";import{a as Xr}from"./chunk-EIWKOY65.js";import{e as gl,f as vl}from"./chunk-KJ5BZ5CM.js";import{a as Ji}from"./chunk-NOPILB5D.js";import"./chunk-UVXAE5YP.js";import{a as Ke,c as Je,d as Kr,e as fl}from"./chunk-J6RUEXVW.js";import{$ as Za,$c as pt,$e as Ye,$g as ml,A as ja,Aa as o,Ab as bt,Ac as me,Af as _e,Ag as nl,Ba as b,Bc as xe,Bf as ci,Bg as Vt,Ca as $,Cb as qr,Ce as Ui,Cg as Zi,Da as H,Db as tn,Dc as it,E as Lo,Ea as xa,Eb as we,Ec as on,Ef as Wt,Eg as pi,Fa as N,Fb as ri,Fc as ee,Ga as E,Gb as Oe,Gc as Te,Gf as ye,Gg as rl,H as qa,Ha as h,Hb as Re,He as It,I as Oo,Ib as an,Ic as Wo,Ie as oi,Jc as Gt,Kc as be,Ke as li,La as Bo,Le as zi,Lf as F,Lg as Pe,M as Mt,Ma as fe,Mf as ji,N as k,Na as ue,Nc as De,Ne as si,Nf as _t,Ng as Qi,O as A,Oa as he,Oc as Ni,Oe as ln,Of as qi,Og as ol,P as Xa,Pc as Fi,Pe as sn,Pf as Xi,Pg as ll,Q as Vo,Qc as Bi,Qe as cn,Qf as jt,R as No,Ra as oe,Rf as _n,Rg as vn,Sa as s,Sf as el,Sg as sl,T as tt,Ta as W,Tc as jo,Ua as L,Uf as Dt,V as Rt,Va as $t,Vg as yn,Wa as $o,We as He,Wf as qt,Wg as cl,Xc as Ut,Xe as dt,Xf as tl,Ya as Li,Yc as St,Ye as ut,Yf as Xt,Za as X,Zg as pl,_a as hi,_c as $i,_e as at,_f as Zt,_g as Ki,a as et,ac as nn,b as yt,ba as p,bb as w,bc as zo,bd as Hi,bf as Ge,bh as Cn,cb as D,cd as Yi,ce as Xo,cf as ht,cg as il,ch as dl,d as jr,da as T,db as We,dg as al,ea as Qa,eb as fi,ef as wt,f as B,ff as Ue,fh as Kt,ga as V,gb as xt,hf as ze,i as Io,ia as Ka,id as Gi,if as Lt,ih as q,ja as Ja,jd as zt,ka as Ii,kf as Qo,kg as Ot,lb as Ho,lf as Ko,m as Ri,ma as v,mb as en,md as Zr,mf as pn,mg as nt,nf as mn,ng as Qt,od as ba,oe as Zo,of as dn,oh as G,pa as Fo,pb as Yo,pd as qo,pf as ft,pg as gn,ph as gt,qa as C,qb as J,qc as Yt,qf as Tt,qh as Jr,ra as Ct,rc as Vi,rf as Wi,rh as eo,s as za,sa as pe,sb as Oi,sf as Qr,t as Wa,tc as rn,te as Ve,ue as Qe,va as x,ve as Ne,wa as ie,wb as Go,wc as Ze,we as Fe,wf as un,xa as ae,xb as Uo,xe as mt,xf as Jo,ya as ne,yc as Ee,ye as Be,yf as hn,za as l,ze as $e,zf as fn}from"./chunk-MTJQDUEX.js";var xn=class t{constructor(i){this.dialogRef=i}confirmDiscard(){this.dialogRef.close(!0)}static{this.\u0275fac=function(e){return new(e||t)(T(Ve))}}static{this.\u0275cmp=V({type:t,selectors:[["app-display-file-page-dirty-dialog"]],decls:8,vars:0,consts:[["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click"]],template:function(e,a){e&1&&(l(0,"mat-dialog-content")(1,"p"),s(2,"You have unsaved changes on the current page. Do you want to discard them?"),o()(),l(3,"mat-dialog-actions",0)(4,"ya-button",1),s(5,"CANCEL"),o(),l(6,"ya-button",2),E("click",function(){return a.confirmDiscard()}),s(7,"DISCARD"),o()())},dependencies:[G,Fe,$e,Be,_e],encapsulation:2})}};var xl=t=>Oo(wa).canDeactivate(t),wa=class t{constructor(i,e,a){this.dialog=i;this.authService=e;this.dialogOpen$=new B(!1);this.bucket=a.getDisplayBucket()}canDeactivate(i){return this.dialogOpen$.value?new jr(e=>{this.dialogRef.afterClosed().subscribe({next:a=>{e.next(a===!0),e.complete()},error:()=>{e.next(!1),e.complete()}})}):i.hasPendingChanges()&&this.mayManageDisplays()?new jr(e=>{this.dialogOpen$.next(!0),this.dialogRef=this.dialog.open(xn,{width:"400px"}),this.dialogRef.afterClosed().subscribe({next:a=>{this.dialogOpen$.next(!1),e.next(a===!0),e.complete()},error:()=>{this.dialogOpen$.next(!1),e.next(!1),e.complete()}})}):Io(!0)}mayManageDisplays(){let i=this.authService.getUser();return i.hasObjectPrivilege("ManageBucket",this.bucket)||i.hasSystemPrivilege("ManageAnyBucket")}static{this.\u0275fac=function(e){return new(e||t)(qa(Ne),qa(gt),qa(ye))}}static{this.\u0275prov=Lo({token:t,factory:t.\u0275fac})}};function ts(t,i){if(t&1&&b(0,"img",6),t&2){let e=h();C("src",e.url,Za)}}var bn=class t{constructor(i,e){this.storageClient=i.createStorageClient(),this.bucket=e.getDisplayBucket()}init(i){return this.url=this.storageClient.getObjectURL(this.bucket,i),Promise.resolve()}hasPendingChanges(){return!1}static{this.\u0275fac=function(e){return new(e||t)(T(q),T(ye))}}static{this.\u0275cmp=V({type:t,selectors:[["app-image-viewer"]],decls:7,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","version","1.1",1,"checkerboard"],["id","pattern","x","0","y","0","width","24","height","24","patternUnits","userSpaceOnUse"],["fill","rgba(204, 204, 204, 0.4)","x","0","width","12","height","12","y","0"],["fill","rgba(204, 204, 204, 0.4)","x","12","width","12","height","12","y","12"],["fill","url(#pattern)","x","0","y","0","width","100%","height","100%"],[1,"wrapper"],[3,"src"]],template:function(e,a){e&1&&(Xa(),l(0,"svg",0)(1,"pattern",1),b(2,"rect",2)(3,"rect",3),o(),b(4,"rect",4),o(),Vo(),l(5,"div",5),v(6,ts,1,1,"img",6),o()),e&2&&(p(6),x(a.url?6:-1))},dependencies:[G],styles:[".checkerboard[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}.wrapper[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}"],changeDetection:0})}};function is(t,i){if(t&1){let e=N();l(0,"ya-page-button",1),s(1,"View"),o(),l(2,"mat-menu",2,0)(4,"button",3),E("click",function(){k(e);let n=h();return A(n.resetZoom())}),l(5,"mat-icon"),s(6,"aspect_ratio"),o(),s(7," Actual size "),o(),l(8,"button",3),E("click",function(){k(e);let n=h();return A(n.fitZoom())}),l(9,"mat-icon"),s(10,"fit_screen"),o(),s(11," Zoom to fit "),o(),l(12,"button",3),E("click",function(){k(e);let n=h();return A(n.zoomIn())}),l(13,"mat-icon"),s(14,"add_circle_outline"),o(),s(15," Zoom in "),o(),l(16,"button",3),E("click",function(){k(e);let n=h();return A(n.zoomOut())}),l(17,"mat-icon"),s(18,"remove_circle_outline"),o(),s(19," Zoom out "),o()()}if(t&2){let e=oe(3);C("matMenuTriggerFor",e)}}var Sn=class t{constructor(){this.initialized$=new B(!1)}init(i){this.viewer=i,this.initialized$.next(!0)}fitZoom(){this.viewer.fitZoom()}zoomIn(){this.viewer.zoomIn()}zoomOut(){this.viewer.zoomOut()}resetZoom(){this.viewer.resetZoom()}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-opi-display-viewer-controls"]],decls:2,vars:3,consts:[["viewMenu","matMenu"],["dropdown","true",3,"matMenuTriggerFor"],["overlapTrigger","false","xPosition","after","yPosition","below",1,"ya-menu"],["mat-menu-item","",3,"click"]],template:function(e,a){e&1&&(v(0,is,20,1),w(1,"async")),e&2&&x(D(1,1,a.initialized$)?0:-1)},dependencies:[G,J,St,Hi,pt,Yi,nt],encapsulation:2})}};var wn=class{constructor(i){this.messageService=i}writeInfo(i){this.messageService.showInfo(i)}writeError(i){this.messageService.showError(i)}writeWarning(i){this.messageService.showInfo(i)}};var Tn=class{constructor(i){this.prefix=i}resolve(i){let e;if(i.name==="Liberation Sans"?(e="LiberationSans-Regular.woff2",i.bold&&i.italic?e="LiberationSans-BoldItalic.woff2":i.bold?e="LiberationSans-Bold.woff2":i.italic&&(e="LiberationSans-Italic.woff2")):i.name==="Liberation Mono"?(e="LiberationMono-Regular.woff2",i.bold&&i.italic?e="LiberationMono-BoldItalic.woff2":i.bold?e="LiberationMono-Bold.woff2":i.italic&&(e="LiberationMono-Italic.woff2")):i.name==="Liberation Serif"&&(e="LiberationSerif-Regular.woff2",i.bold&&i.italic?e="LiberationSerif-BoldItalic.woff2":i.bold?e="LiberationSerif-Bold.woff2":i.italic&&(e="LiberationSerif-Italic.woff2")),e)return new FontFace(i.name,`url(${this.prefix}media/${e})`,{weight:i.bold?"bold":"normal",style:i.italic?"italic":"normal"})}};var Dn=class{constructor(i){this.watermarkObserver=i;this.dirty=!1;this.valueRange=[null,null];this.archiveSamples=[];this.bufferSize=500;this.bufferWatermark=400;this.pointer=0;this.alreadyWarned=!1;this.realtimeBuffer=Array(this.bufferSize).fill(void 0)}setArchiveData(i){this.archiveSamples=i??[],this.dirty=!0}setValueRange(i){this.valueRange=i}addRealtimeValue(i){this.pointer<this.bufferSize&&(this.realtimeBuffer[this.pointer]=i,this.pointer>=this.bufferWatermark&&this.watermarkObserver&&!this.alreadyWarned&&(this.watermarkObserver(),this.alreadyWarned=!0),this.pointer=this.pointer+1),this.dirty=!0}reset(){this.archiveSamples=[],this.realtimeBuffer.fill(void 0),this.pointer=0,this.alreadyWarned=!1,this.valueRange=[null,null],this.dirty=!0}snapshot(){let i=this.realtimeBuffer.filter(n=>n!==void 0),e=null;i.length>0&&(e=i[0][0].getTime());let a=this.archiveSamples.filter(n=>e===null||n[0].getTime()<e).concat(i).sort((n,r)=>n[0].getTime()-r[0].getTime());return{valueRange:this.valueRange,samples:a}}};var ta=class{constructor(i,e,a){this.yamcs=i;this.configService=a;this.extendRequestedRange=!0;this.resolution=6e3;this.loading$=new B(!1);this.data$=new B({valueRange:[null,null],samples:[]});this.parameters$=new B([]);this.latestRealtimeValues=new Map;this.syncSubscription=e.syncFast(()=>this.plotNow()),this.plotBuffer=new Dn(()=>{this.reloadVisibleRange()})}plotNow(){if(this.plotBuffer.dirty&&!this.loading$.getValue()){let i=this.plotBuffer.snapshot();this.data$.next({samples:i.samples,valueRange:i.valueRange}),this.plotBuffer.dirty=!1}}addParameter(...i){if(this.parameters$.next([...this.parameters$.value,...i]),this.realtimeSubscription){let e=i.map(a=>({name:a.qualifiedName}));this.addToRealtimeSubscription(e)}else this.connectRealtime()}removeParameter(i){let e=this.parameters$.value.filter(a=>a.qualifiedName!==i);this.parameters$.next(e)}reloadVisibleRange(){return this.updateWindow(this.visibleStart,this.visibleStop,[null,null])}updateWindowOnly(i,e){this.visibleStart=i,this.visibleStop=e}updateWindow(i,e,a){this.loading$.next(!0);let n=this.extendRequestedRange?e.getTime()-i.getTime():0,r=new Date(i.getTime()-n),c=new Date(e.getTime()+n),d=this.parameters$.value,m=[];for(let g of d)m.push(this.yamcs.yamcsClient.getParameterSamples(this.yamcs.instance,g.qualifiedName,{start:r.toISOString(),stop:c.toISOString(),count:this.resolution,fields:["time","n","avg","min","max"],gapTime:3e5,source:this.configService.isParameterArchiveEnabled()?"ParameterArchive":"replay"}));let u=Promise.allSettled(m);return this.lastLoadPromise=u,u.then(g=>{if(this.lastLoadPromise===u){this.loading$.next(!1),this.plotBuffer.reset(),this.latestRealtimeValues.clear(),this.visibleStart=i,this.visibleStop=e,this.minValue=void 0,this.maxValue=void 0;let f=[];for(let _=0;_<g.length;_++){let S=g[_];S.status==="fulfilled"?f.push(this.processSamples(S.value)):(console.warn(`Failed to retrieve samples for ${d[_].qualifiedName}`,S.reason),f.push([]))}let y=this.mergeSeries(...f);this.plotBuffer.setArchiveData(y),this.plotBuffer.setValueRange(a),this.plotNow(),this.lastLoadPromise=null}})}connectRealtime(){let i=this.parameters$.value.map(e=>({name:e.qualifiedName}));this.realtimeSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:i,sendFromCache:!1,updateOnExpiration:!0,abortOnInvalid:!0,action:"REPLACE"},e=>{e.mapping&&(this.idMapping=et(et({},this.idMapping),e.mapping)),e.values&&e.values.length&&this.processRealtimeDelivery(e.values)})}addToRealtimeSubscription(i){this.realtimeSubscription.addReplyListener(()=>{this.realtimeSubscription.sendMessage({instance:this.yamcs.instance,processor:this.yamcs.processor,id:i,sendFromCache:!1,updateOnExpiration:!0,abortOnInvalid:!0,action:"ADD"})})}processRealtimeDelivery(i){for(let r of i){let c=null,d=F.convertValueToNumber(r.engValue);d!==null&&(r.acquisitionStatus==="EXPIRED"?c=null:r.acquisitionStatus==="ACQUIRED"&&(c=[d,d,d]));let m=this.idMapping[r.numericId];this.latestRealtimeValues.set(m.name,c)}let e=new Date;e.setTime(Date.parse(i[0].generationTime));let a=this.parameters$.value.map(r=>this.latestRealtimeValues.get(r.qualifiedName)||null),n=[e,...a];this.plotBuffer.addRealtimeValue(n)}disconnect(){this.data$.complete(),this.loading$.complete(),this.realtimeSubscription?.cancel(),this.syncSubscription?.unsubscribe()}processSamples(i){let e=[];for(let a of i){let n=new Date;if(n.setTime(Date.parse(a.time)),a.n>0){let r=a.avg,c=a.min,d=a.max;this.minValue===void 0?(this.minValue=c,this.maxValue=d):(this.minValue>c&&(this.minValue=c),this.maxValue<d&&(this.maxValue=d)),e.push([n,[c,r,d]])}else e.push([n,null])}return e}mergeSeries(...i){if(i.length===1)return i[0];let e=null;for(let n=0;n<i.length;n++)i[n].length>0&&(e=i[n]);if(e!==null)for(let n=0;n<i.length;n++)i[n].length===0&&(i[n]=e.map(r=>[r[0],null]));let a=i[0];for(let n=1;n<i.length;n++){let r=[],c=0,d=0,m=[],u=null,g=a,f=i[n];for(;c<g.length||d<f.length;){let y=c<g.length?g[c]:null,_=d<f.length?f[d]:null;y&&_?y[0].getTime()===_[0].getTime()?(m=y.slice(1),u=_[1],r.push([y[0],...m,u]),c++,d++):y[0].getTime()<_[0].getTime()?(m=y.slice(1),r.push([y[0],...m,u]),c++):(u=_[1],r.push([_[0],...m,u]),d++):y?(m=y.slice(1),r.push([y[0],...m,u]),c++):_&&(u=_[1],r.push([_[0],...m,u]),d++)}a=r}return a}};var Pn=class{constructor(i,e,a,n,r){this.yamcs=a;this.processedSamples=[];this.subscriptions=[];this.dataSource=new ta(a,n,r),this.dataSource.extendRequestedRange=!1,this.dataSource.resolution=400,this.dataSource.addParameter({qualifiedName:i}),this.yamcs.range$.subscribe(d=>{let m=this.yamcs.getMissionTime(),u=F.subtractDuration(m,d);this.dataSource.updateWindow(u,m,[null,null])}),this.dataSource.data$.subscribe(d=>{this.processSamples(d),e.requestRepaint()});let c=n.sync(()=>{let d=this.yamcs.getMissionTime(),m=F.subtractDuration(d,this.yamcs.range$.value),u=m.getTime();for(let g=0;g<this.processedSamples.length;g++)if(this.processedSamples[g].x>=u&&g>0){this.processedSamples.splice(0,g);break}this.dataSource.updateWindowOnly(m,d),this.addEdgeSamples(this.processedSamples),e.requestRepaint()});this.subscriptions.push(c),this.backfillSubscription=a.yamcsClient.createBackfillingSubscription({instance:a.instance},d=>{d.finished&&this.dataSource.reloadVisibleRange()})}processSamples(i){let e=[];for(let a of i.samples){let n=a[0].getTime();if(a[1]){let r=a[1][1];e.push({x:n,y:r})}else e.push({x:n,y:null})}this.addEdgeSamples(e),this.processedSamples=e}addEdgeSamples(i){let{visibleStart:e,visibleStop:a}=this.dataSource;if(e&&a){let n={x:e.getTime(),y:null},r={x:a.getTime(),y:null};i.length?(i[0].x>n.x&&i.splice(0,0,n),i[i.length-1].x<r.x&&i.push(r)):(i.push(n),i.push(r))}}getSamples(){return this.processedSamples}disconnect(){this.backfillSubscription?.cancel(),this.subscriptions.forEach(i=>i.unsubscribe()),this.dataSource?.disconnect()}};var En=class extends yl{constructor(e,a){super(a);this.storageClient=e}resolve(e,a){if(e.startsWith("ys://")){let n=e.match(/ys:\/\/([^\\\/]+)\/(.+)/);if(n)return this.storageClient.getObjectURL(n[1],n[2])}return super.resolve(e,a)}};var kn=class{constructor(i,e){this.yamcs=i;this.messageService=e}issueCommand(i,e){this.yamcs.yamcsClient.issueCommand(this.yamcs.instance,this.yamcs.processor,i,{args:e}).catch(a=>this.messageService.showError(a))}runProcedure(i,e){let a={};e&&Object.keys(e).forEach(n=>a[n]=String(e[n])),this.yamcs.yamcsClient.startProcedure(this.yamcs.instance,i,{arguments:a}).catch(n=>this.messageService.showError(n))}};var as=["frameInner"],ns=["displayContainer"],Da="MDB:OPS Name",vi="ops://",rs="args.",An=class t{constructor(i,e,a,n,r,c,d,m){this.yamcs=i;this.router=e;this.route=a;this.synchronizer=n;this.messageService=r;this.baseHref=c;this.configService=d;this.formatter=m;this.idMapping={};this.idInfo={};this.pvsByName=new Map;this.subscriptionDirty=!1;this.storageClient=i.createStorageClient(),this.bucket=d.getDisplayBucket()}setViewerContainerEl(i){this.viewerContainerEl=i}updateSubscription(){if(this.subscriptionDirty){this.subscriptionDirty=!1,this.parameterSubscription&&this.parameterSubscription.cancel();let i=[];for(let e of this.pvsByName.keys())i.push(this.getIdForPvName(e));i.length&&(this.parameterSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:i,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},e=>{if(e.mapping&&(this.idMapping=e.mapping),e.info){this.idInfo=e.info;for(let a in e.info){let n=e.mapping[a],r=e.info[a],c=this.getPVById(n);c&&(r.enumValues&&(c.labels=r.enumValues.map(d=>d.label)),c.writable=r.dataSource==="LOCAL"||r.dataSource==="EXTERNAL1"||r.dataSource==="EXTERNAL2"||r.dataSource==="EXTERNAL3")}}for(let a of e.invalid||[]){let n=this.getPVById(a);n&&(n.disconnected=!0)}if(e.values?.length){let a=new Map;for(let n of e.values){n.id=this.idMapping[n.numericId];let r=n.id.name;n.id.namespace===Da&&(r=vi+r);let c=this.idInfo[n.numericId];a.set(r,this.toSample(n,c))}this.display.setValues(a)}}))}}getIdForPvName(i){return i.startsWith(vi)?{namespace:Da,name:i.substring(vi.length)}:{name:i}}getPVById(i){let e=i.name;return i.namespace===Da&&(e=vi+e),this.display.getPV(e)}toSample(i,e){let a=F.toDate(i.generationTime),n=this.toAlarmSeverity(i),r={time:a,severity:n,value:void 0};return i.engValue&&(r.value=F.convertValue(i.engValue),i.engValue.type==="ENUMERATED"&&(r.valueIndex=Number(i.engValue.sint64Value))),e.units&&(r.units=e.units),r}toAlarmSeverity(i){if(i.acquisitionStatus==="EXPIRED"||i.acquisitionStatus=="NOT_RECEIVED"||i.acquisitionStatus==="INVALID")return ea.INVALID;if(!i.monitoringResult)return ea.NONE;switch(i.monitoringResult){case"DISABLED":case"IN_LIMITS":return ea.NONE;case"WATCH":case"WARNING":case"DISTRESS":return ea.MINOR;case"CRITICAL":case"SEVERE":return ea.MAJOR}}init(i){let e=this.displayContainer.nativeElement;this.display=new Cl(e);let a=this.configService.getConfig().opi;this.display.disconnectedColor=Sa(a.disconnectedColor),this.display.invalidColor=Sa(a.invalidColor),this.display.majorColor=Sa(a.majorColor),this.display.minorColor=Sa(a.minorColor),this.display.utc=this.formatter.isUTC(),this.display.imagesPrefix=this.baseHref+"media/",this.display.setPathResolver(new En(this.storageClient,this.display)),this.display.setConsoleHandler(new wn(this.messageService)),this.display.setFontResolver(new Tn(this.baseHref));let n="";i.lastIndexOf("/")!==-1&&(n=i.substring(0,i.lastIndexOf("/")+1)),this.display.addScriptLibrary("Yamcs",new kn(this.yamcs,this.messageService)),this.display.addEventListener("opendisplay",u=>{let g,f=`?c=${this.yamcs.context}&range=${this.yamcs.getTimeRange()}`;if(u.path.startsWith("/")?g=`/telemetry/displays/files${u.path}${f}`:g=`/telemetry/displays/files/${n}${u.path}${f}`,u.args)for(let y in u.args)g+="&"+rs+encodeURIComponent(y)+"="+encodeURIComponent(u.args[y]);this.router.navigateByUrl(g)}),this.display.addEventListener("closedisplay",u=>{this.router.navigateByUrl(`/telemetry/displays/browse?c=${this.yamcs.context}`)}),this.display.addEventListener("openpv",u=>{u.pvName.startsWith("/")?this.router.navigateByUrl(`/telemetry/parameters${u.pvName}/-/summary?c=${this.yamcs.context}`):u.pvName.startsWith(vi)?this.yamcs.yamcsClient.getParameterById(this.yamcs.instance,{namespace:Da,name:u.pvName.substring(6)}).then(g=>{this.router.navigateByUrl(`/telemetry/parameters${g.qualifiedName}/-/summary?c=${this.yamcs.context}`)}):alert(`Can't navigate to PV ${u.pvName}`)}),this.display.addEventListener("runcommand",u=>{this.yamcs.yamcsClient.issueCommand(this.yamcs.instance,this.yamcs.processor,u.command,{args:u.args}).catch(g=>this.messageService.showError(g))}),this.display.addEventListener("runstack",u=>{let g=u.path.split("/"),f=[];for(let S of g)S==="."||(S===".."?f.pop():f.push(S));let y=f.join("/"),_=this.storageClient.getObjectURL(this.bucket,"");if(y.startsWith(_)){let S=y.slice(_.length);this.yamcs.yamcsClient.startActivity(this.yamcs.instance,{type:"COMMAND_STACK",args:{processor:this.yamcs.processor,bucket:this.bucket,stack:S}}).catch(P=>this.messageService.showError(P))}else this.messageService.showError("Failed to resolve stack path")}),this.display.addEventListener("runprocedure",u=>{this.yamcs.yamcsClient.startProcedure(this.yamcs.instance,u.procedure,{arguments:u.args}).catch(g=>this.messageService.showError(g))}),this.display.addProvider(this),this.display.absPrefix=this.storageClient.getObjectURL(this.bucket,"");let r=this.storageClient.getObjectURL(this.bucket,i),c={},d=this.route.snapshot.queryParams;for(let u in d)u.startsWith("args.")&&(c[u.substring(5)]=d[u]);let m=this.display.setSource(r,c);return m.then(()=>{let u;!this.display.transparent&&this.display.instance?u=this.display.instance.backgroundColor.hex():u="unset",this.frameInner.nativeElement.style.backgroundColor=u,this.syncSubscription=this.synchronizer.syncFast(()=>this.updateSubscription()),this.updateSubscription()}),m}canProvide(i){return!0}startProviding(i){for(let e of i)this.pvsByName.set(e.name,e);this.subscriptionDirty=!0}stopProviding(i){for(let e of i)this.pvsByName.delete(e.name);this.subscriptionDirty=!0}writeValue(i,e){let a=i;i.startsWith(vi)&&(a=Da+"/"+i.substring(vi.length)),this.yamcs.yamcsClient.setParameterValue(this.yamcs.instance,this.yamcs.processor,a,{type:"STRING",stringValue:String(e)}).then(()=>this.messageService.showInfo(`Parameter ${i} set to ${e}`)).catch(n=>this.messageService.showError(n))}createHistoricalDataProvider(i,e){let{yamcs:a,synchronizer:n}=this;if(this.configService.getConfig().tmArchive)return new Pn(i,e,a,n,this.configService)}isNavigable(){return!0}shutdown(){}hasPendingChanges(){return!1}zoomIn(){this.display.scale+=.1}zoomOut(){this.display.scale-=.1}resetZoom(){this.display.scale=1}fitZoom(){let i=this.display.instance;if(i&&this.viewerContainerEl){let e=this.viewerContainerEl.clientWidth,a=this.viewerContainerEl.clientHeight,{width:n,height:r}=i.unscaledBounds,c=e/n,d=a/r;this.display.scale=Math.min(c,d)}}ngOnDestroy(){this.syncSubscription?.unsubscribe(),this.parameterSubscription?.cancel(),this.display.destroy()}static{this.\u0275fac=function(e){return new(e||t)(T(q),T(Oe),T(we),T(Tt),T(ft),T(Ho),T(ye),T(ji))}}static{this.\u0275cmp=V({type:t,selectors:[["app-opi-display-viewer"]],viewQuery:function(e,a){if(e&1&&(fe(as,5),fe(ns,7)),e&2){let n;ue(n=he())&&(a.frameInner=n.first),ue(n=he())&&(a.displayContainer=n.first)}},decls:4,vars:0,consts:[["frameInner",""],["displayContainer",""],[1,"frame-inner"],[1,"display-container"]],template:function(e,a){e&1&&(l(0,"div",2,0),b(2,"div",3,1),o())},dependencies:[G],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:table}.frame-inner[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle;overflow:auto;text-align:center;line-height:0}.display-container[_ngcontent-%COMP%]{display:inline-block}"],changeDetection:0})}};function ss(t,i){if(t&1&&(l(0,"mat-option",5),w(1,"memberPath"),s(2),w(3,"memberPath"),o()),t&2){let e=i.$implicit;C("value",D(1,2,e)),p(2),L(" ",D(3,4,e)," ")}}function cs(t,i){if(t&1&&(l(0,"span",6),s(1),o()),t&2){let e=h();p(),W(e.hint)}}var ei=class t{constructor(i,e,a){this.dialogRef=i;this.yamcs=e;this.data=a;this.parameter=new ee(null,[Ee.required]);this.label=a.label||"Search parameter",this.okLabel=a.okLabel||"SELECT",this.limit=a.limit||10,this.hint=a.hint}ngOnInit(){let i=this.data.exclude||[];this.filteredOptions=this.parameter.valueChanges.pipe(Wa(300),ja(e=>this.yamcs.yamcsClient.getParameters(this.yamcs.instance,{q:e,limit:this.limit,searchMembers:!0})),Ri(e=>e.parameters||[]),Ri(e=>e.filter(a=>{for(let n of i){let r=F.getMemberPath(a);if(n===r)return!1}return!0})))}select(){this.dialogRef.close(this.parameter.value)}static{this.\u0275fac=function(e){return new(e||t)(T(Ve),T(q),T(Qe))}}static{this.\u0275cmp=V({type:t,selectors:[["app-select-parameter-dialog"]],decls:17,vars:9,consts:[["auto",""],["mat-dialog-title",""],[1,"ya-form"],["type","text",3,"formControl","matAutocomplete"],[1,"ya-autocomplete"],[3,"value"],[1,"hint"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){if(e&1){let n=N();l(0,"h2",1),s(1),o(),l(2,"mat-dialog-content",2)(3,"label"),s(4),b(5,"input",3),l(6,"mat-autocomplete",4,0),ae(8,ss,4,6,"mat-option",5,ie),w(10,"async"),o(),v(11,cs,2,1,"span",6),o()(),l(12,"mat-dialog-actions",7)(13,"ya-button",8),s(14,"CANCEL"),o(),l(15,"ya-button",9),E("click",function(){return k(n),A(a.select())}),s(16),o()()}if(e&2){let n=oe(7);p(),W(a.label),p(3),L(" ",a.label," "),p(),C("formControl",a.parameter)("matAutocomplete",n),p(3),ne(D(10,7,a.filteredOptions)),p(3),x(a.hint?11:-1),p(4),C("disabled",!a.parameter.valid),p(),L(" ",a.okLabel," ")}},dependencies:[G,J,Ze,me,Gt,ln,nn,sn,Fe,mt,$e,Be,_e,yn],encapsulation:2,changeDetection:0})}};var ia=class t{constructor(i,e,a){this.dialogRef=i;this.yamcs=e;this.data=a;this.delimiterOptions=[{id:"COMMA",label:"Comma"},{id:"SEMICOLON",label:"Semicolon"},{id:"TAB",label:"Tab"}];this.headerOptions=[{id:"QUALIFIED_NAME",label:"Qualified names"},{id:"SHORT_NAME",label:"Short names"},{id:"NONE",label:"None"}];this.downloadURL$=new B(null);this.form=new it({start:new ee(null),stop:new ee(null),delimiter:new ee(null,Ee.required),interval:new on(null),header:new ee(null,Ee.required)});let n=a.start,r=a.stop;(!n||!r)&&(r=e.getMissionTime(),n=F.subtractDuration(r,"PT1H")),this.form.setValue({start:F.toISOString(n),stop:F.toISOString(r),delimiter:"TAB",header:"QUALIFIED_NAME",interval:""}),this.formChangeSubscription=this.form.valueChanges.subscribe(()=>{this.updateURL()}),this.updateURL()}closeDialog(){this.dialogRef.close(!0)}updateURL(){if(this.form.valid){let i={delimiter:this.form.value.delimiter,header:this.form.value.header};this.data.parameterIds&&(i.parameters=this.data.parameterIds),this.data.list&&(i.list=this.data.list),this.form.value.start&&(i.start=F.toISOString(this.form.value.start)),this.form.value.stop&&(i.stop=F.toISOString(this.form.value.stop)),this.form.value.interval&&(i.interval=this.form.value.interval),this.data.filename&&(i.filename=this.data.filename);let e=this.yamcs.yamcsClient.getParameterValuesDownloadURL(this.yamcs.instance,i);this.downloadURL$.next(e)}else this.downloadURL$.next(null)}ngOnDestroy(){this.formChangeSubscription?.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(T(Ve),T(q),T(Qe))}}static{this.\u0275cmp=V({type:t,selectors:[["app-export-archive-data-dialog"]],decls:38,vars:8,consts:[["mat-dialog-title",""],[1,"ya-form"],[3,"formGroup"],[1,"small-tabs",3,"mat-stretch-tabs"],["label","Content"],[2,"margin-top","1em"],[1,"label"],["cdkFocusRegionstart","","formControlName","start"],[1,"half-break"],["formControlName","stop"],[1,"hint"],["formControlName","interval","type","text",1,"ya-input"],["label","Format"],["formControlName","delimiter",3,"options"],["formControlName","header",3,"options"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","link","disabled"]],template:function(e,a){e&1&&(l(0,"h2",0),s(1,"Export archive data"),o(),l(2,"mat-dialog-content",1)(3,"form",2)(4,"mat-tab-group",3)(5,"mat-tab",4)(6,"div",5)(7,"div",6),s(8," Start "),b(9,"ya-date-time-input",7),o(),b(10,"hr",8),l(11,"div",6),s(12," Stop "),b(13,"ya-date-time-input",9),o(),b(14,"hr",8),l(15,"div",6),s(16," Interval (ms) "),l(17,"span",10),s(18,"(optional)"),o(),b(19,"br")(20,"input",11),o()()(),l(21,"mat-tab",12)(22,"div",5)(23,"div",6),s(24," CSV column delimiter "),b(25,"br")(26,"ya-select",13),o(),b(27,"hr",8),l(28,"div",6),s(29," Header "),b(30,"br")(31,"ya-select",14),o()()()()()(),l(32,"mat-dialog-actions",15)(33,"ya-button",16),s(34,"CANCEL"),o(),l(35,"ya-download-button",17),w(36,"async"),E("click",function(){return a.closeDialog()}),s(37," DOWNLOAD "),o()()),e&2&&(p(3),C("formGroup",a.form),p(),C("mat-stretch-tabs",!1),p(22),C("options",a.delimiterOptions),p(5),C("options",a.headerOptions),p(4),C("link",D(36,6,a.downloadURL$))("disabled",!a.form.valid))},dependencies:[G,J,Te,Ze,me,xe,be,De,Fe,mt,$e,Be,Qo,Ko,_e,_t,_n,Dt],encapsulation:2})}};function ms(t,i){if(t&1){let e=N();l(0,"ya-page-button",11),w(1,"async"),E("clicked",function(){k(e);let n=h(3);return A(n.save())}),s(2," SAVE "),o()}if(t&2){let e=h(3);C("disabled",!D(1,1,e.viewer.hasUnsavedChanges$))}}function ds(t,i){if(t&1){let e=N();l(0,"ya-page-button",12),E("clicked",function(){k(e);let n=h(3);return A(n.viewer.pause())}),s(1," PAUSE "),o()}}function us(t,i){if(t&1){let e=N();l(0,"ya-page-button",13),E("clicked",function(){k(e);let n=h(3);return A(n.viewer.unpause())}),s(1," UNPAUSE "),o()}}function hs(t,i){if(t&1){let e=N();l(0,"ya-page-button",14),E("clicked",function(){k(e);let n=h(3);return A(n.viewer.delete())}),s(1," DELETE "),o()}if(t&2){let e=h(3);C("disabled",e.viewer.selection.isEmpty())}}function fs(t,i){if(t&1){let e=N();l(0,"ya-page-button",15),E("clicked",function(){k(e);let n=h(3);return A(n.viewer.enableScrollView())}),s(1," SCROLL VIEW "),o()}}function _s(t,i){if(t&1){let e=N();l(0,"ya-page-button",16),E("clicked",function(){k(e);let n=h(3);return A(n.viewer.enableStandardView())}),s(1," STANDARD VIEW "),o()}}function gs(t,i){if(t&1){let e=N();v(0,ms,3,3,"ya-page-button",1)(1,ds,2,0,"ya-page-button",2),w(2,"async"),v(3,us,2,0,"ya-page-button",3),w(4,"async"),l(5,"ya-page-button",4),E("clicked",function(){k(e);let n=h(2);return A(n.addParameter())}),s(6,"ADD"),o(),v(7,hs,2,1,"ya-page-button",5)(8,fs,2,0,"ya-page-button",6)(9,_s,2,0,"ya-page-button",7),l(10,"mat-menu",8,0)(12,"button",9),E("click",function(){k(e);let n=h(2);return A(n.exportArchiveData())}),s(13," Export archive data... "),o()(),l(14,"ya-page-button",10),E("clicked",function(n){return k(e),A(n.stopPropagation())}),o()}if(t&2){let e=i,a=oe(11),n=h(2);x(n.mayManageDisplays()?0:-1),p(),x(D(2,8,n.viewer.paused$)?-1:1),p(2),x(D(4,10,n.viewer.paused$)?3:-1),p(4),x(e.scroll?-1:7),p(),x(e.scroll?-1:8),p(),x(e.scroll?9:-1),p(3),C("disabled",!e.parameters.length),p(2),C("matMenuTriggerFor",a)}}function vs(t,i){if(t&1&&(v(0,gs,15,12),w(1,"async")),t&2){let e,a=h();x((e=D(1,1,a.viewer.model$))?0:-1,e)}}var Mn=class t{constructor(i,e,a,n){this.dialog=i;this.snackbar=e;this.authService=a;this.initialized$=new B(!1);this.bucket=n.getDisplayBucket()}init(i){this.viewer=i,this.initialized$.next(!0)}addParameter(){this.dialog.open(ei,{width:"500px",data:{okLabel:"ADD",exclude:this.viewer.getModel().parameters}}).afterClosed().subscribe(e=>{e&&this.viewer.addParameter(e)})}mayManageDisplays(){let i=this.authService.getUser();return i.hasObjectPrivilege("ManageBucket",this.bucket)||i.hasSystemPrivilege("ManageAnyBucket")}save(){this.viewer.save().then(()=>{this.snackbar.open("Changes saved",void 0,{duration:1e3})}).catch(i=>{this.snackbar.open("Failed to save changes: "+i)})}exportArchiveData(){let i=this.viewer.selection.selected;i.length||(i=this.viewer.getModel().parameters),this.dialog.open(ia,{width:"400px",data:{parameterIds:i}})}static{this.\u0275fac=function(e){return new(e||t)(T(Ne),T(rn),T(gt),T(ye))}}static{this.\u0275cmp=V({type:t,selectors:[["app-parameter-table-viewer-controls"]],decls:2,vars:3,consts:[["moreMenu","matMenu"],["icon","save",3,"disabled"],["matTooltip","Pause value updates","icon","pause"],["matTooltip","Unpause value updates","icon","play_arrow"],["icon","playlist_add",3,"clicked"],["icon","delete",3,"disabled"],["icon","view_headline","iconRotate90","true"],["icon","view_headline"],["overlapTrigger","false"],["mat-menu-item","",3,"click","disabled"],["icon","more_vert",3,"clicked","matMenuTriggerFor"],["icon","save",3,"clicked","disabled"],["matTooltip","Pause value updates","icon","pause",3,"clicked"],["matTooltip","Unpause value updates","icon","play_arrow",3,"clicked"],["icon","delete",3,"clicked","disabled"],["icon","view_headline","iconRotate90","true",3,"clicked"],["icon","view_headline",3,"clicked"]],template:function(e,a){e&1&&(v(0,vs,2,3),w(1,"async")),e&2&&x(D(1,1,a.initialized$)?0:-1)},dependencies:[G,J,Hi,pt,Yi,$i,nt],encapsulation:2})}};var Rn=class{constructor(i=10){this.pointer=0;this.latestValues=new Map;this.buf=Array(i).fill(void 0)}push(i,e){let a={};for(let n of i){let r=e[n.numericId];a[r.name]=n}this.buf[this.pointer]=a,this.pointer=(this.pointer+1)%this.buf.length;for(let n of i){let r=e[n.numericId];this.latestValues.set(r.name,n)}}getLatestValue(i){return this.latestValues.get(i)}setSize(i){this.buf=Array(i).fill(void 0),this.pointer=0}snapshot(){return this.pointer===0?[...this.buf]:[...this.buf.slice(this.pointer),...this.buf.slice(0,this.pointer)].reverse()}};var ys=t=>({c:t});function Cs(t,i){if(t&1){let e=N();l(0,"th",19)(1,"input",20),E("change",function(n){k(e);let r=h(2);return A(n?r.masterToggle():null)}),o()()}if(t&2){let e=h(2);p(),C("checked",e.selection.hasValue()&&e.isAllSelected())}}function xs(t,i){if(t&1){let e=N();l(0,"td",21)(1,"input",22),E("click",function(n){return k(e),A(n.stopPropagation())})("change",function(n){let r=k(e).$implicit,c=h(2);return A(n?c.selection.toggle(r.name):null)}),o()()}if(t&2){let e=i.$implicit,a=h(2);p(),C("checked",a.selection.isSelected(e.name))}}function bs(t,i){t&1&&(l(0,"th",23),s(1,"Name"),o())}function Ss(t,i){if(t&1&&(l(0,"td",24)(1,"a",25),s(2),o()()),t&2){let e=i.$implicit,a=h(2);p(),C("routerLink","/telemetry/parameters"+e.name)("queryParams",X(3,ys,a.yamcs.context)),p(),L(" ",e.name," ")}}function ws(t,i){t&1&&(l(0,"th",23),s(1,"Severity"),o())}function Ts(t,i){if(t&1&&b(0,"app-alarm-level",26),t&2){let e=h().$implicit;C("level",e.pval==null?null:e.pval.monitoringResult)}}function Ds(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function Ps(t,i){if(t&1&&(l(0,"td",21),v(1,Ts,1,1,"app-alarm-level",26)(2,Ds,2,0,"span"),o()),t&2){let e=i.$implicit;p(),x(e.pval!=null&&e.pval.monitoringResult?1:2)}}function Es(t,i){t&1&&(l(0,"th",23),s(1,"Raw"),o())}function ks(t,i){if(t&1&&(l(0,"td",27),s(1),w(2,"value"),o()),t&2){let e=i.$implicit;p(),L(" ",D(2,1,e.pval==null?null:e.pval.rawValue)||"-"," ")}}function As(t,i){t&1&&(l(0,"th",23),s(1,"Eng"),o())}function Ms(t,i){t&1&&(l(0,"span"),s(1,"\u2193"),o())}function Rs(t,i){t&1&&(l(0,"span"),s(1,"\u2191"),o())}function Is(t,i){if(t&1&&(l(0,"ya-expirable",28),s(1),w(2,"value"),v(3,Ms,2,0,"span")(4,Rs,2,0,"span"),o()),t&2){let e=h().$implicit;C("pval",e.pval),p(),L(" ",D(2,4,e.pval==null?null:e.pval.engValue)||"-"," "),p(2),x((e.pval==null?null:e.pval.rangeCondition)==="LOW"?3:-1),p(),x((e.pval==null?null:e.pval.rangeCondition)==="HIGH"?4:-1)}}function Ls(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function Os(t,i){if(t&1&&(l(0,"td",27),v(1,Is,5,6,"ya-expirable",28)(2,Ls,2,0,"span"),o()),t&2){let e=i.$implicit;p(),x(e.pval?1:2)}}function Vs(t,i){t&1&&(l(0,"th",23),s(1,"Reception time"),o())}function Ns(t,i){if(t&1&&(l(0,"td",21),s(1),w(2,"datetime"),o()),t&2){let e=i.$implicit;p(),L(" ",D(2,1,e.pval==null?null:e.pval.acquisitionTime)||"-"," ")}}function Fs(t,i){t&1&&(l(0,"th",23),s(1,"Generation time"),o())}function Bs(t,i){if(t&1&&(l(0,"td",21),s(1),w(2,"datetime"),o()),t&2){let e=i.$implicit;p(),W(D(2,1,e.pval==null?null:e.pval.generationTime)||"-")}}function $s(t,i){t&1&&(l(0,"th",23),s(1,"Acquisition status"),o())}function Hs(t,i){if(t&1&&(l(0,"td",21),s(1),o()),t&2){let e=i.$implicit;p(),W((e.pval==null?null:e.pval.acquisitionStatus)||"-")}}function Ys(t,i){t&1&&b(0,"th",29)}function Gs(t,i){if(t&1){let e=N();l(0,"td",21)(1,"ya-icon-action",30),E("click",function(n){let r=k(e).index;return h(2).moveDown.emit(r),A(n.stopPropagation())}),o(),l(2,"ya-icon-action",31),E("click",function(n){let r=k(e).index;return h(2).moveUp.emit(r),A(n.stopPropagation())}),o()()}}function Us(t,i){t&1&&b(0,"tr",32)}function zs(t,i){if(t&1){let e=N();l(0,"tr",33),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.toggleOne(n.name))}),o()}if(t&2){let e=i.$implicit,a=h(2);pe("selected",a.selection.isSelected(e.name))}}function Ws(t,i){if(t&1&&(l(0,"table",1),$(1,2),v(2,Cs,2,1,"th",3)(3,xs,2,1,"td",4),H(),$(4,5),v(5,bs,2,0,"th",6)(6,Ss,3,5,"td",7),H(),$(7,8),v(8,ws,2,0,"th",6)(9,Ps,3,1,"td",4),H(),$(10,9),v(11,Es,2,0,"th",6)(12,ks,3,3,"td",10),H(),$(13,11),v(14,As,2,0,"th",6)(15,Os,3,1,"td",10),H(),$(16,12),v(17,Vs,2,0,"th",6)(18,Ns,3,3,"td",4),H(),$(19,13),v(20,Fs,2,0,"th",6)(21,Bs,3,3,"td",4),H(),$(22,14),v(23,$s,2,0,"th",6)(24,Hs,2,1,"td",4),H(),$(25,15),v(26,Ys,1,0,"th",16)(27,Gs,3,0,"td",4),H(),v(28,Us,1,0,"tr",17)(29,zs,1,2,"tr",18),o()),t&2){let e=h();pe("paused",e.paused),C("dataSource",e.dataSource),p(28),C("cdkHeaderRowDef",e.displayedColumns),p(),C("cdkRowDefColumns",e.displayedColumns)}}var In=class t{constructor(i,e,a){this.yamcs=i;this.changeDetector=e;this.model={scroll:!1,parameters:[]};this.moveUp=new tt;this.moveDown=new tt;this.dataSource=new Lt([]);this.defaultColumns=["severity","name","generationTime","rawValue","engValue","acquisitionStatus"];this.syncSubscription=a.syncFast(()=>{this.paused||this.refreshTable()})}ngOnInit(){this.refreshTable()}refreshTable(){let i=this.model.parameters.map(e=>({name:e}));for(let e of i)e.pval=this.buffer.getLatestValue(e.name);this.dataSource.data=i,this.changeDetector.detectChanges()}ngOnChanges(){this.showActions?this.displayedColumns=["select",...this.defaultColumns,"actions"]:this.displayedColumns=this.defaultColumns}isAllSelected(){let i=this.selection.selected.length,e=this.dataSource.filteredData.length;return i===e&&e>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.filteredData.forEach(i=>this.selection.select(i.name))}toggleOne(i){(!this.selection.isSelected(i)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(i)}ngOnDestroy(){this.syncSubscription?.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(T(q),T(xt),T(Tt))}}static{this.\u0275cmp=V({type:t,selectors:[["app-multiple-parameter-table"]],inputs:{model:"model",buffer:"buffer",showActions:"showActions",paused:"paused",selection:"selection"},outputs:{moveUp:"moveUp",moveDown:"moveDown"},features:[Mt],decls:1,vars:1,consts:[["mat-table","",1,"ya-data-table","expand",3,"dataSource","paused"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["cdkColumnDef","select"],["mat-header-cell","","style","text-align: left",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","","style","white-space: nowrap",4,"cdkCellDef"],["cdkColumnDef","severity"],["cdkColumnDef","rawValue"],["mat-cell","","class","wrap200",4,"cdkCellDef"],["cdkColumnDef","engValue"],["cdkColumnDef","receptionTime"],["cdkColumnDef","generationTime"],["cdkColumnDef","acquisitionStatus"],["cdkColumnDef","actions"],["mat-header-cell","","class","expand",4,"cdkHeaderCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",2,"text-align","left"],["type","checkbox",3,"change","checked"],["mat-cell",""],["type","checkbox",3,"click","change","checked"],["mat-header-cell",""],["mat-cell","",2,"white-space","nowrap"],[3,"routerLink","queryParams"],[3,"level"],["mat-cell","",1,"wrap200"],[3,"pval"],["mat-header-cell","",1,"expand"],["icon","keyboard_arrow_down",3,"click"],["icon","keyboard_arrow_up",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,a){e&1&&v(0,Ws,30,5,"table",0),e&2&&x(a.dataSource.data.length?0:-1)},dependencies:[Jt,G,Re,si,It,oi,li,zi,He,Ye,Ge,Ue,ze,Xt,ci,Pe,Vt],styles:[".paused[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-style:italic}"],changeDetection:0})}};var js=t=>({c:t});function qs(t,i){t&1&&(l(0,"th",10),s(1,"Generation time"),o())}function Xs(t,i){if(t&1&&(l(0,"td",11),s(1),w(2,"datetime"),o()),t&2){let e=i.$implicit;p(),W(D(2,1,e.generationTime)||"-")}}function Zs(t,i){if(t&1){let e=N();l(0,"ya-more")(1,"button",13),E("click",function(){k(e);let n=h(2).$index,r=h(2);return A(r.moveLeft.emit(n))}),s(2,"Move left"),o(),l(3,"button",13),E("click",function(){k(e);let n=h(2).$index,r=h(2);return A(r.moveRight.emit(n))}),s(4,"Move right"),o(),b(5,"mat-divider"),l(6,"button",13),E("click",function(){k(e);let n=h(2).$implicit,r=h(2);return A(r.removeColumn.emit(n))}),s(7,"Remove column"),o()()}}function Qs(t,i){if(t&1&&(l(0,"th",10)(1,"a",12),s(2),o(),v(3,Zs,8,0,"ya-more"),o()),t&2){let e=h().$implicit,a=h(2);p(),C("routerLink","/telemetry/parameters"+e)("queryParams",X(4,js,a.yamcs.context)),p(),L(" ",e," "),p(),x(a.showActions?3:-1)}}function Ks(t,i){t&1&&(l(0,"span"),s(1,"\u2193"),o())}function Js(t,i){t&1&&(l(0,"span"),s(1,"\u2191"),o())}function ec(t,i){if(t&1&&(l(0,"ya-expirable",14),s(1),w(2,"value"),v(3,Ks,2,0,"span")(4,Js,2,0,"span"),o()),t&2){let e=h();C("pval",e),p(),L(" ",D(2,4,e.engValue)||"-"," "),p(2),x(e.rangeCondition==="LOW"?3:-1),p(),x(e.rangeCondition==="HIGH"?4:-1)}}function tc(t,i){t&1&&v(0,ec,5,6,"ya-expirable",14),t&2&&x(i?0:-1)}function ic(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function ac(t,i){if(t&1&&(l(0,"td",11),v(1,tc,1,1)(2,ic,2,0,"span"),o()),t&2){let e,a=i.$implicit,n=h().$implicit;p(),x((e=a.pvals[n])?1:2,e)}}function nc(t,i){if(t&1&&($(0,5),v(1,Qs,4,6,"th",3)(2,ac,3,1,"td",4),H()),t&2){let e=i.$implicit;C("cdkColumnDef",e)}}function rc(t,i){t&1&&b(0,"th",15)}function oc(t,i){t&1&&b(0,"td",11)}function lc(t,i){t&1&&b(0,"tr",16)}function sc(t,i){t&1&&b(0,"tr",17)}function cc(t,i){if(t&1&&(l(0,"table",1),$(1,2),v(2,qs,2,0,"th",3)(3,Xs,3,3,"td",4),H(),ae(4,nc,3,1,"ng-container",5,ie),$(6,6),v(7,rc,1,0,"th",7)(8,oc,1,0,"td",4),H(),v(9,lc,1,0,"tr",8)(10,sc,1,0,"tr",9),o()),t&2){let e=h();pe("paused",e.paused),C("dataSource",e.dataSource),p(4),ne(e.model.parameters),p(5),C("cdkHeaderRowDef",e.displayedColumns),p(),C("cdkRowDefColumns",e.displayedColumns)}}function pc(t,i){if(t&1&&(l(0,"p"),s(1,"\xA0"),o(),s(2," Buffer size: "),l(3,"select",18)(4,"option",19),s(5,"10"),o(),l(6,"option",20),s(7,"25"),o(),l(8,"option",21),s(9,"50"),o(),l(10,"option",22),s(11,"75"),o(),l(12,"option",23),s(13,"100"),o()()),t&2){let e=h();p(3),C("formControl",e.bufferSizeControl)}}var Ln=class t{constructor(i,e,a){this.yamcs=i;this.changeDetector=e;this.model={scroll:!0,parameters:[]};this.removeColumn=new tt;this.moveLeft=new tt;this.moveRight=new tt;this.bufferSize=new tt;this.dataSource=new Lt([]);this.bufferSizeControl=new ee("10");this.displayedColumns=["generationTime","actions"];this.syncSubscription=a.syncFast(()=>{this.paused||this.refreshTable()}),this.bufferSizeControl.valueChanges.subscribe(()=>{let n=this.bufferSizeControl.value;n!==String(this.model.bufferSize)&&this.bufferSize.emit(parseInt(n,10))})}ngOnInit(){this.model.bufferSize&&(this.buffer.setSize(this.model.bufferSize),this.bufferSizeControl.setValue(String(this.model.bufferSize))),this.refreshTable()}refreshTable(){let i=[],e=this.buffer.snapshot();for(let a of e){let n=this.findAnyMatchingParameterValue(a);n&&i.push({generationTime:n.generationTime,pvals:a})}this.dataSource.data=i,this.changeDetector.detectChanges()}findAnyMatchingParameterValue(i){for(let e in i)if(i.hasOwnProperty(e)&&this.model.parameters.indexOf(e)!==-1)return i[e]}ngOnChanges(){this.displayedColumns=["generationTime",...this.model.parameters,"actions"]}ngOnDestroy(){this.syncSubscription?.unsubscribe(),this.bufferSizeControlSubscription?.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(T(q),T(xt),T(Tt))}}static{this.\u0275cmp=V({type:t,selectors:[["app-scrolling-parameter-table"]],inputs:{model:"model",buffer:"buffer",showActions:"showActions",paused:"paused"},outputs:{removeColumn:"removeColumn",moveLeft:"moveLeft",moveRight:"moveRight",bufferSize:"bufferSize"},features:[Mt],decls:2,vars:2,consts:[["mat-table","",1,"ya-data-table","expand",3,"dataSource","paused"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["cdkColumnDef","generationTime"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],[3,"cdkColumnDef"],["cdkColumnDef","actions"],["mat-header-cell","","class","expand",4,"cdkHeaderCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"routerLink","queryParams"],["mat-menu-item","",3,"click"],[3,"pval"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""],[3,"formControl"],["value","10"],["value","25"],["value","50"],["value","75"],["value","100"]],template:function(e,a){e&1&&v(0,cc,11,5,"table",0)(1,pc,14,1),e&2&&(x(a.dataSource.data.length?0:-1),p(),x(a.showActions?1:-1))},dependencies:[G,Fi,Bi,Ni,me,Gt,Re,si,It,oi,li,zi,zt,pt,He,Ye,Ge,Ue,ze,Xt,Ot,Pe,Vt],styles:[".paused[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-style:italic}"],changeDetection:0})}};function mc(t,i){if(t&1){let e=N();l(0,"app-scrolling-parameter-table",4),w(1,"async"),w(2,"async"),E("moveLeft",function(n){k(e);let r=h(3);return A(r.moveUp(n))})("moveRight",function(n){k(e);let r=h(3);return A(r.moveDown(n))})("removeColumn",function(n){k(e);let r=h(3);return A(r.removeParameter(n))})("bufferSize",function(n){k(e);let r=h(3);return A(r.setBufferSize(n))}),o()}if(t&2){let e=h(2),a=h();C("model",e)("buffer",a.buffer)("paused",D(1,4,a.paused$))("showActions",D(2,6,a.showActions$))}}function dc(t,i){if(t&1){let e=N();l(0,"app-multiple-parameter-table",5),w(1,"async"),w(2,"async"),E("moveUp",function(n){k(e);let r=h(3);return A(r.moveUp(n))})("moveDown",function(n){k(e);let r=h(3);return A(r.moveDown(n))}),o()}if(t&2){let e=h(2),a=h();C("model",e)("buffer",a.buffer)("paused",D(1,5,a.paused$))("showActions",D(2,7,a.showActions$))("selection",a.selection)}}function uc(t,i){if(t&1&&v(0,mc,3,8,"app-scrolling-parameter-table",2)(1,dc,3,9,"app-multiple-parameter-table",3),t&2){let e=h();x(e.scroll?0:1)}}function hc(t,i){if(t&1){let e=N();l(0,"ya-empty-message")(1,"div",6)(2,"p"),s(3," This file is empty. "),b(4,"br"),s(5," Start by "),l(6,"a",7),E("click",function(){k(e);let n=h(2);return A(n.showAddParameterDialog())}),s(7," adding a parameter "),o(),s(8," . "),o()()()}}function fc(t,i){if(t&1){let e=N();l(0,"ya-empty-message")(1,"div",6)(2,"p"),s(3," This file is empty. "),b(4,"br"),s(5," Start by "),l(6,"a",7),E("click",function(){k(e);let n=h(2);return A(n.showAddParameterDialog())}),s(7," adding a parameter "),o(),s(8," . "),o()()()}}function _c(t,i){t&1&&(l(0,"div",1),v(1,uc,2,1)(2,hc,9,0,"ya-empty-message")(3,fc,9,0,"ng-template",null,0,fi),o()),t&2&&(p(),x(i.parameters.length?1:2))}var Vn=class t{constructor(i,e,a){this.yamcs=i;this.dialog=e;this.selection=new Vi(!0,[]);this.model$=new B(null);this.buffer=new Rn;this.paused$=new B(!1);this.hasUnsavedChanges$=new B(!1);this.showActions$=new B(!1);this.storageClient=i.createStorageClient(),this.bucket=a.getDisplayBucket()}init(i){return this.objectName=i,this.storageClient.getObject(this.bucket,i).then(e=>{e.text().then(a=>{let n=JSON.parse(a);this.model$.next(n),this.createOrModifySubscription()})}),Promise.resolve()}setEnableActions(){this.showActions$.next(!0)}hasPendingChanges(){return this.hasUnsavedChanges$.value}createOrModifySubscription(){let i=this.model$.value.parameters.map(e=>({name:e}));i.length&&(this.dataSubscription?this.dataSubscription.sendMessage({instance:this.yamcs.instance,processor:this.yamcs.processor,id:i,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"}):this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:i,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},e=>{e.mapping&&(this.idMapping=e.mapping);let a=e.values||[];this.buffer.push(a,this.idMapping)}))}addParameter(i){let e=this.model$.value;e.parameters.push(i),this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0),this.createOrModifySubscription()}emitModelUpdate(i){this.model$.next({scroll:i.scroll,bufferSize:i.bufferSize||10,parameters:i.parameters})}getModel(){return this.model$.value}pause(){this.paused$.next(!0)}unpause(){this.paused$.next(!1)}delete(){if(!this.selection.isEmpty()){let i=this.model$.value;i.parameters=i.parameters.filter(e=>!this.selection.isSelected(e)),this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0)}this.selection.clear()}enableScrollView(){this.selection.clear();let i=this.model$.value;i.scroll=!0,this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0)}enableStandardView(){this.selection.clear();let i=this.model$.value;i.scroll=!1,this.emitModelUpdate(i),this.hasUnsavedChanges$.next(!0)}removeParameter(i){let e=this.model$.value;e.parameters=e.parameters.filter(a=>a!==i),this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}moveUp(i){let e=this.model$.value,a=e.parameters[i];i===0?(e.parameters[i]=e.parameters[e.parameters.length-1],e.parameters[e.parameters.length-1]=a):(e.parameters[i]=e.parameters[i-1],e.parameters[i-1]=a),this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}moveDown(i){let e=this.model$.value,a=e.parameters[i];i===e.parameters.length-1?(e.parameters[i]=e.parameters[0],e.parameters[0]=a):(e.parameters[i]=e.parameters[i+1],e.parameters[i+1]=a),this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}setBufferSize(i){this.buffer.setSize(i);let e=this.model$.value;e.bufferSize=i,this.emitModelUpdate(e),this.hasUnsavedChanges$.next(!0)}save(){let i=new Blob([JSON.stringify(et({$schema:"https://yamcs.org/schema/parameter-table.schema.json"},this.model$.value),void 0,2)],{type:"application/json"});return this.storageClient.uploadObject(this.bucket,this.objectName,i).then(()=>{this.hasUnsavedChanges$.next(!1)})}showAddParameterDialog(){this.dialog.open(ei,{width:"500px",data:{okLabel:"ADD",exclude:this.getModel().parameters}}).afterClosed().subscribe(e=>{e&&this.addParameter(e)})}ngOnDestroy(){this.dataSubscription?.cancel()}static{this.\u0275fac=function(e){return new(e||t)(T(q),T(Ne),T(ye))}}static{this.\u0275cmp=V({type:t,selectors:[["app-parameter-table-viewer"]],decls:2,vars:3,consts:[["empty",""],[1,"panel-content"],[3,"model","buffer","paused","showActions"],[3,"model","buffer","paused","showActions","selection"],[3,"moveLeft","moveRight","removeColumn","bufferSize","model","buffer","paused","showActions"],[3,"moveUp","moveDown","model","buffer","paused","showActions","selection"],[2,"text-align","left"],[1,"ya-link",2,"cursor","pointer",3,"click"]],template:function(e,a){if(e&1&&(v(0,_c,5,1,"div",1),w(1,"async")),e&2){let n;x((n=D(1,1,a.model$))?0:-1,n)}},dependencies:[In,Ln,G,J,qt],styles:[".panel-content[_ngcontent-%COMP%]{position:relative;overflow:auto}"],changeDetection:0})}};function gc(t,i){if(t&1){let e=N();l(0,"ya-page-button",1),w(1,"async"),E("clicked",function(){k(e);let n=h(2);return A(n.save())}),s(2," SAVE "),o()}if(t&2){let e=h(2);C("disabled",!D(1,1,e.viewer.hasUnsavedChanges$))}}function vc(t,i){if(t&1&&v(0,gc,3,3,"ya-page-button",0),t&2){let e=h();x(e.mayManageDisplays()?0:-1)}}var Nn=class t{constructor(i,e,a){this.snackbar=i;this.authService=e;this.initialized$=new B(!1);this.bucket=a.getDisplayBucket()}init(i){this.viewer=i,this.initialized$.next(!0)}mayManageDisplays(){let i=this.authService.getUser();return i.hasObjectPrivilege("ManageBucket",this.bucket)||i.hasSystemPrivilege("ManageAnyBucket")}save(){this.viewer.save().then(()=>{this.snackbar.open("Changes saved",void 0,{duration:1e3})}).catch(i=>{this.snackbar.open("Failed to save changes: "+i)})}static{this.\u0275fac=function(e){return new(e||t)(T(rn),T(gt),T(ye))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],decls:2,vars:3,consts:[["icon","save",3,"disabled"],["icon","save",3,"clicked","disabled"]],template:function(e,a){e&1&&(v(0,vc,1,1),w(1,"async")),e&2&&x(D(1,1,a.initialized$)?0:-1)},dependencies:[G,J,nt],encapsulation:2})}};var yc=["scriptContainer"],Fn=class t{constructor(i,e,a,n){this.messageService=a;this.authService=n;this.hasUnsavedChanges$=new B(!1);this.storageClient=i.createStorageClient(),this.bucket=e.getDisplayBucket()}init(i){return this.objectName=i,this.storageClient.getObject(this.bucket,i).then(e=>e.text().then(a=>this.initializeEditor(a))).catch(e=>this.messageService.showError(e)),Promise.resolve()}initializeEditor(i){let e=[Zo,qo.of([Xo]),gl(),ba.lineWrapping];this.mayManageDisplays()?e.push(ba.updateListener.of(r=>{r.docChanged&&this.hasUnsavedChanges$.next(!0)})):e.push(Zr.readOnly.of(!0));let a=ba.theme({"&":{width:"100%",height:"100%",fontSize:"12px"},".cm-scroller":{overflow:"auto",fontFamily:"'Roboto Mono', monospace"}},{dark:!1});e.push(a);let n=Zr.create({doc:i,extensions:e});this.editorView=new ba({state:n,parent:this.scriptContainer.nativeElement})}mayManageDisplays(){let i=this.authService.getUser();return i.hasObjectPrivilege("ManageBucket",this.bucket)||i.hasSystemPrivilege("ManageAnyBucket")}hasPendingChanges(){return this.hasUnsavedChanges$.value}async save(){let i=this.editorView.state.doc.toString(),e=new Blob([i],{type:"text/javascript"});return this.storageClient.uploadObject(this.bucket,this.objectName,e).then(()=>{this.hasUnsavedChanges$.next(!1)})}static{this.\u0275fac=function(e){return new(e||t)(T(q),T(ye),T(ft),T(gt))}}static{this.\u0275cmp=V({type:t,selectors:[["app-script-viewer"]],viewQuery:function(e,a){if(e&1&&fe(yc,5),e&2){let n;ue(n=he())&&(a.scriptContainer=n.first)}},decls:2,vars:0,consts:[["scriptContainer",""],[1,"script-container"]],template:function(e,a){e&1&&b(0,"div",1,0)},dependencies:[G],styles:[".script-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex}"],changeDetection:0})}};function Cc(t,i){if(t&1&&(l(0,"pre"),s(1),o()),t&2){let e=h();p(),W(e.text)}}var Bn=class t{constructor(i,e,a){this.changeDetector=e;this.storageClient=i.createStorageClient(),this.bucket=a.getDisplayBucket()}init(i){return this.storageClient.getObject(this.bucket,i).then(e=>{e.text().then(a=>{this.text=a,this.changeDetector.detectChanges()})}),Promise.resolve()}hasPendingChanges(){return!1}static{this.\u0275fac=function(e){return new(e||t)(T(q),T(xt),T(ye))}}static{this.\u0275cmp=V({type:t,selectors:[["app-text-viewer"]],decls:1,vars:1,template:function(e,a){e&1&&v(0,Cc,2,1,"pre"),e&2&&x(a.text?0:-1)},dependencies:[G],styles:["pre[_ngcontent-%COMP%]{margin:1em}"],changeDetection:0})}};var Ea=class t{constructor(i){this.viewContainerRef=i}static{this.\u0275fac=function(e){return new(e||t)(T(Qa))}}static{this.\u0275dir=Ka({type:t,selectors:[["","app-viewer-controls-host",""]]})}};var ka=class t{constructor(i){this.viewContainerRef=i}static{this.\u0275fac=function(e){return new(e||t)(T(Qa))}}static{this.\u0275dir=Ka({type:t,selectors:[["","app-viewer-host",""]]})}};var xc=["viewerContainer"],bc=t=>({c:t});function Sc(t,i){}function wc(t,i){}var $n=class t{constructor(i,e,a,n,r){this.yamcs=i;this.route=e;this.title=n;this.subscriptions=[];let c=this.getObjectNameFromUrl();this.loadFile(c);let d=a.events.pipe(za(u=>u instanceof tn)).subscribe(()=>{let u=this.getObjectNameFromUrl();u!==this.objectName&&this.loadFile(u,!0)});this.subscriptions.push(d);let m=e.snapshot.queryParamMap.get("range");m&&i.range$.next(m),d=i.range$.subscribe(u=>{a.navigate([],{replaceUrl:!0,relativeTo:e,queryParams:{range:u},queryParamsHandling:"merge"})}),this.subscriptions.push(d)}getObjectNameFromUrl(){let i=this.route.snapshot.url,e="";for(let a of i)e&&(e+="/"),e+=a.path;return e}loadFile(i,e=!1){this.objectName=i;let a=this.objectName.lastIndexOf("/");if(a===-1)this.folderLink="/telemetry/displays/browse/",this.filename=this.objectName;else{let n=this.objectName.substring(0,a);this.folderLink="/telemetry/displays/browse/"+n,this.filename=this.objectName.substring(a+1)}this.title.setTitle(this.filename),e&&this.ngAfterViewInit()}ngAfterViewInit(){if(this.filename.toLowerCase().endsWith(".opi")){let i=this.createViewer(An);i.setViewerContainerEl(this.viewerContainer.nativeElement),this.createViewerControls(Sn).init(i),this.viewer=i}else if(this.filename.toLowerCase().endsWith(".par")){let i=this.createViewer(Vn);this.createViewerControls(Mn).init(i),i.setEnableActions(),this.viewer=i}else if(this.isImage())this.viewer=this.createViewer(bn);else if(this.filename.toLocaleLowerCase().endsWith(".js")){let i=this.createViewer(Fn);this.createViewerControls(Nn).init(i),this.viewer=i}else this.viewer=this.createViewer(Bn);this.viewer.init(this.objectName)}createViewer(i){let e=this.viewerHost.viewContainerRef;return e.clear(),e.createComponent(i).instance}createViewerControls(i){let e=this.controlsHost.viewContainerRef;return e.clear(),e.createComponent(i).instance}isImage(){let i=this.filename.toLowerCase();return i.endsWith(".png")||i.endsWith(".gif")||i.endsWith(".jpg")||i.endsWith("jpeg")||i.endsWith("bmp")}hasPendingChanges(){return this.viewer.hasPendingChanges()}ngOnDestroy(){this.subscriptions.forEach(i=>i.unsubscribe())}static{this.\u0275fac=function(e){return new(e||t)(T(q),T(we),T(Oe),T(bt),T(ye))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],viewQuery:function(e,a){if(e&1&&(fe(Ea,5),fe(xc,5),fe(ka,5)),e&2){let n;ue(n=he())&&(a.controlsHost=n.first),ue(n=he())&&(a.viewerContainer=n.first),ue(n=he())&&(a.viewerHost=n.first)}},decls:8,vars:5,consts:[["viewerContainer",""],["icon","arrow_back",3,"routerLink","queryParams"],["app-viewer-controls-host",""],[2,"height","100%","width","100%"],["app-viewer-host",""]],template:function(e,a){e&1&&(l(0,"app-instance-page")(1,"app-instance-toolbar"),b(2,"ya-page-icon-button",1),s(3),v(4,Sc,0,0,"ng-template",2),o(),l(5,"div",3,0),v(7,wc,0,0,"ng-template",4),o()()),e&2&&(p(2),C("routerLink",a.folderLink)("queryParams",X(3,bc,a.yamcs.context)),p(),L(" ",a.filename," \xA0\xA0\xA0 "))},dependencies:[Je,Ke,G,Re,Qt,Ea,ka],encapsulation:2,changeDetection:0})}};var Tc=["filename"];function Dc(t,i){if(t&1&&(l(0,"form",2)(1,"label"),s(2," Type "),l(3,"select",7)(4,"option",8),s(5,"Parameter Table"),o()()()()),t&2){let e=h();C("formGroup",e.typeForm)}}function Pc(t,i){t&1&&(l(0,"span",10),s(1," File name must end with "),l(2,"code"),s(3,".par"),o()())}function Ec(t,i){if(t&1&&(l(0,"form",2)(1,"label"),s(2," Name "),b(3,"input",9,0),v(5,Pc,4,0,"span",10),o(),b(6,"br"),l(7,"label"),s(8," Path "),b(9,"input",11),o()()),t&2){let e,a,n=h();C("formGroup",n.filenameForm),p(),pe("invalid",(e=n.filenameForm.get("name"))==null?null:e.invalid),p(4),x((a=n.filenameForm.get("name"))!=null&&a.invalid?5:-1)}}function kc(t,i){if(t&1){let e=N();l(0,"ya-button",12),E("click",function(){k(e);let n=h();return A(n.selectType())}),s(1,"NEXT \xBB"),o()}if(t&2){let e=h();C("disabled",!e.typeForm.valid)}}function Ac(t,i){if(t&1){let e=N();l(0,"ya-button",13),E("click",function(){k(e);let n=h();return A(n.save())}),s(1," SAVE "),o()}if(t&2){let e=h();C("disabled",!e.filenameForm.valid)}}var Hn=class t{constructor(i,e,a,n,r,c){this.dialogRef=i;this.data=n;this.changeDetector=r;this.configService=c;this.page=1;this.storageClient=a.createStorageClient(),this.typeForm=e.group({type:["par",Ee.required]}),this.filenameForm=e.group({path:[n.path,Ee.required],name:["",[Ee.required,Ee.pattern(/.*\.par/i)]]})}selectType(){let i=this.typeForm.value.type;this.filenameForm.get("name").setValue(`NewFile.${i}`),this.page=2,this.changeDetector.detectChanges(),this.filenameInput.nativeElement.select()}save(){let i=this.filenameForm.get("path").value.trim(),e=this.filenameForm.get("name").value.trim();i.startsWith("/")&&(i=i.substring(1)),i.endsWith("/")&&(i=i.substring(0,i.length-1));let a=i?i+"/"+e:e,n=new Blob([JSON.stringify({$schema:"https://yamcs.org/schema/parameter-table.schema.json",scroll:!1,parameters:[]},void 0,2)],{type:"application/json"}),r=this.configService.getDisplayBucket(),c=this.data.prefix+a;this.storageClient.uploadObject(r,c,n).then(()=>{this.dialogRef.close(a)})}static{this.\u0275fac=function(e){return new(e||t)(T(Ve),T(Ut),T(q),T(Qe),T(xt),T(ye))}}static{this.\u0275cmp=V({type:t,selectors:[["app-create-display-dialog"]],viewQuery:function(e,a){if(e&1&&fe(Tc,5),e&2){let n;ue(n=he())&&(a.filenameInput=n.first)}},decls:10,vars:4,consts:[["filename",""],["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["align","end"],["mat-dialog-close",""],[3,"disabled"],["appearance","primary",3,"disabled"],["formControlName","type"],["value","par"],["type","text","formControlName","name"],[1,"error-message"],["type","text","formControlName","path"],[3,"click","disabled"],["appearance","primary",3,"click","disabled"]],template:function(e,a){e&1&&(l(0,"h2",1),s(1,"Create display"),o(),l(2,"mat-dialog-content"),v(3,Dc,6,1,"form",2)(4,Ec,10,4,"form",2),o(),l(5,"mat-dialog-actions",3)(6,"ya-button",4),s(7,"CANCEL"),o(),v(8,kc,2,1,"ya-button",5)(9,Ac,2,1,"ya-button",6),o()),e&2&&(p(3),x(a.page===1?3:-1),p(),x(a.page===2?4:-1),p(4),x(a.page===1?8:-1),p(),x(a.page===2?9:-1))},dependencies:[G,Te,Fi,Bi,Ze,Ni,me,xe,be,De,Fe,mt,$e,Be,_e],encapsulation:2})}};var Yn=class t{constructor(i,e,a,n){this.dialogRef=i;this.data=n;this.storageClient=a.createStorageClient(),this.form=e.group({name:["",Ee.required]})}save(){let{path:i,bucket:e}=this.data;i.startsWith("/")&&(i=i.substring(1));let a=this.form.value.name,n=i?`${i}/${a}/`:`${a}/`;this.storageClient.uploadObject(e,n,new Blob).then(()=>this.dialogRef.close(!0))}static{this.\u0275fac=function(e){return new(e||t)(T(Ve),T(Ut),T(q),T(Qe))}}static{this.\u0275cmp=V({type:t,selectors:[["app-create-display-folder-dialog"]],decls:12,vars:2,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name","pattern","\\w[\\w\\s\\.\\-\\(\\)\\[\\]]*"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){e&1&&(l(0,"h2",0),s(1,"Create folder"),o(),l(2,"mat-dialog-content")(3,"form",1)(4,"label"),s(5," Folder name "),b(6,"input",2),o()()(),l(7,"mat-dialog-actions",3)(8,"ya-button",4),s(9,"CANCEL"),o(),l(10,"ya-button",5),E("click",function(){return a.save()}),s(11,"CREATE"),o()()),e&2&&(p(3),C("formGroup",a.form),p(7),C("disabled",!a.form.valid))},dependencies:[G,Te,Ze,me,xe,jo,be,De,Fe,mt,$e,Be,_e],encapsulation:2,changeDetection:0})}};var Gn=class t{constructor(i,e,a,n,r){this.dialogRef=i;this.data=r;this.storageClient=a.createStorageClient(),this.bucket=n.getDisplayBucket();let c=F.getFilename(this.data.name);this.filenameForm=e.group({name:[c,[Ee.required]]})}async rename(){let i,e=this.data.name.lastIndexOf("/");e!==-1&&(i=this.data.name.substring(0,e+1));let n=await(await this.storageClient.getObject(this.bucket,this.data.name)).blob(),r=(i||"")+this.filenameForm.get("name").value;await this.storageClient.uploadObject(this.bucket,r,n),await this.storageClient.deleteObject(this.bucket,this.data.name),this.dialogRef.close(r)}static{this.\u0275fac=function(e){return new(e||t)(T(Ve),T(Ut),T(q),T(ye),T(Qe))}}static{this.\u0275cmp=V({type:t,selectors:[["app-rename-display-dialog"]],decls:13,vars:4,consts:[["filename",""],["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],["type","text","formControlName","name"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){if(e&1){let n=N();l(0,"h2",1),s(1,"Rename file"),o(),l(2,"mat-dialog-content")(3,"form",2)(4,"label"),s(5," Name "),b(6,"input",3,0),o()()(),l(8,"mat-dialog-actions",4)(9,"ya-button",5),s(10,"CANCEL"),o(),l(11,"ya-button",6),E("click",function(){return k(n),A(a.rename())}),s(12," RENAME "),o()()}if(e&2){let n;p(3),C("formGroup",a.filenameForm),p(),pe("invalid",(n=a.filenameForm.get("name"))==null?null:n.invalid),p(7),C("disabled",!a.filenameForm.valid)}},dependencies:[G,Te,Ze,me,xe,be,De,Fe,mt,$e,Be,_e],encapsulation:2})}};var Un=class t{transform(i){if(!i)return null;let e=i.toLowerCase();return e.endsWith(".opi")?"Operator Interface":e.endsWith(".par")?"Parameter Table":e.endsWith(".js")?"Script File":e.indexOf(".")!==-1?e.substr(e.lastIndexOf(".")+1).toUpperCase()+" File":null}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275pipe=Ja({name:"displayType",type:t,pure:!0})}};var Mc=["droparea"],Rc=["uploader"],Wn=t=>({c:t});function Ic(t,i){if(t&1){let e=N();l(0,"ya-page-button",10),E("clicked",function(){k(e);let n=h();return A(n.createDisplay())}),s(1," Create display "),o()}}function Lc(t,i){if(t&1){let e=N();l(0,"ya-page-button",11),E("clicked",function(){k(e);let n=oe(3);return A(n.click())}),s(1," Upload files "),l(2,"input",12,1),E("change",function(){k(e);let n=h();return A(n.uploadFiles())}),o()()}}function Oc(t,i){if(t&1){let e=N();l(0,"ya-page-button",13),E("clicked",function(){k(e);let n=h();return A(n.createFolder())}),s(1," Create folder "),o()}}function Vc(t,i){if(t&1){let e=N();l(0,"ya-page-button",14),E("clicked",function(){k(e);let n=h();return A(n.deleteSelectedDisplays())}),s(1," Delete "),o()}if(t&2){let e=h();C("disabled",!e.selection.hasValue())}}function Nc(t,i){if(t&1&&b(0,"ya-breadcrumb",16),t&2){let e=i.$implicit,a=h(3);C("link",e.route)("queryParams",X(3,Wn,a.yamcs.context))("label",e.name)}}function Fc(t,i){if(t&1&&(l(0,"ya-breadcrumb-trail"),b(1,"ya-breadcrumb",15),ae(2,Nc,1,5,"ya-breadcrumb",16,ie),o()),t&2){let e=h(),a=h();p(),C("queryParams",X(1,Wn,a.yamcs.context)),p(),ne(e)}}function Bc(t,i){t&1&&v(0,Fc,4,3,"ya-breadcrumb-trail"),t&2&&x(i.length?0:-1)}function $c(t,i){if(t&1){let e=N();l(0,"input",33),E("change",function(n){k(e);let r=h(3);return A(n?r.masterToggle():null)}),o()}if(t&2){let e=h(3);C("checked",e.selection.hasValue()&&e.isAllSelected())}}function Hc(t,i){if(t&1&&(l(0,"th",31),v(1,$c,1,1,"input",32),o()),t&2){let e=h(2);p(),x(e.mayManageDisplays()?1:-1)}}function Yc(t,i){if(t&1){let e=N();l(0,"input",35),E("click",function(n){return k(e),A(n.stopPropagation())})("change",function(n){k(e);let r=h().$implicit,c=h(2);return A(n?c.selection.toggle(r):null)}),o()}if(t&2){let e=h().$implicit,a=h(2);C("checked",a.selection.isSelected(e))}}function Gc(t,i){if(t&1&&(l(0,"td",34),v(1,Yc,1,1,"input",32),o()),t&2){let e=h(2);p(),x(e.mayManageDisplays()?1:-1)}}function Uc(t,i){t&1&&(l(0,"th",36),s(1,"Name"),o())}function zc(t,i){if(t&1){let e=N();l(0,"mat-icon",38),s(1," folder "),o(),l(2,"a",39),E("click",function(n){return k(e),A(n.stopPropagation())}),s(3),w(4,"filename"),o()}if(t&2){let e=h().$implicit,a=h(2);p(2),C("routerLink","/telemetry/displays/browse/"+e.name)("queryParams",X(5,Wn,a.yamcs.context)),p(),L(" ",D(4,3,e.name)," ")}}function Wc(t,i){if(t&1){let e=N();l(0,"mat-icon",38),s(1," description "),o(),l(2,"a",39),E("click",function(n){return k(e),A(n.stopPropagation())}),s(3),w(4,"filename"),o()}if(t&2){let e=h().$implicit,a=h(2);p(2),C("routerLink","/telemetry/displays/files/"+e.name)("queryParams",X(5,Wn,a.yamcs.context)),p(),L(" ",D(4,3,e.name)," ")}}function jc(t,i){if(t&1&&(l(0,"td",37),v(1,zc,5,7)(2,Wc,5,7),o()),t&2){let e=i.$implicit;p(),x(e.folder?1:2)}}function qc(t,i){t&1&&(l(0,"th",36),s(1,"Type"),o())}function Xc(t,i){t&1&&s(0," Folder ")}function Zc(t,i){if(t&1&&(s(0),w(1,"displayType")),t&2){let e=h().$implicit;L(" ",D(1,1,e.name)||"-"," ")}}function Qc(t,i){if(t&1&&(l(0,"td",37),v(1,Xc,1,0)(2,Zc,2,3),o()),t&2){let e=i.$implicit;p(),x(e.folder?1:2)}}function Kc(t,i){t&1&&(l(0,"th",36),s(1,"Visibility"),o())}function Jc(t,i){t&1&&(l(0,"td",37),s(1,"Private"),o())}function ep(t,i){t&1&&(l(0,"th",36),s(1,"Date modified"),o())}function tp(t,i){if(t&1&&(l(0,"td",37),s(1),w(2,"datetime"),o()),t&2){let e=i.$implicit;p(),L(" ",D(2,1,e.modified)||"-"," ")}}function ip(t,i){t&1&&b(0,"th",40)}function ap(t,i){if(t&1){let e=N();l(0,"ya-more")(1,"button",41),E("click",function(){k(e);let n=h(2).$implicit,r=h(2);return A(r.renameFile(n))}),s(2,"Rename"),o(),l(3,"a",42),s(4,"Download"),o(),b(5,"mat-divider"),l(6,"button",41),E("click",function(){k(e);let n=h(2).$implicit,r=h(2);return A(r.deleteFile(n))}),s(7,"Delete"),o()()}if(t&2){let e=h(2).$implicit;p(3),C("href",e.objectUrl,Za)}}function np(t,i){if(t&1&&v(0,ap,8,1,"ya-more"),t&2){let e=h(3);x(e.mayManageDisplays()?0:-1)}}function rp(t,i){if(t&1&&(l(0,"td",37),v(1,np,1,1),o()),t&2){let e=i.$implicit;p(),x(e.folder?-1:1)}}function op(t,i){t&1&&b(0,"tr",43)}function lp(t,i){if(t&1){let e=N();l(0,"tr",44),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.toggleOne(n))}),o()}if(t&2){let e=i.$implicit,a=h(2);pe("selected",a.selection.isSelected(e))}}function sp(t,i){if(t&1&&(l(0,"table",9),$(1,17),v(2,Hc,2,1,"th",18)(3,Gc,2,1,"td",19),H(),$(4,20),v(5,Uc,2,0,"th",21)(6,jc,3,1,"td",22),H(),$(7,23),v(8,qc,2,0,"th",21)(9,Qc,3,1,"td",22),H(),$(10,24),v(11,Kc,2,0,"th",21)(12,Jc,2,0,"td",22),H(),$(13,25),v(14,ep,2,0,"th",21)(15,tp,3,3,"td",22),H(),$(16,26),v(17,ip,1,0,"th",27)(18,rp,2,1,"td",28),H(),v(19,op,1,0,"tr",29)(20,lp,1,2,"tr",30),o()),t&2){let e=h();C("dataSource",e.dataSource),p(19),C("cdkHeaderRowDef",e.displayedColumns),p(),C("cdkRowDefColumns",e.displayedColumns)}}function cp(t,i){t&1&&(l(0,"ya-empty-message"),s(1,"Empty directory."),o())}var zn=class t{constructor(i,e,a,n,r,c,d,m){this.dialog=i;this.yamcs=e;this.router=n;this.route=r;this.authService=c;this.messageService=d;this.breadcrumb$=new B([]);this.dragActive$=new B(!1);this.displayedColumns=["select","name","type","modified","actions"];this.dataSource=new Lt([]);this.selection=new Vi(!0,[]);a.setTitle("Displays"),this.storageClient=e.createStorageClient(),this.bucket=m.getDisplayBucket(),this.loadCurrentFolder(),this.routerSubscription=n.events.pipe(za(u=>u instanceof tn)).subscribe(()=>{this.loadCurrentFolder()})}loadCurrentFolder(){let i={delimiter:"/"},e=this.route.snapshot.url;e.length&&(i.prefix=e.map(a=>a.path).join("/")+"/"),this.storageClient.listObjects(this.bucket,i).then(a=>{this.updateBrowsePath(),this.changedir(a)})}changedir(i){this.selection.clear();let e=[];for(let a of i.prefixes||[])e.push({folder:!0,name:a});for(let a of i.objects||[])a.name.endsWith("/")||e.push({folder:!1,name:a.name,modified:a.created,objectUrl:this.storageClient.getObjectURL(this.bucket,a.name)});this.dataSource.data=e}isAllSelected(){let i=this.selection.selected.length,e=this.dataSource.filteredData.length;return i===e&&e>0}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.filteredData.forEach(i=>this.selection.select(i))}toggleOne(i){(!this.selection.isSelected(i)||this.selection.selected.length>1)&&this.selection.clear(),this.selection.toggle(i)}createDisplay(){this.dialog.open(Hn,{width:"400px",data:{path:this.getCurrentPath(),prefix:""}}).afterClosed().subscribe(e=>{e&&this.router.navigateByUrl(`/telemetry/displays/files/${e}?c=${this.yamcs.context}`)})}createFolder(){this.dialog.open(Yn,{width:"400px",data:{bucket:this.bucket,path:this.getCurrentPath()}}).afterClosed().subscribe({next:()=>this.loadCurrentFolder()})}uploadFiles(){let i=this.getCurrentPath();i.startsWith("/")&&(i=i.substring(1));let e=this.uploaderEl.nativeElement.files,a=[];for(let n in e)if(!isNaN(parseInt(n,10))){let r=e[n],m=""+(i?i+"/"+r.name:r.name),u=this.storageClient.uploadObject(this.bucket,m,r);a.push(u)}Promise.all(a).then(()=>this.loadCurrentFolder()).catch(n=>this.messageService.showError(n))}getCurrentPath(){let i="";for(let e of this.route.snapshot.url)i+="/"+e.path;return i||"/"}deleteSelectedDisplays(){let i=[],e=[];for(let a of this.selection.selected)a.folder?e.push(this.storageClient.listObjects(this.bucket,{prefix:a.name}).then(n=>{let r=n.objects||[];i.push(...r.map(c=>c.name))})):i.push(a.name);Promise.all(e).then(()=>{if(confirm(`You are about to delete ${i.length} files. Are you sure you want to continue?`)){let a=[];for(let n of i)a.push(this.storageClient.deleteObject(this.bucket,n));Promise.all(a).then(()=>{this.loadCurrentFolder()})}})}renameFile(i){this.dialog.open(Gn,{data:{name:i.name},width:"400px"}).afterClosed().subscribe(a=>{a&&this.loadCurrentFolder()})}deleteFile(i){confirm(`Are you sure you want to delete ${i.name}?`)&&this.storageClient.deleteObject(this.bucket,i.name).then(()=>{this.loadCurrentFolder()})}dragEnter(i){return this.dragActive$.next(!0),i.preventDefault(),i.stopPropagation(),!1}dragOver(i){return i.preventDefault(),i.stopPropagation(),!1}dragLeave(i){return this.dragActive$.next(!1),i.preventDefault(),i.stopPropagation(),!1}drop(i){let e=i.dataTransfer||{};if(e){let a=this.getCurrentPath().substring(1);a!==""&&(a+="/"),_l(e).then(n=>{let r=[];for(let c of n){let d=a+c._fullPath,m=this.storageClient.uploadObject(this.bucket,d,c);r.push(m)}Promise.all(r).finally(()=>{this.loadCurrentFolder()})})}return this.dragActive$.next(!1),i.preventDefault(),i.stopPropagation(),!1}mayManageDisplays(){let i=this.authService.getUser();return i.hasObjectPrivilege("ManageBucket",this.bucket)||i.hasSystemPrivilege("ManageAnyBucket")}updateBrowsePath(){let i=[],e="";for(let a of this.route.snapshot.url)e+="/"+a.path,i.push({name:a.path,route:"/telemetry/displays/browse"+e});return this.breadcrumb$.next(i),e||"/"}ngOnDestroy(){this.routerSubscription?.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(T(Ne),T(q),T(bt),T(Oe),T(we),T(gt),T(ft),T(ye))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],viewQuery:function(e,a){if(e&1&&(fe(Mc,7),fe(Rc,5)),e&2){let n;ue(n=he())&&(a.dropArea=n.first),ue(n=he())&&(a.uploaderEl=n.first)}},decls:17,vars:16,consts:[["droparea",""],["uploader",""],["icon","add_circle_outline"],["icon","file_upload"],["icon","create_new_folder"],["icon","delete",3,"disabled"],[1,"droparea",3,"dragenter"],[1,"droparea-overlay",3,"dragover","dragleave","drop"],[1,"panel-content"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["icon","add_circle_outline",3,"clicked"],["icon","file_upload",3,"clicked"],["type","file","hidden","","multiple","",3,"change"],["icon","create_new_folder",3,"clicked"],["icon","delete",3,"clicked","disabled"],["link","/telemetry/displays/browse","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label"],["cdkColumnDef","select"],["mat-header-cell","","class","checkbox",4,"cdkHeaderCellDef"],["mat-cell","","class","checkbox",4,"cdkCellDef"],["cdkColumnDef","name"],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["cdkColumnDef","type"],["cdkColumnDef","visibility"],["cdkColumnDef","modified"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"cdkHeaderRowDef"],["mat-row","",3,"selected","click",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell","",1,"checkbox"],["type","checkbox",3,"checked"],["type","checkbox",3,"change","checked"],["mat-cell","",1,"checkbox"],["type","checkbox",3,"click","change","checked"],["mat-header-cell",""],["mat-cell",""],[1,"icon12",2,"vertical-align","middle","margin-right","7px"],[3,"click","routerLink","queryParams"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"click"],["mat-menu-item","","download","",3,"href"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,a){if(e&1){let n=N();l(0,"app-instance-page")(1,"app-instance-toolbar"),s(2," Displays \xA0\xA0\xA0 "),v(3,Ic,2,0,"ya-page-button",2)(4,Lc,4,0,"ya-page-button",3)(5,Oc,2,0,"ya-page-button",4)(6,Vc,2,1,"ya-page-button",5),o(),l(7,"div",6,0),w(9,"async"),E("dragenter",function(c){return k(n),A(a.dragEnter(c))}),l(10,"div",7),w(11,"async"),E("dragover",function(c){return k(n),A(a.dragOver(c))})("dragleave",function(c){return k(n),A(a.dragLeave(c))})("drop",function(c){return k(n),A(a.drop(c))}),o(),l(12,"div",8),v(13,Bc,1,1),w(14,"async"),v(15,sp,21,3,"table",9)(16,cp,2,0,"ya-empty-message"),o()()()}if(e&2){let n;p(3),x(a.mayManageDisplays()?3:-1),p(),x(a.mayManageDisplays()?4:-1),p(),x(a.mayManageDisplays()?5:-1),p(),x(a.mayManageDisplays()?6:-1),p(),pe("active",D(9,10,a.dragActive$)),p(3),pe("hide",!D(11,12,a.dragActive$)),p(3),x((n=D(14,14,a.breadcrumb$))?13:-1,n),p(2),x(a.dataSource&&a.dataSource.data.length?15:16)}},dependencies:[Un,Je,Ke,G,J,Re,si,It,oi,li,zi,St,zt,pt,He,ut,at,dt,Ye,Ge,Ue,ze,fn,hn,qt,Ot,nt,Pe,vn],styles:[".droparea[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;overflow:auto}.droparea-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;box-sizing:border-box;background:#1b61b91a;border:1px solid rgba(27,97,185,1);z-index:10}"],changeDetection:0})}};var jn=class t{static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-display-page"]],decls:1,vars:0,template:function(e,a){e&1&&b(0,"router-outlet")},dependencies:[ri],encapsulation:2,changeDetection:0})}};var qn=class t{static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-displays-page"]],decls:1,vars:0,template:function(e,a){e&1&&b(0,"router-outlet")},dependencies:[ri],encapsulation:2,changeDetection:0})}};var Xn=class t{constructor(i){this.yamcs=i}transform(i){if(!i)return null;let e=this.yamcs.instance;return this.yamcs.yamcsClient.getPacketDownloadURL(e,i.id.name,i.generationTime,i.sequenceNumber)}static{this.\u0275fac=function(e){return new(e||t)(T(q,16))}}static{this.\u0275pipe=Ja({name:"packetDownloadLink",type:t,pure:!0})}};var Zn=class{constructor(){this.dirty=!1;this.archivePackets=[]}addArchiveData(i){this.archivePackets=this.archivePackets.concat(i),this.dirty=!0}reset(){this.archivePackets=[],this.dirty=!0}snapshot(){return this.archivePackets}};var Qn=class extends Yt{constructor(e,a){super();this.yamcs=e;this.pageSize=100;this.blockHasMore=!1;this.packets$=new B([]);this.loading$=new B(!1);this.syncSubscription=a.sync(()=>{this.buffer.dirty&&!this.loading$.getValue()&&(this.emitPackets(),this.buffer.dirty=!1)}),this.buffer=new Zn}connect(){return this.packets$}emitPackets(){this.packets$.next(this.buffer.snapshot())}loadEntries(e,a){return this.loading$.next(!0),this.loadPage(yt(et({},a),{limit:this.pageSize})).then(n=>{this.loading$.next(!1),this.buffer.reset(),this.blockHasMore=!1,this.buffer.addArchiveData(n),this.emitPackets()})}hasMore(){return!!this.continuationToken&&!this.blockHasMore}loadPage(e){return this.yamcs.yamcsClient.getPackets(this.yamcs.instance,yt(et({},e),{fields:["id","generationTime","earthReceptionTime","receptionTime","sequenceNumber","link","size"]})).then(a=>(this.continuationToken=a.continuationToken,a.packet||[]))}loadMoreData(e){this.continuationToken&&this.loadPage(yt(et({},e),{next:this.continuationToken,limit:this.pageSize})).then(a=>{this.buffer.addArchiveData(a),this.emitPackets()})}disconnect(){this.syncSubscription?.unsubscribe(),this.packets$.complete(),this.loading$.complete()}isEmpty(){return!this.packets$.getValue().length}};function pp(t,i){if(t&1&&(s(0),w(1,"deltaWith")),t&2){let e=h();L(" (",We(1,1,e.earthReceptionTime,e.generationTime),") ")}}function mp(t,i){if(t&1){let e=N();l(0,"ya-detail-toolbar"),s(1,"Packet detail"),o(),l(2,"div",31)(3,"div",32),s(4,"Packet name"),o(),l(5,"div",33),s(6),o(),l(7,"div",32),s(8,"Generation time"),o(),l(9,"div",33),s(10),w(11,"datetime"),o(),l(12,"div",32),s(13,"Earth reception time"),o(),l(14,"div",33),s(15),w(16,"datetime"),v(17,pp,2,4),o(),l(18,"div",32),s(19,"Reception time"),o(),l(20,"div",33),s(21),w(22,"datetime"),w(23,"deltaWith"),o(),l(24,"div",32),s(25,"Link"),o(),l(26,"div",33),s(27),o(),l(28,"div",32),s(29,"Size"),o(),l(30,"div",33),s(31),w(32,"formatBytes"),o(),l(33,"div",32),s(34," Data "),l(35,"ya-more",34)(36,"button",35),E("click",function(){let n=k(e),r=h();return A(r.copyHex(n))}),s(37,"Copy hex"),o(),l(38,"button",35),E("click",function(){let n=k(e),r=h();return A(r.copyBinary(n))}),s(39,"Copy binary"),o(),b(40,"mat-divider"),l(41,"ya-download-menu-item",4),w(42,"packetDownloadLink"),s(43," Download "),o()()(),l(44,"div",36),b(45,"app-hex",37,2),o()()}if(t&2){let e=i;p(6),L(" ",e.id.name," "),p(4),L(" ",D(11,10,e.generationTime)," "),p(5),L(" ",D(16,12,e.earthReceptionTime)||"-"," "),p(2),x(e.earthReceptionTime?17:-1),p(4),$t(" ",D(22,14,e.receptionTime)," (",We(23,16,e.receptionTime,e.generationTime),") "),p(6),L(" ",e.link||"-"," "),p(4),L(" ",D(32,19,e.size)," "),p(10),C("link",D(42,21,e)),p(4),C("base64String",e.packet)}}function dp(t,i){t&1&&(l(0,"ya-detail-toolbar"),s(1,"Select a packet"),o())}function up(t,i){if(t&1){let e=N();b(0,"ya-date-time-input",38)(1,"ya-date-time-input",39),l(2,"ya-button",30),E("click",function(){k(e);let n=h();return A(n.applyCustomDates())}),s(3," Apply "),o()}if(t&2){let e=h();p(2),C("disabled",e.filterForm.invalid)}}function hp(t,i){if(t&1){let e=N();l(0,"ya-button",40),E("click",function(){k(e);let n=h();return A(n.jumpToNow())}),s(1,"Jump to now"),o()}}function fp(t,i){t&1&&b(0,"ya-dots")}function _p(t,i){t&1&&(l(0,"th",41),s(1,"Packet name"),o())}function gp(t,i){if(t&1&&(l(0,"td",42),s(1),o()),t&2){let e=i.$implicit;p(),L(" ",e.id.name," ")}}function vp(t,i){t&1&&(l(0,"th",41),s(1,"Generation time"),o())}function yp(t,i){if(t&1&&(l(0,"td",42),s(1),w(2,"datetime"),o()),t&2){let e=i.$implicit;p(),L(" ",D(2,1,e.generationTime)," ")}}function Cp(t,i){t&1&&(l(0,"th",41),s(1,"Seq"),o())}function xp(t,i){if(t&1&&(l(0,"td",42),s(1),o()),t&2){let e,a=i.$implicit;p(),L(" ",(e=a.sequenceNumber)!==null&&e!==void 0?e:"-"," ")}}function bp(t,i){t&1&&(l(0,"th",41),s(1,"Earth reception time"),o())}function Sp(t,i){if(t&1&&(l(0,"td",42),s(1),w(2,"datetime"),o()),t&2){let e=i.$implicit;p(),L(" ",D(2,1,e.earthReceptionTime)||"-"," ")}}function wp(t,i){t&1&&(l(0,"th",41),s(1,"Reception time"),o())}function Tp(t,i){if(t&1&&(l(0,"td",42),s(1),w(2,"datetime"),o()),t&2){let e=i.$implicit;p(),L(" ",D(2,1,e.receptionTime)," ")}}function Dp(t,i){t&1&&(l(0,"th",41),s(1,"Link"),o())}function Pp(t,i){if(t&1&&(l(0,"td",42),s(1),o()),t&2){let e=i.$implicit;p(),L(" ",e.link||"-"," ")}}function Ep(t,i){t&1&&(l(0,"th",41),s(1,"Size"),o())}function kp(t,i){if(t&1&&(l(0,"td",42),s(1),w(2,"formatBytes"),o()),t&2){let e=i.$implicit;p(),L(" ",D(2,1,e.size)," ")}}function Ap(t,i){t&1&&b(0,"th",43)}function Mp(t,i){if(t&1){let e=N();l(0,"td",42)(1,"ya-text-action",44),E("click",function(){let n=k(e).$implicit,r=h();return A(r.extractPacket(n))}),s(2,"Extract"),o(),l(3,"ya-more")(4,"button",35),E("click",function(){let n=k(e).$implicit,r=h();return A(r.copyHex(n))}),s(5,"Copy hex"),o(),l(6,"button",35),E("click",function(){let n=k(e).$implicit,r=h();return A(r.copyBinary(n))}),s(7,"Copy binary"),o(),b(8,"mat-divider"),l(9,"ya-download-menu-item",4),w(10,"packetDownloadLink"),s(11," Download "),o()()()}if(t&2){let e=i.$implicit;p(9),C("link",D(10,1,e))}}function Rp(t,i){t&1&&b(0,"tr",45)}function Ip(t,i){if(t&1){let e=N();l(0,"tr",46),E("click",function(){let n=k(e).$implicit,r=h();return A(r.selectPacket(n))}),o()}if(t&2){let e=i.$implicit,a=h();pe("selected",a.isSelected(e))}}var Aa="PT1H",Kn=class t extends Wi{constructor(e,a,n){super();this.yamcs=e;this.route=a;this.clipboard=n;this.columns=[{id:"packetName",label:"Packet name",alwaysVisible:!0},{id:"generationTime",label:"Generation time",alwaysVisible:!0},{id:"earthReceptionTime",label:"Earth reception time",visible:!1},{id:"receptionTime",label:"Reception time",visible:!0},{id:"sequenceNumber",label:"Sequence number",visible:!1},{id:"link",label:"Link",visible:!0},{id:"size",label:"Size",visible:!0},{id:"actions",label:"",alwaysVisible:!0}];this.filterForm=new it({name:new ee("ANY"),link:new ee("ANY"),interval:new ee(Aa),customStart:new ee(null),customStop:new ee(null)});this.detailPacket$=new B(null);this.nameOptions$=new B([{id:"ANY",label:"Any name"}]);this.linkOptions$=new B([{id:"ANY",label:"Any link"}]);this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom",group:!0}];this.downloadURL$=new B(null);this.setTitle("Packets"),this.dataSource=new Qn(this.yamcs,this.synchronizer),e.yamcsClient.getPacketNames(e.instance).then(r=>{for(let c of r.packets||[])this.nameOptions$.next([...this.nameOptions$.value,{id:c,label:c}]);for(let c of r.links||[])this.linkOptions$.next([...this.linkOptions$.value,{id:c,label:c}])}),this.initializeOptions(),this.loadData(),this.filterForm.get("name").valueChanges.forEach(r=>{this.name=r!=="ANY"?r:null,this.loadData()}),this.filterForm.get("link").valueChanges.forEach(r=>{this.link=r!=="ANY"?r:null,this.loadData()}),this.filterForm.get("interval").valueChanges.forEach(r=>{if(r==="CUSTOM"){let c=this.validStart||this.yamcs.getMissionTime(),d=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(F.toISOString(c)),this.filterForm.get("customStop").setValue(F.toISOString(d))}else r==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=r,this.loadData()):(this.validStop=e.getMissionTime(),this.validStart=F.subtractDuration(this.validStop,r),this.appliedInterval=r,this.loadData())})}initializeOptions(){let e=this.route.snapshot.queryParamMap;if(e.has("name")&&(this.name=e.get("name")||"",this.filterForm.get("name").setValue(this.name)),e.has("link")&&(this.link=e.get("link")||"",this.filterForm.get("link").setValue(this.link)),e.has("interval"))if(this.appliedInterval=e.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let a=e.get("customStart");this.filterForm.get("customStart").setValue(a),this.validStart=new Date(a);let n=e.get("customStop");this.filterForm.get("customStop").setValue(n),this.validStop=new Date(n)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=F.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=Aa,this.validStop=this.yamcs.getMissionTime(),this.validStart=F.subtractDuration(this.validStop,Aa)}jumpToNow(){let e=this.filterForm.value.interval;e==="NO_LIMIT"?this.filterForm.get("interval").setValue(Aa):e==="CUSTOM"?this.filterForm.get("interval").setValue(Aa):(this.validStop=this.yamcs.getMissionTime(),this.validStart=F.subtractDuration(this.validStop,e),this.loadData())}applyCustomDates(){this.validStart=F.toDate(this.filterForm.value.customStart),this.validStop=F.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();let e={};this.validStart&&(e.start=this.validStart.toISOString()),this.validStop&&(e.stop=this.validStop.toISOString()),this.name&&(e.name=this.name),this.link&&(e.link=this.link);let a={};this.validStart&&(a.start=this.validStart.toISOString()),this.validStop&&(a.stop=this.validStop.toISOString()),this.name&&(a.name=this.name),this.link&&(a.link=this.link),this.dataSource.loadEntries("realtime",e).then(n=>{let r=this.yamcs.yamcsClient.getPacketsDownloadURL(this.yamcs.instance,a);this.downloadURL$.next(r)})}loadMoreData(){let e={};this.validStart&&(e.start=this.validStart.toISOString()),this.name&&(e.name=this.name),this.link&&(e.link=this.link),this.dataSource.loadMoreData(e)}copyHex(e){this.fetchPacket(e).then(a=>{let n=F.convertBase64ToHex(a.packet??"");this.clipboard.copy(n)?this.messageService.showInfo("Hex copied"):this.messageService.showInfo("Hex copy failed")}).catch(a=>this.messageService.showError(a))}copyBinary(e){this.fetchPacket(e).then(a=>{let n=window.atob(a.packet??"");this.clipboard.copy(n)?this.messageService.showInfo("Binary copied"):this.messageService.showInfo("Binary copy failed")}).catch(a=>this.messageService.showError(a))}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{name:this.name||null,link:this.link||null,interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStart:null,customStop:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}selectPacket(e){this.fetchPacket(e).then(a=>{this.detailPacket$.next(a),this.openDetailPane()}).catch(a=>this.messageService.showError(a))}fetchPacket(e){return this.yamcs.yamcsClient.getPacket(this.yamcs.instance,e.id.name,e.generationTime,e.sequenceNumber)}extractPacket(e){this.router.navigate(["/telemetry/packets"+e.id.name,"-","log",e.generationTime,e.sequenceNumber],{queryParams:{c:this.yamcs.context}})}isSelected(e){let a=this.detailPacket$.value;return a?e.id.name===a.id.name&&e.generationTime===a.generationTime&&e.sequenceNumber===a.sequenceNumber:!1}static{this.\u0275fac=function(a){return new(a||t)(T(q),T(we),T(Ui))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],features:[Ii],decls:65,vars:32,consts:[["exportMenu","matMenu"],["columnChooser",""],["hexdump",""],[1,"ya-menu"],[3,"link"],["icon","save_alt",3,"matMenuTriggerFor","disabled"],["matTooltip","Jump to now","icon","refresh",3,"clicked"],[1,"table-wrapper"],[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["formControlName","name",3,"options"],["formControlName","link",3,"options"],["icon","access_time","formControlName","interval",3,"options"],["preferenceKey","tmPackets",3,"columns"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","packetName"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","generationTime"],["matColumnDef","sequenceNumber"],["matColumnDef","earthReceptionTime"],["matColumnDef","receptionTime"],["matColumnDef","link"],["matColumnDef","size"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],[2,"flex","1 1 auto"],[3,"click","disabled"],[2,"padding","0 16px"],[1,"block-title"],[1,"block"],["icon","more_horiz"],["mat-menu-item","",3,"click"],[1,"block",2,"margin-top","4px"],[3,"base64String"],["formControlName","customStart"],["formControlName","customStop"],[3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"expand"],["icon","output",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(a,n){if(a&1){let r=N();l(0,"app-instance-page")(1,"app-instance-toolbar"),s(2," Packets \xA0\xA0\xA0 "),l(3,"mat-menu",3,0)(5,"ya-download-menu-item",4),w(6,"async"),s(7,"Raw dump"),o()(),l(8,"ya-page-button",5),w(9,"async"),s(10," Export "),o(),l(11,"ya-page-icon-button",6),E("clicked",function(){return k(r),A(n.jumpToNow())}),o()(),l(12,"ya-detail-pane"),v(13,mp,47,23),w(14,"async"),v(15,dp,2,0,"ya-detail-toolbar"),o(),l(16,"div",7)(17,"div",8)(18,"form",9)(19,"div",10),b(20,"ya-select",11),w(21,"async"),b(22,"ya-select",12),w(23,"async"),b(24,"ya-select",13),v(25,up,4,1)(26,hp,2,0,"ya-button"),b(27,"ya-column-chooser",14,1),v(29,fp,1,0,"ya-dots"),w(30,"async"),o()(),l(31,"table",15),$(32,16),v(33,_p,2,0,"th",17)(34,gp,2,1,"td",18),H(),$(35,19),v(36,vp,2,0,"th",17)(37,yp,3,3,"td",18),H(),$(38,20),v(39,Cp,2,0,"th",17)(40,xp,2,1,"td",18),H(),$(41,21),v(42,bp,2,0,"th",17)(43,Sp,3,3,"td",18),H(),$(44,22),v(45,wp,2,0,"th",17)(46,Tp,3,3,"td",18),H(),$(47,23),v(48,Dp,2,0,"th",17)(49,Pp,2,1,"td",18),H(),$(50,24),v(51,Ep,2,0,"th",17)(52,kp,3,3,"td",18),H(),$(53,25),v(54,Ap,1,0,"th",26)(55,Mp,12,3,"td",18),H(),v(56,Rp,1,0,"tr",27),w(57,"async"),v(58,Ip,1,2,"tr",28),w(59,"async"),o(),l(60,"mat-toolbar"),b(61,"span",29),l(62,"ya-button",30),E("click",function(){return k(r),A(n.loadMoreData())}),s(63,"Load more"),o(),b(64,"span",29),o()()()()}if(a&2){let r,c,d=oe(4),m=oe(28);p(5),C("link",D(6,16,n.downloadURL$)),p(3),C("matMenuTriggerFor",d)("disabled",!((r=D(9,18,n.dataSource.packets$))!=null&&r.length)),p(5),x((c=D(14,20,n.detailPacket$))?13:15,c),p(5),C("formGroup",n.filterForm),p(2),C("options",D(21,22,n.nameOptions$)),p(2),C("options",D(23,24,n.linkOptions$)),p(2),C("options",n.intervalOptions),p(),x(n.filterForm.value.interval==="CUSTOM"?25:-1),p(),x(n.filterForm.value.interval!=="CUSTOM"?26:-1),p(),C("columns",n.columns),p(2),x(D(30,26,n.dataSource.loading$)?29:-1),p(2),C("dataSource",n.dataSource),p(25),C("matHeaderRowDef",D(57,28,m.displayedColumns$)),p(2),C("matRowDefColumns",D(59,30,m.displayedColumns$)),p(4),C("disabled",!n.dataSource.hasMore())}},dependencies:[Ji,Je,Ke,Xn,G,J,Te,me,xe,be,De,zt,Hi,pt,Yi,He,ut,ht,at,dt,wt,Ye,Ge,Ue,ze,Gi,$i,_e,Wt,_t,qi,Xi,jt,el,Ot,nt,Qt,Dt,Zt,Pe,Qi,sl],styles:[".detail[_ngcontent-%COMP%]{background-color:#fcfcfc;float:right;height:100%;width:450px;overflow:auto;border-left:1px solid #d3d3d3;box-sizing:border-box}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}.table-wrapper[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{cursor:pointer}"],changeDetection:0})}};var Lp=["hex"],Ma=t=>({c:t}),to=()=>[];function Op(t,i){if(t&1&&(l(0,"tr")(1,"td",43)(2,"mat-icon",44),s(3,"warning"),o()(),l(4,"td",45),s(5),o()()),t&2){let e=i.$implicit;p(5),W(e)}}function Vp(t,i){if(t&1&&(l(0,"h4"),s(1,"Warnings"),o(),l(2,"table",41),ae(3,Op,6,1,"tr",null,ie),w(5,"async"),o(),l(6,"div",42),b(7,"mat-divider"),o()),t&2){let e=h(2);p(3),ne(D(5,0,e.messages$))}}function Np(t,i){t&1&&b(0,"th",46)}function Fp(t,i){if(t&1&&b(0,"ya-icon-action",48),t&2){let e=h().$implicit;C("icon",e.expanded?"expand_more":"chevron_right")("padding",!1)}}function Bp(t,i){if(t&1&&(l(0,"td",47),v(1,Fp,1,2,"ya-icon-action",48),o()),t&2){let e=i.$implicit;p(),x(e.type==="CONTAINER"?1:-1)}}function $p(t,i){t&1&&(l(0,"th",49),s(1,"Loc"),o())}function Hp(t,i){if(t&1&&s(0),t&2){let e=h().$implicit;L(" ",e.location," ")}}function Yp(t,i){if(t&1&&(l(0,"td",50),v(1,Hp,1,1),o()),t&2){let e=i.$implicit;p(),x(e.type==="SIMPLE_PARAMETER"||e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER"?1:-1)}}function Gp(t,i){t&1&&(l(0,"th",46),s(1,"Bits"),o())}function Up(t,i){if(t&1&&s(0),t&2){let e=h().$implicit;L(" ",e.size," ")}}function zp(t,i){if(t&1&&(l(0,"td",51),v(1,Up,1,1),o()),t&2){let e=i.$implicit;p(),x(e.type==="SIMPLE_PARAMETER"||e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER"?1:-1)}}function Wp(t,i){t&1&&b(0,"th",52)}function jp(t,i){if(t&1&&b(0,"ya-icon-action",54),t&2){let e=h().$implicit;C("icon",e.expanded?"expand_more":"chevron_right")}}function qp(t,i){if(t&1&&(l(0,"td",53),v(1,jp,1,1,"ya-icon-action",54),o()),t&2){let e=i.$implicit;p(),x(e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER"?1:-1)}}function Xp(t,i){t&1&&(l(0,"th",55),s(1,"Entry"),o())}function Zp(t,i){if(t&1&&(l(0,"a",57),s(1),o()),t&2){let e=h().$implicit,a=h(2);C("routerLink","/telemetry/parameters"+e.parameter.qualifiedName)("queryParams",X(3,Ma,a.yamcs.context)),p(),L(" ",e.parameter.qualifiedName," ")}}function Qp(t,i){t&1&&(l(0,"mat-icon",58),s(1,"chevron_right"),o())}function Kp(t,i){if(t&1&&(ae(0,Qp,2,0,"mat-icon",58,ie),l(2,"a",57),s(3),o()),t&2){let e=h().$implicit,a=h(2);ne(Li(3,to).constructor(e.depth)),p(2),C("routerLink","/telemetry/parameters"+e.parameter.qualifiedName+e.offset)("queryParams",X(4,Ma,a.yamcs.context)),p(),L(" ",e.name," ")}}function Jp(t,i){if(t&1&&(l(0,"mat-icon",44),s(1),o()),t&2){let e=i.$index,a=i.$count,n=h(2).$implicit;Ct("visibility",e===a-1?"visible":"hidden"),p(),L(" ",n.expanded?"expand_more":"chevron_right"," ")}}function em(t,i){if(t&1&&(ae(0,Jp,2,3,"mat-icon",59,ie),l(2,"a",57),s(3),o()),t&2){let e=h().$implicit,a=h(2);ne(Li(3,to).constructor(e.depth)),p(2),C("routerLink","/telemetry/parameters"+e.parameter.qualifiedName+e.offset)("queryParams",X(4,Ma,a.yamcs.context)),p(),L(" ",e.name," ")}}function tm(t,i){if(t&1&&(l(0,"mat-icon",44),s(1),o()),t&2){let e=i.$index,a=i.$count,n=h(2).$implicit;Ct("visibility",e===a-1?"visible":"hidden"),p(),L(" ",n.expanded?"expand_more":"chevron_right"," ")}}function im(t,i){if(t&1&&(ae(0,tm,2,3,"mat-icon",59,ie),l(2,"a",57),s(3),o()),t&2){let e=h().$implicit,a=h(2);ne(Li(3,to).constructor(e.depth)),p(2),C("routerLink","/telemetry/parameters"+e.parameter.qualifiedName+e.offset)("queryParams",X(4,Ma,a.yamcs.context)),p(),L(" ",e.name," ")}}function am(t,i){if(t&1&&(l(0,"td",56),v(1,Zp,2,5,"a",57)(2,Kp,4,6)(3,em,4,6)(4,im,4,6),o()),t&2){let e=i.$implicit;p(),x(e.type==="SIMPLE_PARAMETER"||e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER"?1:-1),p(),x(e.type==="SIMPLE_VALUE"?2:-1),p(),x(e.type==="AGGREGATE_VALUE"?3:-1),p(),x(e.type==="ARRAY_VALUE"?4:-1)}}function nm(t,i){t&1&&(l(0,"th",60),s(1,"Type"),o())}function rm(t,i){t&1&&s(0," container ")}function om(t,i){if(t&1&&s(0),t&2){let e=h().$implicit;L(" ",e.parameter.type.engType," ")}}function lm(t,i){if(t&1&&s(0),t&2){let e=h().$implicit;L(" ",e.parameter.type.engType," ")}}function sm(t,i){if(t&1&&s(0),t&2){let e=h().$implicit,a=h(2);L(" ",a.fillTypeWithValueDimension(e.parameter.type.engType,e.engValue==null?null:e.engValue.arrayValue)," ")}}function cm(t,i){if(t&1&&s(0),t&2){let e=h().$implicit;L(" ",e.parameterType.engType," ")}}function pm(t,i){if(t&1&&s(0),t&2){let e=h().$implicit;L(" ",e.parameterType.engType," ")}}function mm(t,i){if(t&1&&s(0),t&2){let e=h().$implicit,a=h(2);L(" ",a.fillTypeWithValueDimension(e.parameterType.engType,e.engValue==null?null:e.engValue.arrayValue)," ")}}function dm(t,i){if(t&1&&(l(0,"td",61),v(1,rm,1,0)(2,om,1,1)(3,lm,1,1)(4,sm,1,1)(5,cm,1,1)(6,pm,1,1)(7,mm,1,1),o()),t&2){let e=i.$implicit;p(),x(e.type==="CONTAINER"?1:-1),p(),x(e.type==="SIMPLE_PARAMETER"?2:-1),p(),x(e.type==="AGGREGATE_PARAMETER"?3:-1),p(),x(e.type==="ARRAY_PARAMETER"?4:-1),p(),x(e.type==="SIMPLE_VALUE"?5:-1),p(),x(e.type==="AGGREGATE_VALUE"?6:-1),p(),x(e.type==="ARRAY_VALUE"?7:-1)}}function um(t,i){t&1&&(l(0,"th",60),s(1,"Raw value"),o())}function hm(t,i){if(t&1&&b(0,"ya-value",63),t&2){let e=h();C("value",e)}}function fm(t,i){if(t&1&&b(0,"ya-value",63),t&2){let e=h();C("value",e)}}function _m(t,i){if(t&1&&v(0,hm,1,1,"ya-value",63)(1,fm,1,1,"ya-value",63),t&2){let e=h().$implicit;x(e.type==="SIMPLE_PARAMETER"?0:-1),p(),x(e.type==="SIMPLE_VALUE"?1:-1)}}function gm(t,i){if(t&1&&(l(0,"td",62),v(1,_m,2,2),o()),t&2){let e,a=i.$implicit;p(),x((e=a.rawValue)?1:-1,e)}}function vm(t,i){t&1&&(l(0,"th",60),s(1,"Engineering value"),o())}function ym(t,i){t&1&&(s(0),w(1,"units")),t&2&&L(" ",D(1,1,i)," ")}function Cm(t,i){if(t&1&&(b(0,"ya-value",63),v(1,ym,2,3)),t&2){let e,a=h(),n=h().$implicit;C("value",a),p(),x((e=n.parameter.type==null?null:n.parameter.type.unitSet)?1:-1,e)}}function xm(t,i){t&1&&(s(0),w(1,"units")),t&2&&L(" ",D(1,1,i)," ")}function bm(t,i){if(t&1&&(b(0,"ya-value",63),v(1,xm,2,3)),t&2){let e,a=h(),n=h().$implicit;C("value",a),p(),x((e=n.parameterType.unitSet)?1:-1,e)}}function Sm(t,i){if(t&1&&v(0,Cm,2,2)(1,bm,2,2),t&2){let e=h().$implicit;x(e.type==="SIMPLE_PARAMETER"?0:-1),p(),x(e.type==="SIMPLE_VALUE"?1:-1)}}function wm(t,i){if(t&1&&(l(0,"td",62),v(1,Sm,2,2),o()),t&2){let e,a=i.$implicit;p(),x((e=a.engValue)?1:-1,e)}}function Tm(t,i){t&1&&b(0,"th",64)}function Dm(t,i){if(t&1&&s(0),t&2){let e=h().$implicit;L(" ",e.container.qualifiedName," ")}}function Pm(t,i){if(t&1&&(l(0,"td",65),v(1,Dm,1,1),o()),t&2){let e=i.$implicit;Fo("colspan",4),p(),x(e.type==="CONTAINER"?1:-1)}}function Em(t,i){t&1&&b(0,"th",66)}function km(t,i){if(t&1){let e=N();l(0,"ya-more",68)(1,"button",6),E("click",function(){k(e);let n=h().$implicit,r=h(2);return A(r.selectBitRange(n))}),s(2,"Select in hex view"),o()()}t&2&&C("padding",!1)}function Am(t,i){if(t&1&&(l(0,"td",67),v(1,km,3,1,"ya-more",68),o()),t&2){let e=i.$implicit;p(),x(e.type==="SIMPLE_PARAMETER"||e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER"?1:-1)}}function Mm(t,i){t&1&&b(0,"tr",69)}function Rm(t,i){if(t&1){let e=N();l(0,"tr",70),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.toggleRow(n))}),o()}}function Im(t,i){if(t&1){let e=N();l(0,"tr",71),E("mouseover",function(){let n=k(e).$implicit,r=h(2);return A(r.highlightBitRange(n))})("mouseout",function(){k(e);let n=h(2);return A(n.clearHighlightedBitRange())})("click",function(){let n=k(e).$implicit,r=h(2);return A(r.toggleRow(n))}),o()}if(t&2){let e=i.$implicit,a=h(2);pe("expandable",a.isExpandable(e))}}function Lm(t,i){if(t&1){let e=N();l(0,"app-instance-page")(1,"app-instance-toolbar"),b(2,"ya-page-icon-button",1),s(3),l(4,"ya-page-button",2),E("clicked",function(){k(e);let n=h();return A(n.expandAll())}),s(5,"Expand all"),o(),l(6,"ya-page-button",3),E("clicked",function(){k(e);let n=h();return A(n.collapseAll())}),s(7,"Collapse all"),o()(),l(8,"ya-detail-pane",4)(9,"ya-detail-toolbar",4),s(10," Hex view "),b(11,"span",5),l(12,"ya-more")(13,"button",6),E("click",function(){let n=k(e),r=h();return A(r.copyHex(n.packet))}),s(14,"Copy hex"),o(),l(15,"button",6),E("click",function(){let n=k(e),r=h();return A(r.copyBinary(n.packet))}),s(16,"Copy binary"),o()()(),l(17,"div",7),b(18,"app-hex",8,0),o()(),l(20,"div",9)(21,"div",10),v(22,Vp,8,2),w(23,"async"),l(24,"table",11),$(25,12),v(26,Np,1,0,"th",13)(27,Bp,2,1,"td",14),H(),$(28,15),v(29,$p,2,0,"th",16)(30,Yp,2,1,"td",17),H(),$(31,18),v(32,Gp,2,0,"th",13)(33,zp,2,1,"td",19),H(),$(34,20),v(35,Wp,1,0,"th",21)(36,qp,2,1,"td",22),H(),$(37,23),v(38,Xp,2,0,"th",24)(39,am,5,4,"td",25),H(),$(40,26),v(41,nm,2,0,"th",27)(42,dm,8,7,"td",28),H(),$(43,29),v(44,um,2,0,"th",27)(45,gm,2,1,"td",30),H(),$(46,31),v(47,vm,2,0,"th",27)(48,wm,2,1,"td",30),H(),$(49,32),v(50,Tm,1,0,"th",33)(51,Pm,2,2,"td",34),H(),$(52,35),v(53,Em,1,0,"th",36)(54,Am,2,1,"td",37),H(),v(55,Mm,1,0,"tr",38)(56,Rm,1,0,"tr",39)(57,Im,1,2,"tr",40),o()()()()}if(t&2){let e,a=i,n=h();p(2),C("queryParams",X(16,Ma,n.yamcs.context)),p(),$o(" ",a.id.name," / ",a.generationTime," / ",a.sequenceNumber," \xA0\xA0\xA0 "),p(5),C("alwaysOpen",!0),p(),C("alwaysOpen",!0),p(9),C("base64String",a.packet),p(4),x((e=D(23,14,n.messages$))!=null&&e.length?22:-1),p(2),C("dataSource",n.dataSource),p(31),C("matHeaderRowDef",n.displayedColumns),p(),C("matRowDefColumns",n.containerColumns)("matRowDefWhen",n.isContainer),p(),C("matRowDefColumns",n.displayedColumns)("matRowDefWhen",n.isNoContainer)}}var Jn=class t extends Wi{constructor(e,a,n){super();this.route=e;this.yamcs=a;this.clipboard=n;this.packetName=Rt.required({alias:"packet"});this.packet$=new B(null);this.messages$=new B([]);this.allNodes=[];this.dataSource=new Lt;this.displayedColumns=["icon","location","size","expand-aggray","entry","type","rawValue","engValue","actions"];this.containerColumns=["icon","containerName","type","rawValue","engValue","actions"];this.typeOptions=[{id:"ANY",label:"Any type"},{id:"aggregate",label:"aggregate"},{id:"array",label:"array"},{id:"binary",label:"binary"},{id:"boolean",label:"boolean"},{id:"enumeration",label:"enumeration"},{id:"float",label:"float"},{id:"integer",label:"integer"},{id:"string",label:"string"},{id:"time",label:"time"}]}ngOnInit(){let e=this.packetName(),a=this.route.snapshot.paramMap.get("gentime"),n=Number(this.route.snapshot.paramMap.get("seqno"));this.setTitle(e),this.yamcs.yamcsClient.getPacket(this.yamcs.instance,e,a,n).then(r=>this.packet$.next(r)).catch(r=>this.messageService.showError(r)),this.yamcs.yamcsClient.extractPacket(this.yamcs.instance,e,a,n).then(r=>this.processResponse(r)).catch(r=>this.messageService.showError(r))}processResponse(e){this.messages$.next(e.messages||[]);let a;for(let n of e.parameterValues||[]){if(n.entryContainer.qualifiedName!==a?.container.qualifiedName){let r={type:"CONTAINER",container:n.entryContainer,expanded:!1};this.allNodes.push(r),a=r}this.addParameterNodes(a,n,this.allNodes)}a&&(a.expanded=!0),this.updateDataSource()}addParameterNodes(e,a,n){let{parameter:r,location:c,rawValue:d,engValue:m,size:u}=a;if(r.type?.engType.endsWith("[]")){let g={type:"ARRAY_PARAMETER",parent:e,expanded:!1,parameter:r,location:c,rawValue:d,engValue:m,size:u};n.push(g);let f=d?.arrayValue||[],y=m?.arrayValue||[],_=r.type.arrayInfo.type;for(let S=0;S<y.length;S++)this.addValueNode(g,r,_,"["+S+"]","["+S+"]",1,f[S],y[S],n)}else if(r.type?.engType==="aggregate"){let g={type:"AGGREGATE_PARAMETER",parent:e,expanded:!1,parameter:r,location:c,rawValue:d,engValue:m,size:u};n.push(g);let f=d.aggregateValue,y=m.aggregateValue;for(let _=0;_<y.name.length;_++){let S=r.type.member[_].type;this.addValueNode(g,r,S,y.name[_],"."+y.name[_],1,f.value[_],y.value[_],n)}}else n.push({type:"SIMPLE_PARAMETER",parent:e,expanded:!1,parameter:r,location:c,rawValue:d,engValue:m,size:u})}addValueNode(e,a,n,r,c,d,m,u,g){if(n.engType.endsWith("[]")){let f={type:"ARRAY_VALUE",parent:e,expanded:!1,parameter:a,parameterType:n,name:r,offset:c,rawValue:m,engValue:u,depth:d};g.push(f);let y=m?.arrayValue||[],_=u?.arrayValue||[];for(let S=0;S<_.length;S++)this.addValueNode(f,a,n.arrayInfo.type,"["+S+"]",c+"["+S+"]",d+1,y[S],_[S],g)}else if(n.engType==="aggregate"){let f={type:"AGGREGATE_VALUE",parent:e,expanded:!1,parameter:a,parameterType:n,name:r,offset:c,rawValue:m,engValue:u,depth:d};g.push(f);let y=m.aggregateValue,_=u.aggregateValue;for(let S=0;S<_.name.length;S++){let P=n.member[S].type;this.addValueNode(f,a,P,_.name[S],c+"."+_.name[S],d+1,y.value[S],_.value[S],g)}}else g.push({type:"SIMPLE_VALUE",parent:e,expanded:!1,parameter:a,parameterType:n,name:r,offset:c,rawValue:m,engValue:u,depth:d})}get hex(){return this._hex}set hex(e){this._hex=e}highlightBitRange(e){(e.type==="SIMPLE_PARAMETER"||e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER")&&this.hex?.setHighlight(new Qr(e.location,e.size))}clearHighlightedBitRange(){this.hex?.setHighlight(null)}selectBitRange(e){(e.type==="SIMPLE_PARAMETER"||e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER")&&this.hex?.setSelection(new Qr(e.location,e.size))}toggleRow(e){this.isExpandable(e)&&(e.expanded?this.collapseNode(e):e.expanded=!0),this.updateDataSource()}collapseNode(e){for(let a of this.allNodes)a.parent===e&&this.collapseNode(a);e.expanded=!1,this.updateDataSource()}expandAll(){for(let e of this.allNodes)this.isExpandable(e)&&(e.expanded=!0);this.updateDataSource()}collapseAll(){for(let e of this.allNodes)e.expanded=!1;this.updateDataSource()}isExpandable(e){return e.type==="CONTAINER"||e.type==="AGGREGATE_PARAMETER"||e.type==="ARRAY_PARAMETER"||e.type==="AGGREGATE_VALUE"||e.type==="ARRAY_VALUE"}updateDataSource(){let e=[];for(let a of this.allNodes)(!a.parent||a.parent?.expanded)&&e.push(a);this.dataSource.data=e}isContainer(e,a){return a.type==="CONTAINER"}isNoContainer(e,a){return a.type!=="CONTAINER"}copyHex(e){let a=F.convertBase64ToHex(e);this.clipboard.copy(a)?this.messageService.showInfo("Hex copied"):this.messageService.showInfo("Hex copy failed")}copyBinary(e){let a=window.atob(e);this.clipboard.copy(a)?this.messageService.showInfo("Binary copied"):this.messageService.showInfo("Binary copy failed")}fillTypeWithValueDimension(e,a){if(e.endsWith("[]")){let n=a?.length||0;e=e.substring(0,e.length-2)+"["+n+"]"}return e.replaceAll("[]","[?]")}static{this.\u0275fac=function(a){return new(a||t)(T(we),T(q),T(Ui))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],viewQuery:function(a,n){if(a&1&&fe(Lp,5),a&2){let r;ue(r=he())&&(n.hex=r.first)}},inputs:{packetName:[1,"packet","packetName"]},features:[Ii],decls:2,vars:3,consts:[["hex",""],["routerLink","/telemetry/packets","icon","arrow_back",3,"queryParams"],["icon","unfold_more",3,"clicked"],["icon","unfold_less",3,"clicked"],[3,"alwaysOpen"],[2,"flex","1 1 auto"],["mat-menu-item","",3,"click"],[2,"padding","0 16px"],[3,"base64String"],[1,"table-wrapper"],[1,"panel-content"],["mat-table","","multiTemplateDataRows","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","icon"],["mat-header-cell","","width","1",4,"matHeaderCellDef"],["mat-cell","","class","vtop",4,"matCellDef"],["matColumnDef","location"],["mat-header-cell","","class","no-left-padding","width","1",4,"matHeaderCellDef"],["mat-cell","","class","vtop right no-left-padding",4,"matCellDef"],["matColumnDef","size"],["mat-cell","","class","vtop right",4,"matCellDef"],["matColumnDef","expand-aggray"],["mat-header-cell","","width","1","class","icon",4,"matHeaderCellDef"],["mat-cell","","class","icon vtop",4,"matCellDef"],["matColumnDef","entry"],["mat-header-cell","","class","entry",4,"matHeaderCellDef"],["mat-cell","","class","entry vtop",4,"matCellDef"],["matColumnDef","type"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","mono vtop",4,"matCellDef"],["matColumnDef","rawValue"],["mat-cell","","class","vtop wrap200",4,"matCellDef"],["matColumnDef","engValue"],["matColumnDef","containerName"],["mat-header-cell","","class","no-left-padding",4,"matHeaderCellDef"],["mat-cell","","class","no-left-padding",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-cell","","class","icon",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","expandable container",3,"click",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["mat-row","",3,"expandable","mouseover","mouseout","click",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["yaDataTable","",1,"expand"],[1,"section-divider"],[1,"iconcol"],[1,"icon12"],[1,"expand"],["mat-header-cell","","width","1"],["mat-cell","",1,"vtop"],[3,"icon","padding"],["mat-header-cell","","width","1",1,"no-left-padding"],["mat-cell","",1,"vtop","right","no-left-padding"],["mat-cell","",1,"vtop","right"],["mat-header-cell","","width","1",1,"icon"],["mat-cell","",1,"icon","vtop"],[3,"icon"],["mat-header-cell","",1,"entry"],["mat-cell","",1,"entry","vtop"],[1,"ya-link",3,"routerLink","queryParams"],[1,"icon12",2,"visibility","hidden"],[1,"icon12",3,"visibility"],["mat-header-cell",""],["mat-cell","",1,"mono","vtop"],["mat-cell","",1,"vtop","wrap200"],[3,"value"],["mat-header-cell","",1,"no-left-padding"],["mat-cell","",1,"no-left-padding"],["mat-header-cell","",1,"expand"],["mat-cell","",1,"icon"],[3,"padding"],["mat-header-row",""],["mat-row","",1,"expandable","container",3,"click"],["mat-row","",3,"mouseover","mouseout","click"]],template:function(a,n){if(a&1&&(v(0,Lm,58,18,"app-instance-page"),w(1,"async")),a&2){let r;x((r=D(1,1,n.packet$))?0:-1,r)}},dependencies:[Ji,Je,Ke,G,J,Re,pi,St,zt,pt,He,ut,ht,at,dt,wt,Ye,Ge,Ue,ze,qi,Xi,ci,Ot,nt,Qt,Zi,Kt],styles:[".detail[_ngcontent-%COMP%]{background-color:#fcfcfc;float:right;height:100%;width:450px;overflow:auto;border-left:1px solid #d3d3d3;box-sizing:border-box}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}tr.container[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#f0f0f0}tr.container[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background-color:#f0f0f0!important}tr.expandable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{cursor:pointer}td.vtop[_ngcontent-%COMP%]{vertical-align:top}td.icon[_ngcontent-%COMP%]{padding:0;line-height:25px;text-align:right}th.entry[_ngcontent-%COMP%], td.entry[_ngcontent-%COMP%]{padding-left:7px}td.right[_ngcontent-%COMP%]{text-align:right}th.no-left-padding[_ngcontent-%COMP%], td.no-left-padding[_ngcontent-%COMP%]{padding-left:5px}.icon12[_ngcontent-%COMP%]{vertical-align:middle}"],changeDetection:0})}};var Om=t=>({c:t});function Vm(t,i){t&1&&(l(0,"tr")(1,"td",10),s(2,"No rows to display"),o()())}function Nm(t,i){if(t&1){let e=N();l(0,"tr")(1,"td"),s(2),o(),l(3,"td",11)(4,"ya-icon-action",12),E("click",function(n){let r=k(e).$index;return h(2).moveDown(r),A(n.stopPropagation())}),o(),l(5,"ya-icon-action",13),E("click",function(n){let r=k(e).$index;return h(2).moveUp(r),A(n.stopPropagation())}),o(),l(6,"ya-text-action",14),E("click",function(){let n=k(e).$index,r=h(2);return A(r.deletePattern(n))}),s(7,"DELETE"),o()()()}if(t&2){let e=i.$implicit;p(2),W(e)}}function Fm(t,i){if(t&1&&(l(0,"table",6)(1,"tr")(2,"th"),s(3,"Pattern"),o(),b(4,"th"),o(),v(5,Vm,3,0,"tr"),ae(6,Nm,8,1,"tr",null,ie),o()),t&2){let e=i;p(5),x(e.length?-1:5),p(),ne(e)}}var er=class t{constructor(i,e,a,n,r,c,d,m){this.router=a;this.route=n;this.yamcs=r;this.dialog=c;this.messageService=d;this.location=m;this.patterns$=new B([]);e.setTitle("Create a Parameter List"),this.form=i.group({name:new ee("",[Ee.required]),description:new ee})}showAddPatternDialog(){this.dialog.open(ei,{width:"500px",data:{label:"Add parameter or pattern",okLabel:"ADD",hint:"Either an exact parameter name, or a glob pattern with *, **, or ? wildcards."}}).afterClosed().subscribe(e=>{e&&this.patterns$.next([...this.patterns$.value,e])})}deletePattern(i){this.patterns$.value.splice(i,1),this.patterns$.next([...this.patterns$.value])}moveUp(i){let e=this.patterns$.value,a=e[i];i===0?(e[i]=e[e.length-1],e[e.length-1]=a):(e[i]=e[i-1],e[i-1]=a),this.patterns$.next([...this.patterns$.value])}moveDown(i){let e=this.patterns$.value,a=e[i];i===e.length-1?(e[i]=e[0],e[0]=a):(e[i]=e[i+1],e[i+1]=a),this.patterns$.next([...this.patterns$.value])}onConfirm(){let i={name:this.form.value.name,description:this.form.value.description,patterns:[...this.patterns$.value]};this.yamcs.yamcsClient.createParameterList(this.yamcs.instance,i).then(()=>this.router.navigate([".."],{relativeTo:this.route,queryParams:{c:this.yamcs.context}})).catch(e=>this.messageService.showError(e))}static{this.\u0275fac=function(e){return new(e||t)(T(Ut),T(bt),T(Oe),T(we),T(q),T(Ne),T(ft),T(en))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],decls:29,vars:8,consts:[["routerLink","..","icon","arrow_back",3,"queryParams"],[1,"form-content","ya-form"],["novalidate","",3,"formGroup"],["formControlName","name","type","text"],["formControlName","description","rows","5",2,"resize","none"],["icon","add_circle_outline",3,"click"],["yaDataTable","",2,"width","100%"],[1,"action-bar"],[3,"click"],["appearance","primary",3,"click","disabled"],["colspan","3"],[2,"text-align","right"],["icon","keyboard_arrow_down",3,"click"],["icon","keyboard_arrow_up",3,"click"],["icon","delete",3,"click"]],template:function(e,a){if(e&1&&(l(0,"app-instance-page")(1,"app-instance-toolbar"),b(2,"ya-page-icon-button",0),s(3," Create parameter list "),o(),l(4,"div",1)(5,"form",2)(6,"label"),s(7," Name "),b(8,"br")(9,"input",3),o(),b(10,"br"),l(11,"label"),s(12," Description "),b(13,"textarea",4),o()(),l(14,"p"),s(15,"\xA0"),o(),l(16,"ya-button",5),E("click",function(){return a.showAddPatternDialog()}),s(17," Add parameter or pattern "),o(),l(18,"p"),s(19,"\xA0"),o(),v(20,Fm,8,1,"table",6),w(21,"async"),l(22,"p"),s(23,"\xA0"),o(),l(24,"div",7)(25,"ya-button",8),E("click",function(){return a.location.back()}),s(26,"Cancel"),o(),l(27,"ya-button",9),E("click",function(){return a.onConfirm()}),s(28," CREATE "),o()()()()),e&2){let n;p(2),C("queryParams",X(6,Om,a.yamcs.context)),p(3),C("formGroup",a.form),p(15),x((n=D(21,4,a.patterns$))?20:-1,n),p(7),C("disabled",!a.form.valid)}},dependencies:[Je,Ke,G,J,Te,Ze,me,xe,be,De,Re,pi,_e,ci,Qt,Zt],encapsulation:2,changeDetection:0})}};function Bm(t,i){t&1&&(l(0,"tr")(1,"td",9),s(2,"No rows to display"),o()())}function $m(t,i){if(t&1){let e=N();l(0,"tr")(1,"td"),s(2),o(),l(3,"td",10)(4,"ya-icon-action",11),E("click",function(n){let r=k(e).$index;return h(3).moveDown(r),A(n.stopPropagation())}),o(),l(5,"ya-icon-action",12),E("click",function(n){let r=k(e).$index;return h(3).moveUp(r),A(n.stopPropagation())}),o(),l(6,"ya-text-action",13),E("click",function(){let n=k(e).$index,r=h(3);return A(r.deletePattern(n))}),s(7,"DELETE"),o()()()}if(t&2){let e=i.$implicit;p(2),W(e)}}function Hm(t,i){if(t&1&&(l(0,"table",5)(1,"tr")(2,"th"),s(3,"Pattern"),o(),b(4,"th"),o(),v(5,Bm,3,0,"tr"),ae(6,$m,8,1,"tr",null,ie),o()),t&2){let e=i;p(5),x(e.length?-1:5),p(),ne(e)}}function Ym(t,i){if(t&1){let e=N();l(0,"app-instance-page")(1,"app-instance-toolbar"),s(2),o(),l(3,"div",0)(4,"form",1)(5,"label"),s(6," Name "),b(7,"br")(8,"input",2),o(),b(9,"br"),l(10,"label"),s(11," Description "),b(12,"textarea",3),o()(),l(13,"p"),s(14,"\xA0"),o(),l(15,"ya-button",4),E("click",function(){k(e);let n=h();return A(n.showAddPatternDialog())}),s(16," Add parameter or pattern "),o(),l(17,"p"),s(18,"\xA0"),o(),v(19,Hm,8,1,"table",5),w(20,"async"),l(21,"p"),s(22,"\xA0"),o(),l(23,"div",6)(24,"ya-button",7),E("click",function(){k(e);let n=h();return A(n.location.back())}),s(25,"Cancel"),o(),l(26,"ya-button",8),w(27,"async"),E("click",function(){k(e);let n=h();return A(n.onConfirm())}),s(28," SAVE CHANGES "),o()()()()}if(t&2){let e,a=h();p(2),L("Edit list: ",i.name,""),p(2),C("formGroup",a.form),p(15),x((e=D(20,4,a.patterns$))?19:-1,e),p(7),C("disabled",!D(27,6,a.dirty$)||!a.form.valid)}}var tr=class t{constructor(i,e,a,n,r,c,d,m){this.router=a;this.route=n;this.yamcs=r;this.dialog=c;this.messageService=d;this.location=m;this.patterns$=new B([]);this.dirty$=new B(!1);e.setTitle("Edit Parameter List");let u=n.snapshot.paramMap.get("list");this.plist$=r.yamcsClient.getParameterList(r.instance,u),this.plist$.then(g=>{this.plist=g,this.form=i.group({name:new ee(g.name,[Ee.required]),description:new ee(g.description)}),this.formSubscription=this.form.valueChanges.subscribe(()=>{this.dirty$.next(!0)}),this.patterns$.next(g.patterns||[])})}showAddPatternDialog(){this.dialog.open(ei,{width:"500px",data:{label:"Add parameter or pattern",okLabel:"ADD",hint:"Either an exact parameter name, or a glob pattern with *, **, or ? wildcards."}}).afterClosed().subscribe(e=>{e&&(this.patterns$.next([...this.patterns$.value,e]),this.dirty$.next(!0))})}deletePattern(i){this.patterns$.value.splice(i,1),this.patterns$.next([...this.patterns$.value]),this.dirty$.next(!0)}moveUp(i){let e=this.patterns$.value,a=e[i];i===0?(e[i]=e[e.length-1],e[e.length-1]=a):(e[i]=e[i-1],e[i-1]=a),this.patterns$.next([...this.patterns$.value]),this.dirty$.next(!0)}moveDown(i){let e=this.patterns$.value,a=e[i];i===e.length-1?(e[i]=e[0],e[0]=a):(e[i]=e[i+1],e[i+1]=a),this.patterns$.next([...this.patterns$.value]),this.dirty$.next(!0)}onConfirm(){let i={name:this.form.value.name,description:this.form.value.description,patternDefinition:{patterns:[...this.patterns$.value]}};this.yamcs.yamcsClient.updateParameterList(this.yamcs.instance,this.plist.id,i).then(()=>this.router.navigateByUrl(`/telemetry/parameter-lists/${this.plist.id}?c=${this.yamcs.context}`)).catch(e=>this.messageService.showError(e))}ngOnDestroy(){this.formSubscription?.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(T(Ut),T(bt),T(Oe),T(we),T(q),T(Ne),T(ft),T(en))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],decls:2,vars:3,consts:[[1,"form-content","ya-form"],["novalidate","",3,"formGroup"],["formControlName","name","type","text"],["formControlName","description","rows","5",2,"resize","none"],["icon","add_circle_outline",3,"click"],["yaDataTable","",2,"width","100%"],[1,"action-bar"],[3,"click"],["appearance","primary",3,"click","disabled"],["colspan","3"],[2,"text-align","right"],["icon","keyboard_arrow_down",3,"click"],["icon","keyboard_arrow_up",3,"click"],["icon","delete",3,"click"]],template:function(e,a){if(e&1&&(v(0,Ym,29,8,"app-instance-page"),w(1,"async")),e&2){let n;x((n=D(1,1,a.plist$))?0:-1,n)}},dependencies:[Je,Ke,G,J,Te,Ze,me,xe,be,De,pi,_e,ci,Zt],encapsulation:2,changeDetection:0})}};function Gm(t,i){if(t&1){let e=N();b(0,"ya-date-time-input",9)(1,"ya-date-time-input",10),l(2,"ya-button",11),E("click",function(){k(e);let n=h(2);return A(n.applyCustomDates())}),s(3,"Apply"),o()}if(t&2){let e=h(2);p(2),C("disabled",e.filterForm.invalid)}}function Um(t,i){if(t&1){let e=N();l(0,"ya-button",12),E("click",function(){k(e);let n=h(2);return A(n.jumpToNow())}),s(1,"Jump to now"),o()}}function zm(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"the last hour"),o(),s(4," ending at "),l(5,"b"),s(6),w(7,"datetime"),o(),s(8," (Mission Time) "),o()),t&2){let e=h(2);p(6),W(D(7,1,e.validStop))}}function Wm(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"the last 6 hours"),o(),s(4," ending at "),l(5,"b"),s(6),w(7,"datetime"),o(),s(8," (Mission Time) "),o()),t&2){let e=h(2);p(6),W(D(7,1,e.validStop))}}function jm(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"the last 24 hours"),o(),s(4," ending at "),l(5,"b"),s(6),w(7,"datetime"),o(),s(8," (Mission Time) "),o()),t&2){let e=h(2);p(6),W(D(7,1,e.validStop))}}function qm(t,i){t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"all time"),o()())}function Xm(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3),w(4,"datetime"),o(),s(5," to "),l(6,"b"),s(7),w(8,"datetime"),o(),s(9," (Mission Time) "),o()),t&2){let e=h(2);p(3),W(D(4,2,e.validStart)),p(4),W(D(8,4,e.validStop))}}function Zm(t,i){t&1&&(l(0,"th",22),s(1,"Generation time"),o())}function Qm(t,i){if(t&1&&(l(0,"td",23),s(1),w(2,"datetime"),o()),t&2){let e=i.$implicit;p(),L(" ",D(2,1,e.generationTime)," ")}}function Km(t,i){if(t&1&&(l(0,"th",22),s(1),o()),t&2){let e=h().$implicit;p(),W(e)}}function Jm(t,i){if(t&1&&(l(0,"td",23),s(1),o()),t&2){let e,a=i.$implicit,n=h().$index;p(),L(" ",(e=a.values[n])!==null&&e!==void 0?e:"-"," ")}}function ed(t,i){if(t&1&&($(0,17),v(1,Km,2,1,"th",15)(2,Jm,2,1,"td",16),H()),t&2){let e=i.$implicit;C("cdkColumnDef",e)}}function td(t,i){t&1&&b(0,"th",24)}function id(t,i){t&1&&b(0,"td",23)}function ad(t,i){t&1&&b(0,"tr",25)}function nd(t,i){t&1&&b(0,"tr",26)}function rd(t,i){if(t&1&&(l(0,"div",8)(1,"table",13),$(2,14),v(3,Zm,2,0,"th",15)(4,Qm,3,3,"td",16),H(),ae(5,ed,3,1,"ng-container",17,ie),$(7,18),v(8,td,1,0,"th",19)(9,id,1,0,"td",16),H(),v(10,ad,1,0,"tr",20),w(11,"async"),v(12,nd,1,0,"tr",21),w(13,"async"),o()()),t&2){let e=h(2);p(),C("dataSource",e.dataSource),p(4),ne(i.headers),p(5),C("matHeaderRowDef",D(11,4,e.displayedColumns$))("matHeaderRowDefSticky",!0),p(2),C("cdkRowDefColumns",D(13,6,e.displayedColumns$))}}function od(t,i){if(t&1){let e=N();l(0,"div",0)(1,"form",1)(2,"div",2),b(3,"ya-select",3),v(4,Gm,4,1)(5,Um,2,0,"ya-button"),b(6,"div",4),l(7,"ya-button",5),E("click",function(){k(e);let n=h();return A(n.exportParameterData())}),s(8," Export CSV "),o()()(),l(9,"div",6),b(10,"div",7),v(11,zm,9,3,"span")(12,Wm,9,3,"span")(13,jm,9,3,"span")(14,qm,4,0,"span")(15,Xm,10,6,"span"),o(),v(16,rd,14,8,"div",8),w(17,"async"),o()}if(t&2){let e,a,n=h();p(),C("formGroup",n.filterForm),p(2),C("options",n.intervalOptions),p(),x(n.filterForm.value.interval==="CUSTOM"?4:-1),p(),x(n.filterForm.value.interval!=="CUSTOM"?5:-1),p(6),x((e=n.appliedInterval)==="PT1H"?11:e==="PT6H"?12:e==="P1D"?13:e==="NO_LIMIT"?14:e==="CUSTOM"?15:-1),p(5),x((a=D(17,6,n.exportData$))?16:-1,a)}}var na="PT1H",ir=class t{constructor(i,e,a,n){this.router=i;this.route=e;this.yamcs=a;this.dialog=n;this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom"}];this.filterForm=new it({interval:new ee(na),customStart:new ee(null),customStop:new ee(null)});this.displayedColumns=["generationTime","actions"];this.displayedColumns$=new B(this.displayedColumns);this.plist$=new B(null);this.exportData$=new B(null);this.dataSource=new Lt;this.plistId=e.snapshot.paramMap.get("list"),this.validStop=a.getMissionTime(),this.validStart=F.subtractDuration(this.validStop,na),this.appliedInterval=na,this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(r=>{if(r==="CUSTOM"){let c=this.validStart||this.yamcs.getMissionTime(),d=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(F.toISOString(c)),this.filterForm.get("customStop").setValue(F.toISOString(d))}else r==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=r,this.loadData()):(this.validStop=a.getMissionTime(),this.validStart=F.subtractDuration(this.validStop,r),this.appliedInterval=r,this.loadData())})}initializeOptions(){let i=this.route.snapshot.queryParamMap;if(i.has("interval"))if(this.appliedInterval=i.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let e=i.get("customStart");this.filterForm.get("customStart").setValue(e),this.validStart=new Date(e);let a=i.get("customStop");this.filterForm.get("customStop").setValue(a),this.validStop=new Date(a)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=F.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=na,this.validStop=this.yamcs.getMissionTime(),this.validStart=F.subtractDuration(this.validStop,na)}jumpToNow(){let i=this.filterForm.value.interval;i==="NO_LIMIT"?this.filterForm.get("interval").setValue(na):(this.validStop=this.yamcs.getMissionTime(),this.validStart=F.subtractDuration(this.validStop,i),this.loadData())}applyCustomDates(){this.validStart=F.toDate(this.filterForm.value.customStart),this.validStop=F.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();let i={delimiter:"TAB",limit:100,order:"desc"};if(this.validStart){let e=new Date(this.validStart.getTime());e.setUTCMilliseconds(this.validStart.getUTCMilliseconds()-1),i.start=e.toISOString()}this.validStop&&(i.stop=this.validStop.toISOString()),this.yamcs.yamcsClient.getParameterList(this.yamcs.instance,this.plistId).then(e=>{this.plist$.next(e),e.match&&this.yamcs.yamcsClient.exportParameterValues(this.yamcs.instance,yt(et({},i),{list:e.id})).then(a=>{let n=this.processCsv(a);this.exportData$.next(n),this.displayedColumns$.next(["generationTime",...n.headers,"actions"]),this.dataSource.data=n.records})})}processCsv(i){let e=[],a=i.split(/\r?\n/);for(let d=1;d<a.length;d++){let m=a[d];if(!m)continue;let u=m.split(/\t/),g={generationTime:u[0],values:[]};for(let f=1;f<u.length;f++)g.values[f-1]=u[f]||null;e.push(g)}return{headers:a[0].split(/\t/).slice(1).map(d=>F.getFilename(d)),records:e}}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStart:null,customStop:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}exportParameterData(){let i=this.plist$.value;if(i?.match){let a=i.name;this.validStart&&this.validStop?a+="_"+this.validStart.toISOString()+"_"+this.validStop.toISOString():this.validStart?a+="_"+this.validStart.toISOString():this.validStop&&(a+="_"+this.validStop.toISOString()),a+=".csv",this.dialog.open(ia,{width:"400px",data:{list:i.id,start:this.validStart,stop:this.validStop,filename:a}})}}static{this.\u0275fac=function(e){return new(e||t)(T(Oe),T(we),T(q),T(Ne))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],decls:2,vars:3,consts:[[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],[2,"flex","1 1 auto"],["appearance","primary","icon","download",1,"no-margin",3,"click"],[1,"table-status"],[1,"toggles"],[1,"table-container"],["formControlName","customStart"],["formControlName","customStop"],[3,"click","disabled"],[3,"click"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","generationTime","sticky",""],["mat-header-cell","",4,"cdkHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],[3,"cdkColumnDef"],["cdkColumnDef","actions"],["mat-header-cell","","class","expand",4,"cdkHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"cdkRowDef","cdkRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,a){if(e&1&&(v(0,od,18,8,"div",0),w(1,"async")),e&2){let n;x((n=D(1,1,a.plist$))?0:-1,n)}},dependencies:[G,J,Te,me,xe,be,De,si,It,oi,li,He,ht,at,Ye,Ge,Ue,ze,_e,_t,Dt,Pe],styles:[".table-container[_ngcontent-%COMP%]{position:absolute;inset:96px 0 0;overflow:auto;margin-top:24px}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{padding-left:24px;padding-right:24px;background-color:inherit;border-bottom:none}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#fff}.table-status[_ngcontent-%COMP%]{background-color:var(--y-background-color);height:24px;line-height:24px;font-size:12px;padding-left:6px}.table-status[_ngcontent-%COMP%]   .toggles[_ngcontent-%COMP%]{float:right;height:24px;line-height:24px;font-size:12px;padding-right:6px}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child, .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{background-color:var(--y-background-color);border-left:1px solid rgba(0,0,0,.1);border-right:1px solid rgba(0,0,0,.1)}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child, .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-right:1px solid rgba(0,0,0,.1)}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.1)}"],changeDetection:0})}};var io=t=>({c:t}),ld=t=>[t,"edit"];function sd(t,i){if(t&1&&(l(0,"ya-page-button",0),s(1," Create list "),o()),t&2){let e=h();C("queryParams",X(1,io,e.yamcs.context))}}function cd(t,i){t&1&&(l(0,"th",14),s(1,"Name"),o())}function pd(t,i){if(t&1&&(l(0,"td",15)(1,"a",16),s(2),o()()),t&2){let e=i.$implicit,a=h();p(),C("routerLink",e.id)("queryParams",X(3,io,a.yamcs.context)),p(),W(e.name)}}function md(t,i){t&1&&(l(0,"th",14),s(1,"Description"),o())}function dd(t,i){if(t&1&&(l(0,"td",17),s(1),o()),t&2){let e=i.$implicit;p(),L(" ",e.description||"-"," ")}}function ud(t,i){t&1&&b(0,"th",18)}function hd(t,i){if(t&1){let e=N();l(0,"td",15)(1,"ya-more")(2,"a",19),s(3," Edit list "),o(),l(4,"button",20),E("click",function(){let n=k(e).$implicit,r=h();return A(r.deleteList(n))}),s(5,"Delete list"),o()()()}if(t&2){let e=i.$implicit,a=h();p(2),C("routerLink",X(2,ld,e.id))("queryParams",X(4,io,a.yamcs.context))}}function fd(t,i){t&1&&b(0,"tr",21)}function _d(t,i){t&1&&b(0,"tr",22)}function gd(t,i){t&1&&(l(0,"ya-empty-message"),s(1,"No rows to display"),o())}var ar=class t{constructor(i,e,a,n,r,c){this.yamcs=i;this.authService=e;this.route=n;this.router=r;this.messageService=c;this.filterControl=new ee;this.displayedColumns=["name","description","actions"];this.dataSource=new Lt;a.setTitle("Parameter lists"),this.dataSource.filterPredicate=(d,m)=>d.name.toLowerCase().indexOf(m)>=0}ngAfterViewInit(){let i=this.route.snapshot.queryParamMap;i.has("filter")&&(this.filterControl.setValue(i.get("filter")),this.dataSource.filter=i.get("filter").toLowerCase()),this.filterControl.valueChanges.subscribe(()=>{this.updateURL();let e=this.filterControl.value||"";this.dataSource.filter=e.toLowerCase()}),this.refresh()}mayManageParameterLists(){return this.authService.getUser().hasSystemPrivilege("ManageParameterLists")}refresh(){this.yamcs.yamcsClient.getParameterLists(this.yamcs.instance).then(i=>{this.dataSource.data=i}).catch(i=>this.messageService.showError(i))}updateURL(){let i=this.filterControl.value;this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{filter:i||null},queryParamsHandling:"merge"})}deleteList(i){confirm(`Are you sure you want to delete the list '${i.name}'`)&&this.yamcs.yamcsClient.deleteParameterList(this.yamcs.instance,i.id).then(()=>this.refresh()).catch(e=>this.messageService.showError(e))}static{this.\u0275fac=function(e){return new(e||t)(T(q),T(gt),T(bt),T(we),T(Oe),T(ft))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],decls:20,vars:6,consts:[["routerLink","create","icon","add_circle_outline",3,"queryParams"],[1,"panel-content"],[1,"filter-bar"],["placeholder","Filter lists",3,"formControl"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","style","vertical-align: top",4,"matCellDef"],["matColumnDef","description"],["mat-cell","","class","wrap400","style","white-space: pre-wrap",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",2,"vertical-align","top"],[3,"routerLink","queryParams"],["mat-cell","",1,"wrap400",2,"white-space","pre-wrap"],["mat-header-cell","",1,"expand"],["mat-menu-item","",3,"routerLink","queryParams"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,a){e&1&&(l(0,"app-instance-page")(1,"app-instance-toolbar"),s(2," Parameter lists \xA0\xA0\xA0 "),v(3,sd,2,3,"ya-page-button",0),o(),l(4,"div",1)(5,"div",2),b(6,"ya-search-filter",3),o(),l(7,"table",4),$(8,5),v(9,cd,2,0,"th",6)(10,pd,3,5,"td",7),H(),$(11,8),v(12,md,2,0,"th",6)(13,dd,2,1,"td",9),H(),$(14,10),v(15,ud,1,0,"th",11)(16,hd,6,6,"td",7),H(),v(17,fd,1,0,"tr",12)(18,_d,1,0,"tr",13),o(),v(19,gd,2,0,"ya-empty-message"),o()()),e&2&&(p(3),x(a.mayManageParameterLists()?3:-1),p(3),C("formControl",a.filterControl),p(),C("dataSource",a.dataSource),p(10),C("matHeaderRowDef",a.displayedColumns),p(),C("matRowDefColumns",a.displayedColumns),p(),x(a.dataSource.data.length?-1:19))},dependencies:[Je,Ke,G,me,Gt,Re,pt,He,ut,ht,at,dt,wt,Ye,Ge,Ue,ze,qt,Ot,nt,gn],encapsulation:2,changeDetection:0})}};var nr=class extends Yt{constructor(e,a,n){super();this.yamcs=e;this.synchronizer=a;this.changeDetection=n;this.binaryPreview=16;this.items$=new B([]);this.totalSize$=new B(0);this.loading$=new B(!1);this.idMapping={};this.latestValues=new Map}connect(){return this.syncSubscription=this.synchronizer.syncFast(()=>{this.refreshTable()}),this.items$}async loadParameters(e){return this.loading$.next(!0),this.dataSubscription&&(this.dataSubscription.cancel(),this.dataSubscription=void 0),this.yamcs.yamcsClient.getParameters(this.yamcs.instance,e).then(a=>{this.totalSize$.next(a.totalSize);let n=[];for(let r of a.systems||[])n.push({name:r.qualifiedName,system:r});for(let r of a.parameters||[])n.push({name:F.getMemberPath(r),parameter:r});this.items$.next(n),this.startSubscription(a.parameters||[])}).finally(()=>this.loading$.next(!1))}refreshTable(){let e=this.items$.value;for(let a of e)a.system||(a.pval=this.latestValues.get(a.name));this.items$.next([...e]),this.changeDetection.detectChanges()}startSubscription(e){let a=e.map(n=>({name:F.getMemberPath(n)}));a.length&&(this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:a,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,maxBytes:this.binaryPreview+1,action:"REPLACE"},n=>{n.mapping&&(this.idMapping=n.mapping,this.latestValues.clear()),this.processDelivery(n.values||[]),n.mapping&&this.refreshTable()}))}processDelivery(e){for(let a of e){let n=this.idMapping[a.numericId];n&&this.latestValues.set(n.name,a)}}getAliasNamespaces(){let e=[];for(let a of this.items$.value)if(a.parameter?.alias)for(let n of a.parameter.alias)n.namespace&&e.indexOf(n.namespace)===-1&&e.push(n.namespace);return e.sort()}disconnect(){this.syncSubscription?.unsubscribe(),this.dataSubscription?.cancel(),this.items$.complete(),this.totalSize$.complete(),this.loading$.complete()}};var vd=["top"],Dl=t=>({c:t}),yd=(t,i)=>({c:t,system:i}),Pl=t=>({maxBytes:t});function Cd(t,i){if(t&1&&b(0,"ya-breadcrumb",32),t&2){let e=i.$implicit;C("link",e.route)("queryParams",e.queryParams)("label",e.name)}}function xd(t,i){if(t&1&&(l(0,"div",5)(1,"ya-breadcrumb-trail"),b(2,"ya-breadcrumb",31),ae(3,Cd,1,3,"ya-breadcrumb",32,ie),o()()),t&2){let e=h(),a=h();p(2),C("queryParams",X(1,Dl,a.yamcs.context)),p(),ne(e)}}function bd(t,i){t&1&&v(0,xd,5,3,"div",5),t&2&&x(i.length?0:-1)}function Sd(t,i){t&1&&b(0,"ya-dots")}function wd(t,i){t&1&&(l(0,"th",33),s(1,"Name"),o())}function Td(t,i){if(t&1&&(l(0,"mat-icon",35),s(1,"folder"),o(),l(2,"a",36),s(3),w(4,"filename"),o()),t&2){let e=h().$implicit,a=h();p(2),C("queryParams",hi(4,yd,a.yamcs.context,e.name)),p(),L(" ",D(4,2,e.name),"/ ")}}function Dd(t,i){if(t&1&&b(0,"ya-highlight",38),t&2){let e=h(2).$implicit,a=h();C("text",e.name)("term",a.filterForm.value.filter)}}function Pd(t,i){if(t&1&&(b(0,"ya-highlight",38),w(1,"slice")),t&2){let e=h(2).$implicit,a=h();C("text",We(1,2,e.name,i.length+1))("term",a.filterForm.value.filter)}}function Ed(t,i){if(t&1&&(l(0,"mat-icon",35),s(1,"toll"),o(),l(2,"a",37),v(3,Dd,1,2,"ya-highlight",38),w(4,"async"),v(5,Pd,2,5,"ya-highlight",38),w(6,"async"),o()),t&2){let e,a=h().$implicit,n=h();p(2),C("routerLink","/telemetry/parameters"+a.name)("queryParams",X(8,Dl,n.yamcs.context)),p(),x(D(4,4,n.system$)?-1:3),p(2),x((e=D(6,6,n.system$))?5:-1,e)}}function kd(t,i){if(t&1&&(l(0,"td",34),v(1,Td,5,7)(2,Ed,7,10),o()),t&2){let e=i.$implicit;p(),x(e.system?1:-1),p(),x(e.system?-1:2)}}function Ad(t,i){t&1&&(l(0,"th",39),s(1,"Raw value"),o())}function Md(t,i){if(t&1&&(l(0,"td",40),s(1),w(2,"value"),o()),t&2){let e=i.$implicit,a=h();p(),L(" ",We(2,1,e.pval==null?null:e.pval.rawValue,X(4,Pl,a.dataSource.binaryPreview))||"-"," ")}}function Rd(t,i){t&1&&(l(0,"th",39),s(1,"Value"),o())}function Id(t,i){if(t&1&&(l(0,"span"),s(1),w(2,"parameterTypeForPath"),w(3,"units"),o()),t&2){let e,a=h(2).$implicit;p(),L(" ",D(3,3,(e=D(2,1,a.parameter))==null?null:e.unitSet)," ")}}function Ld(t,i){t&1&&(l(0,"span"),s(1,"\u2193"),o())}function Od(t,i){t&1&&(l(0,"span"),s(1,"\u2191"),o())}function Vd(t,i){if(t&1&&(l(0,"ya-expirable",41),s(1),w(2,"value"),v(3,Id,4,5,"span")(4,Ld,2,0,"span")(5,Od,2,0,"span"),o()),t&2){let e=h().$implicit,a=h();C("pval",e.pval),p(),L(" ",We(2,5,e.pval==null?null:e.pval.engValue,X(8,Pl,a.dataSource.binaryPreview))||"-"," "),p(2),x(!(e.parameter==null||e.parameter.type==null)&&e.parameter.type.unitSet?3:-1),p(),x((e.pval==null?null:e.pval.rangeCondition)==="LOW"?4:-1),p(),x((e.pval==null?null:e.pval.rangeCondition)==="HIGH"?5:-1)}}function Nd(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function Fd(t,i){if(t&1&&(l(0,"td",40),v(1,Vd,6,10,"ya-expirable",41)(2,Nd,2,0,"span"),o()),t&2){let e=i.$implicit;pe("alert",(e.pval==null?null:e.pval.monitoringResult)&&(e.pval==null?null:e.pval.monitoringResult)!=="IN_LIMITS"),p(),x(e.pval?1:-1),p(),x(e.pval?-1:2)}}function Bd(t,i){t&1&&(l(0,"th",33),s(1,"Generation time"),o())}function $d(t,i){if(t&1&&(l(0,"td",40),s(1),w(2,"datetime"),o()),t&2){let e=i.$implicit;p(),L(" ",D(2,1,e.pval==null?null:e.pval.generationTime)||"-"," ")}}function Hd(t,i){t&1&&(l(0,"th",33),s(1,"Reception time"),o())}function Yd(t,i){if(t&1&&(s(0),w(1,"deltaWith")),t&2){let e=h().$implicit;L(" (",We(1,1,e.pval.acquisitionTime,e.pval.generationTime),") ")}}function Gd(t,i){if(t&1&&(l(0,"td",40),s(1),w(2,"datetime"),v(3,Yd,2,4),o()),t&2){let e=i.$implicit;p(),L(" ",D(2,2,e.pval==null?null:e.pval.acquisitionTime)||"-"," "),p(2),x(e.pval!=null&&e.pval.generationTime&&(e.pval!=null&&e.pval.acquisitionTime)?3:-1)}}function Ud(t,i){t&1&&(l(0,"th",33),s(1,"Type"),o())}function zd(t,i){t&1&&(l(0,"span",42),s(1),o()),t&2&&(p(),L(" ",i," "))}function Wd(t,i){t&1&&s(0," - ")}function jd(t,i){if(t&1&&(l(0,"td",40),v(1,zd,2,1,"span",42),w(2,"parameterTypeForPath"),v(3,Wd,1,0),o()),t&2){let e,a=i.$implicit;p(),x((e=(e=D(2,1,a.parameter))==null?null:e.engType)?1:3,e)}}function qd(t,i){t&1&&(l(0,"th",33),s(1,"Data source"),o())}function Xd(t,i){if(t&1&&(l(0,"td",40),s(1),w(2,"titlecase"),o()),t&2){let e=i.$implicit;p(),L(" ",D(2,1,e.parameter==null?null:e.parameter.dataSource)||"-"," ")}}function Zd(t,i){t&1&&(l(0,"th",39),s(1,"Description"),o())}function Qd(t,i){if(t&1&&s(0),t&2){let e=h().$implicit;L(" ",e.system.shortDescription||"-"," ")}}function Kd(t,i){if(t&1&&s(0),t&2){let e=h().$implicit;L(" ",e.parameter.shortDescription||"-"," ")}}function Jd(t,i){if(t&1&&(l(0,"td",40),v(1,Qd,1,1)(2,Kd,1,1),o()),t&2){let e=i.$implicit;p(),x(e.system?1:-1),p(),x(e.parameter?2:-1)}}function eu(t,i){if(t&1&&(l(0,"th",33),s(1),o()),t&2){let e=h().$implicit;p(),L(" ",e.label," ")}}function tu(t,i){if(t&1&&b(0,"ya-highlight",38),t&2){let e=h(3);C("text",i)("term",e.filterForm.value.filter)}}function iu(t,i){t&1&&s(0," - ")}function au(t,i){if(t&1&&(l(0,"td",40),v(1,tu,1,2,"ya-highlight",38),w(2,"alias"),v(3,iu,1,0),o()),t&2){let e,a=i.$implicit,n=h().$implicit;p(),x((e=We(2,1,a.parameter,n.id))?1:3,e)}}function nu(t,i){if(t&1&&($(0,25),v(1,eu,2,1,"th",12)(2,au,4,4,"td",20),H()),t&2){let e=i.$implicit;C("matColumnDef",e.id)}}function ru(t,i){t&1&&b(0,"th",43)}function ou(t,i){t&1&&b(0,"td",40)}function lu(t,i){t&1&&b(0,"tr",44)}function su(t,i){if(t&1&&b(0,"tr",45),t&2){let e=i.$implicit,a=h();pe("selected",a.selection.isSelected(e))}}function cu(t,i){if(t&1&&(l(0,"div",3),s(1," The Mission Database for "),l(2,"i"),s(3),o(),s(4," does not define any parameters. "),o()),t&2){let e=h();p(3),W(e.yamcs.instance)}}var ao=[{id:"name",label:"Name",alwaysVisible:!0},{id:"type",label:"Type",visible:!0},{id:"dataSource",label:"Data source",visible:!0},{id:"engValue",label:"Value",visible:!0},{id:"gentime",label:"Generation time",visible:!1},{id:"rectime",label:"Reception time",visible:!1},{id:"shortDescription",label:"Description",visible:!0},{id:"actions",label:"",alwaysVisible:!0}],pu=[{id:"ANY",label:"Any type"},{id:"aggregate",label:"aggregate"},{id:"array",label:"array"},{id:"binary",label:"binary"},{id:"boolean",label:"boolean"},{id:"enumeration",label:"enumeration"},{id:"float",label:"float"},{id:"integer",label:"integer"},{id:"string",label:"string"},{id:"time",label:"time"}],mu=[{id:"ANY",label:"Any source"},{id:"COMMAND",label:"Command"},{id:"COMMAND_HISTORY",label:"Command History"},{id:"CONSTANT",label:"Constant"},{id:"DERIVED",label:"Derived"},{id:"EXTERNAL1",label:"External 1"},{id:"EXTERNAL2",label:"External 2"},{id:"EXTERNAL3",label:"External 3"},{id:"GROUND",label:"Ground"},{id:"LOCAL",label:"Local"},{id:"SYSTEM",label:"System"},{id:"TELEMETERED",label:"Telemetered"}],rr=class t{constructor(i,e,a,n,r){this.yamcs=i;this.route=e;this.router=a;this.synchronizer=n;this.filterForm=new it({filter:new ee,type:new ee("ANY"),source:new ee("ANY")});this.shortName=!1;this.pageSize=100;this.system=null;this.system$=new B(null);this.breadcrumb$=new B([]);this.columns=ao;this.typeOptions=pu;this.sourceOptions=mu;this.aliasColumns$=new B([]);this.selection=new Vi(!1);this.dataSource=new nr(this.yamcs,this.synchronizer,r)}ngAfterViewInit(){let i=this.route.snapshot.queryParamMap;i.has("filter")&&(this.filter=i.get("filter")||"",this.filterForm.get("filter").setValue(this.filter)),i.has("type")&&(this.type=i.get("type"),this.filterForm.get("type").setValue(this.type)),i.has("source")&&(this.source=i.get("source"),this.filterForm.get("source").setValue(this.source)),this.filterForm.get("filter").valueChanges.subscribe(e=>{this.paginator.pageIndex=0,this.filter=e,this.updateDataSource()}),this.filterForm.get("type").valueChanges.forEach(e=>{this.type=e!=="ANY"?e:null,this.updateDataSource()}),this.filterForm.get("source").valueChanges.forEach(e=>{this.source=e!=="ANY"?e:null,this.updateDataSource()}),this.changeSystem(this.route.snapshot.queryParamMap),this.queryParamMapSubscription=this.route.queryParamMap.subscribe(e=>{e.get("system")!==this.system&&this.changeSystem(e)}),this.paginator.page.subscribe(()=>{this.updateDataSource(),this.top.nativeElement.scrollIntoView()})}changeSystem(i){this.system=i.get("system"),this.updateBrowsePath(),i.has("page")?this.paginator.pageIndex=Number(i.get("page")):this.paginator.pageIndex=0,this.updateDataSource()}updateDataSource(){this.updateURL();let i={system:this.system||"/",details:!0,pos:this.paginator.pageIndex*this.pageSize,limit:this.pageSize};this.filter&&(i.q=this.filter,i.searchMembers=!0),this.type&&(i.type=this.type),this.source&&(i.source=this.source),this.dataSource.loadParameters(i).then(()=>{this.selection.clear(),this.updateBrowsePath(),this.system$.next(this.system);let e=[...this.columns];for(let n of this.aliasColumns$.value){let r=e.indexOf(n);r!==-1&&e.splice(r,1)}let a=[];for(let n of this.dataSource.getAliasNamespaces()){let r={id:n,label:n,alwaysVisible:!0};a.push(r)}e.splice(1,0,...a),this.aliasColumns$.next(a),this.columnChooser.recalculate(e)})}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{page:this.paginator.pageIndex||null,filter:this.filter||null,type:this.type||null,source:this.source||null,system:this.system||null},queryParamsHandling:"merge"})}updateBrowsePath(){let i=[],e="";if(this.system)for(let a of this.system.slice(1).split("/"))e+="/"+a,i.push({name:a,route:"/telemetry/parameters",queryParams:{system:e,c:this.yamcs.context}});this.breadcrumb$.next(i)}selectNext(){let i=this.dataSource.items$.value,e=0;if(this.selection.hasValue()){let a=this.selection.selected[0];i.indexOf(a)!==-1&&(e=Math.min(i.indexOf(a)+1,i.length-1))}this.selection.select(i[e])}selectPrevious(){let i=this.dataSource.items$.value,e=0;if(this.selection.hasValue()){let a=this.selection.selected[0];i.indexOf(a)!==-1&&(e=Math.max(i.indexOf(a)-1,0))}this.selection.select(i[e])}applySelection(){if(this.selection.hasValue()){let i=this.selection.selected[0],e=this.dataSource.items$.value;i.parameter&&e.indexOf(i)!==-1&&this.router.navigate(["/telemetry/parameters"+i.parameter?.qualifiedName],{queryParams:{c:this.yamcs.context}})}}ngOnDestroy(){this.queryParamMapSubscription?.unsubscribe(),this.dataSource.disconnect()}static{this.\u0275fac=function(e){return new(e||t)(T(q),T(we),T(Oe),T(Tt),T(xt))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],viewQuery:function(e,a){if(e&1&&(fe(vd,7),fe(cn,7),fe(Wt,5)),e&2){let n;ue(n=he())&&(a.top=n.first),ue(n=he())&&(a.paginator=n.first),ue(n=he())&&(a.columnChooser=n.first)}},decls:56,vars:26,consts:[["top",""],["columnChooser",""],["empty",""],[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["placeholder","Search by name","icon","search",3,"onArrowDown","onArrowUp","onEnter","formControl"],["formControlName","type",3,"options"],["formControlName","source",3,"options"],["preferenceKey","tmParameters",3,"columns"],["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","primary-td",4,"matCellDef"],["matColumnDef","rawValue"],["mat-header-cell","","class","wrap200",4,"matHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["matColumnDef","engValue"],["mat-cell","",3,"alert",4,"matCellDef"],["matColumnDef","gentime"],["mat-cell","",4,"matCellDef"],["matColumnDef","rectime"],["matColumnDef","type"],["matColumnDef","dataSource"],["matColumnDef","shortDescription"],[3,"matColumnDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected",4,"matRowDef","matRowDefColumns"],[3,"pageSize","hidePageSize","showFirstLastButtons","length"],["link","/telemetry/parameters","icon","account_tree",3,"queryParams"],[3,"link","queryParams","label"],["mat-header-cell",""],["mat-cell","",1,"primary-td"],[1,"icon12",2,"vertical-align","middle"],["routerLink","/telemetry/parameters",3,"queryParams"],[3,"routerLink","queryParams"],[3,"text","term"],["mat-header-cell","",1,"wrap200"],["mat-cell",""],[3,"pval"],[1,"mono"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,a){if(e&1){let n=N();l(0,"app-instance-page")(1,"app-instance-toolbar"),s(2,"Parameters"),o(),b(3,"span",null,0),l(5,"div",3)(6,"form",4),v(7,bd,1,1),w(8,"async"),l(9,"div",5)(10,"ya-search-filter",6),E("onArrowDown",function(){return k(n),A(a.selectNext())})("onArrowUp",function(){return k(n),A(a.selectPrevious())})("onEnter",function(){return k(n),A(a.applySelection())}),o(),b(11,"ya-select",7)(12,"ya-select",8)(13,"ya-column-chooser",9,1),v(15,Sd,1,0,"ya-dots"),w(16,"async"),o()(),l(17,"table",10),$(18,11),v(19,wd,2,0,"th",12)(20,kd,3,2,"td",13),H(),$(21,14),v(22,Ad,2,0,"th",15)(23,Md,3,6,"td",16),H(),$(24,17),v(25,Rd,2,0,"th",15)(26,Fd,3,4,"td",18),H(),$(27,19),v(28,Bd,2,0,"th",12)(29,$d,3,3,"td",20),H(),$(30,21),v(31,Hd,2,0,"th",12)(32,Gd,4,4,"td",20),H(),$(33,22),v(34,Ud,2,0,"th",12)(35,jd,4,3,"td",20),H(),$(36,23),v(37,qd,2,0,"th",12)(38,Xd,3,3,"td",20),H(),$(39,24),v(40,Zd,2,0,"th",15)(41,Jd,3,2,"td",20),H(),ae(42,nu,3,1,"ng-container",25,ie),w(44,"async"),$(45,26),v(46,ru,1,0,"th",27)(47,ou,1,0,"td",20),H(),v(48,lu,1,0,"tr",28),w(49,"async"),v(50,su,1,2,"tr",29),w(51,"async"),o(),b(52,"mat-paginator",30),w(53,"async"),o(),v(54,cu,5,1,"ng-template",null,2,fi),o()}if(e&2){let n,r=oe(14);p(6),C("formGroup",a.filterForm),p(),x((n=D(8,14,a.breadcrumb$))?7:-1,n),p(3),C("formControl",a.filterForm.controls.filter),p(),C("options",a.typeOptions),p(),C("options",a.sourceOptions),p(),C("columns",a.columns),p(2),x(D(16,16,a.dataSource.loading$)?15:-1),p(2),C("dataSource",a.dataSource),p(25),ne(D(44,18,a.aliasColumns$)),p(6),C("matHeaderRowDef",D(49,20,r.displayedColumns$)),p(2),C("matRowDefColumns",D(51,22,r.displayedColumns$)),p(2),C("pageSize",a.pageSize)("hidePageSize",!0)("showFirstLastButtons",!0)("length",D(53,24,a.dataSource.totalSize$))}},dependencies:[Je,Ke,G,J,Uo,Oi,Te,me,xe,Gt,be,De,Re,It,St,cn,He,ut,ht,at,dt,wt,Ye,Ge,Ue,ze,fn,hn,Wt,jt,Xt,il,gn,Dt,rl,Pe,Qi,vn,Ki,Kt,Vt],styles:[".primary-td[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:7px}.alert[_ngcontent-%COMP%]{color:var(--y-error-color)!important}"],changeDetection:0})}};var or=class extends Yt{constructor(e,a,n){super();this.yamcs=e;this.synchronizer=a;this.changeDetection=n;this.binaryPreview=16;this.items$=new B([]);this.totalSize$=new B(0);this.loading$=new B(!1);this.idMapping={};this.latestValues=new Map}connect(){return this.syncSubscription=this.synchronizer.syncFast(()=>{this.refreshTable()}),this.items$}async loadParameters(e){this.loading$.next(!0),this.dataSubscription&&(this.dataSubscription.cancel(),this.dataSubscription=void 0);let a=[];for(let n of e)a.push({name:n.qualifiedName,parameter:n});this.items$.next(a),this.startSubscription(e||[])}refreshTable(){let e=this.items$.value;for(let a of e)a.pval=this.latestValues.get(a.name);this.items$.next([...e]),this.changeDetection.detectChanges()}startSubscription(e){let a=e.map(n=>({name:n.qualifiedName}));a.length&&(this.dataSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:a,abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,maxBytes:this.binaryPreview+1,action:"REPLACE"},n=>{n.mapping&&(this.idMapping=n.mapping,this.latestValues.clear()),this.processDelivery(n.values||[]),this.loading$.next(!1),n.mapping&&this.refreshTable()}))}processDelivery(e){for(let a of e){let n=this.idMapping[a.numericId];n&&this.latestValues.set(n.name,a)}}disconnect(){this.syncSubscription?.unsubscribe(),this.dataSubscription?.cancel(),this.items$.complete(),this.totalSize$.complete(),this.loading$.complete()}};var du=t=>({c:t}),El=t=>({maxBytes:t});function uu(t,i){t&1&&b(0,"ya-dots")}function hu(t,i){t&1&&(l(0,"th",22),s(1,"Name"),o())}function fu(t,i){if(t&1&&(l(0,"td",23)(1,"a",24),s(2),o()()),t&2){let e=i.$implicit,a=h(2);p(),C("routerLink","/telemetry/parameters"+e.parameter.qualifiedName)("queryParams",X(3,du,a.yamcs.context)),p(),L(" ",e.name," ")}}function _u(t,i){t&1&&(l(0,"th",25),s(1,"Raw value"),o())}function gu(t,i){if(t&1&&(l(0,"td",23),s(1),w(2,"value"),o()),t&2){let e=i.$implicit,a=h(2);p(),L(" ",We(2,1,e.pval==null?null:e.pval.rawValue,X(4,El,a.dataSource.binaryPreview))||"-"," ")}}function vu(t,i){t&1&&(l(0,"th",25),s(1,"Value"),o())}function yu(t,i){if(t&1&&(l(0,"span"),s(1),w(2,"parameterTypeForPath"),w(3,"units"),o()),t&2){let e,a=h(2).$implicit;p(),L(" ",D(3,3,(e=D(2,1,a.parameter))==null?null:e.unitSet)," ")}}function Cu(t,i){t&1&&(l(0,"span"),s(1,"\u2193"),o())}function xu(t,i){t&1&&(l(0,"span"),s(1,"\u2191"),o())}function bu(t,i){if(t&1&&(l(0,"ya-expirable",26),s(1),w(2,"value"),v(3,yu,4,5,"span")(4,Cu,2,0,"span")(5,xu,2,0,"span"),o()),t&2){let e=h().$implicit,a=h(2);C("pval",e.pval),p(),L(" ",We(2,5,e.pval==null?null:e.pval.engValue,X(8,El,a.dataSource.binaryPreview))||"-"," "),p(2),x(!(e.parameter==null||e.parameter.type==null)&&e.parameter.type.unitSet?3:-1),p(),x((e.pval==null?null:e.pval.rangeCondition)==="LOW"?4:-1),p(),x((e.pval==null?null:e.pval.rangeCondition)==="HIGH"?5:-1)}}function Su(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function wu(t,i){if(t&1&&(l(0,"td",23),v(1,bu,6,10,"ya-expirable",26)(2,Su,2,0,"span"),o()),t&2){let e=i.$implicit;pe("alert",(e.pval==null?null:e.pval.monitoringResult)&&(e.pval==null?null:e.pval.monitoringResult)!=="IN_LIMITS"),p(),x(e.pval?1:2)}}function Tu(t,i){t&1&&(l(0,"th",22),s(1,"Generation time"),o())}function Du(t,i){if(t&1&&(l(0,"td",23),s(1),w(2,"datetime"),o()),t&2){let e=i.$implicit;p(),L(" ",D(2,1,e.pval==null?null:e.pval.generationTime)||"-"," ")}}function Pu(t,i){t&1&&(l(0,"th",22),s(1,"Reception time"),o())}function Eu(t,i){if(t&1&&(s(0),w(1,"deltaWith")),t&2){let e=h().$implicit;L(" (",We(1,1,e.pval.acquisitionTime,e.pval.generationTime),") ")}}function ku(t,i){if(t&1&&(l(0,"td",23),s(1),w(2,"datetime"),v(3,Eu,2,4),o()),t&2){let e=i.$implicit;p(),L(" ",D(2,2,e.pval==null?null:e.pval.acquisitionTime)||"-"," "),p(2),x(e.pval!=null&&e.pval.generationTime&&(e.pval!=null&&e.pval.acquisitionTime)?3:-1)}}function Au(t,i){t&1&&(l(0,"th",22),s(1,"Type"),o())}function Mu(t,i){t&1&&(l(0,"span",27),s(1),o()),t&2&&(p(),L(" ",i," "))}function Ru(t,i){t&1&&s(0," - ")}function Iu(t,i){if(t&1&&(l(0,"td",23),v(1,Mu,2,1,"span",27),w(2,"parameterTypeForPath"),v(3,Ru,1,0),o()),t&2){let e,a=i.$implicit;p(),x((e=(e=D(2,1,a.parameter))==null?null:e.engType)?1:3,e)}}function Lu(t,i){t&1&&(l(0,"th",22),s(1,"Data source"),o())}function Ou(t,i){if(t&1&&(l(0,"td",23),s(1),w(2,"titlecase"),o()),t&2){let e=i.$implicit;p(),L(" ",D(2,1,e.parameter==null?null:e.parameter.dataSource)||"-"," ")}}function Vu(t,i){t&1&&(l(0,"th",25),s(1,"Description"),o())}function Nu(t,i){if(t&1&&(l(0,"td",23),s(1),o()),t&2){let e=i.$implicit;p(),L(" ",e.parameter.shortDescription||"-"," ")}}function Fu(t,i){t&1&&b(0,"th",28)}function Bu(t,i){t&1&&b(0,"td",23)}function $u(t,i){t&1&&b(0,"tr",29)}function Hu(t,i){t&1&&b(0,"tr",30)}function Yu(t,i){if(t&1&&(l(0,"div",2),b(1,"ya-column-chooser",3,0),v(3,uu,1,0,"ya-dots"),w(4,"async"),o(),l(5,"table",4),$(6,5),v(7,hu,2,0,"th",6)(8,fu,3,5,"td",7),H(),$(9,8),v(10,_u,2,0,"th",9)(11,gu,3,6,"td",10),H(),$(12,11),v(13,vu,2,0,"th",9)(14,wu,3,3,"td",12),H(),$(15,13),v(16,Tu,2,0,"th",6)(17,Du,3,3,"td",7),H(),$(18,14),v(19,Pu,2,0,"th",6)(20,ku,4,4,"td",7),H(),$(21,15),v(22,Au,2,0,"th",6)(23,Iu,4,3,"td",7),H(),$(24,16),v(25,Lu,2,0,"th",6)(26,Ou,3,3,"td",7),H(),$(27,17),v(28,Vu,2,0,"th",9)(29,Nu,2,1,"td",7),H(),$(30,18),v(31,Fu,1,0,"th",19)(32,Bu,1,0,"td",7),H(),v(33,$u,1,0,"tr",20),w(34,"async"),v(35,Hu,1,0,"tr",21),w(36,"async"),o()),t&2){let e=oe(2),a=h();p(),C("columns",a.columns),p(2),x(D(4,6,a.dataSource.loading$)?3:-1),p(2),C("dataSource",a.dataSource)("trackBy",a.tableTrackerFn),p(28),C("matHeaderRowDef",D(34,8,e.displayedColumns$)),p(2),C("matRowDefColumns",D(36,10,e.displayedColumns$))}}var lr=class t{constructor(i,e,a,n){this.yamcs=e;this.synchronizer=a;this.plist$=new B(null);this.columns=ao;this.tableTrackerFn=(i,e)=>e.name;this.dataSource=new or(this.yamcs,this.synchronizer,n),i.paramMap.subscribe(r=>{let c=r.get("list");this.changeList(c)})}changeList(i){this.yamcs.yamcsClient.getParameterList(this.yamcs.instance,i).then(e=>{this.plist$.next(e),this.dataSource.loadParameters(e.match||[])})}ngOnDestroy(){this.dataSource?.disconnect()}static{this.\u0275fac=function(e){return new(e||t)(T(we),T(q),T(Tt),T(xt))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],viewQuery:function(e,a){if(e&1&&fe(Wt,5),e&2){let n;ue(n=he())&&(a.columnChooser=n.first)}},decls:3,vars:3,consts:[["columnChooser",""],[1,"panel-content"],[1,"filter-bar"],["preferenceKey","tmParameters",3,"columns"],["mat-table","",1,"ya-data-table","expand",3,"dataSource","trackBy"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","rawValue"],["mat-header-cell","","class","wrap200",4,"matHeaderCellDef"],["mat-cell","",4,"cdkCellDef"],["matColumnDef","engValue"],["mat-cell","",3,"alert",4,"matCellDef"],["matColumnDef","gentime"],["matColumnDef","rectime"],["matColumnDef","type"],["matColumnDef","dataSource"],["matColumnDef","shortDescription"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"routerLink","queryParams"],["mat-header-cell","",1,"wrap200"],[3,"pval"],[1,"mono"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row",""]],template:function(e,a){if(e&1&&(l(0,"div",1),v(1,Yu,37,12),w(2,"async"),o()),e&2){let n;p(),x((n=D(2,1,a.plist$))?1:-1,n)}},dependencies:[G,J,Oi,Re,It,He,ut,ht,at,dt,wt,Ye,Ge,Ue,ze,Wt,jt,Xt,Pe,Qi,Ki,Kt,Vt],styles:[".alert[_ngcontent-%COMP%]{color:var(--y-error-color)!important}"],changeDetection:0})}};var sr=t=>({c:t});function Gu(t,i){if(t&1&&(l(0,"ya-page-button",5),s(1," Edit list "),o()),t&2){let e=h(2);C("queryParams",X(1,sr,e.yamcs.context))}}function Uu(t,i){if(t&1&&(l(0,"a",8,3),s(2," Historical Data "),o()),t&2){let e=oe(1),a=h(2);C("active",e.isActive)("queryParams",X(2,sr,a.yamcs.context))}}function zu(t,i){if(t&1&&(l(0,"app-instance-page")(1,"app-instance-toolbar"),b(2,"ya-page-icon-button",4),s(3),v(4,Gu,2,3,"ya-page-button",5),o(),l(5,"nav",6,0)(7,"a",7,1),s(9," Realtime "),o(),v(10,Uu,3,4,"a",8),o(),l(11,"div",9)(12,"mat-tab-nav-panel",null,2),b(14,"router-outlet"),o()()()),t&2){let e=oe(8),a=oe(13),n=h();p(2),C("queryParams",X(8,sr,n.yamcs.context)),p(),L(" ",i.name," \xA0\xA0\xA0 "),p(),x(n.mayManageParameterLists()?4:-1),p(),C("mat-stretch-tabs",!1)("tabPanel",a),p(2),C("active",e.isActive)("queryParams",X(10,sr,n.yamcs.context)),p(3),x(n.config.tmArchive?10:-1)}}var cr=class t{constructor(i,e,a,n,r){this.yamcs=e;this.authService=a;this.title=n;this.plist$=new B(null);this.config=r.getConfig(),i.paramMap.subscribe(c=>{let d=c.get("list");this.changeList(d)})}mayManageParameterLists(){return this.authService.getUser().hasSystemPrivilege("ManageParameterLists")}changeList(i){this.yamcs.yamcsClient.getParameterList(this.yamcs.instance,i).then(e=>{this.plist$.next(e),this.title.setTitle(e.name)})}static{this.\u0275fac=function(e){return new(e||t)(T(we),T(q),T(gt),T(bt),T(ye))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],decls:2,vars:3,consts:[["tabs",""],["rla","routerLinkActive"],["tabPanel",""],["rlb","routerLinkActive"],["routerLink","..","icon","arrow_back",3,"queryParams"],["routerLink","edit","icon","edit",3,"queryParams"],["mat-tab-nav-bar","",1,"secondary",3,"mat-stretch-tabs","tabPanel"],["mat-tab-link","","routerLink","realtime","routerLinkActive","",3,"active","queryParams"],["mat-tab-link","","routerLink","data","routerLinkActive","",3,"active","queryParams"],[1,"tab-content-wrapper"]],template:function(e,a){if(e&1&&(v(0,zu,15,12,"app-instance-page"),w(1,"async")),e&2){let n;x((n=D(1,1,a.plist$))?0:-1,n)}},dependencies:[Je,Ke,G,J,ri,Re,an,pn,dn,mn,nt,Qt],encapsulation:2,changeDetection:0})}};function Wu(t,i){t&1&&(l(0,"th",16),s(1,"Severity"),o())}function ju(t,i){if(t&1&&(l(0,"td",17),b(1,"app-alarm-level",18),o()),t&2){let e=i.$implicit;p(),C("level",e.severity)("grayscale",!0)}}function qu(t,i){t&1&&(l(0,"th",16),s(1,"Start"),o())}function Xu(t,i){if(t&1&&(l(0,"td",17),s(1),w(2,"datetime"),o()),t&2){let e=i.$implicit;p(),W(D(2,1,e.triggerTime)||"-")}}function Zu(t,i){t&1&&(l(0,"th",16),s(1,"Stop"),o())}function Qu(t,i){if(t&1&&(l(0,"td",17),s(1),w(2,"datetime"),o()),t&2){let e=i.$implicit;p(),L(" ",D(2,1,e.updateTime)||"-"," ")}}function Ku(t,i){t&1&&(l(0,"th",16),s(1,"Trip value"),o())}function Ju(t,i){t&1&&(l(0,"span"),s(1,"\u2193"),o())}function e0(t,i){t&1&&(l(0,"span"),s(1,"\u2191"),o())}function t0(t,i){if(t&1&&(s(0),w(1,"value"),v(2,Ju,2,0,"span")(3,e0,2,0,"span")),t&2){let e=i;L(" ",D(1,3,e.triggerValue.engValue)," "),p(2),x(e.triggerValue.rangeCondition==="LOW"?2:-1),p(),x(e.triggerValue.rangeCondition==="HIGH"?3:-1)}}function i0(t,i){if(t&1&&(l(0,"td",19),v(1,t0,4,5),o()),t&2){let e,a=i.$implicit;p(),x((e=a.parameterDetail)?1:-1,e)}}function a0(t,i){t&1&&(l(0,"th",16),s(1,"Duration"),o())}function n0(t,i){if(t&1&&(s(0),w(1,"duration")),t&2){let e=h().$implicit,a=h(2);L(" ",D(1,1,a.durationFor(e))||"-"," ")}}function r0(t,i){if(t&1&&(l(0,"mat-icon",20),s(1,"comment"),o()),t&2){let e=h(2).$implicit;C("matTooltip",e.clearInfo==null?null:e.clearInfo.clearMessage)}}function o0(t,i){if(t&1&&(s(0),v(1,r0,2,1,"mat-icon",20)),t&2){let e=h().$implicit;L(" (cleared by ",e.clearInfo==null?null:e.clearInfo.clearedBy,") "),p(),x(e.clearInfo!=null&&e.clearInfo.clearMessage?1:-1)}}function l0(t,i){if(t&1&&(l(0,"td",17),v(1,n0,2,3)(2,o0,2,2),o()),t&2){let e=i.$implicit;p(),x(e.updateTime?1:-1),p(),x(e.clearInfo!=null&&e.clearInfo.clearedBy?2:-1)}}function s0(t,i){t&1&&(l(0,"th",21),s(1,"Violations"),o())}function c0(t,i){if(t&1&&(s(0),w(1,"number"),w(2,"number")),t&2){let e=h().$implicit;$t(" ",D(1,2,e.violations)," (",We(2,4,e.violations/e.count*100,"1.2-2"),"%) ")}}function p0(t,i){t&1&&s(0," - ")}function m0(t,i){if(t&1&&(l(0,"td",22),v(1,c0,3,7)(2,p0,1,0),o()),t&2){let e=i.$implicit;p(),x(e.violations?1:2)}}function d0(t,i){t&1&&b(0,"th",23)}function u0(t,i){if(t&1){let e=N();l(0,"td",17)(1,"ya-text-action",24),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.showChart(n))}),s(2," SHOW CHART "),o(),l(3,"ya-text-action",25),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.showData(n))}),s(4," SHOW DATA "),o()()}}function h0(t,i){t&1&&b(0,"tr",26)}function f0(t,i){t&1&&b(0,"tr",27)}function _0(t,i){if(t&1&&(l(0,"table",0),$(1,1),v(2,Wu,2,0,"th",2)(3,ju,2,2,"td",3),H(),$(4,4),v(5,qu,2,0,"th",2)(6,Xu,3,3,"td",3),H(),$(7,5),v(8,Zu,2,0,"th",2)(9,Qu,3,3,"td",3),H(),$(10,6),v(11,Ku,2,0,"th",2)(12,i0,2,1,"td",7),H(),$(13,8),v(14,a0,2,0,"th",2)(15,l0,3,2,"td",3),H(),$(16,9),v(17,s0,2,0,"th",10)(18,m0,3,1,"td",11),H(),$(19,12),v(20,d0,1,0,"th",13)(21,u0,5,0,"td",3),H(),v(22,h0,1,0,"tr",14)(23,f0,1,0,"tr",15),o()),t&2){let e=h();C("dataSource",e.dataSource),p(22),C("matHeaderRowDef",e.displayedColumns),p(),C("matRowDefColumns",e.displayedColumns)}}var pr=class t{constructor(i,e){this.router=i;this.yamcs=e;this.displayedColumns=["severity","start","stop","duration","triggerValue","violations","actions"]}durationFor(i){if(i.updateTime)return F.toDate(i.updateTime).getTime()-F.toDate(i.triggerTime).getTime()}showChart(i){let e=i.triggerTime,a=i.updateTime||i.clearInfo?.clearTime,n,r;a?(n=e,r=a):(n=e,r=Xr(F.toDate(e),1).toISOString()),this.router.navigate(["/telemetry/parameters"+i.parameterDetail?.triggerValue.id.name,"-","chart"],{queryParams:{c:this.yamcs.context,interval:"CUSTOM",customStart:n,customStop:r}})}showData(i){let e=i.triggerTime,a=i.updateTime||i.clearInfo?.clearTime,n,r;a?(n=e,r=a):(n=e,r=Xr(F.toDate(e),1).toISOString()),this.router.navigate(["/telemetry/parameters"+i.parameterDetail?.triggerValue.id.name,"-","data"],{queryParams:{c:this.yamcs.context,interval:"CUSTOM",customStart:n,customStop:r}})}static{this.\u0275fac=function(e){return new(e||t)(T(Oe),T(q))}}static{this.\u0275cmp=V({type:t,selectors:[["app-parameter-alarms-table"]],inputs:{dataSource:"dataSource"},decls:1,vars:1,consts:[["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","severity"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","start"],["matColumnDef","stop"],["matColumnDef","triggerValue"],["mat-cell","","class","wrap200",4,"matCellDef"],["matColumnDef","duration"],["matColumnDef","violations"],["mat-header-cell","","style","text-align: right",4,"matHeaderCellDef"],["mat-cell","","style","text-align: right",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"level","grayscale"],["mat-cell","",1,"wrap200"],[3,"matTooltip"],["mat-header-cell","",2,"text-align","right"],["mat-cell","",2,"text-align","right"],["mat-header-cell","",1,"expand"],["icon","show_chart",3,"click"],["icon","view_headline",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,a){e&1&&v(0,_0,24,3,"table",0),e&2&&x(a.dataSource?0:-1)},dependencies:[Jt,G,Go,St,He,ut,ht,at,dt,wt,Ye,Ge,Ue,ze,$i,Zt,Pe,ol,Vt],encapsulation:2,changeDetection:0})}};var mr=class extends Yt{constructor(e,a){super();this.yamcs=e;this.qualifiedName=a;this.pageSize=100;this.alarms$=new B([]);this.loading$=new B(!1)}connect(e){return this.alarms$}isEmpty(){return this.alarms$.value.length===0}loadAlarms(e){return this.loading$.next(!0),this.loadPage(yt(et({},e),{limit:this.pageSize+1})).then(a=>{this.loading$.next(!1),this.alarms$.next(a)})}hasMore(){return this.offscreenRecord!=null}loadPage(e){return this.yamcs.yamcsClient.getAlarmsForParameter(this.yamcs.instance,this.qualifiedName,e).then(a=>(a.length>this.pageSize?this.offscreenRecord=a.splice(a.length-1,1)[0]:this.offscreenRecord=null,a))}loadMoreData(e){this.offscreenRecord&&this.loadPage(yt(et({},e),{stop:this.offscreenRecord.triggerTime,limit:this.pageSize+1})).then(a=>{let n=this.alarms$.getValue().concat(a);this.alarms$.next(n)})}disconnect(){this.alarms$.complete(),this.loading$.complete()}};function g0(t,i){if(t&1){let e=N();b(0,"ya-date-time-input",6)(1,"ya-date-time-input",7),l(2,"ya-button",8),E("click",function(){k(e);let n=h();return A(n.applyCustomDates())}),s(3,"Apply"),o()}if(t&2){let e=h();p(2),C("disabled",e.filter.invalid)}}function v0(t,i){if(t&1){let e=N();l(0,"ya-button",9),E("click",function(){k(e);let n=h();return A(n.jumpToNow())}),s(1,"Jump to now"),o()}}function y0(t,i){t&1&&b(0,"ya-dots")}function C0(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"the last month"),o(),s(4," ending at "),l(5,"b"),s(6),w(7,"datetime"),o(),s(8," (Mission Time) "),o()),t&2){let e=h();p(6),W(D(7,1,e.validStop))}}function x0(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"the last year"),o(),s(4," ending at "),l(5,"b"),s(6),w(7,"datetime"),o(),s(8," (Mission Time) "),o()),t&2){let e=h();p(6),W(D(7,1,e.validStop))}}function b0(t,i){t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"all time"),o()())}function S0(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3),w(4,"datetime"),o(),s(5," to "),l(6,"b"),s(7),w(8,"datetime"),o(),s(9," (Mission Time) "),o()),t&2){let e=h();p(3),W(D(4,2,e.validStart)),p(4),W(D(8,4,e.validStop))}}function w0(t,i){t&1&&(l(0,"ya-empty-message"),s(1," No records found matching current filter in the selected time range. "),o())}function T0(t,i){if(t&1){let e=N();l(0,"mat-toolbar"),b(1,"span",10),l(2,"ya-button",8),E("click",function(){k(e);let n=h();return A(n.loadMoreData())}),s(3,"Load more"),o(),b(4,"span",10),o()}if(t&2){let e=h();p(2),C("disabled",!e.dataSource.hasMore())}}var dr="P1M",ur=class t{constructor(i){this.yamcs=i;this.qualifiedName=Rt.required({alias:"parameter"});this.intervalOptions=[{id:"P1M",label:"Last Month"},{id:"P1Y",label:"Last Year"},{id:"NO_LIMIT",label:"No Limit"},{id:"CUSTOM",label:"Custom"}];this.filter=new it({interval:new ee(dr),customStart:new ee(null),customStop:new ee(null)})}ngOnInit(){let i=this.qualifiedName();this.dataSource=new mr(this.yamcs,i),this.validStop=this.yamcs.getMissionTime(),this.validStart=F.subtractDuration(this.validStop,dr),this.appliedInterval=dr,this.loadData(),this.filter.get("interval").valueChanges.forEach(e=>{if(e==="CUSTOM"){let a=this.validStart||this.yamcs.getMissionTime(),n=this.validStop||this.yamcs.getMissionTime();this.filter.get("customStart").setValue(F.toISOString(a)),this.filter.get("customStop").setValue(F.toISOString(n))}else e==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=e,this.loadData()):(this.validStop=this.yamcs.getMissionTime(),this.validStart=F.subtractDuration(this.validStop,e),this.appliedInterval=e,this.loadData())})}jumpToNow(){let i=this.filter.value.interval;i==="NO_LIMIT"?this.filter.get("interval").setValue(dr):(this.validStop=this.yamcs.getMissionTime(),this.validStart=F.subtractDuration(this.validStop,i),this.loadData())}applyCustomDates(){this.validStart=F.toDate(this.filter.value.customStart),this.validStop=F.toDate(this.filter.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){let i={detail:!0};this.validStart&&(i.start=this.validStart.toISOString()),this.validStop&&(i.stop=this.validStop.toISOString()),this.dataSource.loadAlarms(i)}loadMoreData(){let i={detail:!0};this.validStart&&(i.start=this.validStart.toISOString()),this.dataSource.loadMoreData(i)}ngOnDestroy(){this.dataSource?.disconnect()}static{this.\u0275fac=function(e){return new(e||t)(T(q))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],inputs:{qualifiedName:[1,"parameter","qualifiedName"]},decls:17,vars:13,consts:[[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["formControlName","interval","icon","access_time",3,"options"],[1,"table-status"],[3,"dataSource"],["formControlName","customStart"],["formControlName","customStop"],[3,"click","disabled"],[3,"click"],[2,"flex","1 1 auto"]],template:function(e,a){if(e&1&&(l(0,"div",0)(1,"form",1)(2,"div",2),b(3,"ya-select",3),v(4,g0,4,1)(5,v0,2,0,"ya-button")(6,y0,1,0,"ya-dots"),w(7,"async"),o()(),l(8,"div",4),v(9,C0,9,3,"span")(10,x0,9,3,"span")(11,b0,4,0,"span")(12,S0,10,6,"span"),o(),b(13,"app-parameter-alarms-table",5),v(14,w0,2,0,"ya-empty-message")(15,T0,5,1,"mat-toolbar"),w(16,"async"),o()),e&2){let n;p(),C("formGroup",a.filter),p(2),C("options",a.intervalOptions),p(),x(a.filter.value.interval==="CUSTOM"?4:-1),p(),x(a.filter.value.interval!=="CUSTOM"?5:-1),p(),x(D(7,9,a.dataSource.loading$)?6:-1),p(3),x((n=a.appliedInterval)==="P1M"?9:n==="P1Y"?10:n==="NO_LIMIT"?11:n==="CUSTOM"?12:-1),p(4),C("dataSource",a.dataSource),p(),x(a.dataSource.isEmpty()?14:-1),p(),x(!D(16,11,a.dataSource.loading$)&&!a.dataSource.isEmpty()?15:-1)}},dependencies:[pr,G,J,Te,me,xe,be,De,Gi,_e,_t,jt,qt,Dt,Pe],styles:[".table-status[_ngcontent-%COMP%]{background-color:var(--y-background-color);height:24px;line-height:24px;font-size:12px;padding-left:6px}"],changeDetection:0})}};var kl=function(t,i,e,a,n,r){var c=function(d){return d==="logscale"?!1:a(d)};return ii(t,i,e,c,n,r)},ii=function(t,i,e,a,n,r){var c=a("pixelsPerLabel"),d=[],m,u,g,f;if(r)for(m=0;m<r.length;m++)d.push({v:r[m]});else{if(a("logscale")){f=Math.floor(e/c);var y=Ra(t,hr,1),_=Ra(i,hr,-1);y==-1&&(y=0),_==-1&&(_=hr.length-1);var S=null;if(_-y>=f/4){for(var P=_;P>=y;P--){var R=hr[P],I=Math.log(R/t)/Math.log(i/t)*e,O={v:R};S===null?S={tickValue:R,pixel_coord:I}:Math.abs(I-S.pixel_coord)>=c?S={tickValue:R,pixel_coord:I}:O.label="",d.push(O)}d.reverse()}}if(d.length===0){var Y=a("labelsKMG2"),U,Q;Y?(U=[1,2,4,8,16,32,64,128,256],Q=16):(U=[1,2,5,10,20,50,100],Q=10);var Ae=Math.ceil(e/c),z=Math.abs(i-t)/Ae,K=Math.floor(Math.log(z)/Math.log(Q)),de=Math.pow(Q,K),j,ce,st,Le;for(u=0;u<U.length&&(j=de*U[u],ce=Math.floor(t/j)*j,st=Math.ceil(i/j)*j,f=Math.abs(st-ce)/j,Le=e/f,!(Le>c));u++);for(ce>st&&(j*=-1),m=0;m<=f;m++)g=ce+m*j,d.push({v:g})}}var Pt=a("axisLabelFormatter");for(m=0;m<d.length;m++)d[m].label===void 0&&(d[m].label=Pt.call(n,d[m].v,0,a,n));return d},yi=function(t,i,e,a,n,r){var c=D0(t,i,e,a);return c>=0?no(t,i,c,a,n):[]},le={MILLISECONDLY:0,TWO_MILLISECONDLY:1,FIVE_MILLISECONDLY:2,TEN_MILLISECONDLY:3,FIFTY_MILLISECONDLY:4,HUNDRED_MILLISECONDLY:5,FIVE_HUNDRED_MILLISECONDLY:6,SECONDLY:7,TWO_SECONDLY:8,FIVE_SECONDLY:9,TEN_SECONDLY:10,THIRTY_SECONDLY:11,MINUTELY:12,TWO_MINUTELY:13,FIVE_MINUTELY:14,TEN_MINUTELY:15,THIRTY_MINUTELY:16,HOURLY:17,TWO_HOURLY:18,SIX_HOURLY:19,DAILY:20,TWO_DAILY:21,WEEKLY:22,MONTHLY:23,QUARTERLY:24,BIANNUAL:25,ANNUAL:26,DECADAL:27,CENTENNIAL:28,NUM_GRANULARITIES:29},se={DATEFIELD_Y:0,DATEFIELD_M:1,DATEFIELD_D:2,DATEFIELD_HH:3,DATEFIELD_MM:4,DATEFIELD_SS:5,DATEFIELD_MS:6,NUM_DATEFIELDS:7},ge=[];ge[le.MILLISECONDLY]={datefield:se.DATEFIELD_MS,step:1,spacing:1};ge[le.TWO_MILLISECONDLY]={datefield:se.DATEFIELD_MS,step:2,spacing:2};ge[le.FIVE_MILLISECONDLY]={datefield:se.DATEFIELD_MS,step:5,spacing:5};ge[le.TEN_MILLISECONDLY]={datefield:se.DATEFIELD_MS,step:10,spacing:10};ge[le.FIFTY_MILLISECONDLY]={datefield:se.DATEFIELD_MS,step:50,spacing:50};ge[le.HUNDRED_MILLISECONDLY]={datefield:se.DATEFIELD_MS,step:100,spacing:100};ge[le.FIVE_HUNDRED_MILLISECONDLY]={datefield:se.DATEFIELD_MS,step:500,spacing:500};ge[le.SECONDLY]={datefield:se.DATEFIELD_SS,step:1,spacing:1e3*1};ge[le.TWO_SECONDLY]={datefield:se.DATEFIELD_SS,step:2,spacing:1e3*2};ge[le.FIVE_SECONDLY]={datefield:se.DATEFIELD_SS,step:5,spacing:1e3*5};ge[le.TEN_SECONDLY]={datefield:se.DATEFIELD_SS,step:10,spacing:1e3*10};ge[le.THIRTY_SECONDLY]={datefield:se.DATEFIELD_SS,step:30,spacing:1e3*30};ge[le.MINUTELY]={datefield:se.DATEFIELD_MM,step:1,spacing:1e3*60};ge[le.TWO_MINUTELY]={datefield:se.DATEFIELD_MM,step:2,spacing:1e3*60*2};ge[le.FIVE_MINUTELY]={datefield:se.DATEFIELD_MM,step:5,spacing:1e3*60*5};ge[le.TEN_MINUTELY]={datefield:se.DATEFIELD_MM,step:10,spacing:1e3*60*10};ge[le.THIRTY_MINUTELY]={datefield:se.DATEFIELD_MM,step:30,spacing:1e3*60*30};ge[le.HOURLY]={datefield:se.DATEFIELD_HH,step:1,spacing:1e3*3600};ge[le.TWO_HOURLY]={datefield:se.DATEFIELD_HH,step:2,spacing:1e3*3600*2};ge[le.SIX_HOURLY]={datefield:se.DATEFIELD_HH,step:6,spacing:1e3*3600*6};ge[le.DAILY]={datefield:se.DATEFIELD_D,step:1,spacing:1e3*86400};ge[le.TWO_DAILY]={datefield:se.DATEFIELD_D,step:2,spacing:1e3*86400*2};ge[le.WEEKLY]={datefield:se.DATEFIELD_D,step:7,spacing:1e3*604800};ge[le.MONTHLY]={datefield:se.DATEFIELD_M,step:1,spacing:1e3*7200*365.2425};ge[le.QUARTERLY]={datefield:se.DATEFIELD_M,step:3,spacing:1e3*21600*365.2425};ge[le.BIANNUAL]={datefield:se.DATEFIELD_M,step:6,spacing:1e3*43200*365.2425};ge[le.ANNUAL]={datefield:se.DATEFIELD_Y,step:1,spacing:1e3*86400*365.2425};ge[le.DECADAL]={datefield:se.DATEFIELD_Y,step:10,spacing:1e3*864e3*365.2425};ge[le.CENTENNIAL]={datefield:se.DATEFIELD_Y,step:100,spacing:1e3*864e4*365.2425};var hr=function(){for(var t=[],i=-39;i<=39;i++)for(var e=Math.pow(10,i),a=1;a<=9;a++){var n=e*a;t.push(n)}return t}(),D0=function(t,i,e,a){for(var n=a("pixelsPerLabel"),r=0;r<le.NUM_GRANULARITIES;r++){var c=P0(t,i,r);if(e/c>=n)return r}return-1},P0=function(t,i,e){var a=ge[e].spacing;return Math.round(1*(i-t)/a)},no=function(t,i,e,a,n){var r=a("axisLabelFormatter"),c=a("labelsUTC"),d=c?_r:fr,m=ge[e].datefield,u=ge[e].step,g=ge[e].spacing,f=new Date(t),y=[];y[se.DATEFIELD_Y]=d.getFullYear(f),y[se.DATEFIELD_M]=d.getMonth(f),y[se.DATEFIELD_D]=d.getDate(f),y[se.DATEFIELD_HH]=d.getHours(f),y[se.DATEFIELD_MM]=d.getMinutes(f),y[se.DATEFIELD_SS]=d.getSeconds(f),y[se.DATEFIELD_MS]=d.getMilliseconds(f);var _=y[m]%u;e==le.WEEKLY&&(_=d.getDay(f)),y[m]-=_;for(var S=m+1;S<se.NUM_DATEFIELDS;S++)y[S]=S===se.DATEFIELD_D?1:0;var P=[],R=d.makeDate.apply(null,y),I=R.getTime();if(e<=le.HOURLY)for(I<t&&(I+=g,R=new Date(I));I<=i;)P.push({v:I,label:r.call(n,R,e,a,n)}),I+=g,R=new Date(I);else for(I<t&&(y[m]+=u,R=d.makeDate.apply(null,y),I=R.getTime());I<=i;)(e>=le.DAILY||d.getHours(R)%u===0)&&P.push({v:I,label:r.call(n,R,e,a,n)}),y[m]+=u,R=d.makeDate.apply(null,y),I=R.getTime();return P};var xi=10,E0=Math.log(xi),Se=function(t){return Math.log(t)/E0},La=function(t,i,e){var a=Se(t),n=Se(i),r=a+e*(n-a),c=Math.pow(xi,r);return c};var Ol=[7,3],Vl=[7,2,2,2],ra=1,oa=2,la=function(t){return t.getContext("2d")},bi=function(i,e,a){i.addEventListener(e,a,!1)};function Et(t,i,e){t.removeEventListener(i,e,!1)}function ai(t){return t=t||window.event,t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.cancel=!0,t.returnValue=!1,!1}function Nl(t,i,e){var a,n,r;if(i===0)a=e,n=e,r=e;else{var c=Math.floor(t*6),d=t*6-c,m=e*(1-i),u=e*(1-i*d),g=e*(1-i*(1-d));switch(c){case 1:a=u,n=e,r=m;break;case 2:a=m,n=e,r=g;break;case 3:a=m,n=u,r=e;break;case 4:a=g,n=m,r=e;break;case 5:a=e,n=m,r=u;break;case 6:case 0:a=e,n=g,r=m;break}}return a=Math.floor(255*a+.5),n=Math.floor(255*n+.5),r=Math.floor(255*r+.5),"rgb("+a+","+n+","+r+")"}function mi(t){var i=t.getBoundingClientRect(),e=window,a=document.documentElement;return{x:i.left+(e.pageXOffset||a.scrollLeft),y:i.top+(e.pageYOffset||a.scrollTop)}}function sa(t){return!t.pageX||t.pageX<0?0:t.pageX}function ca(t){return!t.pageY||t.pageY<0?0:t.pageY}function pa(t,i){return sa(t)-i.px}function ma(t,i){return ca(t)-i.py}function Fl(t){return!!t&&!isNaN(t)}function da(t,i){return!(!t||t.yval===null||t.x===null||t.x===void 0||t.y===null||t.y===void 0||isNaN(t.x)||!i&&isNaN(t.y))}function co(t,i){var e=Math.min(Math.max(1,i||2),21);return Math.abs(t)<.001&&t!==0?t.toExponential(e-1):t.toPrecision(e)}function Ci(t){return t<10?"0"+t:""+t}var fr={getFullYear:t=>t.getFullYear(),getMonth:t=>t.getMonth(),getDate:t=>t.getDate(),getHours:t=>t.getHours(),getMinutes:t=>t.getMinutes(),getSeconds:t=>t.getSeconds(),getMilliseconds:t=>t.getMilliseconds(),getDay:t=>t.getDay(),makeDate:function(t,i,e,a,n,r,c){return new Date(t,i,e,a,n,r,c)}},_r={getFullYear:t=>t.getUTCFullYear(),getMonth:t=>t.getUTCMonth(),getDate:t=>t.getUTCDate(),getHours:t=>t.getUTCHours(),getMinutes:t=>t.getUTCMinutes(),getSeconds:t=>t.getUTCSeconds(),getMilliseconds:t=>t.getUTCMilliseconds(),getDay:t=>t.getUTCDay(),makeDate:function(t,i,e,a,n,r,c){return new Date(Date.UTC(t,i,e,a,n,r,c))}};function so(t,i,e,a){var n=Ci(t)+":"+Ci(i);if(e&&(n+=":"+Ci(e),a)){var r=""+a;n+="."+("000"+r).substring(r.length)}return n}function po(t,i){var e=i?_r:fr,a=new Date(t),n=e.getFullYear(a),r=e.getMonth(a),c=e.getDate(a),d=e.getHours(a),m=e.getMinutes(a),u=e.getSeconds(a),g=e.getMilliseconds(a),f=""+n,y=Ci(r+1),_=Ci(c),S=d*3600+m*60+u+.001*g,P=f+"/"+y+"/"+_;return S&&(P+=" "+so(d,m,u,g)),P}function oo(t,i){var e=Math.pow(10,i);return Math.round(t*e)/e}function Ra(t,i,e,a,n){if((a==null||n===null||n===void 0)&&(a=0,n=i.length-1),a>n)return-1;e==null&&(e=0);var r=function(u){return u>=0&&u<i.length},c=parseInt((a+n)/2,10),d=i[c],m;return d==t?c:d>t?e>0&&(m=c-1,r(m)&&i[m]<t)?c:Ra(t,i,e,a,c-1):d<t?e<0&&(m=c+1,r(m)&&i[m]>t)?c:Ra(t,i,e,c+1,n):-1}function mo(t){var i,e;if((t.search("-")==-1||t.search("T")!=-1||t.search("Z")!=-1)&&(e=lo(t),e&&!isNaN(e)))return e;if(t.search("-")!=-1){for(i=t.replace("-","/","g");i.search("-")!=-1;)i=i.replace("-","/");e=lo(i)}else e=lo(t);return(!e||isNaN(e))&&console.error("Couldn't parse "+t+" as a date"),e}function lo(t){return new Date(t).getTime()}function vt(t,i){if(typeof i<"u"&&i!==null)for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e]);return t}var k0=typeof Node<"u"&&Node!==null&&typeof Node=="object"?function(i){return i instanceof Node}:function(i){return typeof i=="object"&&typeof i.nodeType=="number"&&typeof i.nodeName=="string"};function vr(t,i){if(typeof i<"u"&&i!==null){for(var e in i)if(i.hasOwnProperty(e)){let a=i[e];a===null?t[e]=null:Si(a)?t[e]=a.slice():k0(a)?t[e]=a:typeof a=="object"?((typeof t[e]!="object"||t[e]===null)&&(t[e]={}),vr(t[e],a)):t[e]=a}}return t}function Bl(t){if(t===null)return"null";let i=typeof t;return(i==="object"||i==="function"&&typeof t.item=="function")&&typeof t.length=="number"&&t.nodeType!==3&&t.nodeType!==4?"array":i}function Si(t){let i=typeof t;return t!==null&&(i==="object"||i==="function"&&typeof t.item=="function")&&typeof t.length=="number"&&t.nodeType!==3&&t.nodeType!==4}function uo(t){return t!==null&&typeof t=="object"&&typeof t.getTime=="function"}function ho(t){for(var i=[],e=0;e<t.length;e++)Si(t[e])?i.push(ho(t[e])):i.push(t[e]);return i}function ua(){return document.createElement("canvas")}function Oa(t){try{var i=window.devicePixelRatio,e=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return i!==void 0?i/e:1}catch{return 1}}function $l(t,i,e,a){i=i||0,e=e||t.length,this.hasNext=!0,this.peek=null,this.start_=i,this.array_=t,this.predicate_=a,this.end_=Math.min(t.length,i+e),this.nextIdx_=i-1,this.next()}$l.prototype.next=function(){if(!this.hasNext)return null;for(var t=this.peek,i=this.nextIdx_+1,e=!1;i<this.end_;){if(!this.predicate_||this.predicate_(this.array_,i)){this.peek=this.array_[i],e=!0;break}i++}return this.nextIdx_=i,e||(this.hasNext=!1,this.peek=null),t};function yr(t,i,e,a){return new $l(t,i,e,a)}var A0=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function fo(t,i,e,a){var n=0,r,c=new Date().getTime();if(t(n),i==1){a();return}var d=i-1;(function m(){n>=i||A0.call(window,function(){var u=new Date().getTime(),g=u-c;r=n,n=Math.floor(g/e);var f=n-r,y=n+f>d;y||n>=d?(t(d),a()):(f!==0&&t(n),m())})})()}var Al={annotationClickHandler:!0,annotationDblClickHandler:!0,annotationMouseOutHandler:!0,annotationMouseOverHandler:!0,axisLineColor:!0,axisLineWidth:!0,clickCallback:!0,drawCallback:!0,drawHighlightPointCallback:!0,drawPoints:!0,drawPointCallback:!0,drawGrid:!0,fillAlpha:!0,gridLineColor:!0,gridLineWidth:!0,hideOverlayOnMouseOut:!0,highlightCallback:!0,highlightCircleSize:!0,interactionModel:!0,labelsDiv:!0,labelsKMB:!0,labelsKMG2:!0,labelsSeparateLines:!0,labelsShowZeroValues:!0,legend:!0,panEdgeFraction:!0,pixelsPerYLabel:!0,pointClickCallback:!0,pointSize:!0,rangeSelectorPlotFillColor:!0,rangeSelectorPlotFillGradientColor:!0,rangeSelectorPlotStrokeColor:!0,rangeSelectorBackgroundStrokeColor:!0,rangeSelectorBackgroundLineWidth:!0,rangeSelectorPlotLineWidth:!0,rangeSelectorForegroundStrokeColor:!0,rangeSelectorForegroundLineWidth:!0,rangeSelectorAlpha:!0,showLabelsOnHighlight:!0,showRoller:!0,strokeWidth:!0,underlayCallback:!0,unhighlightCallback:!0,zoomCallback:!0};function Hl(t,i){var e={};if(t)for(var a=1;a<t.length;a++)e[t[a]]=!0;var n=function(m){for(var u in m)if(m.hasOwnProperty(u)&&!Al[u])return!0;return!1};for(var r in i)if(i.hasOwnProperty(r)){if(r=="highlightSeriesOpts"||e[r]&&!i.series){if(n(i[r]))return!0}else if(r=="series"||r=="axes"){var c=i[r];for(var d in c)if(c.hasOwnProperty(d)&&n(c[d]))return!0}else if(!Al[r])return!0}return!1}var Va={DEFAULT:function(t,i,e,a,n,r,c){e.beginPath(),e.fillStyle=r,e.arc(a,n,c,0,2*Math.PI,!1),e.fill()}};function _o(t){for(var i=0;i<t.length;i++){var e=t.charAt(i);if(e==="\r")return i+1<t.length&&t.charAt(i+1)===`
`?`\r
`:e;if(e===`
`)return i+1<t.length&&t.charAt(i+1)==="\r"?`
\r`:e}return null}function go(t,i){if(i===null||t===null)return!1;for(var e=t;e&&e!==i;)e=e.parentNode;return e===i}function Ml(t,i){return i<0?1/Math.pow(t,-i):Math.pow(t,i)}var M0=/^#([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})?$/,R0=/^rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(?:,\s*([01](?:\.\d+)?))?\)$/;function Rl(t){var i,e,a,n,r=null;if(i=M0.exec(t))e=parseInt(i[1],16),a=parseInt(i[2],16),n=parseInt(i[3],16),i[4]&&(r=parseInt(i[4],16));else if(i=R0.exec(t))e=parseInt(i[1],10),a=parseInt(i[2],10),n=parseInt(i[3],10),i[4]&&(r=parseFloat(i[4]));else return null;return r!==null?{r:e,g:a,b:n,a:r}:{r:e,g:a,b:n}}function ha(t){var i=Rl(t);if(i)return i;var e=document.createElement("div");e.style.backgroundColor=t,e.style.visibility="hidden",document.body.appendChild(e);var a=window.getComputedStyle(e,null).backgroundColor;return document.body.removeChild(e),Rl(a)}function Yl(t){try{var i=t||document.createElement("canvas");i.getContext("2d")}catch{return!1}return!0}function ni(t,i,e){var a=parseFloat(t);if(!isNaN(a))return a;if(/^ *$/.test(t))return null;if(/^ *nan *$/i.test(t))return NaN;var n="Unable to parse '"+t+"' as a number";return e!==void 0&&i!==void 0&&(n+=" on line "+(1+(i||0))+" ('"+e+"') of CSV."),console.error(n),null}var I0=["k","M","G","T","P","E","Z","Y"],Gl=["m","\xB5","n","p","f","a","z","y"],L0=["Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"],O0=["p-10","p-20","p-30","p-40","p-50","p-60","p-70","p-80"],V0=["K","M","G","T","P","E","Z","Y"],N0=Gl;function Cr(t,i){var e=i("sigFigs");if(e!==null)return co(t,e);if(t===0)return"0";var a=i("digitsAfterDecimal"),n=i("maxNumberWidth"),r=i("labelsKMB"),c=i("labelsKMG2"),d,m=Math.abs(t);if(r||c){var u,g=[],f=[];r&&(u=1e3,g=I0,f=Gl),c&&(u=1024,g=L0,f=O0,r&&(g=V0,f=N0));var y,_;if(m>=u){for(_=g.length;_>0;)if(y=Ml(u,_),--_,m>=y)return m/y>=Math.pow(10,n)?d=t.toExponential(a):d=oo(t/y,a)+g[_],d}else if(m<1){for(_=0;_<f.length&&(++_,y=Ml(u,_),!(m*y>=1)););return m*y<Math.pow(10,-a)?d=t.toExponential(a):d=oo(t*y,a)+f[_-1],d}}return m>=Math.pow(10,n)||m<Math.pow(10,-a)?d=t.toExponential(a):d=""+oo(t,a),d}function Na(t,i,e){return Cr.call(this,t,e)}var Il=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function wi(t,i,e){var a=e("labelsUTC"),n=a?_r:fr,r=n.getFullYear(t),c=n.getMonth(t),d=n.getDate(t),m=n.getHours(t),u=n.getMinutes(t),g=n.getSeconds(t),f=n.getMilliseconds(t);if(i>=le.DECADAL)return""+r;if(i>=le.MONTHLY)return Il[c]+"&#160;"+r;var y=m*3600+u*60+g+.001*f;if(y===0||i>=le.DAILY)return Ci(d)+"&#160;"+Il[c];if(i<le.SECONDLY){var _=""+f;return Ci(g)+"."+("000"+_).substring(_.length)}else return i>le.MINUTELY?so(m,u,g,0):so(m,u,g,f)}function fa(t,i){return po(t,i("labelsUTC"))}var gr=[],Ll=!1;function Ia(t){return typeof t=="function"&&t(),!0}function Ul(t){if(typeof document<"u"){let i=function(){if(!Ll){Ll=!0,t.onDOMready=Ia,document.removeEventListener("DOMContentLoaded",i,!1),window.removeEventListener("load",i,!1);for(let a=0;a<gr.length;++a)gr[a]();gr=null}};t.onDOMready=function(a){if(document.readyState==="complete")return t.onDOMready=Ia,Ia(a);let n=function(c){return typeof c=="function"&&gr.push(c),!1};return t.onDOMready=n,document.addEventListener("DOMContentLoaded",i,!1),window.addEventListener("load",i,!1),document.readyState==="complete"?(i(),t.onDOMready=Ia,Ia(a)):n(a)}}}var lt=function(t){this.dygraph_=t,this.points=[],this.setNames=[],this.annotations=[],this.yAxes_=null,this.xTicks_=null,this.yTicks_=null};lt.prototype.addDataset=function(t,i){this.points.push(i),this.setNames.push(t)};lt.prototype.getPlotArea=function(){return this.area_};lt.prototype.computePlotArea=function(){var t={x:0,y:0};t.w=this.dygraph_.width_-t.x-this.dygraph_.getOption("rightGap"),t.h=this.dygraph_.height_;var i={chart_div:this.dygraph_.graphDiv,reserveSpaceLeft:function(e){var a={x:t.x,y:t.y,w:e,h:t.h};return t.x+=e,t.w-=e,a},reserveSpaceRight:function(e){var a={x:t.x+t.w-e,y:t.y,w:e,h:t.h};return t.w-=e,a},reserveSpaceTop:function(e){var a={x:t.x,y:t.y,w:t.w,h:e};return t.y+=e,t.h-=e,a},reserveSpaceBottom:function(e){var a={x:t.x,y:t.y+t.h-e,w:t.w,h:e};return t.h-=e,a},chartRect:function(){return{x:t.x,y:t.y,w:t.w,h:t.h}}};this.dygraph_.cascadeEvents_("layout",i),this.area_=t};lt.prototype.setAnnotations=function(t){this.annotations=[];for(var i=this.dygraph_.getOption("xValueParser")||function(n){return n},e=0;e<t.length;e++){var a={};if(!t[e].xval&&t[e].x===void 0){console.error("Annotations must have an 'x' property");return}if(t[e].icon&&!(t[e].hasOwnProperty("width")&&t[e].hasOwnProperty("height"))){console.error("Must set width and height when setting annotation.icon property");return}vt(a,t[e]),a.xval||(a.xval=i(a.x)),this.annotations.push(a)}};lt.prototype.setXTicks=function(t){this.xTicks_=t};lt.prototype.setYAxes=function(t){this.yAxes_=t};lt.prototype.evaluate=function(){this._xAxis={},this._evaluateLimits(),this._evaluateLineCharts(),this._evaluateLineTicks(),this._evaluateAnnotations()};lt.prototype._evaluateLimits=function(){var t=this.dygraph_.xAxisRange();this._xAxis.minval=t[0],this._xAxis.maxval=t[1];var i=t[1]-t[0];this._xAxis.scale=i!==0?1/i:1,this.dygraph_.getOptionForAxis("logscale","x")&&(this._xAxis.xlogrange=Se(this._xAxis.maxval)-Se(this._xAxis.minval),this._xAxis.xlogscale=this._xAxis.xlogrange!==0?1/this._xAxis.xlogrange:1);for(var e=0;e<this.yAxes_.length;e++){var a=this.yAxes_[e];a.minyval=a.computedValueRange[0],a.maxyval=a.computedValueRange[1],a.yrange=a.maxyval-a.minyval,a.yscale=a.yrange!==0?1/a.yrange:1,(this.dygraph_.getOption("logscale")||a.logscale)&&(a.ylogrange=Se(a.maxyval)-Se(a.minyval),a.ylogscale=a.ylogrange!==0?1/a.ylogrange:1,(!isFinite(a.ylogrange)||isNaN(a.ylogrange))&&console.error("axis "+e+" of graph at "+a.g+" can't be displayed in log scale for range ["+a.minyval+" - "+a.maxyval+"]"))}};lt.calcXNormal_=function(t,i,e){return e?(Se(t)-Se(i.minval))*i.xlogscale:(t-i.minval)*i.scale};lt.calcYNormal_=function(t,i,e){if(e){var a=1-(Se(i)-Se(t.minyval))*t.ylogscale;return isFinite(a)?a:NaN}else return 1-(i-t.minyval)*t.yscale};lt.prototype._evaluateLineCharts=function(){for(var t=this.dygraph_.getOption("stackedGraph"),i=this.dygraph_.getOptionForAxis("logscale","x"),e=0;e<this.points.length;e++){for(var a=this.points[e],n=this.setNames[e],r=this.dygraph_.getOption("connectSeparatedPoints",n),c=this.dygraph_.axisPropertiesForSeries(n),d=this.dygraph_.attributes_.getForSeries("logscale",n),m=0;m<a.length;m++){var u=a[m];u.x=lt.calcXNormal_(u.xval,this._xAxis,i);var g=u.yval;t&&(u.y_stacked=lt.calcYNormal_(c,u.yval_stacked,d),g!==null&&!isNaN(g)&&(g=u.yval_stacked)),g===null&&(g=NaN,r||(u.yval=NaN)),u.y=lt.calcYNormal_(c,g,d)}this.dygraph_.dataHandler_.onLineEvaluated(a,c,d)}};lt.prototype._evaluateLineTicks=function(){var t,i,e,a,n,r;for(this.xticks=[],t=0;t<this.xTicks_.length;t++)i=this.xTicks_[t],e=i.label,r=!("label_v"in i),n=r?i.v:i.label_v,a=this.dygraph_.toPercentXCoord(n),a>=0&&a<1&&this.xticks.push({pos:a,label:e,has_tick:r});for(this.yticks=[],t=0;t<this.yAxes_.length;t++)for(var c=this.yAxes_[t],d=0;d<c.ticks.length;d++)i=c.ticks[d],e=i.label,r=!("label_v"in i),n=r?i.v:i.label_v,a=this.dygraph_.toPercentYCoord(n,t),a>0&&a<=1&&this.yticks.push({axis:t,pos:a,label:e,has_tick:r})};lt.prototype._evaluateAnnotations=function(){var t,i={};for(t=0;t<this.annotations.length;t++){var e=this.annotations[t];i[e.xval+","+e.series]=e}if(this.annotated_points=[],!(!this.annotations||!this.annotations.length))for(var a=0;a<this.points.length;a++){var n=this.points[a];for(t=0;t<n.length;t++){var r=n[t],c=r.xval+","+r.name;c in i&&(r.annotation=i[c],this.annotated_points.push(r),delete i[c])}}};lt.prototype.removeAllDatasets=function(){delete this.points,delete this.setNames,delete this.setPointsLengths,delete this.setPointsOffsets,this.points=[],this.setNames=[],this.setPointsLengths=[],this.setPointsOffsets=[]};var Fa=lt;var ke=function(t,i,e,a){if(this.dygraph_=t,this.layout=a,this.element=i,this.elementContext=e,this.height=t.height_,this.width=t.width_,!Yl(this.element))throw"Canvas is not supported.";this.area=a.getPlotArea();var n=this.dygraph_.canvas_ctx_;n.beginPath(),n.rect(this.area.x,this.area.y,this.area.w,this.area.h),n.clip(),n=this.dygraph_.hidden_ctx_,n.beginPath(),n.rect(this.area.x,this.area.y,this.area.w,this.area.h),n.clip()};ke.prototype.clear=function(){this.elementContext.clearRect(0,0,this.width,this.height)};ke.prototype.render=function(){this._updatePoints(),this._renderLineChart()};ke._getIteratorPredicate=function(t){return t?ke._predicateThatSkipsEmptyPoints:null};ke._predicateThatSkipsEmptyPoints=function(t,i){return t[i].yval!==null};ke._drawStyledLine=function(t,i,e,a,n,r,c){var d=t.dygraph,m=d.getBooleanOption("stepPlot",t.setName);Si(a)||(a=null);var u=d.getBooleanOption("drawGapEdgePoints",t.setName),g=t.points,f=t.setName,y=yr(g,0,g.length,ke._getIteratorPredicate(d.getBooleanOption("connectSeparatedPoints",f))),_=a&&a.length>=2,S=t.drawingContext;S.save(),_&&S.setLineDash&&S.setLineDash(a);var P=ke._drawSeries(t,y,e,c,n,u,m,i);ke._drawPointsOnLine(t,P,r,i,c),_&&S.setLineDash&&S.setLineDash([]),S.restore()};ke._drawSeries=function(t,i,e,a,n,r,c,d){var m=null,u=null,g=null,f,y,_=[],S=!0,P=t.drawingContext;P.beginPath(),P.strokeStyle=d,P.lineWidth=e;for(var R=i.array_,I=i.end_,O=i.predicate_,Y=i.start_;Y<I;Y++){if(y=R[Y],O){for(;Y<I&&!O(R,Y);)Y++;if(Y==I)break;y=R[Y]}if(y.canvasy===null||y.canvasy!=y.canvasy)c&&m!==null&&(P.moveTo(m,u),P.lineTo(y.canvasx,u)),m=u=null;else{if(f=!1,r||m===null){i.nextIdx_=Y,i.next(),g=i.hasNext?i.peek.canvasy:null;var U=g===null||g!=g;f=m===null&&U,r&&(!S&&m===null||i.hasNext&&U)&&(f=!0)}m!==null?e&&(c&&(P.moveTo(m,u),P.lineTo(y.canvasx,u)),P.lineTo(y.canvasx,y.canvasy)):P.moveTo(y.canvasx,y.canvasy),(n||f)&&_.push([y.canvasx,y.canvasy,y.idx]),m=y.canvasx,u=y.canvasy}S=!1}return P.stroke(),_};ke._drawPointsOnLine=function(t,i,e,a,n){for(var r=t.drawingContext,c=0;c<i.length;c++){var d=i[c];r.save(),e.call(t.dygraph,t.dygraph,t.setName,r,d[0],d[1],a,n,d[2]),r.restore()}};ke.prototype._updatePoints=function(){for(var t=this.layout.points,i=t.length;i--;)for(var e=t[i],a=e.length;a--;){var n=e[a];n.canvasx=this.area.w*n.x+this.area.x,n.canvasy=this.area.h*n.y+this.area.y}};ke.prototype._renderLineChart=function(t,i){var e=i||this.elementContext,a,n=this.layout.points,r=this.layout.setNames,c;this.colors=this.dygraph_.colorsMap_;var d=this.dygraph_.getOption("plotter"),m=d;Si(m)||(m=[m]);var u={};for(a=0;a<r.length;a++){c=r[a];var g=this.dygraph_.getOption("plotter",c);g!=d&&(u[c]=g)}for(a=0;a<m.length;a++)for(var f=m[a],y=a==m.length-1,_=0;_<n.length;_++)if(c=r[_],!(t&&c!=t)){var S=n[_],P=f;if(c in u)if(y)P=u[c];else continue;var R=this.colors[c],I=this.dygraph_.getOption("strokeWidth",c);e.save(),e.strokeStyle=R,e.lineWidth=I,P({points:S,setName:c,drawingContext:e,color:R,strokeWidth:I,dygraph:this.dygraph_,axis:this.dygraph_.axisPropertiesForSeries(c),plotArea:this.area,seriesIndex:_,seriesCount:n.length,singleSeriesName:t,allSeriesPoints:n}),e.restore()}};ke._Plotters={linePlotter:function(t){ke._linePlotter(t)},fillPlotter:function(t){ke._fillPlotter(t)},errorPlotter:function(t){ke._errorPlotter(t)}};ke._linePlotter=function(t){var i=t.dygraph,e=t.setName,a=t.strokeWidth,n=i.getNumericOption("strokeBorderWidth",e),r=i.getOption("drawPointCallback",e)||Va.DEFAULT,c=i.getOption("strokePattern",e),d=i.getBooleanOption("drawPoints",e),m=i.getNumericOption("pointSize",e);n&&a&&ke._drawStyledLine(t,i.getOption("strokeBorderColor",e),a+2*n,c,d,r,m),ke._drawStyledLine(t,t.color,a,c,d,r,m)};ke._errorPlotter=function(t){var i=t.dygraph,e=t.setName,a=i.getBooleanOption("errorBars")||i.getBooleanOption("customBars");if(a){var n=i.getBooleanOption("fillGraph",e);n&&console.warn("Can't use fillGraph option with customBars or errorBars option");var r=t.drawingContext,c=t.color,d=i.getNumericOption("fillAlpha",e),m=i.getBooleanOption("stepPlot",e),u=t.points,g=yr(u,0,u.length,ke._getIteratorPredicate(i.getBooleanOption("connectSeparatedPoints",e))),f,y=NaN,_=NaN,S=[-1,-1],P=ha(c),R="rgba("+P.r+","+P.g+","+P.b+","+d+")";r.fillStyle=R,r.beginPath();for(var I=function(Y){return Y==null||isNaN(Y)};g.hasNext;){var O=g.next();if(!m&&I(O.y)||m&&!isNaN(_)&&I(_)){y=NaN;continue}f=[O.y_bottom,O.y_top],m&&(_=O.y),isNaN(f[0])&&(f[0]=O.y),isNaN(f[1])&&(f[1]=O.y),f[0]=t.plotArea.h*f[0]+t.plotArea.y,f[1]=t.plotArea.h*f[1]+t.plotArea.y,isNaN(y)||(m?(r.moveTo(y,S[0]),r.lineTo(O.canvasx,S[0]),r.lineTo(O.canvasx,S[1])):(r.moveTo(y,S[0]),r.lineTo(O.canvasx,f[0]),r.lineTo(O.canvasx,f[1])),r.lineTo(y,S[1]),r.closePath()),S=f,y=O.canvasx}r.fill()}};ke._fastCanvasProxy=function(t){var i=[],e=null,a=null,n=1,r=2,c=0,d=function(g){if(!(i.length<=1)){for(var f=i.length-1;f>0;f--){var y=i[f];if(y[0]==r){var _=i[f-1];_[1]==y[1]&&_[2]==y[2]&&i.splice(f,1)}}for(var f=0;f<i.length-1;){var y=i[f];y[0]==r&&i[f+1][0]==r?i.splice(f,1):f++}if(i.length>2&&!g){var S=0;i[0][0]==r&&S++;for(var P=null,R=null,f=S;f<i.length;f++){var y=i[f];if(y[0]==n)if(P===null&&R===null)P=f,R=f;else{var I=y[2];I<i[P][2]?P=f:I>i[R][2]&&(R=f)}}var O=i[P],Y=i[R];i.splice(S,i.length-S),P<R?(i.push(O),i.push(Y)):(P>R&&i.push(Y),i.push(O))}}},m=function(g){d(g);for(var f=0,y=i.length;f<y;f++){var _=i[f];_[0]==n?t.lineTo(_[1],_[2]):_[0]==r&&t.moveTo(_[1],_[2])}i.length&&(a=i[i.length-1][1]),c+=i.length,i=[]},u=function(g,f,y){var _=Math.round(f);if(e===null||_!=e){var S=e-a>1,P=_-e>1,R=S||P;m(R),e=_}i.push([g,f,y])};return{moveTo:function(g,f){u(r,g,f)},lineTo:function(g,f){u(n,g,f)},stroke:function(){m(!0),t.stroke()},fill:function(){m(!0),t.fill()},beginPath:function(){m(!0),t.beginPath()},closePath:function(){m(!0),t.closePath()},_count:function(){return c}}};ke._fillPlotter=function(t){if(!t.singleSeriesName&&t.seriesIndex===0){for(var i=t.dygraph,e=i.getLabels().slice(1),a=e.length;a>=0;a--)i.visibility()[a]||e.splice(a,1);var n=function(){for(var Bt=0;Bt<e.length;Bt++)if(i.getBooleanOption("fillGraph",e[Bt]))return!0;return!1}();if(n)for(var r=t.plotArea,c=t.allSeriesPoints,d=c.length,m=i.getBooleanOption("stackedGraph"),u=i.getColors(),g={},f,y,_=function(Bt,Jl,es,Mo){if(Bt.lineTo(Jl,es),m)for(var Wr=Mo.length-1;Wr>=0;Wr--){var Ro=Mo[Wr];Bt.lineTo(Ro[0],Ro[1])}},S=d-1;S>=0;S--){var P=t.drawingContext,R=e[S];if(i.getBooleanOption("fillGraph",R)){var I=i.getNumericOption("fillAlpha",R),O=i.getBooleanOption("stepPlot",R),Y=u[S],U=i.axisPropertiesForSeries(R),Q=1+U.minyval*U.yscale;Q<0?Q=0:Q>1&&(Q=1),Q=r.h*Q+r.y;var Ae=c[S],z=yr(Ae,0,Ae.length,ke._getIteratorPredicate(i.getBooleanOption("connectSeparatedPoints",R))),K=NaN,de=[-1,-1],j,ce=ha(Y),st="rgba("+ce.r+","+ce.g+","+ce.b+","+I+")";P.fillStyle=st,P.beginPath();var Le,Pt=!0;(Ae.length>2*i.width_||qe.FORCE_FAST_PROXY)&&(P=ke._fastCanvasProxy(P));for(var Xe=[],Ce;z.hasNext;){if(Ce=z.next(),!Fl(Ce.y)&&!O){_(P,K,de[1],Xe),Xe=[],K=NaN,Ce.y_stacked!==null&&!isNaN(Ce.y_stacked)&&(g[Ce.canvasx]=r.h*Ce.y_stacked+r.y);continue}if(m){if(!Pt&&Le==Ce.xval)continue;Pt=!1,Le=Ce.xval,f=g[Ce.canvasx];var Mi;f===void 0?Mi=Q:y?Mi=f[0]:Mi=f,j=[Ce.canvasy,Mi],O?de[0]===-1?g[Ce.canvasx]=[Ce.canvasy,Q]:g[Ce.canvasx]=[Ce.canvasy,de[0]]:g[Ce.canvasx]=Ce.canvasy}else isNaN(Ce.canvasy)&&O?j=[r.y+r.h,Q]:j=[Ce.canvasy,Q];isNaN(K)?(P.moveTo(Ce.canvasx,j[1]),P.lineTo(Ce.canvasx,j[0])):(O&&P.lineTo(Ce.canvasx,de[0]),P.lineTo(Ce.canvasx,j[0]),m&&(Xe.push([K,de[1]]),y&&f?Xe.push([Ce.canvasx,f[1]]):Xe.push([Ce.canvasx,j[1]]))),de=j,K=Ce.canvasx}y=O,j&&Ce&&(_(P,Ce.canvasx,j[1],Xe),Xe=[]),P.fill()}}}};var Ti=ke;var F0=100,ve={};ve.maybeTreatMouseOpAsClick=function(t,i,e){e.dragEndX=pa(t,e),e.dragEndY=ma(t,e);var a=Math.abs(e.dragEndX-e.dragStartX),n=Math.abs(e.dragEndY-e.dragStartY);a<2&&n<2&&i.lastx_!==void 0&&i.lastx_!==null&&ve.treatMouseOpAsClick(i,t,e),e.regionWidth=a,e.regionHeight=n};ve.startPan=function(t,i,e){var a,n;e.isPanning=!0;var r=i.xAxisRange();if(i.getOptionForAxis("logscale","x")?(e.initialLeftmostDate=Se(r[0]),e.dateRange=Se(r[1])-Se(r[0])):(e.initialLeftmostDate=r[0],e.dateRange=r[1]-r[0]),e.xUnitsPerPixel=e.dateRange/(i.plotter_.area.w-1),i.getNumericOption("panEdgeFraction")){var c=i.width_*i.getNumericOption("panEdgeFraction"),d=i.xAxisExtremes(),m=i.toDomXCoord(d[0])-c,u=i.toDomXCoord(d[1])+c,g=i.toDataXCoord(m),f=i.toDataXCoord(u);e.boundedDates=[g,f];var y=[],_=i.height_*i.getNumericOption("panEdgeFraction");for(a=0;a<i.axes_.length;a++){n=i.axes_[a];var S=n.extremeRange,P=i.toDomYCoord(S[0],a)+_,R=i.toDomYCoord(S[1],a)-_,I=i.toDataYCoord(P,a),O=i.toDataYCoord(R,a);y[a]=[I,O]}e.boundedValues=y}else e.boundedDates=null,e.boundedValues=null;for(e.is2DPan=!1,e.axes=[],a=0;a<i.axes_.length;a++){n=i.axes_[a];var Y={},U=i.yAxisRange(a),Q=i.attributes_.getForAxis("logscale",a);Q?(Y.initialTopValue=Se(U[1]),Y.dragValueRange=Se(U[1])-Se(U[0])):(Y.initialTopValue=U[1],Y.dragValueRange=U[1]-U[0]),Y.unitsPerPixel=Y.dragValueRange/(i.plotter_.area.h-1),e.axes.push(Y),n.valueRange&&(e.is2DPan=!0)}};ve.movePan=function(t,i,e){e.dragEndX=pa(t,e),e.dragEndY=ma(t,e);var a=e.initialLeftmostDate-(e.dragEndX-e.dragStartX)*e.xUnitsPerPixel;e.boundedDates&&(a=Math.max(a,e.boundedDates[0]));var n=a+e.dateRange;if(e.boundedDates&&n>e.boundedDates[1]&&(a=a-(n-e.boundedDates[1]),n=a+e.dateRange),i.getOptionForAxis("logscale","x")?i.dateWindow_=[Math.pow(xi,a),Math.pow(xi,n)]:i.dateWindow_=[a,n],e.is2DPan)for(var r=e.dragEndY-e.dragStartY,c=0;c<i.axes_.length;c++){var d=i.axes_[c],m=e.axes[c],u=r*m.unitsPerPixel,g=e.boundedValues?e.boundedValues[c]:null,f=m.initialTopValue+u;g&&(f=Math.min(f,g[1]));var y=f-m.dragValueRange;g&&y<g[0]&&(f=f-(y-g[0]),y=f-m.dragValueRange),i.attributes_.getForAxis("logscale",c)?d.valueRange=[Math.pow(xi,y),Math.pow(xi,f)]:d.valueRange=[y,f]}i.drawGraph_(!1)};ve.endPan=ve.maybeTreatMouseOpAsClick;ve.startZoom=function(t,i,e){e.isZooming=!0,e.zoomMoved=!1};ve.moveZoom=function(t,i,e){e.zoomMoved=!0,e.dragEndX=pa(t,e),e.dragEndY=ma(t,e);var a=Math.abs(e.dragStartX-e.dragEndX),n=Math.abs(e.dragStartY-e.dragEndY);e.dragDirection=a<n/2?oa:ra,i.drawZoomRect_(e.dragDirection,e.dragStartX,e.dragEndX,e.dragStartY,e.dragEndY,e.prevDragDirection,e.prevEndX,e.prevEndY),e.prevEndX=e.dragEndX,e.prevEndY=e.dragEndY,e.prevDragDirection=e.dragDirection};ve.treatMouseOpAsClick=function(t,i,e){for(var a=t.getFunctionOption("clickCallback"),n=t.getFunctionOption("pointClickCallback"),r=null,c=-1,d=Number.MAX_VALUE,m=0;m<t.selPoints_.length;m++){var u=t.selPoints_[m],g=Math.pow(u.canvasx-e.dragEndX,2)+Math.pow(u.canvasy-e.dragEndY,2);!isNaN(g)&&(c==-1||g<d)&&(d=g,c=m)}var f=t.getNumericOption("highlightCircleSize")+2;if(d<=f*f&&(r=t.selPoints_[c]),r){var _={cancelable:!0,point:r,canvasx:e.dragEndX,canvasy:e.dragEndY},y=t.cascadeEvents_("pointClick",_);if(y)return;n&&n.call(t,i,r)}var _={cancelable:!0,xval:t.lastx_,pts:t.selPoints_,canvasx:e.dragEndX,canvasy:e.dragEndY};t.cascadeEvents_("click",_)||a&&a.call(t,i,t.lastx_,t.selPoints_)};ve.endZoom=function(t,i,e){i.clearZoomRect_(),e.isZooming=!1,ve.maybeTreatMouseOpAsClick(t,i,e);var a=i.getArea();if(e.regionWidth>=10&&e.dragDirection==ra){var n=Math.min(e.dragStartX,e.dragEndX),r=Math.max(e.dragStartX,e.dragEndX);n=Math.max(n,a.x),r=Math.min(r,a.x+a.w),n<r&&i.doZoomX_(n,r),e.cancelNextDblclick=!0}else if(e.regionHeight>=10&&e.dragDirection==oa){var c=Math.min(e.dragStartY,e.dragEndY),d=Math.max(e.dragStartY,e.dragEndY);c=Math.max(c,a.y),d=Math.min(d,a.y+a.h),c<d&&i.doZoomY_(c,d),e.cancelNextDblclick=!0}e.dragStartX=null,e.dragStartY=null};ve.startTouch=function(t,i,e){t.preventDefault(),t.touches.length>1&&(e.startTimeForDoubleTapMs=null);for(var a=[],n=0;n<t.touches.length;n++){var r=t.touches[n],c=r.target.getBoundingClientRect();a.push({pageX:r.pageX,pageY:r.pageY,dataX:i.toDataXCoord(r.clientX-c.left),dataY:i.toDataYCoord(r.clientY-c.top)})}if(e.initialTouches=a,a.length==1)e.initialPinchCenter=a[0],e.touchDirections={x:!0,y:!0};else if(a.length>=2){e.initialPinchCenter={pageX:.5*(a[0].pageX+a[1].pageX),pageY:.5*(a[0].pageY+a[1].pageY),dataX:.5*(a[0].dataX+a[1].dataX),dataY:.5*(a[0].dataY+a[1].dataY)};var d=180/Math.PI*Math.atan2(e.initialPinchCenter.pageY-a[0].pageY,a[0].pageX-e.initialPinchCenter.pageX);d=Math.abs(d),d>90&&(d=90-d),e.touchDirections={x:d<90-45/2,y:d>45/2}}e.initialRange={x:i.xAxisRange(),y:i.yAxisRange()}};ve.moveTouch=function(t,i,e){e.startTimeForDoubleTapMs=null;var a,n=[];for(a=0;a<t.touches.length;a++){var r=t.touches[a];n.push({pageX:r.pageX,pageY:r.pageY})}var c=e.initialTouches,d,m=e.initialPinchCenter;n.length==1?d=n[0]:d={pageX:.5*(n[0].pageX+n[1].pageX),pageY:.5*(n[0].pageY+n[1].pageY)};var u={pageX:d.pageX-m.pageX,pageY:d.pageY-m.pageY},g=e.initialRange.x[1]-e.initialRange.x[0],f=e.initialRange.y[0]-e.initialRange.y[1];u.dataX=u.pageX/i.plotter_.area.w*g,u.dataY=u.pageY/i.plotter_.area.h*f;var y,_;if(n.length==1)y=1,_=1;else if(n.length>=2){var S=c[1].pageX-m.pageX;y=(n[1].pageX-d.pageX)/S;var P=c[1].pageY-m.pageY;_=(n[1].pageY-d.pageY)/P}y=Math.min(8,Math.max(.125,y)),_=Math.min(8,Math.max(.125,_));var R=!1;if(e.touchDirections.x){var I=m.dataX-u.dataX/y;i.dateWindow_=[I+(e.initialRange.x[0]-m.dataX)/y,I+(e.initialRange.x[1]-m.dataX)/y],R=!0}if(e.touchDirections.y)for(a=0;a<1;a++){var O=i.axes_[a],Y=i.attributes_.getForAxis("logscale",a);if(!Y){var I=m.dataY-u.dataY/_;O.valueRange=[I+(e.initialRange.y[0]-m.dataY)/_,I+(e.initialRange.y[1]-m.dataY)/_],R=!0}}if(i.drawGraph_(!1),R&&n.length>1&&i.getFunctionOption("zoomCallback")){var U=i.xAxisRange();i.getFunctionOption("zoomCallback").call(i,U[0],U[1],i.yAxisRanges())}};ve.endTouch=function(t,i,e){if(t.touches.length!==0)ve.startTouch(t,i,e);else if(t.changedTouches.length==1){var a=new Date().getTime(),n=t.changedTouches[0];e.startTimeForDoubleTapMs&&a-e.startTimeForDoubleTapMs<500&&e.doubleTapX&&Math.abs(e.doubleTapX-n.screenX)<50&&e.doubleTapY&&Math.abs(e.doubleTapY-n.screenY)<50?i.resetZoom():(e.startTimeForDoubleTapMs=a,e.doubleTapX=n.screenX,e.doubleTapY=n.screenY)}};var zl=function(t,i,e){return t<i?i-t:t>e?t-e:0},B0=function(t,i){var e=mi(i.canvas_),a={left:e.x,right:e.x+i.canvas_.offsetWidth,top:e.y,bottom:e.y+i.canvas_.offsetHeight},n={x:sa(t),y:ca(t)},r=zl(n.x,a.left,a.right),c=zl(n.y,a.top,a.bottom);return Math.max(r,c)};ve.defaultModel={mousedown:function(t,i,e){if(!(t.button&&t.button==2)){e.initializeMouseDown(t,i,e),t.altKey||t.shiftKey?ve.startPan(t,i,e):ve.startZoom(t,i,e);var a=function(r){if(e.isZooming){var c=B0(r,i);c<F0?ve.moveZoom(r,i,e):e.dragEndX!==null&&(e.dragEndX=null,e.dragEndY=null,i.clearZoomRect_())}else e.isPanning&&ve.movePan(r,i,e)},n=function(r){e.isZooming?e.dragEndX!==null?ve.endZoom(r,i,e):ve.maybeTreatMouseOpAsClick(r,i,e):e.isPanning&&ve.endPan(r,i,e),Et(document,"mousemove",a),Et(document,"mouseup",n),e.destroy()};i.addAndTrackEvent(document,"mousemove",a),i.addAndTrackEvent(document,"mouseup",n)}},willDestroyContextMyself:!0,touchstart:function(t,i,e){ve.startTouch(t,i,e)},touchmove:function(t,i,e){ve.moveTouch(t,i,e)},touchend:function(t,i,e){ve.endTouch(t,i,e)},dblclick:function(t,i,e){if(e.cancelNextDblclick){e.cancelNextDblclick=!1;return}var a={canvasx:e.dragEndX,canvasy:e.dragEndY,cancelable:!0};i.cascadeEvents_("dblclick",a)||t.altKey||t.shiftKey||i.resetZoom()}};ve.nonInteractiveModel_={mousedown:function(t,i,e){e.initializeMouseDown(t,i,e)},mouseup:ve.maybeTreatMouseOpAsClick};ve.dragIsPanInteractionModel={mousedown:function(t,i,e){e.initializeMouseDown(t,i,e),ve.startPan(t,i,e)},mousemove:function(t,i,e){e.isPanning&&ve.movePan(t,i,e)},mouseup:function(t,i,e){e.isPanning&&ve.endPan(t,i,e)}};var kt=ve;var $0={highlightCircleSize:3,highlightSeriesOpts:null,highlightSeriesBackgroundAlpha:.5,highlightSeriesBackgroundColor:"rgb(255, 255, 255)",labelsSeparateLines:!1,labelsShowZeroValues:!0,labelsKMB:!1,labelsKMG2:!1,showLabelsOnHighlight:!0,digitsAfterDecimal:2,maxNumberWidth:6,sigFigs:null,strokeWidth:1,strokeBorderWidth:0,strokeBorderColor:"white",axisTickSize:3,axisLabelFontSize:14,rightGap:5,showRoller:!1,xValueParser:void 0,delimiter:",",sigma:2,errorBars:!1,fractions:!1,wilsonInterval:!0,customBars:!1,fillGraph:!1,fillAlpha:.15,connectSeparatedPoints:!1,stackedGraph:!1,stackedGraphNaNFill:"all",hideOverlayOnMouseOut:!0,resizable:"no",legend:"onmouseover",legendFollowOffsetX:50,legendFollowOffsetY:-50,stepPlot:!1,xRangePad:0,yRangePad:null,drawAxesAtZero:!1,titleHeight:28,xLabelHeight:18,yLabelWidth:18,axisLineColor:"black",axisLineWidth:.3,gridLineWidth:.3,axisLabelWidth:50,gridLineColor:"rgb(128,128,128)",interactionModel:kt.defaultModel,animatedZooms:!1,animateBackgroundFade:!0,showRangeSelector:!1,rangeSelectorHeight:40,rangeSelectorPlotStrokeColor:"#808FAB",rangeSelectorPlotFillGradientColor:"white",rangeSelectorPlotFillColor:"#A7B1C4",rangeSelectorBackgroundStrokeColor:"gray",rangeSelectorBackgroundLineWidth:1,rangeSelectorPlotLineWidth:1.5,rangeSelectorForegroundStrokeColor:"black",rangeSelectorForegroundLineWidth:1,rangeSelectorAlpha:.6,showInRangeSelector:null,plotter:[Ti._fillPlotter,Ti._errorPlotter,Ti._linePlotter],plugins:[],axes:{x:{pixelsPerLabel:70,axisLabelWidth:60,axisLabelFormatter:wi,valueFormatter:fa,drawGrid:!0,drawAxis:!0,independentTicks:!0,ticker:yi},y:{axisLabelWidth:50,pixelsPerLabel:30,valueFormatter:Cr,axisLabelFormatter:Na,drawGrid:!0,drawAxis:!0,independentTicks:!0,ticker:ii},y2:{axisLabelWidth:50,pixelsPerLabel:30,valueFormatter:Cr,axisLabelFormatter:Na,drawAxis:!0,drawGrid:!1,independentTicks:!1,ticker:ii}}},_a=$0;var ct=function(t){this.dygraph_=t,this.yAxes_=[],this.xAxis_={},this.series_={},this.global_=this.dygraph_.attrs_,this.user_=this.dygraph_.user_attrs_||{},this.labels_=[],this.highlightSeries_=this.get("highlightSeriesOpts")||{},this.reparseSeries()};ct.AXIS_STRING_MAPPINGS_={y:0,Y:0,y1:0,Y1:0,y2:1,Y2:1};ct.axisToIndex_=function(t){if(typeof t=="string"){if(ct.AXIS_STRING_MAPPINGS_.hasOwnProperty(t))return ct.AXIS_STRING_MAPPINGS_[t];throw"Unknown axis : "+t}if(typeof t=="number"){if(t===0||t===1)return t;throw"Dygraphs only supports two y-axes, indexed from 0-1."}if(t)throw"Unknown axis : "+t;return 0};ct.prototype.reparseSeries=function(){var t=this.get("labels");if(t){this.labels_=t.slice(1),this.yAxes_=[{series:[],options:{}}],this.xAxis_={options:{}},this.series_={};for(var i=this.user_.series||{},e=0;e<this.labels_.length;e++){var a=this.labels_[e],n=i[a]||{},r=ct.axisToIndex_(n.axis);this.series_[a]={idx:e,yAxis:r,options:n},this.yAxes_[r]?this.yAxes_[r].series.push(a):this.yAxes_[r]={series:[a],options:{}}}var c=this.user_.axes||{};vt(this.yAxes_[0].options,c.y||{}),this.yAxes_.length>1&&vt(this.yAxes_[1].options,c.y2||{}),vt(this.xAxis_.options,c.x||{}),typeof process<"u"}};ct.prototype.get=function(t){var i=this.getGlobalUser_(t);return i!==null?i:this.getGlobalDefault_(t)};ct.prototype.getGlobalUser_=function(t){return this.user_.hasOwnProperty(t)?this.user_[t]:null};ct.prototype.getGlobalDefault_=function(t){return this.global_.hasOwnProperty(t)?this.global_[t]:_a.hasOwnProperty(t)?_a[t]:null};ct.prototype.getForAxis=function(t,i){var e,a;if(typeof i=="number")e=i,a=e===0?"y":"y2";else{if(i=="y1"&&(i="y"),i=="y")e=0;else if(i=="y2")e=1;else if(i=="x")e=-1;else throw"Unknown axis "+i;a=i}var n=e==-1?this.xAxis_:this.yAxes_[e];if(n){var r=n.options;if(r.hasOwnProperty(t))return r[t]}if(!(i==="x"&&t==="logscale")){var c=this.getGlobalUser_(t);if(c!==null)return c}var d=_a.axes[a];return d.hasOwnProperty(t)?d[t]:this.getGlobalDefault_(t)};ct.prototype.getForSeries=function(t,i){if(i===this.dygraph_.getHighlightSeries()&&this.highlightSeries_.hasOwnProperty(t))return this.highlightSeries_[t];if(!this.series_.hasOwnProperty(i))throw"Unknown series: "+i;var e=this.series_[i],a=e.options;return a.hasOwnProperty(t)?a[t]:this.getForAxis(t,e.yAxis)};ct.prototype.numAxes=function(){return this.yAxes_.length};ct.prototype.axisForSeries=function(t){return this.series_[t].yAxis};ct.prototype.axisOptions=function(t){return this.yAxes_[t].options};ct.prototype.seriesForAxis=function(t){return this.yAxes_[t].series};ct.prototype.seriesNames=function(){return this.labels_};var Wl=ct;function vo(){this.tarps=[]}vo.prototype.cover=function(){for(var t=document.getElementsByTagName("iframe"),i=0;i<t.length;i++){var e=t[i],a=mi(e),n=a.x,r=a.y,c=e.offsetWidth,d=e.offsetHeight,m=document.createElement("div");m.style.position="absolute",m.style.left=n+"px",m.style.top=r+"px",m.style.width=c+"px",m.style.height=d+"px",m.style.zIndex=999,document.body.appendChild(m),this.tarps.push(m)}};vo.prototype.uncover=function(){for(var t=0;t<this.tarps.length;t++)this.tarps[t].parentNode.removeChild(this.tarps[t]);this.tarps=[]};var xr=vo;var jl=function(){},Nt=jl;Nt.X=0;Nt.Y=1;Nt.EXTRAS=2;Nt.prototype.extractSeries=function(t,i,e){};Nt.prototype.seriesToPoints=function(t,i,e){for(var a=[],n=0;n<t.length;++n){var r=t[n],c=r[1],d=c===null?null:Nt.parseFloat(c),m={x:NaN,y:NaN,xval:Nt.parseFloat(r[0]),yval:d,name:i,idx:n+e,canvasx:NaN,canvasy:NaN};a.push(m)}return this.onPointsCreated_(t,a),a};Nt.prototype.onPointsCreated_=function(t,i){};Nt.prototype.rollingAverage=function(t,i,e,a){};Nt.prototype.getExtremeYValues=function(t,i,e){};Nt.prototype.onLineEvaluated=function(t,i,e){};Nt.parseFloat=function(t){return t===null?NaN:t};var Di=jl;var Ba=function(){};Ba.prototype=new Di;Ba.prototype.extractSeries=function(t,i,e){var a=[];let n=e.get("labels")[i],r=e.getForSeries("logscale",n);for(var c=0;c<t.length;c++){var d=t[c][0],m=t[c][i];r&&m<=0&&(m=null),a.push([d,m])}return a};Ba.prototype.rollingAverage=function(t,i,e,r){i=Math.min(i,t.length);var n=[],r,c,d,m,u;if(i==1)return t;for(r=0;r<t.length;r++){for(m=0,u=0,c=Math.max(0,r-i+1);c<r+1;c++)d=t[c][1],!(d===null||isNaN(d))&&(u++,m+=t[c][1]);u?n[r]=[t[r][0],m/u]:n[r]=[t[r][0],null]}return n};Ba.prototype.getExtremeYValues=function(i,e,a){for(var n=null,r=null,c,d=0,m=i.length-1,u=d;u<=m;u++)c=i[u][1],!(c===null||isNaN(c))&&((r===null||c>r)&&(r=c),(n===null||c<n)&&(n=c));return[n,r]};var $a=Ba;var Pi=function(){Di.call(this)};Pi.prototype=new Di;Pi.prototype.extractSeries=function(t,i,e){};Pi.prototype.rollingAverage=function(t,i,e,a){};Pi.prototype.onPointsCreated_=function(t,i){for(var e=0;e<t.length;++e){var a=t[e],n=i[e];n.y_top=NaN,n.y_bottom=NaN,n.yval_minus=Di.parseFloat(a[2][0]),n.yval_plus=Di.parseFloat(a[2][1])}};Pi.prototype.getExtremeYValues=function(t,i,e){for(var a=null,n=null,r,c=0,d=t.length-1,m=c;m<=d;m++)if(r=t[m][1],!(r===null||isNaN(r))){var u=t[m][2][0],g=t[m][2][1];u>r&&(u=r),g<r&&(g=r),(n===null||g>n)&&(n=g),(a===null||u<a)&&(a=u)}return[a,n]};Pi.prototype.onLineEvaluated=function(t,i,e){for(var a,n=0;n<t.length;n++)a=t[n],a.y_top=Fa.calcYNormal_(i,a.yval_minus,e),a.y_bottom=Fa.calcYNormal_(i,a.yval_plus,e)};var di=Pi;var br=function(){};br.prototype=new di;br.prototype.extractSeries=function(t,i,e){var a=[],n,r,c,d;let m=e.get("labels")[i],u=e.getForSeries("logscale",m),g=e.getForSeries("sigma",m);for(var f=0;f<t.length;f++)n=t[f][0],d=t[f][i],u&&d!==null&&(d[0]<=0||d[0]-g*d[1]<=0)&&(d=null),d!==null?(r=d[0],r!==null&&!isNaN(r)?(c=g*d[1],a.push([n,r,[r-c,r+c,d[1]]])):a.push([n,r,[r,r,r]])):a.push([n,null,[null,null,null]]);return a};br.prototype.rollingAverage=function(t,i,e,d){i=Math.min(i,t.length);var n=[];let r=e.get("labels")[d],c=e.getForSeries("sigma",r);var d,m,u,g,f,y,_,S,P;for(d=0;d<t.length;d++){for(f=0,S=0,y=0,m=Math.max(0,d-i+1);m<d+1;m++)u=t[m][1],!(u===null||isNaN(u))&&(y++,f+=u,S+=Math.pow(t[m][2][2],2));y?(_=Math.sqrt(S)/y,P=f/y,n[d]=[t[d][0],P,[P-c*_,P+c*_]]):(g=i==1?t[d][1]:null,n[d]=[t[d][0],g,[g,g]])}return n};var yo=br;var Sr=function(){};Sr.prototype=new di;Sr.prototype.extractSeries=function(t,i,e){var a=[],n,r,c;let d=e.get("labels")[i],m=e.getForSeries("logscale",d);for(var u=0;u<t.length;u++)n=t[u][0],c=t[u][i],m&&c!==null&&(c[0]<=0||c[1]<=0||c[2]<=0)&&(c=null),c!==null?(r=c[1],r!==null&&!isNaN(r)?a.push([n,r,[c[0],c[2]]]):a.push([n,r,[r,r]])):a.push([n,null,[null,null]]);return a};Sr.prototype.rollingAverage=function(t,i,e,g){i=Math.min(i,t.length);var n=[],r,c,d,m,u,g,f;for(c=0,m=0,d=0,u=0,g=0;g<t.length;g++){if(r=t[g][1],f=t[g][2],n[g]=t[g],r!==null&&!isNaN(r)&&(c+=f[0],m+=r,d+=f[1],u+=1),g-i>=0){var y=t[g-i];y[1]!==null&&!isNaN(y[1])&&(c-=y[2][0],m-=y[1],d-=y[2][1],u-=1)}u?n[g]=[t[g][0],1*m/u,[1*c/u,1*d/u]]:n[g]=[t[g][0],null,[null,null]]}return n};var Co=Sr;var wr=function(){};wr.prototype=new $a;wr.prototype.extractSeries=function(t,i,e){var a=[],n,r,c,d,m,u,g=100;let f=e.get("labels")[i],y=e.getForSeries("logscale",f);for(var _=0;_<t.length;_++)n=t[_][0],c=t[_][i],y&&c!==null&&(c[0]<=0||c[1]<=0)&&(c=null),c!==null?(d=c[0],m=c[1],d!==null&&!isNaN(d)?(u=m?d/m:0,r=g*u,a.push([n,r,[d,m]])):a.push([n,d,[d,m]])):a.push([n,null,[null,null]]);return a};wr.prototype.rollingAverage=function(t,i,e,r){i=Math.min(i,t.length);var n=[],r,c=0,d=0,m=100;for(r=0;r<t.length;r++){c+=t[r][2][0],d+=t[r][2][1],r-i>=0&&(c-=t[r-i][2][0],d-=t[r-i][2][1]);var u=t[r][0],g=d?c/d:0;n[r]=[u,m*g]}return n};var xo=wr;var Tr=function(){};Tr.prototype=new di;Tr.prototype.extractSeries=function(t,i,e){var a=[],n,r,c,d,m,u,g,f,y=100;let _=e.get("labels")[i],S=e.getForSeries("logscale",_),P=e.getForSeries("sigma",_);for(var R=0;R<t.length;R++)n=t[R][0],c=t[R][i],S&&c!==null&&(c[0]<=0||c[1]<=0)&&(c=null),c!==null?(d=c[0],m=c[1],d!==null&&!isNaN(d)?(u=m?d/m:0,g=m?P*Math.sqrt(u*(1-u)/m):1,f=y*g,r=y*u,a.push([n,r,[r-f,r+f,d,m]])):a.push([n,d,[d,d,d,m]])):a.push([n,null,[null,null,null,null]]);return a};Tr.prototype.rollingAverage=function(t,i,e,g){i=Math.min(i,t.length);var n=[];let r=e.get("labels")[g],c=e.getForSeries("sigma",r),d=e.getForSeries("wilsonInterval",r);var m,u,g,f,y=0,_=0,S=100;for(g=0;g<t.length;g++){y+=t[g][2][2],_+=t[g][2][3],g-i>=0&&(y-=t[g-i][2][2],_-=t[g-i][2][3]);var P=t[g][0],R=_?y/_:0;if(d)if(_){var I=R<0?0:R,O=_,Y=c*Math.sqrt(I*(1-I)/O+c*c/(4*O*O)),U=1+c*c/_;m=(I+c*c/(2*_)-Y)/U,u=(I+c*c/(2*_)+Y)/U,n[g]=[P,I*S,[m*S,u*S]]}else n[g]=[P,0,[0,0]];else f=_?c*Math.sqrt(R*(1-R)/_):1,n[g]=[P,S*R,[S*(R-f),S*(R+f)]]}return n};var bo=Tr;var Ei=function(){this.annotations_=[]};Ei.prototype.toString=function(){return"Annotations Plugin"};Ei.prototype.activate=function(t){return{clearChart:this.clearChart,didDrawChart:this.didDrawChart}};Ei.prototype.detachLabels=function(){for(var t=0;t<this.annotations_.length;t++){var i=this.annotations_[t];i.parentNode&&i.parentNode.removeChild(i),this.annotations_[t]=null}this.annotations_=[]};Ei.prototype.clearChart=function(t){this.detachLabels()};Ei.prototype.didDrawChart=function(t){var i=t.dygraph,e=i.layout_.annotated_points;if(!(!e||e.length===0))for(var a=t.canvas.parentNode,n=function(U,Q,Ae){return function(z){var K=Ae.annotation;K.hasOwnProperty(U)?K[U](K,Ae,i,z):i.getOption(Q)&&i.getOption(Q)(K,Ae,i,z)}},r=t.dygraph.getArea(),c={},d=0;d<e.length;d++){var m=e[d];if(!(m.canvasx<r.x||m.canvasx>r.x+r.w||m.canvasy<r.y||m.canvasy>r.y+r.h)){var u=m.annotation,g=6;u.hasOwnProperty("tickHeight")&&(g=u.tickHeight);var f=document.createElement("div");f.style.fontSize=i.getOption("axisLabelFontSize")+"px";var y="dygraph-annotation";u.hasOwnProperty("icon")||(y+=" dygraphDefaultAnnotation dygraph-default-annotation"),u.hasOwnProperty("cssClass")&&(y+=" "+u.cssClass),f.className=y;var _=u.hasOwnProperty("width")?u.width:16,S=u.hasOwnProperty("height")?u.height:16;if(u.hasOwnProperty("icon")){var P=document.createElement("img");P.src=u.icon,P.width=_,P.height=S,f.appendChild(P)}else m.annotation.hasOwnProperty("shortText")&&f.appendChild(document.createTextNode(m.annotation.shortText));var R=m.canvasx-_/2;f.style.left=R+"px";var I=0;if(u.attachAtBottom){var O=r.y+r.h-S-g;c[R]?O-=c[R]:c[R]=0,c[R]+=g+S,I=O}else I=m.canvasy-S-g;f.style.top=I+"px",f.style.width=_+"px",f.style.height=S+"px",f.title=m.annotation.text,f.style.color=i.colorsMap_[m.name],f.style.borderColor=i.colorsMap_[m.name],u.div=f,i.addAndTrackEvent(f,"click",n("clickHandler","annotationClickHandler",m,this)),i.addAndTrackEvent(f,"mouseover",n("mouseOverHandler","annotationMouseOverHandler",m,this)),i.addAndTrackEvent(f,"mouseout",n("mouseOutHandler","annotationMouseOutHandler",m,this)),i.addAndTrackEvent(f,"dblclick",n("dblClickHandler","annotationDblClickHandler",m,this)),a.appendChild(f),this.annotations_.push(f);var Y=t.drawingContext;if(Y.save(),Y.strokeStyle=u.hasOwnProperty("tickColor")?u.tickColor:i.colorsMap_[m.name],Y.lineWidth=u.hasOwnProperty("tickWidth")?u.tickWidth:i.getOption("strokeWidth"),Y.beginPath(),!u.attachAtBottom)Y.moveTo(m.canvasx,m.canvasy),Y.lineTo(m.canvasx,m.canvasy-2-g);else{var O=I+S;Y.moveTo(m.canvasx,O),Y.lineTo(m.canvasx,O+g)}Y.closePath(),Y.stroke(),Y.restore()}}};Ei.prototype.destroy=function(){this.detachLabels()};var So=Ei;var ki=function(){this.xlabels_=[],this.ylabels_=[]};ki.prototype.toString=function(){return"Axes Plugin"};ki.prototype.activate=function(t){return{layout:this.layout,clearChart:this.clearChart,willDrawChart:this.willDrawChart}};ki.prototype.layout=function(t){var i=t.dygraph;if(i.getOptionForAxis("drawAxis","y")){var e=i.getOptionForAxis("axisLabelWidth","y")+2*i.getOptionForAxis("axisTickSize","y");t.reserveSpaceLeft(e)}if(i.getOptionForAxis("drawAxis","x")){var a;i.getOption("xAxisHeight")?a=i.getOption("xAxisHeight"):a=i.getOptionForAxis("axisLabelFontSize","x")+2*i.getOptionForAxis("axisTickSize","x"),t.reserveSpaceBottom(a)}if(i.numAxes()==2){if(i.getOptionForAxis("drawAxis","y2")){var e=i.getOptionForAxis("axisLabelWidth","y2")+2*i.getOptionForAxis("axisTickSize","y2");t.reserveSpaceRight(e)}}else i.numAxes()>2&&i.error("Only two y-axes are supported at this time. (Trying to use "+i.numAxes()+")")};ki.prototype.detachLabels=function(){function t(i){for(var e=0;e<i.length;e++){var a=i[e];a.parentNode&&a.parentNode.removeChild(a)}}t(this.xlabels_),t(this.ylabels_),this.xlabels_=[],this.ylabels_=[]};ki.prototype.clearChart=function(t){this.detachLabels()};ki.prototype.willDrawChart=function(t){var i=t.dygraph;if(!i.getOptionForAxis("drawAxis","x")&&!i.getOptionForAxis("drawAxis","y")&&!i.getOptionForAxis("drawAxis","y2"))return;function e(j){return Math.round(j)+.5}function a(j){return Math.round(j)-.5}var n=t.drawingContext,r=t.canvas.parentNode,c=i.width_,d=i.height_,m,u,g,f,y,_=function(j){return{position:"absolute",fontSize:i.getOptionForAxis("axisLabelFontSize",j)+"px",width:i.getOptionForAxis("axisLabelWidth",j)+"px"}},S={x:_("x"),y:_("y"),y2:_("y2")},P=function(j,ce,st){var Le=document.createElement("div"),Pt=S[st=="y2"?"y2":ce];vt(Le.style,Pt);var Xe=document.createElement("div");return Xe.className="dygraph-axis-label dygraph-axis-label-"+ce+(st?" dygraph-axis-label-"+st:""),Xe.innerHTML=j,Le.appendChild(Xe),Le};n.save();var R=i.layout_,I=t.dygraph.plotter_.area,O=function(j){return function(ce){return i.getOptionForAxis(ce,j)}};let Y=this;if(i.getOptionForAxis("drawAxis","y")||i.numAxes()==2&&i.getOptionForAxis("drawAxis","y2")){if(R.yticks&&R.yticks.length>0){var U=i.numAxes(),Q=[O("y"),O("y2")];R.yticks.forEach(function(j){if(j.label!==void 0){u=I.x;var ce=1,st="y1",Le=Q[0];if(j.axis==1&&(u=I.x+I.w,ce=-1,st="y2",Le=Q[1]),!!Le("drawAxis")){var Pt=Le("axisLabelFontSize");g=I.y+j.pos*I.h,m=P(j.label,"y",U==2?st:null);var Xe=g-Pt/2;Xe<0&&(Xe=0),Xe+Pt+3>d?m.style.bottom="0":m.style.top=Math.min(Xe,d-2*Pt)+"px",j.axis===0?(m.style.left=I.x-Le("axisLabelWidth")-Le("axisTickSize")+"px",m.style.textAlign="right"):j.axis==1&&(m.style.left=I.x+I.w+Le("axisTickSize")+"px",m.style.textAlign="left"),m.style.width=Le("axisLabelWidth")+"px",r.appendChild(m),Y.ylabels_.push(m)}}})}var Ae;if(i.getOption("drawAxesAtZero")){var z=i.toPercentXCoord(0);(z>1||z<0||isNaN(z))&&(z=0),Ae=e(I.x+z*I.w)}else Ae=e(I.x);n.strokeStyle=i.getOptionForAxis("axisLineColor","y"),n.lineWidth=i.getOptionForAxis("axisLineWidth","y"),n.beginPath(),n.moveTo(Ae,a(I.y)),n.lineTo(Ae,a(I.y+I.h)),n.closePath(),n.stroke(),i.numAxes()==2&&i.getOptionForAxis("drawAxis","y2")&&(n.strokeStyle=i.getOptionForAxis("axisLineColor","y2"),n.lineWidth=i.getOptionForAxis("axisLineWidth","y2"),n.beginPath(),n.moveTo(a(I.x+I.w),a(I.y)),n.lineTo(a(I.x+I.w),a(I.y+I.h)),n.closePath(),n.stroke())}if(i.getOptionForAxis("drawAxis","x")){if(R.xticks){var K=O("x");R.xticks.forEach(function(j){if(j.label!==void 0){u=I.x+j.pos*I.w,g=I.y+I.h,m=P(j.label,"x"),m.style.textAlign="center",m.style.top=g+K("axisTickSize")+"px";var ce=u-K("axisLabelWidth")/2;ce+K("axisLabelWidth")>c&&(ce=c-K("axisLabelWidth"),m.style.textAlign="right"),ce<0&&(ce=0,m.style.textAlign="left"),m.style.left=ce+"px",m.style.width=K("axisLabelWidth")+"px",r.appendChild(m),Y.xlabels_.push(m)}})}n.strokeStyle=i.getOptionForAxis("axisLineColor","x"),n.lineWidth=i.getOptionForAxis("axisLineWidth","x"),n.beginPath();var de;if(i.getOption("drawAxesAtZero")){var z=i.toPercentYCoord(0,0);(z>1||z<0)&&(z=1),de=a(I.y+z*I.h)}else de=a(I.y+I.h);n.moveTo(e(I.x),de),n.lineTo(e(I.x+I.w),de),n.closePath(),n.stroke()}n.restore()};var wo=ki;var ui=function(){this.title_div_=null,this.xlabel_div_=null,this.ylabel_div_=null,this.y2label_div_=null};ui.prototype.toString=function(){return"ChartLabels Plugin"};ui.prototype.activate=function(t){return{layout:this.layout,didDrawChart:this.didDrawChart}};var ql=function(t){var i=document.createElement("div");return i.style.position="absolute",i.style.left=t.x+"px",i.style.top=t.y+"px",i.style.width=t.w+"px",i.style.height=t.h+"px",i};ui.prototype.detachLabels_=function(){for(var t=[this.title_div_,this.xlabel_div_,this.ylabel_div_,this.y2label_div_],i=0;i<t.length;i++){var e=t[i];e&&e.parentNode&&e.parentNode.removeChild(e)}this.title_div_=null,this.xlabel_div_=null,this.ylabel_div_=null,this.y2label_div_=null};var Xl=function(t,i,e,a,n){var r=document.createElement("div");r.style.position="absolute",e==1?r.style.left="0px":r.style.left=i.x+"px",r.style.top=i.y+"px",r.style.width=i.w+"px",r.style.height=i.h+"px",r.style.fontSize=t.getOption("yLabelWidth")-2+"px";var c=document.createElement("div");c.style.position="absolute",c.style.width=i.h+"px",c.style.height=i.w+"px",c.style.top=i.h/2-i.w/2+"px",c.style.left=i.w/2-i.h/2+"px",c.className="dygraph-label-rotate-"+(e==1?"right":"left");var d=document.createElement("div");return d.className=a,d.innerHTML=n,c.appendChild(d),r.appendChild(c),r};ui.prototype.layout=function(t){this.detachLabels_();var i=t.dygraph,e=t.chart_div;if(i.getOption("title")){var a=t.reserveSpaceTop(i.getOption("titleHeight"));this.title_div_=ql(a),this.title_div_.style.fontSize=i.getOption("titleHeight")-8+"px";var n=document.createElement("div");n.className="dygraph-label dygraph-title",n.innerHTML=i.getOption("title"),this.title_div_.appendChild(n),e.appendChild(this.title_div_)}if(i.getOption("xlabel")){var r=t.reserveSpaceBottom(i.getOption("xLabelHeight"));this.xlabel_div_=ql(r),this.xlabel_div_.style.fontSize=i.getOption("xLabelHeight")-2+"px";var n=document.createElement("div");n.className="dygraph-label dygraph-xlabel",n.innerHTML=i.getOption("xlabel"),this.xlabel_div_.appendChild(n),e.appendChild(this.xlabel_div_)}if(i.getOption("ylabel")){var c=t.reserveSpaceLeft(0);this.ylabel_div_=Xl(i,c,1,"dygraph-label dygraph-ylabel",i.getOption("ylabel")),e.appendChild(this.ylabel_div_)}if(i.getOption("y2label")&&i.numAxes()==2){var d=t.reserveSpaceRight(0);this.y2label_div_=Xl(i,d,2,"dygraph-label dygraph-y2label",i.getOption("y2label")),e.appendChild(this.y2label_div_)}};ui.prototype.didDrawChart=function(t){var i=t.dygraph;this.title_div_&&(this.title_div_.children[0].innerHTML=i.getOption("title")),this.xlabel_div_&&(this.xlabel_div_.children[0].innerHTML=i.getOption("xlabel")),this.ylabel_div_&&(this.ylabel_div_.children[0].children[0].innerHTML=i.getOption("ylabel")),this.y2label_div_&&(this.y2label_div_.children[0].children[0].innerHTML=i.getOption("y2label"))};ui.prototype.clearChart=function(){};ui.prototype.destroy=function(){this.detachLabels_()};var To=ui;var Ha=function(){};Ha.prototype.toString=function(){return"Gridline Plugin"};Ha.prototype.activate=function(t){return{willDrawChart:this.willDrawChart}};Ha.prototype.willDrawChart=function(t){var i=t.dygraph,e=t.drawingContext,a=i.layout_,n=t.dygraph.plotter_.area;function r(I){return Math.round(I)+.5}function c(I){return Math.round(I)-.5}var d,m,u,g;if(i.getOptionForAxis("drawGrid","y")){for(var f=["y","y2"],y=[],_=[],S=[],P=[],R=[],u=0;u<f.length;u++)S[u]=i.getOptionForAxis("drawGrid",f[u]),S[u]&&(y[u]=i.getOptionForAxis("gridLineColor",f[u]),_[u]=i.getOptionForAxis("gridLineWidth",f[u]),R[u]=i.getOptionForAxis("gridLinePattern",f[u]),P[u]=R[u]&&R[u].length>=2);g=a.yticks,e.save(),g.forEach(I=>{if(I.has_tick){var O=I.axis;S[O]&&(e.save(),P[O]&&e.setLineDash&&e.setLineDash(R[O]),e.strokeStyle=y[O],e.lineWidth=_[O],d=r(n.x),m=c(n.y+I.pos*n.h),e.beginPath(),e.moveTo(d,m),e.lineTo(d+n.w,m),e.stroke(),e.restore())}}),e.restore()}if(i.getOptionForAxis("drawGrid","x")){g=a.xticks,e.save();var R=i.getOptionForAxis("gridLinePattern","x"),P=R&&R.length>=2;P&&e.setLineDash&&e.setLineDash(R),e.strokeStyle=i.getOptionForAxis("gridLineColor","x"),e.lineWidth=i.getOptionForAxis("gridLineWidth","x"),g.forEach(Y=>{Y.has_tick&&(d=r(n.x+Y.pos*n.w),m=c(n.y+n.h),e.beginPath(),e.moveTo(d,m),e.lineTo(d,n.y),e.stroke())}),P&&e.setLineDash&&e.setLineDash([]),e.restore()}};Ha.prototype.destroy=function(){};var Do=Ha;var At=function(){this.legend_div_=null,this.is_generated_div_=!1};At.prototype.toString=function(){return"Legend Plugin"};At.prototype.activate=function(t){var i,e=t.getOption("labelsDiv");return e&&e!==null?typeof e=="string"||e instanceof String?i=document.getElementById(e):i=e:(i=document.createElement("div"),i.className="dygraph-legend",t.graphDiv.appendChild(i),this.is_generated_div_=!0),this.legend_div_=i,this.one_em_width_=10,{select:this.select,deselect:this.deselect,predraw:this.predraw,didDrawChart:this.didDrawChart}};var H0=function(t){var i=document.createElement("span");i.setAttribute("style","margin: 0; padding: 0 0 0 1em; border: 0;"),t.appendChild(i);var e=i.offsetWidth;return t.removeChild(i),e},Y0=function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&#34;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};At.prototype.select=function(t){var i=t.selectedX,e=t.selectedPoints,a=t.selectedRow,n=t.dygraph.getOption("legend");if(n==="never"){this.legend_div_.style.display="none";return}var r=At.generateLegendHTML(t.dygraph,i,e,this.one_em_width_,a);if(r instanceof Node&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?(this.legend_div_.innerHTML="",this.legend_div_.appendChild(r)):this.legend_div_.innerHTML=r,this.legend_div_.style.display="",n==="follow"){var c=t.dygraph.plotter_.area,d=this.legend_div_.offsetWidth,m=t.dygraph.getOptionForAxis("axisLabelWidth","y"),u=t.dygraph.getHighlightSeries(),g;u?(g=e.find(P=>P.name===u),g||(g=e[0])):g=e[0];let _=t.dygraph.getNumericOption("legendFollowOffsetX"),S=t.dygraph.getNumericOption("legendFollowOffsetY");var f=g.x*c.w+_,y=g.y*c.h+S;f+d+1>c.w&&(f=f-2*_-d-(m-c.x)),this.legend_div_.style.left=m+f+"px",this.legend_div_.style.top=y+"px"}else if(n==="onmouseover"&&this.is_generated_div_){var c=t.dygraph.plotter_.area,d=this.legend_div_.offsetWidth;this.legend_div_.style.left=c.x+c.w-d-1+"px",this.legend_div_.style.top=c.y+"px"}};At.prototype.deselect=function(t){var i=t.dygraph.getOption("legend");i!=="always"&&(this.legend_div_.style.display="none");var e=H0(this.legend_div_);this.one_em_width_=e;var a=At.generateLegendHTML(t.dygraph,void 0,void 0,e,null);a instanceof Node&&a.nodeType===Node.DOCUMENT_FRAGMENT_NODE?(this.legend_div_.innerHTML="",this.legend_div_.appendChild(a)):this.legend_div_.innerHTML=a};At.prototype.didDrawChart=function(t){this.deselect(t)};At.prototype.predraw=function(t){if(this.is_generated_div_){t.dygraph.graphDiv.appendChild(this.legend_div_);var i=t.dygraph.plotter_.area,e=this.legend_div_.offsetWidth;this.legend_div_.style.left=i.x+i.w-e-1+"px",this.legend_div_.style.top=i.y+"px"}};At.prototype.destroy=function(){this.legend_div_=null};At.generateLegendHTML=function(t,i,e,a,n){var r={dygraph:t,x:i,i:n,series:[]},c={},d=t.getLabels();if(d)for(var m=1;m<d.length;m++){var u=t.getPropertiesForSeries(d[m]),g=t.getOption("strokePattern",d[m]),f={dashHTML:G0(g,u.color,a),label:d[m],labelHTML:Y0(d[m]),isVisible:u.visible,color:u.color};r.series.push(f),c[d[m]]=f}if(typeof i<"u"){var y=t.optionsViewForAxis_("x"),_=y("valueFormatter");r.xHTML=_.call(t,i,y,d[0],t,n,0);for(var S=[],P=t.numAxes(),m=0;m<P;m++)S[m]=t.optionsViewForAxis_("y"+(m?1+m:""));var R=t.getOption("labelsShowZeroValues"),I=t.getHighlightSeries();for(m=0;m<e.length;m++){var O=e[m],f=c[O.name];if(f.y=O.yval,O.yval===0&&!R||isNaN(O.canvasy)){f.isVisible=!1;continue}var u=t.getPropertiesForSeries(O.name),Y=S[u.axis-1],U=Y("valueFormatter"),Q=U.call(t,O.yval,Y,O.name,t,n,d.indexOf(O.name));vt(f,{yHTML:Q}),O.name==I&&(f.isHighlighted=!0)}}var Ae=t.getOption("legendFormatter")||At.defaultFormatter;return Ae.call(t,r)};At.defaultFormatter=function(t){var i=t.dygraph;if(i.getOption("showLabelsOnHighlight")!==!0)return"";var e=i.getOption("labelsSeparateLines"),a;if(typeof t.x>"u"){if(i.getOption("legend")!="always")return"";a="";for(var n=0;n<t.series.length;n++){var r=t.series[n];r.isVisible&&(a!==""&&(a+=e?"<br />":" "),a+=`<span style='font-weight: bold; color: ${r.color};'>${r.dashHTML} ${r.labelHTML}</span>`)}return a}a=t.xHTML+":";for(var n=0;n<t.series.length;n++){var r=t.series[n];if(!(!r.y&&!r.yHTML)&&r.isVisible){e&&(a+="<br>");var c=r.isHighlighted?' class="highlight"':"";a+=`<span${c}> <b><span style='color: ${r.color};'>${r.labelHTML}</span></b>:&#160;${r.yHTML}</span>`}}return a};function G0(t,i,e){if(!t||t.length<=1)return`<div class="dygraph-legend-line" style="border-bottom-color: ${i};"></div>`;var a,n,r,c,d=0,m=0,u=[],g;for(a=0;a<=t.length;a++)d+=t[a%t.length];if(g=Math.floor(e/(d-t[0])),g>1){for(a=0;a<t.length;a++)u[a]=t[a]/e;m=u.length}else{for(g=1,a=0;a<t.length;a++)u[a]=t[a]/d;m=u.length+1}var f="";for(n=0;n<g;n++)for(a=0;a<m;a+=2)r=u[a%u.length],a<t.length?c=u[(a+1)%u.length]:c=0,f+=`<div class="dygraph-legend-dash" style="margin-right: ${c}em; padding-left: ${r}em;"></div>`;return f}var Po=At;var Ie=function(){this.hasTouchInterface_=typeof TouchEvent<"u",this.isMobileDevice_=/mobile|android/gi.test(navigator.appVersion),this.interfaceCreated_=!1};Ie.prototype.toString=function(){return"RangeSelector Plugin"};Ie.prototype.activate=function(t){return this.dygraph_=t,this.getOption_("showRangeSelector")&&this.createInterface_(),{layout:this.reserveSpace_,predraw:this.renderStaticLayer_,didDrawChart:this.renderInteractiveLayer_}};Ie.prototype.destroy=function(){this.bgcanvas_=null,this.fgcanvas_=null,this.leftZoomHandle_=null,this.rightZoomHandle_=null};Ie.prototype.getOption_=function(t,i){return this.dygraph_.getOption(t,i)};Ie.prototype.setDefaultOption_=function(t,i){this.dygraph_.attrs_[t]=i};Ie.prototype.createInterface_=function(){this.createCanvases_(),this.createZoomHandles_(),this.initInteraction_(),this.getOption_("animatedZooms")&&(console.warn("Animated zooms and range selector are not compatible; disabling animatedZooms."),this.dygraph_.updateOptions({animatedZooms:!1},!0)),this.interfaceCreated_=!0,this.addToGraph_()};Ie.prototype.addToGraph_=function(){var t=this.graphDiv_=this.dygraph_.graphDiv;t.appendChild(this.bgcanvas_),t.appendChild(this.fgcanvas_),t.appendChild(this.leftZoomHandle_),t.appendChild(this.rightZoomHandle_)};Ie.prototype.removeFromGraph_=function(){var t=this.graphDiv_;t.removeChild(this.bgcanvas_),t.removeChild(this.fgcanvas_),t.removeChild(this.leftZoomHandle_),t.removeChild(this.rightZoomHandle_),this.graphDiv_=null};Ie.prototype.reserveSpace_=function(t){this.getOption_("showRangeSelector")&&t.reserveSpaceBottom(this.getOption_("rangeSelectorHeight")+4)};Ie.prototype.renderStaticLayer_=function(){this.updateVisibility_()&&(this.resize_(),this.drawStaticLayer_())};Ie.prototype.renderInteractiveLayer_=function(){!this.updateVisibility_()||this.isChangingRange_||(this.placeZoomHandles_(),this.drawInteractiveLayer_())};Ie.prototype.updateVisibility_=function(){var t=this.getOption_("showRangeSelector");if(t)this.interfaceCreated_?(!this.graphDiv_||!this.graphDiv_.parentNode)&&this.addToGraph_():this.createInterface_();else if(this.graphDiv_){this.removeFromGraph_();var i=this.dygraph_;setTimeout(function(){i.width_=0,i.resize()},1)}return t};Ie.prototype.resize_=function(){function t(n,r,c,d){var m=d||Oa(r);n.style.top=c.y+"px",n.style.left=c.x+"px",n.width=c.w*m,n.height=c.h*m,n.style.width=c.w+"px",n.style.height=c.h+"px",m!=1&&r.scale(m,m)}var i=this.dygraph_.layout_.getPlotArea(),e=0;this.dygraph_.getOptionForAxis("drawAxis","x")&&(e=this.getOption_("xAxisHeight")||this.getOption_("axisLabelFontSize")+2*this.getOption_("axisTickSize")),this.canvasRect_={x:i.x,y:i.y+i.h+e+4,w:i.w,h:this.getOption_("rangeSelectorHeight")};var a=this.dygraph_.getNumericOption("pixelRatio");t(this.bgcanvas_,this.bgcanvas_ctx_,this.canvasRect_,a),t(this.fgcanvas_,this.fgcanvas_ctx_,this.canvasRect_,a)};Ie.prototype.createCanvases_=function(){this.bgcanvas_=ua(),this.bgcanvas_.className="dygraph-rangesel-bgcanvas",this.bgcanvas_.style.position="absolute",this.bgcanvas_.style.zIndex=9,this.bgcanvas_ctx_=la(this.bgcanvas_),this.fgcanvas_=ua(),this.fgcanvas_.className="dygraph-rangesel-fgcanvas",this.fgcanvas_.style.position="absolute",this.fgcanvas_.style.zIndex=9,this.fgcanvas_.style.cursor="default",this.fgcanvas_ctx_=la(this.fgcanvas_)};Ie.prototype.createZoomHandles_=function(){var t=new Image;t.className="dygraph-rangesel-zoomhandle",t.style.position="absolute",t.style.zIndex=10,t.style.visibility="hidden",t.style.cursor="col-resize",t.width=9,t.height=16,t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAQCAYAAADESFVDAAAAAXNSR0IArs4c6QAAAAZiS0dEANAAzwDP4Z7KegAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAAd0SU1FB9sHGw0cMqdt1UwAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAaElEQVQoz+3SsRFAQBCF4Z9WJM8KCDVwownl6YXsTmCUsyKGkZzcl7zkz3YLkypgAnreFmDEpHkIwVOMfpdi9CEEN2nGpFdwD03yEqDtOgCaun7sqSTDH32I1pQA2Pb9sZecAxc5r3IAb21d6878xsAAAAAASUVORK5CYII=",this.isMobileDevice_&&(t.width*=2,t.height*=2),this.leftZoomHandle_=t,this.rightZoomHandle_=t.cloneNode(!1)};Ie.prototype.initInteraction_=function(){var t=this,i=document,e=0,a=null,n=!1,r=!1,c=!this.isMobileDevice_,d=new xr,m,u,g,f,y,_,S,P,R,I,O,Y,U,Q;m=function(z){var K=t.dygraph_.xAxisExtremes(),de=(K[1]-K[0])/t.canvasRect_.w,j=K[0]+(z.leftHandlePos-t.canvasRect_.x)*de,ce=K[0]+(z.rightHandlePos-t.canvasRect_.x)*de;return[j,ce]},u=function(z){return ai(z),n=!0,e=z.clientX,a=z.target?z.target:z.srcElement,(z.type==="mousedown"||z.type==="dragstart")&&(bi(i,"mousemove",g),bi(i,"mouseup",f)),t.fgcanvas_.style.cursor="col-resize",d.cover(),!0},g=function(z){if(!n)return!1;ai(z);var K=z.clientX-e;if(Math.abs(K)<4)return!0;e=z.clientX;var de=t.getZoomHandleStatus_(),j;a==t.leftZoomHandle_?(j=de.leftHandlePos+K,j=Math.min(j,de.rightHandlePos-a.width-3),j=Math.max(j,t.canvasRect_.x)):(j=de.rightHandlePos+K,j=Math.min(j,t.canvasRect_.x+t.canvasRect_.w),j=Math.max(j,de.leftHandlePos+a.width+3));var ce=a.width/2;return a.style.left=j-ce+"px",t.drawInteractiveLayer_(),c&&y(),!0},f=function(z){return n?(n=!1,d.uncover(),Et(i,"mousemove",g),Et(i,"mouseup",f),t.fgcanvas_.style.cursor="default",c||y(),!0):!1},y=function(){try{var z=t.getZoomHandleStatus_();if(t.isChangingRange_=!0,!z.isZoomed)t.dygraph_.resetZoom();else{var K=m(z);t.dygraph_.doZoomXDates_(K[0],K[1])}}finally{t.isChangingRange_=!1}},_=function(z){var K=t.leftZoomHandle_.getBoundingClientRect(),de=K.left+K.width/2;K=t.rightZoomHandle_.getBoundingClientRect();var j=K.left+K.width/2;return z.clientX>de&&z.clientX<j},S=function(z){return!r&&_(z)&&t.getZoomHandleStatus_().isZoomed?(ai(z),r=!0,e=z.clientX,z.type==="mousedown"&&(bi(i,"mousemove",P),bi(i,"mouseup",R)),!0):!1},P=function(z){if(!r)return!1;ai(z);var K=z.clientX-e;if(Math.abs(K)<4)return!0;e=z.clientX;var de=t.getZoomHandleStatus_(),j=de.leftHandlePos,ce=de.rightHandlePos,st=ce-j;j+K<=t.canvasRect_.x?(j=t.canvasRect_.x,ce=j+st):ce+K>=t.canvasRect_.x+t.canvasRect_.w?(ce=t.canvasRect_.x+t.canvasRect_.w,j=ce-st):(j+=K,ce+=K);var Le=t.leftZoomHandle_.width/2;return t.leftZoomHandle_.style.left=j-Le+"px",t.rightZoomHandle_.style.left=ce-Le+"px",t.drawInteractiveLayer_(),c&&I(),!0},R=function(z){return r?(r=!1,Et(i,"mousemove",P),Et(i,"mouseup",R),c||I(),!0):!1},I=function(){try{t.isChangingRange_=!0,t.dygraph_.dateWindow_=m(t.getZoomHandleStatus_()),t.dygraph_.drawGraph_(!1)}finally{t.isChangingRange_=!1}},O=function(z){if(!(n||r)){var K=_(z)?"move":"default";K!=t.fgcanvas_.style.cursor&&(t.fgcanvas_.style.cursor=K)}},Y=function(z){z.type=="touchstart"&&z.targetTouches.length==1?u(z.targetTouches[0])&&ai(z):z.type=="touchmove"&&z.targetTouches.length==1?g(z.targetTouches[0])&&ai(z):f(z)},U=function(z){z.type=="touchstart"&&z.targetTouches.length==1?S(z.targetTouches[0])&&ai(z):z.type=="touchmove"&&z.targetTouches.length==1?P(z.targetTouches[0])&&ai(z):R(z)},Q=function(z,K){for(var de=["touchstart","touchend","touchmove","touchcancel"],j=0;j<de.length;j++)t.dygraph_.addAndTrackEvent(z,de[j],K)},this.setDefaultOption_("interactionModel",kt.dragIsPanInteractionModel),this.setDefaultOption_("panEdgeFraction",1e-4);var Ae=window.opera?"mousedown":"dragstart";this.dygraph_.addAndTrackEvent(this.leftZoomHandle_,Ae,u),this.dygraph_.addAndTrackEvent(this.rightZoomHandle_,Ae,u),this.dygraph_.addAndTrackEvent(this.fgcanvas_,"mousedown",S),this.dygraph_.addAndTrackEvent(this.fgcanvas_,"mousemove",O),this.hasTouchInterface_&&(Q(this.leftZoomHandle_,Y),Q(this.rightZoomHandle_,Y),Q(this.fgcanvas_,U))};Ie.prototype.drawStaticLayer_=function(){var t=this.bgcanvas_ctx_;t.clearRect(0,0,this.canvasRect_.w,this.canvasRect_.h);try{this.drawMiniPlot_()}catch(e){console.warn(e)}var i=.5;this.bgcanvas_ctx_.lineWidth=this.getOption_("rangeSelectorBackgroundLineWidth"),t.strokeStyle=this.getOption_("rangeSelectorBackgroundStrokeColor"),t.beginPath(),t.moveTo(i,i),t.lineTo(i,this.canvasRect_.h-i),t.lineTo(this.canvasRect_.w-i,this.canvasRect_.h-i),t.lineTo(this.canvasRect_.w-i,i),t.stroke()};Ie.prototype.drawMiniPlot_=function(){var t=this.getOption_("rangeSelectorPlotFillColor"),i=this.getOption_("rangeSelectorPlotFillGradientColor"),e=this.getOption_("rangeSelectorPlotStrokeColor");if(!(!t&&!e)){var a=this.getOption_("stepPlot"),n=this.computeCombinedSeriesAndLimits_(),r=n.yMax-n.yMin,c=this.bgcanvas_ctx_,d=.5,m=this.dygraph_.xAxisExtremes(),u=Math.max(m[1]-m[0],1e-30),g=(this.canvasRect_.w-d)/u,f=(this.canvasRect_.h-d)/r,y=this.canvasRect_.w-d,_=this.canvasRect_.h-d,S=null,P=null;c.beginPath(),c.moveTo(d,_);for(var R=0;R<n.data.length;R++){var I=n.data[R],O=I[0]!==null?(I[0]-m[0])*g:NaN,Y=I[1]!==null?_-(I[1]-n.yMin)*f:NaN;!a&&S!==null&&Math.round(O)==Math.round(S)||(isFinite(O)&&isFinite(Y)?(S===null?c.lineTo(O,_):a&&c.lineTo(O,P),c.lineTo(O,Y),S=O,P=Y):(S!==null&&(a?(c.lineTo(O,P),c.lineTo(O,_)):c.lineTo(S,_)),S=P=null))}if(c.lineTo(y,_),c.closePath(),t){var U=this.bgcanvas_ctx_.createLinearGradient(0,0,0,_);i&&U.addColorStop(0,i),U.addColorStop(1,t),this.bgcanvas_ctx_.fillStyle=U,c.fill()}e&&(this.bgcanvas_ctx_.strokeStyle=e,this.bgcanvas_ctx_.lineWidth=this.getOption_("rangeSelectorPlotLineWidth"),c.stroke())}};Ie.prototype.computeCombinedSeriesAndLimits_=function(){var t=this.dygraph_,i=this.getOption_("logscale"),e,a=t.numColumns(),n=t.getLabels(),r=new Array(a),c=!1,d=t.visibility(),m=[];for(e=1;e<a;e++){var u=this.getOption_("showInRangeSelector",n[e]);m.push(u),u!==null&&(c=!0)}if(c)for(e=1;e<a;e++)r[e]=m[e-1];else for(e=1;e<a;e++)r[e]=d[e-1];var g=[],f=t.dataHandler_,y=t.attributes_;for(e=1;e<t.numColumns();e++)if(r[e]){var _=f.extractSeries(t.rawData_,e,y);t.rollPeriod()>1&&(_=f.rollingAverage(_,t.rollPeriod(),y,e)),g.push(_)}var S=[];for(e=0;e<g[0].length;e++){for(var P=0,R=0,I=0;I<g.length;I++){var O=g[I][e][1];O===null||isNaN(O)||(R++,P+=O)}S.push([g[0][e][0],P/R])}var Y=Number.MAX_VALUE,U=-Number.MAX_VALUE;for(e=0;e<S.length;e++){var Q=S[e][1];Q!==null&&isFinite(Q)&&(!i||Q>0)&&(Y=Math.min(Y,Q),U=Math.max(U,Q))}var Ae=.25;if(i)for(U=Se(U),U+=U*Ae,Y=Se(Y),e=0;e<S.length;e++)S[e][1]=Se(S[e][1]);else{var z,K=U-Y;K<=Number.MIN_VALUE?z=U*Ae:z=K*Ae,U+=z,Y-=z}return{data:S,yMin:Y,yMax:U}};Ie.prototype.placeZoomHandles_=function(){var t=this.dygraph_.xAxisExtremes(),i=this.dygraph_.xAxisRange(),e=t[1]-t[0],a=Math.max(0,(i[0]-t[0])/e),n=Math.max(0,(t[1]-i[1])/e),r=this.canvasRect_.x+this.canvasRect_.w*a,c=this.canvasRect_.x+this.canvasRect_.w*(1-n),d=Math.max(this.canvasRect_.y,this.canvasRect_.y+(this.canvasRect_.h-this.leftZoomHandle_.height)/2),m=this.leftZoomHandle_.width/2;this.leftZoomHandle_.style.left=r-m+"px",this.leftZoomHandle_.style.top=d+"px",this.rightZoomHandle_.style.left=c-m+"px",this.rightZoomHandle_.style.top=this.leftZoomHandle_.style.top,this.leftZoomHandle_.style.visibility="visible",this.rightZoomHandle_.style.visibility="visible"};Ie.prototype.drawInteractiveLayer_=function(){var t=this.fgcanvas_ctx_;t.clearRect(0,0,this.canvasRect_.w,this.canvasRect_.h);var i=1,e=this.canvasRect_.w-i,a=this.canvasRect_.h-i,n=this.getZoomHandleStatus_();if(t.strokeStyle=this.getOption_("rangeSelectorForegroundStrokeColor"),t.lineWidth=this.getOption_("rangeSelectorForegroundLineWidth"),!n.isZoomed)t.beginPath(),t.moveTo(i,i),t.lineTo(i,a),t.lineTo(e,a),t.lineTo(e,i),t.stroke();else{var r=Math.max(i,n.leftHandlePos-this.canvasRect_.x),c=Math.min(e,n.rightHandlePos-this.canvasRect_.x);let d=this.getOption_("rangeSelectorVeilColour");t.fillStyle=d||"rgba(240, 240, 240, "+this.getOption_("rangeSelectorAlpha").toString()+")",t.fillRect(0,0,r,this.canvasRect_.h),t.fillRect(c,0,this.canvasRect_.w-c,this.canvasRect_.h),t.beginPath(),t.moveTo(i,i),t.lineTo(r,i),t.lineTo(r,a),t.lineTo(c,a),t.lineTo(c,i),t.lineTo(e,i),t.stroke()}};Ie.prototype.getZoomHandleStatus_=function(){var t=this.leftZoomHandle_.width/2,i=parseFloat(this.leftZoomHandle_.style.left)+t,e=parseFloat(this.rightZoomHandle_.style.left)+t;return{leftHandlePos:i,rightHandlePos:e,isZoomed:i-1>this.canvasRect_.x||e+1<this.canvasRect_.x+this.canvasRect_.w}};var Eo=Ie;var Dr=function(t){this.container=t};Dr.prototype.draw=function(t,i){this.container.innerHTML="",typeof this.date_graph<"u"&&this.date_graph.destroy(),this.date_graph=new qe(this.container,t,i)};Dr.prototype.setSelection=function(t){var i=!1;t.length&&(i=t[0].row),this.date_graph.setSelection(i)};Dr.prototype.getSelection=function(){var t=[],i=this.date_graph.getSelection();if(i<0)return t;for(var e=this.date_graph.layout_.points,a=0;a<e.length;++a)t.push({row:i,column:a+1});return t};var Zl=Dr;var M=function(i,e,a){this.__init__(i,e,a)};M.NAME="Dygraph";M.VERSION="2.2.1";var ko={};M._require=function(i){return i in ko?ko[i]:M._require._b(i)};M._require._b=null;M._require.add=function(i,e){ko[i]=e};M.DEFAULT_ROLL_PERIOD=1;M.DEFAULT_WIDTH=480;M.DEFAULT_HEIGHT=320;M.ANIMATION_STEPS=12;M.ANIMATION_DURATION=200;M.Plotters=Ti._Plotters;M.addedAnnotationCSS=!1;M.prototype.__init__=function(t,i,e){if(this.is_initial_draw_=!0,this.readyFns_=[],e==null&&(e={}),e=M.copyUserAttrs_(e),typeof t=="string"&&(t=document.getElementById(t)),!t)throw new Error("Constructing dygraph with a non-existent div!");this.maindiv_=t,this.file_=i,this.rollPeriod_=e.rollPeriod||M.DEFAULT_ROLL_PERIOD,this.previousVerticalX_=-1,this.fractions_=e.fractions||!1,this.dateWindow_=e.dateWindow||null,this.annotations_=[],t.innerHTML="";let a=window.getComputedStyle(t,null);(a.paddingLeft!=="0px"||a.paddingRight!=="0px"||a.paddingTop!=="0px"||a.paddingBottom!=="0px")&&console.error("Main div contains padding; graph will misbehave"),t.style.width===""&&e.width&&(t.style.width=e.width+"px"),t.style.height===""&&e.height&&(t.style.height=e.height+"px"),t.style.height===""&&t.clientHeight===0&&(t.style.height=M.DEFAULT_HEIGHT+"px",t.style.width===""&&(t.style.width=M.DEFAULT_WIDTH+"px")),this.width_=t.clientWidth||e.width||0,this.height_=t.clientHeight||e.height||0,e.stackedGraph&&(e.fillGraph=!0),this.user_attrs_={},vt(this.user_attrs_,e),this.attrs_={},vr(this.attrs_,_a),this.boundaryIds_=[],this.setIndexByName_={},this.datasetIndex_=[],this.registeredEvents_=[],this.eventListeners_={},this.attributes_=new Wl(this),this.createInterface_(),this.plugins_=[];for(var n=M.PLUGINS.concat(this.getOption("plugins")),r=0;r<n.length;r++){var c=n[r],d;typeof c.activate<"u"?d=c:d=new c;var m={plugin:d,events:{},options:{},pluginOptions:{}},u=d.activate(this);for(var g in u)u.hasOwnProperty(g)&&(m.events[g]=u[g]);this.plugins_.push(m)}for(var r=0;r<this.plugins_.length;r++){var f=this.plugins_[r];for(var g in f.events)if(f.events.hasOwnProperty(g)){var y=f.events[g],_=[f.plugin,y];g in this.eventListeners_?this.eventListeners_[g].push(_):this.eventListeners_[g]=[_]}}this.createDragInterface_(),this.start_()};M.prototype.cascadeEvents_=function(t,i){if(!(t in this.eventListeners_))return!1;var e={dygraph:this,cancelable:!1,defaultPrevented:!1,preventDefault:function(){if(!e.cancelable)throw"Cannot call preventDefault on non-cancelable event.";e.defaultPrevented=!0},propagationStopped:!1,stopPropagation:function(){e.propagationStopped=!0}};vt(e,i);var a=this.eventListeners_[t];if(a)for(var n=a.length-1;n>=0;n--){var r=a[n][0],c=a[n][1];if(c.call(r,e),e.propagationStopped)break}return e.defaultPrevented};M.prototype.getPluginInstance_=function(t){for(var i=0;i<this.plugins_.length;i++){var e=this.plugins_[i];if(e.plugin instanceof t)return e.plugin}return null};M.prototype.isZoomed=function(t){let i=!!this.dateWindow_;if(t==="x")return i;let e=this.axes_.map(a=>!!a.valueRange).indexOf(!0)>=0;if(t==null)return i||e;if(t==="y")return e;throw new Error(`axis parameter is [${t}] must be null, 'x' or 'y'.`)};M.prototype.toString=function(){var t=this.maindiv_,i=t&&t.id?t.id:t;return"[Dygraph "+i+"]"};M.prototype.attr_=function(t,i){return typeof process<"u",i?this.attributes_.getForSeries(t,i):this.attributes_.get(t)};M.prototype.getOption=function(t,i){return this.attr_(t,i)};M.prototype.getNumericOption=function(t,i){return this.getOption(t,i)};M.prototype.getStringOption=function(t,i){return this.getOption(t,i)};M.prototype.getBooleanOption=function(t,i){return this.getOption(t,i)};M.prototype.getFunctionOption=function(t,i){return this.getOption(t,i)};M.prototype.getOptionForAxis=function(t,i){return this.attributes_.getForAxis(t,i)};M.prototype.optionsViewForAxis_=function(t){var i=this;return function(e){var a=i.user_attrs_.axes;return a&&a[t]&&a[t].hasOwnProperty(e)?a[t][e]:t==="x"&&e==="logscale"?!1:typeof i.user_attrs_[e]<"u"?i.user_attrs_[e]:(a=i.attrs_.axes,a&&a[t]&&a[t].hasOwnProperty(e)?a[t][e]:t=="y"&&i.axes_[0].hasOwnProperty(e)?i.axes_[0][e]:t=="y2"&&i.axes_[1].hasOwnProperty(e)?i.axes_[1][e]:i.attr_(e))}};M.prototype.rollPeriod=function(){return this.rollPeriod_};M.prototype.xAxisRange=function(){return this.dateWindow_?this.dateWindow_:this.xAxisExtremes()};M.prototype.xAxisExtremes=function(){var t=this.getNumericOption("xRangePad")/this.plotter_.area.w;if(this.numRows()===0)return[0-t,1+t];var i=this.rawData_[0][0],e=this.rawData_[this.rawData_.length-1][0];if(t){var a=e-i;i-=a*t,e+=a*t}return[i,e]};M.prototype.yAxisExtremes=function(){let t=this.gatherDatasets_(this.rolledSeries_,null),{extremes:i}=t,e=this.axes_;this.computeYAxisRanges_(i);let a=this.axes_;return this.axes_=e,a.map(n=>n.extremeRange)};M.prototype.yAxisRange=function(t){if(typeof t>"u"&&(t=0),t<0||t>=this.axes_.length)return null;var i=this.axes_[t];return[i.computedValueRange[0],i.computedValueRange[1]]};M.prototype.yAxisRanges=function(){for(var t=[],i=0;i<this.axes_.length;i++)t.push(this.yAxisRange(i));return t};M.prototype.toDomCoords=function(t,i,e){return[this.toDomXCoord(t),this.toDomYCoord(i,e)]};M.prototype.toDomXCoord=function(t){if(t===null)return null;var i=this.plotter_.area,e=this.xAxisRange();return i.x+(t-e[0])/(e[1]-e[0])*i.w};M.prototype.toDomYCoord=function(t,i){var e=this.toPercentYCoord(t,i);if(e===null)return null;var a=this.plotter_.area;return a.y+e*a.h};M.prototype.toDataCoords=function(t,i,e){return[this.toDataXCoord(t),this.toDataYCoord(i,e)]};M.prototype.toDataXCoord=function(t){if(t===null)return null;var i=this.plotter_.area,e=this.xAxisRange();if(this.attributes_.getForAxis("logscale","x")){var a=(t-i.x)/i.w;return La(e[0],e[1],a)}else return e[0]+(t-i.x)/i.w*(e[1]-e[0])};M.prototype.toDataYCoord=function(t,i){if(t===null)return null;var e=this.plotter_.area,a=this.yAxisRange(i);if(typeof i>"u"&&(i=0),this.attributes_.getForAxis("logscale",i)){var n=(t-e.y)/e.h;return La(a[1],a[0],n)}else return a[0]+(e.y+e.h-t)/e.h*(a[1]-a[0])};M.prototype.toPercentYCoord=function(t,i){if(t===null)return null;typeof i>"u"&&(i=0);var e=this.yAxisRange(i),a,n=this.attributes_.getForAxis("logscale",i);if(n){var r=Se(e[0]),c=Se(e[1]);a=(c-Se(t))/(c-r)}else a=(e[1]-t)/(e[1]-e[0]);return a};M.prototype.toPercentXCoord=function(t){if(t===null)return null;var i=this.xAxisRange(),e,a=this.attributes_.getForAxis("logscale","x");if(a===!0){var n=Se(i[0]),r=Se(i[1]);e=(Se(t)-n)/(r-n)}else e=(t-i[0])/(i[1]-i[0]);return e};M.prototype.numColumns=function(){return this.rawData_?this.rawData_[0]?this.rawData_[0].length:this.attr_("labels").length:0};M.prototype.numRows=function(){return this.rawData_?this.rawData_.length:0};M.prototype.getValue=function(t,i){return t<0||t>=this.rawData_.length||i<0||i>=this.rawData_[t].length?null:this.rawData_[t][i]};M.prototype.createInterface_=function(){var t=this.maindiv_;this.graphDiv=document.createElement("div"),this.graphDiv.style.textAlign="left",this.graphDiv.style.position="relative",t.appendChild(this.graphDiv),this.canvas_=ua(),this.canvas_.style.position="absolute",this.canvas_.style.top=0,this.canvas_.style.left=0,this.hidden_=this.createPlotKitCanvas_(this.canvas_),this.canvas_ctx_=la(this.canvas_),this.hidden_ctx_=la(this.hidden_),this.resizeElements_(),this.graphDiv.appendChild(this.hidden_),this.graphDiv.appendChild(this.canvas_),this.mouseEventElement_=this.createMouseEventElement_(),this.layout_=new Fa(this);var i=this;if(this.mouseMoveHandler_=function(a){i.mouseMove_(a)},this.mouseOutHandler_=function(a){var n=a.target||a.fromElement,r=a.relatedTarget||a.toElement;go(n,i.graphDiv)&&!go(r,i.graphDiv)&&i.mouseOut_(a)},this.addAndTrackEvent(window,"mouseout",this.mouseOutHandler_),this.addAndTrackEvent(this.mouseEventElement_,"mousemove",this.mouseMoveHandler_),!this.resizeHandler_){this.resizeHandler_=function(a){i.resize()},this.addAndTrackEvent(window,"resize",this.resizeHandler_),this.resizeObserver_=null;var e=this.getStringOption("resizable");if(typeof ResizeObserver>"u"&&e!=="no"&&(console.error("ResizeObserver unavailable; ignoring resizable property"),e="no"),e==="horizontal"||e==="vertical"||e==="both"?t.style.resize=e:e!=="passive"&&(e="no"),e!=="no"){let a=window.getComputedStyle(t).overflow;window.getComputedStyle(t).overflow==="visible"&&(t.style.overflow="hidden"),this.resizeObserver_=new ResizeObserver(this.resizeHandler_),this.resizeObserver_.observe(t)}}};M.prototype.resizeElements_=function(){this.graphDiv.style.width=this.width_+"px",this.graphDiv.style.height=this.height_+"px";var t=this.getNumericOption("pixelRatio"),i=t||Oa(this.canvas_ctx_);this.canvas_.width=this.width_*i,this.canvas_.height=this.height_*i,this.canvas_.style.width=this.width_+"px",this.canvas_.style.height=this.height_+"px",i!==1&&this.canvas_ctx_.scale(i,i);var e=t||Oa(this.hidden_ctx_);this.hidden_.width=this.width_*e,this.hidden_.height=this.height_*e,this.hidden_.style.width=this.width_+"px",this.hidden_.style.height=this.height_+"px",e!==1&&this.hidden_ctx_.scale(e,e)};M.prototype.destroy=function(){this.canvas_ctx_.restore(),this.hidden_ctx_.restore();for(var t=this.plugins_.length-1;t>=0;t--){var i=this.plugins_.pop();i.plugin.destroy&&i.plugin.destroy()}var e=function(n){for(;n.hasChildNodes();)e(n.firstChild),n.removeChild(n.firstChild)};this.removeTrackedEvents_(),Et(window,"mouseout",this.mouseOutHandler_),Et(this.mouseEventElement_,"mousemove",this.mouseMoveHandler_),this.resizeObserver_&&(this.resizeObserver_.disconnect(),this.resizeObserver_=null),Et(window,"resize",this.resizeHandler_),this.resizeHandler_=null,e(this.maindiv_);var a=function(r){for(var c in r)typeof r[c]=="object"&&(r[c]=null)};a(this.layout_),a(this.plotter_),a(this)};M.prototype.createPlotKitCanvas_=function(t){var i=ua();return i.style.position="absolute",i.style.top=t.style.top,i.style.left=t.style.left,i.width=this.width_,i.height=this.height_,i.style.width=this.width_+"px",i.style.height=this.height_+"px",i};M.prototype.createMouseEventElement_=function(){return this.canvas_};M.prototype.setColors_=function(){var t=this.getLabels(),i=t.length-1;this.colors_=[],this.colorsMap_={};for(var e=this.getNumericOption("colorSaturation")||1,a=this.getNumericOption("colorValue")||.5,n=Math.ceil(i/2),r=this.getOption("colors"),c=this.visibility(),d=0;d<i;d++)if(c[d]){var m=t[d+1],u=this.attributes_.getForSeries("color",m);if(!u)if(r)u=r[d%r.length];else{var g=d%2?n+(d+1)/2:Math.ceil((d+1)/2),f=1*g/(1+i);u=Nl(f,e,a)}this.colors_.push(u),this.colorsMap_[m]=u}};M.prototype.getColors=function(){return this.colors_};M.prototype.getPropertiesForSeries=function(t){for(var i=-1,e=this.getLabels(),a=1;a<e.length;a++)if(e[a]==t){i=a;break}return i==-1?null:{name:t,column:i,visible:this.visibility()[i-1],color:this.colorsMap_[t],axis:1+this.attributes_.axisForSeries(t)}};M.prototype.createRollInterface_=function(){var t=this.roller_;t||(this.roller_=t=document.createElement("input"),t.type="text",t.style.display="none",t.className="dygraph-roller",this.graphDiv.appendChild(t));var i=this.getBooleanOption("showRoller")?"block":"none",e=this.getArea(),a={top:e.y+e.h-25+"px",left:e.x+1+"px",display:i};t.size="2",t.value=this.rollPeriod_,vt(t.style,a);let n=this;t.onchange=function(){return n.adjustRoll(t.value)}};M.prototype.createDragInterface_=function(){var t={isZooming:!1,isPanning:!1,is2DPan:!1,dragStartX:null,dragStartY:null,dragEndX:null,dragEndY:null,dragDirection:null,prevEndX:null,prevEndY:null,prevDragDirection:null,cancelNextDblclick:!1,initialLeftmostDate:null,xUnitsPerPixel:null,dateRange:null,px:0,py:0,boundedDates:null,boundedValues:null,tarp:new xr,initializeMouseDown:function(c,d,m){c.preventDefault?c.preventDefault():(c.returnValue=!1,c.cancelBubble=!0);var u=mi(d.canvas_);m.px=u.x,m.py=u.y,m.dragStartX=pa(c,m),m.dragStartY=ma(c,m),m.cancelNextDblclick=!1,m.tarp.cover()},destroy:function(){var c=this;if((c.isZooming||c.isPanning)&&(c.isZooming=!1,c.dragStartX=null,c.dragStartY=null),c.isPanning){c.isPanning=!1,c.draggingDate=null,c.dateRange=null;for(var d=0;d<e.axes_.length;d++)delete e.axes_[d].draggingValue,delete e.axes_[d].dragValueRange}c.tarp.uncover()}},i=this.getOption("interactionModel"),e=this,a=function(c){return function(d){c(d,e,t)}};for(var n in i)i.hasOwnProperty(n)&&this.addAndTrackEvent(this.mouseEventElement_,n,a(i[n]));if(!i.willDestroyContextMyself){var r=function(c){t.destroy()};this.addAndTrackEvent(document,"mouseup",r)}};M.prototype.drawZoomRect_=function(t,i,e,a,n,r,c,d){var m=this.canvas_ctx_;r==ra?m.clearRect(Math.min(i,c),this.layout_.getPlotArea().y,Math.abs(i-c),this.layout_.getPlotArea().h):r==oa&&m.clearRect(this.layout_.getPlotArea().x,Math.min(a,d),this.layout_.getPlotArea().w,Math.abs(a-d)),t==ra?e&&i&&(m.fillStyle="rgba(128,128,128,0.33)",m.fillRect(Math.min(i,e),this.layout_.getPlotArea().y,Math.abs(e-i),this.layout_.getPlotArea().h)):t==oa&&n&&a&&(m.fillStyle="rgba(128,128,128,0.33)",m.fillRect(this.layout_.getPlotArea().x,Math.min(a,n),this.layout_.getPlotArea().w,Math.abs(n-a)))};M.prototype.clearZoomRect_=function(){this.currentZoomRectArgs_=null,this.canvas_ctx_.clearRect(0,0,this.width_,this.height_)};M.prototype.doZoomX_=function(t,i){this.currentZoomRectArgs_=null;var e=this.toDataXCoord(t),a=this.toDataXCoord(i);this.doZoomXDates_(e,a)};M.prototype.doZoomXDates_=function(t,i){var e=this.xAxisRange(),a=[t,i];let n=this.getFunctionOption("zoomCallback"),r=this;this.doAnimatedZoom(e,a,null,null,function(){n&&n.call(r,t,i,r.yAxisRanges())})};M.prototype.doZoomY_=function(t,i){this.currentZoomRectArgs_=null;for(var e=this.yAxisRanges(),a=[],n=0;n<this.axes_.length;n++){var r=this.toDataYCoord(t,n),c=this.toDataYCoord(i,n);a.push([c,r])}let d=this.getFunctionOption("zoomCallback"),m=this;this.doAnimatedZoom(null,null,e,a,function(){if(d){let[g,f]=m.xAxisRange();d.call(m,g,f,m.yAxisRanges())}})};M.zoomAnimationFunction=function(t,i){var e=1.5;return(1-Math.pow(e,-t))/(1-Math.pow(e,-i))};M.prototype.resetZoom=function(){let t=this.isZoomed("x"),i=this.isZoomed("y"),e=t||i;if(this.clearSelection(),!e)return;let[a,n]=this.xAxisExtremes(),r=this.getBooleanOption("animatedZooms"),c=this.getFunctionOption("zoomCallback");if(!r){this.dateWindow_=null,this.axes_.forEach(y=>{y.valueRange&&delete y.valueRange}),this.drawGraph_(),c&&c.call(this,a,n,this.yAxisRanges());return}var d=null,m=null,u=null,g=null;t&&(d=this.xAxisRange(),m=[a,n]),i&&(u=this.yAxisRanges(),g=this.yAxisExtremes());let f=this;this.doAnimatedZoom(d,m,u,g,function(){f.dateWindow_=null,f.axes_.forEach(_=>{_.valueRange&&delete _.valueRange}),c&&c.call(f,a,n,f.yAxisRanges())})};M.prototype.doAnimatedZoom=function(t,i,e,a,n){var r=this.getBooleanOption("animatedZooms")?M.ANIMATION_STEPS:1,c=[],d=[],m,u;if(t!==null&&i!==null)for(m=1;m<=r;m++)u=M.zoomAnimationFunction(m,r),c[m-1]=[t[0]*(1-u)+u*i[0],t[1]*(1-u)+u*i[1]];if(e!==null&&a!==null)for(m=1;m<=r;m++){u=M.zoomAnimationFunction(m,r);for(var g=[],f=0;f<this.axes_.length;f++)g.push([e[f][0]*(1-u)+u*a[f][0],e[f][1]*(1-u)+u*a[f][1]]);d[m-1]=g}let y=this;fo(function(_){if(d.length)for(var S=0;S<y.axes_.length;S++){var P=d[_][S];y.axes_[S].valueRange=[P[0],P[1]]}c.length&&(y.dateWindow_=c[_]),y.drawGraph_()},r,M.ANIMATION_DURATION/r,n)};M.prototype.getArea=function(){return this.plotter_.area};M.prototype.eventToDomCoords=function(t){if(t.offsetX&&t.offsetY)return[t.offsetX,t.offsetY];var i=mi(this.mouseEventElement_),e=sa(t)-i.x,a=ca(t)-i.y;return[e,a]};M.prototype.findClosestRow=function(t){for(var i=1/0,e=-1,a=this.layout_.points,n=0;n<a.length;n++)for(var r=a[n],c=r.length,d=0;d<c;d++){var m=r[d];if(da(m,!0)){var u=Math.abs(m.canvasx-t);u<i&&(i=u,e=m.idx)}}return e};M.prototype.findClosestPoint=function(t,i){for(var e=1/0,a,n,r,c,d,m,u,g=this.layout_.points.length-1;g>=0;--g)for(var f=this.layout_.points[g],y=0;y<f.length;++y)c=f[y],da(c)&&(n=c.canvasx-t,r=c.canvasy-i,a=n*n+r*r,a<e&&(e=a,d=c,m=g,u=c.idx));var _=this.layout_.setNames[m];return{row:u,seriesName:_,point:d}};M.prototype.findStackedPoint=function(t,i){for(var e=this.findClosestRow(t),a,n,r=0;r<this.layout_.points.length;++r){var c=this.getLeftBoundary_(r),d=e-c,m=this.layout_.points[r];if(!(d>=m.length)){var u=m[d];if(da(u)){var g=u.canvasy;if(t>u.canvasx&&d+1<m.length){var f=m[d+1];if(da(f)){var y=f.canvasx-u.canvasx;if(y>0){var _=(t-u.canvasx)/y;g+=_*(f.canvasy-u.canvasy)}}}else if(t<u.canvasx&&d>0){var S=m[d-1];if(da(S)){var y=u.canvasx-S.canvasx;if(y>0){var _=(u.canvasx-t)/y;g+=_*(S.canvasy-u.canvasy)}}}(r===0||g<i)&&(a=u,n=r)}}}var P=this.layout_.setNames[n];return{row:e,seriesName:P,point:a}};M.prototype.mouseMove_=function(t){var i=this.layout_.points;if(i!=null){var e=this.eventToDomCoords(t),a=e[0],n=e[1],r=this.getOption("highlightSeriesOpts"),c=!1;if(r&&!this.isSeriesLocked()){var d;this.getBooleanOption("stackedGraph")?d=this.findStackedPoint(a,n):d=this.findClosestPoint(a,n),c=this.setSelection(d.row,d.seriesName)}else{var m=this.findClosestRow(a);c=this.setSelection(m)}var u=this.getFunctionOption("highlightCallback");u&&c&&u.call(this,t,this.lastx_,this.selPoints_,this.lastRow_,this.highlightSet_)}};M.prototype.getLeftBoundary_=function(t){if(this.boundaryIds_[t])return this.boundaryIds_[t][0];for(var i=0;i<this.boundaryIds_.length;i++)if(this.boundaryIds_[i]!==void 0)return this.boundaryIds_[i][0];return 0};M.prototype.animateSelection_=function(t){var i=10,e=30;this.fadeLevel===void 0&&(this.fadeLevel=0),this.animateId===void 0&&(this.animateId=0);var a=this.fadeLevel,n=t<0?a:i-a;if(n<=0){this.fadeLevel&&this.updateSelection_(1);return}var r=++this.animateId,c=this,d=function(){c.fadeLevel!==0&&t<0&&(c.fadeLevel=0,c.clearSelection())};fo(function(m){c.animateId==r&&(c.fadeLevel+=t,c.fadeLevel===0?c.clearSelection():c.updateSelection_(c.fadeLevel/i))},n,e,d)};M.prototype.updateSelection_=function(t){this.cascadeEvents_("select",{selectedRow:this.lastRow_===-1?void 0:this.lastRow_,selectedX:this.lastx_===null?void 0:this.lastx_,selectedPoints:this.selPoints_});var i,e=this.canvas_ctx_;if(this.getOption("highlightSeriesOpts")){e.clearRect(0,0,this.width_,this.height_);var a=1-this.getNumericOption("highlightSeriesBackgroundAlpha"),n=ha(this.getOption("highlightSeriesBackgroundColor"));if(a){var r=this.getBooleanOption("animateBackgroundFade");if(r){if(t===void 0){this.animateSelection_(1);return}a*=t}e.fillStyle="rgba("+n.r+","+n.g+","+n.b+","+a+")",e.fillRect(0,0,this.width_,this.height_)}this.plotter_._renderLineChart(this.highlightSet_,e)}else if(this.previousVerticalX_>=0){var c=0,d=this.attr_("labels");for(i=1;i<d.length;i++){var m=this.getNumericOption("highlightCircleSize",d[i]);m>c&&(c=m)}var u=this.previousVerticalX_;e.clearRect(u-c-1,0,2*c+2,this.height_)}if(this.selPoints_.length>0){var g=this.selPoints_[0].canvasx;for(e.save(),i=0;i<this.selPoints_.length;i++){var f=this.selPoints_[i];if(!isNaN(f.canvasy)){var y=this.getNumericOption("highlightCircleSize",f.name),_=this.getFunctionOption("drawHighlightPointCallback",f.name),S=this.plotter_.colors[f.name];_||(_=Va.DEFAULT),e.lineWidth=this.getNumericOption("strokeWidth",f.name),e.strokeStyle=S,e.fillStyle=S,_.call(this,this,f.name,e,g,f.canvasy,S,y,f.idx)}}e.restore(),this.previousVerticalX_=g}};M.prototype.setSelection=function(i,e,a,n){this.selPoints_=[];var r=!1;if(i!==!1&&i>=0){i!=this.lastRow_&&(r=!0),this.lastRow_=i;for(var c=0;c<this.layout_.points.length;++c){var d=this.layout_.points[c],m=i-this.getLeftBoundary_(c);if(m>=0&&m<d.length&&d[m].idx==i){var u=d[m];u.yval!==null&&this.selPoints_.push(u)}else for(var g=0;g<d.length;++g){var u=d[g];if(u.idx==i){u.yval!==null&&this.selPoints_.push(u);break}}}}else this.lastRow_>=0&&(r=!0),this.lastRow_=-1;if(this.selPoints_.length?this.lastx_=this.selPoints_[0].xval:this.lastx_=null,e!==void 0&&(this.highlightSet_!==e&&(r=!0),this.highlightSet_=e),a!==void 0&&(this.lockedSet_=a),r&&(this.updateSelection_(void 0),n)){var f=this.getFunctionOption("highlightCallback");if(f){var y={};f.call(this,y,this.lastx_,this.selPoints_,this.lastRow_,this.highlightSet_)}}return r};M.prototype.mouseOut_=function(t){this.getFunctionOption("unhighlightCallback")&&this.getFunctionOption("unhighlightCallback").call(this,t),this.getBooleanOption("hideOverlayOnMouseOut")&&!this.lockedSet_&&this.clearSelection()};M.prototype.clearSelection=function(){if(this.cascadeEvents_("deselect",{}),this.lockedSet_=!1,this.fadeLevel){this.animateSelection_(-1);return}this.canvas_ctx_.clearRect(0,0,this.width_,this.height_),this.fadeLevel=0,this.selPoints_=[],this.lastx_=null,this.lastRow_=-1,this.highlightSet_=null};M.prototype.getSelection=function(){if(!this.selPoints_||this.selPoints_.length<1)return-1;for(var t=0;t<this.layout_.points.length;t++)for(var i=this.layout_.points[t],e=0;e<i.length;e++)if(i[e].x==this.selPoints_[0].x)return i[e].idx;return-1};M.prototype.getHighlightSeries=function(){return this.highlightSet_};M.prototype.isSeriesLocked=function(){return this.lockedSet_};M.prototype.loadedEvent_=function(t){this.rawData_=this.parseCSV_(t),this.cascadeDataDidUpdateEvent_(),this.predraw_()};M.prototype.addXTicks_=function(){var t;this.dateWindow_?t=[this.dateWindow_[0],this.dateWindow_[1]]:t=this.xAxisExtremes();var i=this.optionsViewForAxis_("x"),e=i("ticker")(t[0],t[1],this.plotter_.area.w,i,this);this.layout_.setXTicks(e)};M.prototype.getHandlerClass_=function(){var t;return this.attr_("dataHandler")?t=this.attr_("dataHandler"):this.fractions_?this.getBooleanOption("errorBars")?t=bo:t=xo:this.getBooleanOption("customBars")?t=Co:this.getBooleanOption("errorBars")?t=yo:t=$a,t};M.prototype.predraw_=function(){var t=new Date;this.dataHandler_=new(this.getHandlerClass_()),this.layout_.computePlotArea(),this.computeYAxes_(),this.is_initial_draw_||(this.canvas_ctx_.restore(),this.hidden_ctx_.restore()),this.canvas_ctx_.save(),this.hidden_ctx_.save(),this.plotter_=new Ti(this,this.hidden_,this.hidden_ctx_,this.layout_),this.createRollInterface_(),this.cascadeEvents_("predraw"),this.rolledSeries_=[null];for(var i=1;i<this.numColumns();i++){var e=this.dataHandler_.extractSeries(this.rawData_,i,this.attributes_);this.rollPeriod_>1&&(e=this.dataHandler_.rollingAverage(e,this.rollPeriod_,this.attributes_,i)),this.rolledSeries_.push(e)}this.drawGraph_();var a=new Date;this.drawingTimeMs_=a-t};M.PointType=void 0;M.stackPoints_=function(t,i,e,a){for(var n=null,r=null,c=null,d=-1,m=function(S){if(!(d>=S)){for(var P=S;P<t.length;++P)if(c=null,!isNaN(t[P].yval)&&t[P].yval!==null){d=P,c=t[P];break}}},u=0;u<t.length;++u){var g=t[u],f=g.xval;i[f]===void 0&&(i[f]=0);var y=g.yval;isNaN(y)||y===null?a=="none"?y=0:(m(u),r&&c&&a!="none"?y=r.yval+(c.yval-r.yval)*((f-r.xval)/(c.xval-r.xval)):r&&a=="all"?y=r.yval:c&&a=="all"?y=c.yval:y=0):r=g;var _=i[f];n!=f&&(_+=y,i[f]=_),n=f,g.yval_stacked=_,_>e[1]&&(e[1]=_),_<e[0]&&(e[0]=_)}};M.prototype.gatherDatasets_=function(t,i){var e=[],a=[],n=[],r={},c,d,m,u,g,f=t.length-1,y;for(c=f;c>=1;c--)if(this.visibility()[c-1]){if(i){y=t[c];var _=i[0],S=i[1];for(m=null,u=null,d=0;d<y.length;d++)y[d][0]>=_&&m===null&&(m=d),y[d][0]<=S&&(u=d);m===null&&(m=0);for(var P=m,R=!0;R&&P>0;)P--,R=y[P][1]===null;u===null&&(u=y.length-1);var I=u;for(R=!0;R&&I<y.length-1;)I++,R=y[I][1]===null;P!==m&&(m=P),I!==u&&(u=I),e[c-1]=[m,u],y=y.slice(m,u+1)}else y=t[c],e[c-1]=[0,y.length-1];var O=this.attr_("labels")[c],Y=this.dataHandler_.getExtremeYValues(y,i,this.getBooleanOption("stepPlot",O)),U=this.dataHandler_.seriesToPoints(y,O,e[c-1][0]);this.getBooleanOption("stackedGraph")&&(g=this.attributes_.axisForSeries(O),n[g]===void 0&&(n[g]=[]),M.stackPoints_(U,n[g],Y,this.getBooleanOption("stackedGraphNaNFill"))),r[O]=Y,a[c]=U}return{points:a,extremes:r,boundaryIds:e}};M.prototype.drawGraph_=function(){var t=new Date,i=this.is_initial_draw_;this.is_initial_draw_=!1,this.layout_.removeAllDatasets(),this.setColors_(),this.attrs_.pointSize=.5*this.getNumericOption("highlightCircleSize");var e=this.gatherDatasets_(this.rolledSeries_,this.dateWindow_),a=e.points,n=e.extremes;this.boundaryIds_=e.boundaryIds,this.setIndexByName_={};for(var r=this.attr_("labels"),c=0,d=1;d<a.length;d++)this.visibility()[d-1]&&(this.layout_.addDataset(r[d],a[d]),this.datasetIndex_[d]=c++);for(var d=0;d<r.length;d++)this.setIndexByName_[r[d]]=d;if(this.computeYAxisRanges_(n),this.layout_.setYAxes(this.axes_),this.addXTicks_(),this.layout_.evaluate(),this.renderGraph_(i),this.getStringOption("timingName")){var m=new Date;console.log(this.getStringOption("timingName")+" - drawGraph: "+(m-t)+"ms")}};M.prototype.renderGraph_=function(t){this.cascadeEvents_("clearChart"),this.plotter_.clear();let i=this.getFunctionOption("underlayCallback");i&&i.call(this,this.hidden_ctx_,this.layout_.getPlotArea(),this,this);var e={canvas:this.hidden_,drawingContext:this.hidden_ctx_};this.cascadeEvents_("willDrawChart",e),this.plotter_.render(),this.cascadeEvents_("didDrawChart",e),this.lastRow_=-1,this.canvas_.getContext("2d").clearRect(0,0,this.width_,this.height_);let a=this.getFunctionOption("drawCallback");if(a!==null&&a.call(this,this,t),t)for(this.readyFired_=!0;this.readyFns_.length>0;){var n=this.readyFns_.pop();n(this)}};M.prototype.computeYAxes_=function(){var t,i,e,a;for(this.axes_=[],t=0;t<this.attributes_.numAxes();t++)e={g:this},vt(e,this.attributes_.axisOptions(t)),this.axes_[t]=e;for(t=0;t<this.axes_.length;t++)if(t===0)e=this.optionsViewForAxis_("y"+(t?"2":"")),a=e("valueRange"),a&&(this.axes_[t].valueRange=a);else{var n=this.user_attrs_.axes;n&&n.y2&&(a=n.y2.valueRange,a&&(this.axes_[t].valueRange=a))}};M.prototype.numAxes=function(){return this.attributes_.numAxes()};M.prototype.axisPropertiesForSeries=function(t){return this.axes_[this.attributes_.axisForSeries(t)]};M.prototype.computeYAxisRanges_=function(t){for(var i=function(Bt){return isNaN(parseFloat(Bt))},e=this.attributes_.numAxes(),a,n,r,c,d,m=0;m<e;m++){var u=this.axes_[m],g=this.attributes_.getForAxis("logscale",m),f=this.attributes_.getForAxis("includeZero",m),y=this.attributes_.getForAxis("independentTicks",m);r=this.attributes_.seriesForAxis(m),a=!0,c=.1;let Bt=this.getNumericOption("yRangePad");if(Bt!==null&&(a=!1,c=Bt/this.plotter_.area.h),r.length===0)u.extremeRange=[0,1];else{for(var _=1/0,S=-1/0,P,R,I=0;I<r.length;I++)t.hasOwnProperty(r[I])&&(P=t[r[I]][0],P!==null&&(_=Math.min(P,_)),R=t[r[I]][1],R!==null&&(S=Math.max(R,S)));f&&!g&&(_>0&&(_=0),S<0&&(S=0)),_==1/0&&(_=0),S==-1/0&&(S=1),n=S-_,n===0&&(S!==0?n=Math.abs(S):(S=1,n=1));var O=S,Y=_;a&&(g?(O=S+c*n,Y=_):(O=S+c*n,Y=_-c*n,Y<0&&_>=0&&(Y=0),O>0&&S<=0&&(O=0))),u.extremeRange=[Y,O]}if(u.valueRange){var U=i(u.valueRange[0])?u.extremeRange[0]:u.valueRange[0],Q=i(u.valueRange[1])?u.extremeRange[1]:u.valueRange[1];u.computedValueRange=[U,Q]}else u.computedValueRange=u.extremeRange;if(!a){if(U=u.computedValueRange[0],Q=u.computedValueRange[1],U===Q)if(U===0)Q=1;else{var Ae=Math.abs(U/10);U-=Ae,Q+=Ae}if(g){var z=c/(2*c-1),K=(c-1)/(2*c-1);u.computedValueRange[0]=La(U,Q,z),u.computedValueRange[1]=La(U,Q,K)}else n=Q-U,u.computedValueRange[0]=U-n*c,u.computedValueRange[1]=Q+n*c}if(y){u.independentTicks=y;var de=this.optionsViewForAxis_("y"+(m?"2":"")),j=de("ticker");u.ticks=j(u.computedValueRange[0],u.computedValueRange[1],this.plotter_.area.h,de,this),d||(d=u)}}if(d===void 0)throw'Configuration Error: At least one axis has to have the "independentTicks" option activated.';for(var m=0;m<e;m++){var u=this.axes_[m];if(!u.independentTicks){for(var de=this.optionsViewForAxis_("y"+(m?"2":"")),j=de("ticker"),ce=d.ticks,st=d.computedValueRange[1]-d.computedValueRange[0],Le=u.computedValueRange[1]-u.computedValueRange[0],Pt=[],Xe=0;Xe<ce.length;Xe++){var Ce=(ce[Xe].v-d.computedValueRange[0])/st,Mi=u.computedValueRange[0]+Ce*Le;Pt.push(Mi)}u.ticks=j(u.computedValueRange[0],u.computedValueRange[1],this.plotter_.area.h,de,this,Pt)}}};M.prototype.detectTypeFromString_=function(t){var i=!1,e=t.indexOf("-");(e>0&&t[e-1]!="e"&&t[e-1]!="E"||t.indexOf("/")>=0||isNaN(parseFloat(t)))&&(i=!0),this.setXAxisOptions_(i)};M.prototype.setXAxisOptions_=function(t){t?(this.attrs_.xValueParser=mo,this.attrs_.axes.x.valueFormatter=fa,this.attrs_.axes.x.ticker=yi,this.attrs_.axes.x.axisLabelFormatter=wi):(this.attrs_.xValueParser=function(i){return parseFloat(i)},this.attrs_.axes.x.valueFormatter=function(i){return i},this.attrs_.axes.x.ticker=ii,this.attrs_.axes.x.axisLabelFormatter=this.attrs_.axes.x.valueFormatter)};M.prototype.parseCSV_=function(t){var i=[],e=_o(t),a=t.split(e||`
`),n,r,c=this.getStringOption("delimiter");a[0].indexOf(c)==-1&&a[0].indexOf("	")>=0&&(c="	");var d=0;"labels"in this.user_attrs_||(d=1,this.attrs_.labels=a[0].split(c),this.attributes_.reparseSeries());for(var m=0,u,g=!1,f=this.attr_("labels").length,y=!1,_=d;_<a.length;_++){var S=a[_];if(m=_,S.length!==0&&S[0]!="#"){var P=S.split(c);if(!(P.length<2)){var R=[];if(g||(this.detectTypeFromString_(P[0]),u=this.getFunctionOption("xValueParser"),g=!0),R[0]=u(P[0],this),this.fractions_)for(r=1;r<P.length;r++)n=P[r].split("/"),n.length!=2?(console.error(`Expected fractional "num/den" values in CSV data but found a value '`+P[r]+"' on line "+(1+_)+" ('"+S+"') which is not of this form."),R[r]=[0,0]):R[r]=[ni(n[0],_,S),ni(n[1],_,S)];else if(this.getBooleanOption("errorBars"))for(P.length%2!=1&&console.error("Expected alternating (value, stdev.) pairs in CSV data but line "+(1+_)+" has an odd number of values ("+(P.length-1)+"): '"+S+"'"),r=1;r<P.length;r+=2)R[(r+1)/2]=[ni(P[r],_,S),ni(P[r+1],_,S)];else if(this.getBooleanOption("customBars"))for(r=1;r<P.length;r++){var I=P[r];/^ *$/.test(I)?R[r]=[null,null,null]:(n=I.split(";"),n.length==3?R[r]=[ni(n[0],_,S),ni(n[1],_,S),ni(n[2],_,S)]:console.warn('When using customBars, values must be either blank or "low;center;high" tuples (got "'+I+'" on line '+(1+_)+")"))}else for(r=1;r<P.length;r++)R[r]=ni(P[r],_,S);if(i.length>0&&R[0]<i[i.length-1][0]&&(y=!0),R.length!=f&&console.error("Number of columns in line "+_+" ("+R.length+") does not agree with number of labels ("+f+") "+S),_===0&&this.attr_("labels")){var O=!0;for(r=0;O&&r<R.length;r++)R[r]&&(O=!1);if(O){console.warn("The dygraphs 'labels' option is set, but the first row of CSV data ('"+S+"') appears to also contain labels. Will drop the CSV labels and use the option labels.");continue}}i.push(R)}}}return y&&(console.warn("CSV is out of order; order it correctly to speed loading."),i.sort(function(Y,U){return Y[0]-U[0]})),i};function U0(t){let i=t[0],e=i[0];if(typeof e!="number"&&!uo(e))throw new Error(`Expected number or date but got ${typeof e}: ${e}.`);for(let a=1;a<i.length;a++){let n=i[a];if(n!=null&&typeof n!="number"&&!Si(n))throw new Error(`Expected number or array but got ${typeof n}: ${n}.`)}}M.prototype.parseArray_=function(t){if(t.length===0&&(t=[[0]]),t[0].length===0)return console.error("Data set cannot contain an empty row"),null;U0(t);var i;if(this.attr_("labels")===null){for(console.warn("Using default labels. Set labels explicitly via 'labels' in the options parameter"),this.attrs_.labels=["X"],i=1;i<t[0].length;i++)this.attrs_.labels.push("Y"+i);this.attributes_.reparseSeries()}else{var e=this.attr_("labels");if(e.length!=t[0].length)return console.error("Mismatch between number of labels ("+e+") and number of columns in array ("+t[0].length+")"),null}if(uo(t[0][0])){this.attrs_.axes.x.valueFormatter=fa,this.attrs_.axes.x.ticker=yi,this.attrs_.axes.x.axisLabelFormatter=wi;var a=ho(t);for(i=0;i<t.length;i++){if(a[i].length===0)return console.error("Row "+(1+i)+" of data is empty"),null;if(a[i][0]===null||typeof a[i][0].getTime!="function"||isNaN(a[i][0].getTime()))return console.error("x value in row "+(1+i)+" is not a Date"),null;a[i][0]=a[i][0].getTime()}return a}else return this.attrs_.axes.x.valueFormatter=function(n){return n},this.attrs_.axes.x.ticker=ii,this.attrs_.axes.x.axisLabelFormatter=Na,t};M.prototype.parseDataTable_=function(t){var i=function(U){var Q=String.fromCharCode(65+U%26);for(U=Math.floor(U/26);U>0;)Q=String.fromCharCode(65+(U-1)%26)+Q.toLowerCase(),U=Math.floor((U-1)/26);return Q},e=t.getNumberOfColumns(),a=t.getNumberOfRows(),n=t.getColumnType(0);if(n=="date"||n=="datetime")this.attrs_.xValueParser=mo,this.attrs_.axes.x.valueFormatter=fa,this.attrs_.axes.x.ticker=yi,this.attrs_.axes.x.axisLabelFormatter=wi;else if(n=="number")this.attrs_.xValueParser=function(U){return parseFloat(U)},this.attrs_.axes.x.valueFormatter=function(U){return U},this.attrs_.axes.x.ticker=ii,this.attrs_.axes.x.axisLabelFormatter=this.attrs_.axes.x.valueFormatter;else throw new Error("only 'date', 'datetime' and 'number' types are supported for column 1 of DataTable input (Got '"+n+"')");var r=[],c={},d=!1,m,u;for(m=1;m<e;m++){var g=t.getColumnType(m);if(g=="number")r.push(m);else if(g=="string"&&this.getBooleanOption("displayAnnotations")){var f=r[r.length-1];c.hasOwnProperty(f)?c[f].push(m):c[f]=[m],d=!0}else throw new Error("Only 'number' is supported as a dependent type with Gviz. 'string' is only supported if displayAnnotations is true")}var y=[t.getColumnLabel(0)];for(m=0;m<r.length;m++)y.push(t.getColumnLabel(r[m])),this.getBooleanOption("errorBars")&&(m+=1);this.attrs_.labels=y,e=y.length;var _=[],S=!1,P=[];for(m=0;m<a;m++){var R=[];if(typeof t.getValue(m,0)>"u"||t.getValue(m,0)===null){console.warn("Ignoring row "+m+" of DataTable because of undefined or null first column.");continue}if(n=="date"||n=="datetime"?R.push(t.getValue(m,0).getTime()):R.push(t.getValue(m,0)),this.getBooleanOption("errorBars"))for(u=0;u<e-1;u++)R.push([t.getValue(m,1+2*u),t.getValue(m,2+2*u)]);else{for(u=0;u<r.length;u++){var I=r[u];if(R.push(t.getValue(m,I)),d&&c.hasOwnProperty(I)&&t.getValue(m,c[I][0])!==null){var O={};O.series=t.getColumnLabel(I),O.xval=R[0],O.shortText=i(P.length),O.text="";for(var Y=0;Y<c[I].length;Y++)Y&&(O.text+=`
`),O.text+=t.getValue(m,c[I][Y]);P.push(O)}}for(u=0;u<R.length;u++)isFinite(R[u])||(R[u]=null)}_.length>0&&R[0]<_[_.length-1][0]&&(S=!0),_.push(R)}S&&(console.warn("DataTable is out of order; order it correctly to speed loading."),_.sort(function(U,Q){return U[0]-Q[0]})),this.rawData_=_,P.length>0&&this.setAnnotations(P,!0),this.attributes_.reparseSeries()};M.prototype.cascadeDataDidUpdateEvent_=function(){this.cascadeEvents_("dataDidUpdate",{})};M.prototype.start_=function(){var t=this.file_;typeof t=="function"&&(t=t());let i=Bl(t);if(i=="array")this.rawData_=this.parseArray_(t),this.cascadeDataDidUpdateEvent_(),this.predraw_();else if(i=="object"&&typeof t.getColumnRange=="function")this.parseDataTable_(t),this.cascadeDataDidUpdateEvent_(),this.predraw_();else if(i=="string"){var e=_o(t);if(e)this.loadedEvent_(t);else{var a;window.XMLHttpRequest?a=new XMLHttpRequest:a=new ActiveXObject("Microsoft.XMLHTTP");var n=this;a.onreadystatechange=function(){a.readyState==4&&(a.status===200||a.status===0)&&n.loadedEvent_(a.responseText)},a.open("GET",t,!0),a.send(null)}}else console.error("Unknown data format: "+i)};M.prototype.updateOptions=function(t,i){typeof i>"u"&&(i=!1);var e=t.file,a=M.copyUserAttrs_(t),n=this.attributes_.numAxes();"rollPeriod"in a&&(this.rollPeriod_=a.rollPeriod),"dateWindow"in a&&(this.dateWindow_=a.dateWindow);var r=Hl(this.attr_("labels"),a);vr(this.user_attrs_,a),this.attributes_.reparseSeries(),n<this.attributes_.numAxes()&&this.plotter_.clear(),e?(this.cascadeEvents_("dataWillUpdate",{}),this.file_=e,i||this.start_()):i||(r?this.predraw_():this.renderGraph_(!1))};M.copyUserAttrs_=function(t){var i={};for(var e in t)t.hasOwnProperty(e)&&e!="file"&&t.hasOwnProperty(e)&&(i[e]=t[e]);return i};M.prototype.resize=function(t,i){if(!this.resize_lock){this.resize_lock=!0,t===null!=(i===null)&&(console.warn("Dygraph.resize() should be called with zero parameters or two non-NULL parameters. Pretending it was zero."),t=i=null);var e=this.width_,a=this.height_;t?(this.maindiv_.style.width=t+"px",this.maindiv_.style.height=i+"px",this.width_=t,this.height_=i):(this.width_=this.maindiv_.clientWidth,this.height_=this.maindiv_.clientHeight),(e!=this.width_||a!=this.height_)&&(this.resizeElements_(),this.predraw_()),this.resize_lock=!1}};M.prototype.adjustRoll=function(t){this.rollPeriod_=t,this.predraw_()};M.prototype.visibility=function(){for(this.getOption("visibility")||(this.attrs_.visibility=[]);this.getOption("visibility").length<this.numColumns()-1;)this.attrs_.visibility.push(!0);return this.getOption("visibility")};M.prototype.setVisibility=function(t,i){var e=this.visibility(),a=!1;if(Array.isArray(t)||(t!==null&&typeof t=="object"?a=!0:t=[t]),a)for(var n in t)t.hasOwnProperty(n)&&(n<0||n>=e.length?console.warn("Invalid series number in setVisibility: "+n):e[n]=t[n]);else for(var n=0;n<t.length;n++)typeof t[n]=="boolean"?n>=e.length?console.warn("Invalid series number in setVisibility: "+n):e[n]=t[n]:t[n]<0||t[n]>=e.length?console.warn("Invalid series number in setVisibility: "+t[n]):e[t[n]]=i;this.predraw_()};M.prototype.size=function(){return{width:this.width_,height:this.height_}};M.prototype.setAnnotations=function(t,i){if(this.annotations_=t,!this.layout_){console.warn("Tried to setAnnotations before dygraph was ready. Try setting them in a ready() block. See dygraphs.com/tests/annotation.html");return}this.layout_.setAnnotations(this.annotations_),i||this.predraw_()};M.prototype.annotations=function(){return this.annotations_};M.prototype.getLabels=function(){var t=this.attr_("labels");return t?t.slice():null};M.prototype.indexFromSetName=function(t){return this.setIndexByName_[t]};M.prototype.getRowForX=function(t){for(var i=0,e=this.numRows()-1;i<=e;){var a=e+i>>1,n=this.getValue(a,0);if(n<t)i=a+1;else if(n>t)e=a-1;else if(i!=a)e=a;else return a}return null};M.prototype.ready=function(t){this.is_initial_draw_?this.readyFns_.push(t):t.call(this,this)};M.prototype.addAndTrackEvent=function(t,i,e){bi(t,i,e),this.registeredEvents_.push({elem:t,type:i,fn:e})};M.prototype.removeTrackedEvents_=function(){if(this.registeredEvents_)for(var t=0;t<this.registeredEvents_.length;t++){var i=this.registeredEvents_[t];Et(i.elem,i.type,i.fn)}this.registeredEvents_=[]};M.PLUGINS=[Po,wo,Eo,To,So,Do];M.GVizChart=Zl;M.DASHED_LINE=Ol;M.DOT_DASH_LINE=Vl;M.dateAxisLabelFormatter=wi;M.toRGB_=ha;M.findPos=mi;M.pageX=sa;M.pageY=ca;M.dateString_=po;M.defaultInteractionModel=kt.defaultModel;M.nonInteractiveModel=M.nonInteractiveModel_=kt.nonInteractiveModel_;M.Circles=Va;M.Plugins={Legend:Po,Axes:wo,Annotations:So,ChartLabels:To,Grid:Do,RangeSelector:Eo};M.DataHandlers={DefaultHandler:$a,BarsHandler:di,CustomBarsHandler:Co,DefaultFractionHandler:xo,ErrorBarsHandler:yo,FractionsBarsHandler:bo};M.startPan=kt.startPan;M.startZoom=kt.startZoom;M.movePan=kt.movePan;M.moveZoom=kt.moveZoom;M.endPan=kt.endPan;M.endZoom=kt.endZoom;M.numericLinearTicks=kl;M.numericTicks=ii;M.dateTicker=yi;M.Granularity=le;M.getDateAxis=no;M.floatFormat=co;Ul(M);var qe=M;function z0(t,i){t&1&&b(0,"div",0)}function W0(t,i){if(t&1){let e=N();l(0,"div",1),E("click",function(){let n=k(e).$implicit,r=h();return A(r.doSelect(n))}),o(),v(1,z0,1,0,"div",0)}if(t&2){let e=i.$implicit,a=i.$index,n=h();Ct("background-color",e),pe("selected",e===n.selectedColor),p(),x((a+1)%10===0?1:-1)}}var Ao=["#ff0029","#377eb8","#66a61e","#984ea3","#00d2d5","#ff7f00","#af8d00","#7f80cd","#b3e900","#c42e60","#a65628","#f781bf","#8dd3c7","#bebada","#fb8072","#80b1d3","#fdb462","#fccde5","#bc80bd","#ffed6f","#c4eaff","#cf8c00","#1b9e77","#d95f02","#e7298a","#e6ab02","#a6761d","#0097ff","#00d067","#000000"],ga=class t{constructor(){this.selectedColor=Ao[Math.floor(Math.random()*Ao.length)];this.select=new tt;this.colors=Ao}doSelect(i){this.select.emit(i),this.selectedColor=i}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-color-palette"]],inputs:{selectedColor:"selectedColor"},outputs:{select:"select"},decls:3,vars:0,consts:[[2,"clear","both"],[1,"box",3,"click"]],template:function(e,a){e&1&&(ae(0,W0,2,5,null,null,ie),b(2,"div",0)),e&2&&ne(a.colors)},dependencies:[G],styles:[".box[_ngcontent-%COMP%]{float:left;width:20px;height:20px;box-sizing:border-box;cursor:pointer}.box[_ngcontent-%COMP%]:hover{border:1px solid black}.box.selected[_ngcontent-%COMP%]{border:2px solid black}"],changeDetection:0})}};function j0(t,i){if(t&1){let e=N();l(0,"div",2),E("click",function(){let n=k(e).$implicit,r=h();return A(r.select(n))}),o()}if(t&2){let e=i.$implicit,a=h();Ct("border-bottom",e+"px solid")("border-color",e===a.selectedThickness?a.color:"black"),pe("selected",e===a.selectedThickness)}}var va=class t{constructor(i){this.changeDetection=i;this.options=[1,2,3,4];this.selectedThickness=2}select(i){this.selectedThickness=i}changeColor(i){this.color=i,this.changeDetection.detectChanges()}static{this.\u0275fac=function(e){return new(e||t)(T(xt))}}static{this.\u0275cmp=V({type:t,selectors:[["app-thickness"]],inputs:{selectedThickness:"selectedThickness",color:"color"},decls:3,vars:0,consts:[[1,"box",3,"selected","borderBottom","borderColor"],[2,"clear","both"],[1,"box",3,"click"]],template:function(e,a){e&1&&(ae(0,j0,1,6,"div",0,ie),b(2,"div",1)),e&2&&ne(a.options)},dependencies:[G],styles:[".box[_ngcontent-%COMP%]{float:left;width:30px;height:20px;box-sizing:border-box;cursor:pointer;margin-right:5px}"],changeDetection:0})}};var q0=["palette"],X0=["thickness"],Pr=class t{constructor(i,e){this.dialogRef=i;this.data=e}select(){this.dialogRef.close({color:this.palette.selectedColor,thickness:this.thickness.selectedThickness})}static{this.\u0275fac=function(e){return new(e||t)(T(Ve),T(Qe))}}static{this.\u0275cmp=V({type:t,selectors:[["app-modify-parameter-dialog"]],viewQuery:function(e,a){if(e&1&&(fe(q0,7),fe(X0,7)),e&2){let n;ue(n=he())&&(a.palette=n.first),ue(n=he())&&(a.thickness=n.first)}},decls:17,vars:3,consts:[["palette",""],["thickness",""],[3,"select","selectedColor"],[3,"selectedThickness","color"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click"]],template:function(e,a){if(e&1){let n=N();l(0,"mat-dialog-content")(1,"label"),s(2,"Color"),o(),b(3,"br"),l(4,"app-color-palette",2,0),E("select",function(c){k(n);let d=oe(11);return A(d.changeColor(c))}),o(),b(6,"br"),l(7,"label"),s(8,"Thickness"),o(),b(9,"br")(10,"app-thickness",3,1),o(),l(12,"mat-dialog-actions",4)(13,"ya-button",5),s(14,"CANCEL"),o(),l(15,"ya-button",6),E("click",function(){return k(n),A(a.select())}),s(16,"OK"),o()()}e&2&&(p(4),C("selectedColor",a.data.color),p(6),C("selectedThickness",a.data.strokeWidth)("color",a.data.color))},dependencies:[ga,G,Fe,$e,Be,_e,va],encapsulation:2,changeDetection:0})}};function Z0(t,i){if(t&1&&(l(0,"div",1)(1,"div",2)(2,"span",3),s(3),w(4,"datetime"),o()()()),t&2){let e=h(2);Ct("left",e.timestampData.canvasx+"px"),p(),Ct("background-color","black"),p(2),W(We(4,5,e.timestampData.timestamp,!1))}}function Q0(t,i){if(t&1&&v(0,Z0,5,8,"div",0),t&2){let e=h();x(e.timestampData?0:-1)}}var Er=class t{static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-timestamp-tracker"]],inputs:{legendData:"legendData",timestampData:"timestampData"},decls:1,vars:1,consts:[[1,"timestamp",2,"pointer-events","none",3,"left"],[1,"timestamp",2,"pointer-events","none"],[1,"box"],[1,"xvalue"]],template:function(e,a){e&1&&v(0,Q0,1,1),e&2&&x(a.legendData!=null&&a.legendData.x?0:-1)},dependencies:[G,Pe],styles:[".timestamp[_ngcontent-%COMP%]{position:absolute;bottom:0;background-color:transparent}.box[_ngcontent-%COMP%]{margin-top:5px;margin-right:5px;padding-left:3px;padding-right:3px;border-radius:2px;display:inline-block;font-size:10px;line-height:14px;position:relative;left:-50%}.xvalue[_ngcontent-%COMP%]{margin-left:5px;font-weight:700;color:#fff;white-space:nowrap}"],changeDetection:0})}};var Ya=class{constructor(){this.canvas=document.createElement("canvas")}activate(i){return i.graphDiv.appendChild(this.canvas),{select:this.select,deselect:this.deselect}}select(i){let e=i.dygraph.width_,a=i.dygraph.height_;this.canvas.width=e,this.canvas.height=a,this.canvas.style.width=e+"px",this.canvas.style.height=a+"px";let n=this.canvas.getContext("2d");n.clearRect(0,0,e,a),n.strokeStyle="#e1e1e1",n.beginPath();for(let r of i.dygraph.selPoints_){let c=Math.floor(r.canvasy)+.5;n.moveTo(0,c),n.lineTo(e,c)}n.stroke(),n.closePath()}deselect(i){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)}destroy(){this.canvas=null}toString(){return"Crosshair Plugin"}};var ya=class{constructor(){this.yLimits=[]}activate(i){return{willDrawChart:this.willDrawChart}}setAlarmZones(i){this.yLimits=[];for(let e of i)this.yLimits.push(e.y1IsLimit?e.y1:e.y2)}willDrawChart(i){let e=i.dygraph,a=i.drawingContext,n=e.layout_,r=i.dygraph.plotter_.area;if(e.getOptionForAxis("drawGrid","y")){let c=["y","y2"],d=[],m=[],u=[],g=[],f=[];for(let _=0;_<c.length;_++)u[_]=e.getOptionForAxis("drawGrid",c[_]),u[_]&&(d[_]=e.getOptionForAxis("gridLineColor",c[_]),m[_]=e.getOptionForAxis("gridLineWidth",c[_]),f[_]=e.getOptionForAxis("gridLinePattern",c[_]),g[_]=f[_]&&f[_].length>=2);let y=n.yticks;a.save();for(let _ of y){if(!_.has_tick||this.yLimits.indexOf(parseFloat(_.label))>=0)continue;let S=_.axis;if(u[S]){a.save(),g[S]&&a.setLineDash&&a.setLineDash(f[S]),a.strokeStyle=d[S],a.lineWidth=m[S];let P=this.halfUp(r.x),R=this.halfDown(r.y+_.pos*r.h);a.beginPath(),a.moveTo(P,R),a.lineTo(P+r.w,R),a.stroke(),a.restore()}}a.restore()}if(e.getOptionForAxis("drawGrid","x")){let c=n.xticks;a.save();let d=e.getOptionForAxis("gridLinePattern","x"),m=d&&d.length>=2;m&&a.setLineDash&&a.setLineDash(d),a.strokeStyle=e.getOptionForAxis("gridLineColor","x"),a.lineWidth=e.getOptionForAxis("gridLineWidth","x");for(let u of c){if(!u.has_tick)continue;let g=this.halfUp(r.x+u.pos*r.w),f=this.halfDown(r.y+r.h);a.beginPath(),a.moveTo(g,f),a.lineTo(g,r.y),a.closePath(),a.stroke()}m&&a.setLineDash&&a.setLineDash([]),a.restore()}}halfUp(i){return Math.round(i)+.5}halfDown(i){return Math.round(i)-.5}toString(){return"Gridline Plugin"}destroy(){}};function kr(t){let i,e,a=[];if(t.type&&t.type.defaultAlarm){let r=t.type.defaultAlarm;if(r.staticAlarmRanges){let c=-1/0;for(let d=r.staticAlarmRanges.length-1;d>=0;d--){let m=r.staticAlarmRanges[d];if(m.minInclusive!==void 0){let u={y1:c,y2:m.minInclusive,y1IsLimit:!1,color:Ql(m.level)||"black"};a.push(u),c=u.y2,i===void 0?i=m.minInclusive:i=Math.min(i,m.minInclusive)}}c=1/0;for(let d=r.staticAlarmRanges.length-1;d>=0;d--){let m=r.staticAlarmRanges[d];if(m.maxInclusive){let u={y1:m.maxInclusive,y2:c,y1IsLimit:!0,color:Ql(m.level)||"black"};a.push(u),c=u.y1,e===void 0?e=m.maxInclusive:e=Math.max(e,m.maxInclusive)}}}}let n=[null,null];return i!==void 0&&(n[0]=i),e!==void 0&&(n[1]=e),{valueRange:n,staticAlarmZones:a}}function Ql(t){switch(t){case"WATCH":return"#ffdddb";case"WARNING":return"#ffc3c1";case"DISTRESS":return"#ffaaa8";case"CRITICAL":return"#c35e5c";case"SEVERE":return"#a94442";default:console.error("Unknown level "+t)}}function K0(t,i){if(t&1&&(l(0,"span",4),s(1),o()),t&2){let e=h().$implicit;p(),W(e.yHTML)}}function J0(t,i){if(t&1){let e=N();l(0,"div",6),E("click",function(){k(e);let n=h().$implicit,r=h(2);return A(r.close.emit(n.label))}),l(1,"mat-icon",7),s(2,"close"),o()()}}function eh(t,i){if(t&1){let e=N();l(0,"div",2)(1,"span",3),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.select.emit(n.label))}),s(2),o(),v(3,K0,2,1,"span",4)(4,J0,3,0,"div",5),o()}if(t&2){let e=i.$implicit,a=i.$index,n=h(2);Ct("background-color",n.backgroundColor)("border","1px solid "+n.borderColor)("border-left","3px solid "+e.color)("padding-right",n.closable&&a!==0?"15px":"5px"),p(2),W(e.label),p(),x(e.yHTML?3:-1),p(),x(n.closable&&a!==0?4:-1)}}function th(t,i){if(t&1&&(l(0,"div",0),ae(1,eh,5,11,"div",1,ie),o()),t&2){let e=h();p(),ne(e.data.series)}}var Ar=class t{constructor(){this.closable=!1;this.select=new tt;this.close=new tt}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-parameter-legend"]],inputs:{data:"data",backgroundColor:"backgroundColor",borderColor:"borderColor",closable:"closable"},outputs:{select:"select",close:"close"},decls:1,vars:1,consts:[[1,"legend","no-select"],[1,"legend-box",3,"backgroundColor","border","borderLeft","paddingRight"],[1,"legend-box"],[1,"label",3,"click"],[1,"yvalue"],[1,"close-button"],[1,"close-button",3,"click"],[1,"icon12"]],template:function(e,a){e&1&&v(0,th,3,0,"div",0),e&2&&x(a.data?0:-1)},dependencies:[St],styles:[".legend[_ngcontent-%COMP%]{position:absolute;top:0;left:63px;background-color:transparent}.legend-box[_ngcontent-%COMP%]{margin-top:5px;margin-right:5px;padding-left:3px;padding-right:15px;border-radius:2px;display:inline-block;font-size:10px;line-height:14px;position:relative}.label[_ngcontent-%COMP%]{cursor:pointer}.label[_ngcontent-%COMP%]:hover{opacity:.7}.yvalue[_ngcontent-%COMP%]{margin-left:5px;font-weight:700}.close-button[_ngcontent-%COMP%]{position:absolute;top:0;right:0;cursor:pointer}"],changeDetection:0})}};var Ai=class t{constructor(){this.grid=!1;this.axis=!0;this.axisLineWidth=1;this.alarmRanges="line";this.color="#1b61b9";this.strokeWidth=2}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-parameter-series"]],inputs:{parameter:"parameter",grid:"grid",axis:"axis",axisLineWidth:"axisLineWidth",alarmRanges:"alarmRanges",color:"color",label:"label",strokeWidth:"strokeWidth"},decls:0,vars:0,template:function(e,a){},encapsulation:2})}};var ih=["graphContainer"],Ga=class t{constructor(i,e){this.dialog=i;this.formatter=e;this.fillGraph=!1;this.xGrid=!1;this.xAxis=!0;this.xAxisLineWidth=1;this.duration="PT1H";this.height="100%";this.width="100%";this.removableSeries=!1;this.stop=new Date;this.crosshair="vertical";this.axisBackgroundColor="#fafafa";this.axisLineColor="#e1e1e1";this.gridLineColor="#f2f2f2";this.plotAreaBackgroundColor="#fff";this.highlightColor="#e1e1e1";this.onVisibleRange=new tt;this.onManualRangeChange=new tt;this.parameters=[];this.parameterConfig=new Map;this.disableDataReload=!1;this.legendData$=new B(null);this.timestampTrackerData$=new B(null)}ngAfterViewInit(){this.dataSource.parameters$.value.forEach(e=>{this.parameters.push(e)}),this.seriesComponents.forEach(e=>{this.parameterConfig.set(e.parameter,e)});let i=this.graphContainer.nativeElement;if(this.initDygraphs(i),this.dataSource.data$.subscribe(e=>{if(this.disableDataReload)return;let a={file:e.samples.length?e.samples:`X
`};if(this.dataSource.visibleStart&&(a.dateWindow=[this.dataSource.visibleStart.getTime(),this.dataSource.visibleStop.getTime()],this.onVisibleRange.emit([this.dataSource.visibleStart,this.dataSource.visibleStop])),e.valueRange[0]!==null&&e.valueRange[1]!==null)a.axes={y:{valueRange:e.valueRange}};else{let n=kr(this.parameters[0]).valueRange,r=n[0];this.dataSource.minValue!==void 0&&(r=r!==null?Math.min(r,this.dataSource.minValue):this.dataSource.minValue);let c=n[1];this.dataSource.maxValue!==void 0&&(c=c!==null?Math.max(c,this.dataSource.maxValue):this.dataSource.maxValue),r===c&&r!==null&&(r=Math.min(r,0),c=Math.max(c,0)),r!==null&&c!==null&&(r=r-(c-r)*.1,c=c+(c-r)*.1),a.axes={y:{valueRange:[r,c]}}}this.dygraph.updateOptions(a)}),this.duration){let e=this.stop,a=F.subtractDuration(e,this.duration);this.dataSource.updateWindow(a,e,[null,null])}this.applyTheme()}initDygraphs(i){let e={},a=this.parameters.map(f=>this.parameterConfig.get(f.qualifiedName));a.forEach(f=>{e[f.label||f.parameter]={color:f.color,strokeWidth:f.strokeWidth}});let n=this.parameters[0],r=a[0],d=kr(n).staticAlarmZones,m=null,u={legend:"always",fillGraph:this.fillGraph,drawGrid:!1,drawPoints:!1,showRoller:!1,customBars:!0,gridLineColor:this.gridLineColor,axisLineColor:this.axisLineColor,axisLabelFontSize:11,digitsAfterDecimal:6,labels:["Generation Time",...a.map(f=>f.label||f.parameter)],rightGap:0,labelsUTC:this.formatter.isUTC(),series:e,axes:{x:{drawAxis:this.xAxis,drawGrid:this.xGrid,axisLineWidth:this.xAxisLineWidth||1e-7},y:{axisLabelWidth:50,drawAxis:r.axis,drawGrid:r.grid,axisLineWidth:r.axisLineWidth||1e-7,valueRange:kr(n).valueRange}},interactionModel:{mousedown:(f,y,_)=>{_.initializeMouseDown(f,y,_),f.altKey||f.shiftKey?qe.startZoom(f,y,_):qe.startPan(f,y,_)},mousemove:(f,y,_)=>{_.isPanning?(this.disableDataReload=!0,qe.movePan(f,y,_)):_.isZooming&&(this.disableDataReload=!0,qe.moveZoom(f,y,_))},mouseup:(f,y,_)=>{_.isPanning?qe.endPan(f,y,_):_.isZooming&&qe.endZoom(f,y,_);let S=y.xAxisRange(),P=new Date(S[0]),R=new Date(S[1]),I=y.yAxisRanges()[0];this.dataSource.updateWindow(P,R,I),this.onManualRangeChange.emit(),this.disableDataReload=!1},click:(f,y,_)=>{m=y,f.preventDefault(),f.stopPropagation()},mouseout:(f,y,_)=>{if(_.isPanning){let S=y.xAxisRange(),P=new Date(S[0]),R=new Date(S[1]),I=y.yAxisRanges()[0];this.dataSource.updateWindow(P,R,I)}this.disableDataReload=!1},mousewheel:(f,y,_)=>{if(m!==y)return;let P=(f.detail?f.detail*-1:f.deltaY/40)/50;f.offsetX&&f.offsetY||(f.offsetX=f.layerX-f.target.offsetLeft,f.offsetY=f.layerY-f.target.offsetTop);let R=this.offsetToPercentage(f.offsetX);this.zoom(P,R),f.preventDefault(),f.stopPropagation()}},underlayCallback:(f,y,_)=>{if(f.save(),f.globalAlpha=1,f.fillStyle=this.plotAreaBackgroundColor,f.fillRect(y.x,y.y,y.w,y.h),r.alarmRanges==="line")for(let S of d){let P=S.y1IsLimit?S.y1:S.y2,R=_.toDomCoords(0,P)[1];f.strokeStyle=S.color,f.lineWidth=1,f.beginPath(),f.moveTo(y.x,R),f.lineTo(y.x+y.w,R),f.stroke()}else if(r.alarmRanges==="fill"){f.globalAlpha=.2;for(let S of d){if(S.y2===null)return;let P,R;S.y1===-1/0?P=y.y+y.h:P=_.toDomCoords(0,S.y1)[1],S.y2===1/0?R=0:R=_.toDomCoords(0,S.y2)[1],f.fillStyle=S.color,f.fillRect(y.x,Math.min(P,R),y.w,Math.abs(R-P))}}f.restore()},drawHighlightPointCallback:(f,y,_,S,P,R,I)=>{if((r.label||r.parameter)===y){_.save(),_.setLineDash([5,5]),_.strokeStyle=this.highlightColor,_.lineWidth=1,this.timestampTrackerData$.next({timestamp:new Date(f.selPoints_[0].xval),canvasx:f.selPoints_[0].canvasx}),_.beginPath();let O=Math.floor(f.selPoints_[0].canvasx)+.5;if((this.crosshair==="vertical"||this.crosshair==="both")&&(_.moveTo(O,0),_.lineTo(O,f.height_)),this.crosshair==="horizontal"||this.crosshair==="both")for(let Y of f.selPoints_){let U=Math.floor(Y.canvasy)+.5;_.moveTo(0,U),_.lineTo(f.width_,U)}_.stroke(),_.closePath(),_.restore()}_.beginPath(),_.arc(S,P,I,0,2*Math.PI,!1),_.fill()},legendFormatter:f=>{for(let y of f.series)if(y.y===void 0){let _=this.dataSource.latestRealtimeValues.get(y.label);_&&(y.y=_[1],y.yHTML=String(_[1]))}return this.legendData$.next(f),""},plugins:[new Ya]};this.xAxisHeight!==void 0&&(u.xAxisHeight=this.xAxisHeight),qe.Plugins.Grid=ya,qe.PLUGINS=[qe.Plugins.Legend,qe.Plugins.Axes,qe.Plugins.Annotations,qe.Plugins.ChartLabels,qe.Plugins.Grid,qe.Plugins.RangeSelector],this.dygraph=new qe(i,`X
`,u),this.dygraph.getPluginInstance_(ya).setAlarmZones(d)}getParameters(){return this.parameters}addParameter(i,e){this.dataSource.addParameter(i),this.parameters.push(i),this.parameterConfig.set(i.qualifiedName,e),this.updateDygraphSeries()}removeParameter(i){let e=i;this.dataSource.removeParameter(e),this.parameters=this.parameters.filter(a=>a.qualifiedName!==e),this.parameterConfig.delete(e),this.updateDygraphSeries()}modifyParameter(i){let e=this.dygraph.getPropertiesForSeries(i);this.dialog.open(Pr,{data:yt(et({},e),{strokeWidth:this.dygraph.getOption("strokeWidth",i)})}).afterClosed().subscribe(n=>{if(n){let r=this.parameterConfig.get(i);r.color=n.color,r.strokeWidth=n.thickness,this.updateDygraphSeries()}})}updateDygraphSeries(){let i={},e=this.parameters.map(n=>this.parameterConfig.get(n.qualifiedName));e.forEach(n=>{i[n.label||n.parameter]={color:n.color,strokeWidth:n.strokeWidth}});let a={labels:["Generation Time",...e.map(n=>n.label||n.parameter)],series:i};this.dataSource.reloadVisibleRange().then(()=>{this.dygraph.updateOptions(a,!0)})}applyTheme(){if(this.dygraph&&this.dygraph.updateOptions({axisLineColor:this.axisLineColor,gridLineColor:this.gridLineColor}),this.graphContainer){let i=this.graphContainer.nativeElement;i.style.backgroundColor=this.axisBackgroundColor}}getDateRange(){if(this.dygraph){let i=this.dygraph.xAxisRange();return[new Date(i[0]),new Date(i[1])]}}zoomIn(){this.zoom(.2)}zoomOut(){this.zoom(-.25)}reset(){let i=this.dygraph.xAxisRange(),e=new Date(i[0]),a=new Date(i[1]);this.dataSource.updateWindow(e,a,[null,null])}zoom(i,e=.5){this.dygraph.updateOptions({dateWindow:this.adjustAxis(this.dygraph.xAxisRange(),i,e)});let a=this.dygraph.xAxisRange(),n=new Date(a[0]),r=new Date(a[1]);this.dataSource.updateWindow(n,r,[null,null]),this.onManualRangeChange.emit()}updateWindowOnly(i,e){this.dataSource.updateWindowOnly(i,e),this.dygraph.updateOptions({dateWindow:[i,e]})}adjustAxis(i,e,a){let r=(i[1]-i[0])*e,c=[r*a,r*(1-a)];return[i[0]+c[0],i[1]-c[1]]}offsetToPercentage(i){let e=this.dygraph.toDomCoords(this.dygraph.xAxisRange()[0],null)[0],a=i-e,n=this.dygraph.toDomCoords(this.dygraph.xAxisRange()[1],null)[0]-e;return n===0?0:a/n}ngOnDestroy(){this.dygraph?.destroy()}static{this.\u0275fac=function(e){return new(e||t)(T(Ne),T(ji))}}static{this.\u0275cmp=V({type:t,selectors:[["app-parameter-plot"]],contentQueries:function(e,a,n){if(e&1&&Bo(n,Ai,4),e&2){let r;ue(r=he())&&(a.seriesComponents=r)}},viewQuery:function(e,a){if(e&1&&fe(ih,7),e&2){let n;ue(n=he())&&(a.graphContainer=n.first)}},inputs:{dataSource:"dataSource",fillGraph:"fillGraph",xGrid:"xGrid",xAxis:"xAxis",xAxisLineWidth:"xAxisLineWidth",xAxisHeight:"xAxisHeight",duration:"duration",height:"height",width:"width",removableSeries:"removableSeries",stop:"stop",crosshair:"crosshair"},outputs:{onVisibleRange:"onVisibleRange",onManualRangeChange:"onManualRangeChange"},decls:9,vars:16,consts:[["graphContainer",""],[1,"legend-wrapper"],[3,"close","select","data","backgroundColor","borderColor","closable"],[1,"timestamp-wrapper"],[3,"legendData","timestampData"],[1,"graph-container"]],template:function(e,a){if(e&1){let n=N();l(0,"div",1)(1,"app-parameter-legend",2),w(2,"async"),E("close",function(c){return k(n),A(a.removeParameter(c))})("select",function(c){return k(n),A(a.modifyParameter(c))}),o()(),l(3,"div",3),b(4,"app-timestamp-tracker",4),w(5,"async"),w(6,"async"),o(),b(7,"div",5,0)}e&2&&(p(),C("data",D(2,10,a.legendData$))("backgroundColor",a.plotAreaBackgroundColor)("borderColor",a.gridLineColor)("closable",a.removableSeries),p(3),C("legendData",D(5,12,a.legendData$))("timestampData",D(6,14,a.timestampTrackerData$)),p(3),Ct("height",a.height)("width",a.width))},dependencies:[J,Ar,Er],styles:[".legend-wrapper[_ngcontent-%COMP%]{position:relative;z-index:50}.timestamp-wrapper[_ngcontent-%COMP%]{position:absolute;z-index:50;bottom:4px}.graph-container[_ngcontent-%COMP%]{overflow:hidden}  .annotation{background-color:#ffb6c1;color:red!important;opacity:.7;border-color:red!important}  .dygraph-axis-label{color:#aaa}  .dygraph-legend{position:absolute;font-size:14px;z-index:10;width:250px;background:#fff;line-height:normal;text-align:left;overflow:hidden}  .dygraph-legend-line{display:inline-block;position:relative;bottom:.5ex;padding-left:1em;height:1px;border-bottom-width:2px;border-bottom-style:solid}  .dygraph-legend-dash{display:inline-block;position:relative;bottom:.5ex;height:1px;border-bottom-width:2px;border-bottom-style:solid}  .dygraph-roller{position:absolute;z-index:10}  .dygraph-annotation{position:absolute;z-index:10;overflow:hidden}  .dygraph-default-annotation{border:1px solid black;background-color:#fff;text-align:center}  .dygraph-axis-label{z-index:10;line-height:normal;overflow:hidden;color:#000}  .dygraph-title{font-weight:700;z-index:10;text-align:center}  .dygraph-xlabel{text-align:center}  .dygraph-label-rotate-left{text-align:center;transform:rotate(90deg)}  .dygraph-label-rotate-right{text-align:center;transform:rotate(-90deg)}"],changeDetection:0})}};var ah=["palette"],nh=["thickness"];function rh(t,i){if(t&1&&(l(0,"mat-option",6),w(1,"memberPath"),s(2),w(3,"memberPath"),o()),t&2){let e=i.$implicit;C("value",D(1,2,e)),p(2),L(" ",D(3,4,e)," ")}}var Mr=class t{constructor(i,e,a){this.dialogRef=i;this.yamcs=e;this.data=a;this.parameter=new ee(null,[Ee.required])}ngOnInit(){let i=this.data.exclude;this.filteredOptions=this.parameter.valueChanges.pipe(Wa(300),ja(e=>this.yamcs.yamcsClient.getParameters(this.yamcs.instance,{q:e,limit:10,searchMembers:!0})),Ri(e=>e.parameters||[]),Ri(e=>e.filter(a=>{for(let n of i){let r=F.getMemberPath(a);if(n.qualifiedName===r)return!1}return!0})))}select(){this.dialogRef.close({qualifiedName:this.parameter.value,color:this.palette.selectedColor,thickness:this.thickness.selectedThickness})}static{this.\u0275fac=function(e){return new(e||t)(T(Ve),T(q),T(Qe))}}static{this.\u0275cmp=V({type:t,selectors:[["app-compare-parameter-dialog"]],viewQuery:function(e,a){if(e&1&&(fe(ah,7),fe(nh,7)),e&2){let n;ue(n=he())&&(a.palette=n.first),ue(n=he())&&(a.thickness=n.first)}},decls:24,vars:6,consts:[["auto",""],["palette",""],["thickness",""],[1,"ya-form"],["type","text",3,"formControl","matAutocomplete"],[1,"ya-autocomplete"],[3,"value"],[3,"color"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){if(e&1){let n=N();l(0,"mat-dialog-content",3)(1,"label"),s(2," Search parameter for comparison "),b(3,"input",4),l(4,"mat-autocomplete",5,0),ae(6,rh,4,6,"mat-option",6,ie),w(8,"async"),o()(),b(9,"br"),l(10,"label"),s(11,"Color"),o(),b(12,"app-color-palette",null,1)(14,"br"),l(15,"label"),s(16,"Thickness"),o(),b(17,"app-thickness",7,2),o(),l(19,"mat-dialog-actions",8)(20,"ya-button",9),s(21,"CANCEL"),o(),l(22,"ya-button",10),E("click",function(){return k(n),A(a.select())}),s(23,"ADD"),o()()}if(e&2){let n=oe(5),r=oe(13);p(3),C("formControl",a.parameter)("matAutocomplete",n),p(3),ne(D(8,4,a.filteredOptions)),p(11),C("color",r.selectedColor),p(5),C("disabled",!a.parameter.valid)}},dependencies:[ga,G,J,Ze,me,Gt,ln,nn,sn,Fe,$e,Be,_e,yn,va],encapsulation:2,changeDetection:0})}};var Rr=class t{constructor(i,e,a){this.dialogRef=i;this.yamcs=a;this.form=new it({start:new ee(null,Ee.required),stop:new ee(null,Ee.required)});let n=e.start,r=e.stop;(!n||!r)&&(r=this.yamcs.getMissionTime(),n=F.subtractDuration(r,"PT1H")),this.form.setValue({start:F.toISOString(n),stop:F.toISOString(r)})}select(){let i=F.toDate(this.form.value.start),e=F.toDate(this.form.value.stop);this.dialogRef.close({start:i,stop:e})}static{this.\u0275fac=function(e){return new(e||t)(T(Ve),T(Qe),T(q))}}static{this.\u0275cmp=V({type:t,selectors:[["app-select-range-dialog"]],decls:15,vars:2,consts:[["mat-dialog-title",""],[1,"ya-form"],[3,"formGroup"],["formControlName","start"],["formControlName","stop"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){e&1&&(l(0,"h2",0),s(1,"Select Range"),o(),l(2,"mat-dialog-content",1)(3,"form",2)(4,"label"),s(5," Start "),b(6,"ya-date-time-input",3),o(),l(7,"label"),s(8," Stop "),b(9,"ya-date-time-input",4),o()()(),l(10,"mat-dialog-actions",5)(11,"ya-button",6),s(12,"CANCEL"),o(),l(13,"ya-button",7),E("click",function(){return a.select()}),s(14,"OK"),o()()),e&2&&(p(3),C("formGroup",a.form),p(10),C("disabled",!a.form.valid))},dependencies:[G,Te,me,xe,be,De,Fe,mt,$e,Be,_e,_t],encapsulation:2})}};function oh(t,i){t&1&&(l(0,"span"),s(1,"Date Range"),o())}function lh(t,i){if(t&1&&(l(0,"span"),s(1),w(2,"datetime"),w(3,"datetime"),o()),t&2){let e=h(),a=h();p(),$t(" ",D(2,2,a)," - ",D(3,4,e)," ")}}function sh(t,i){if(t&1&&v(0,lh,4,6,"span"),t&2){let e=h(2);x(e==="CUSTOM"?0:-1)}}function ch(t,i){if(t&1&&(v(0,sh,1,1),w(1,"async")),t&2){let e,a=h(3);x((e=D(1,1,a.customStop$))?0:-1,e)}}function ph(t,i){if(t&1){let e=N();l(0,"div",2)(1,"ya-text-action",10),E("click",function(){k(e);let n=h(2);return A(n.compareParameter())}),s(2," Comparison "),o(),b(3,"span",9),l(4,"ya-text-action",11),E("click",function(){k(e);let n=h(2);return A(n.chooseRange())}),v(5,oh,2,0,"span")(6,ch,2,3),w(7,"async"),o(),l(8,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT1M"))}),s(9," 1 minute "),o(),l(10,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT5M"))}),s(11," 5 minutes "),o(),l(12,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT15M"))}),s(13," 15 minutes "),o(),l(14,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT30M"))}),s(15," 30 minutes "),o(),l(16,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT1H"))}),s(17," 1 hour "),o(),l(18,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT6H"))}),s(19," 6 hours "),o(),l(20,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("PT12H"))}),s(21," 12 hours "),o(),l(22,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("P1D"))}),s(23," 1 day "),o(),l(24,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("P2D"))}),s(25," 2 days "),o(),l(26,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("P1W"))}),s(27," 7 days "),o(),l(28,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("P2W"))}),s(29," 14 days "),o(),l(30,"ya-text-action",12),E("click",function(){k(e);let n=h(2);return A(n.loadLatest("P1M"))}),s(31," 30 days "),o()()}if(t&2){let e,a=i,n=h(2);p(4),C("active",a==="CUSTOM"),p(),x(a!=="CUSTOM"?5:-1),p(),x((e=D(7,15,n.customStart$))?6:-1,e),p(2),C("active",a==="PT1M"),p(2),C("active",a==="PT5M"),p(2),C("active",a==="PT15M"),p(2),C("active",a==="PT30M"),p(2),C("active",a==="PT1H"),p(2),C("active",a==="PT6H"),p(2),C("active",a==="PT12H"),p(2),C("active",a==="P1D"),p(2),C("active",a==="P2D"),p(2),C("active",a==="P1W"),p(2),C("active",a==="P2W"),p(2),C("active",a==="P1M")}}function mh(t,i){t&1&&(l(0,"span"),s(1,"the last minute"),o())}function dh(t,i){t&1&&(l(0,"span"),s(1,"the last 5 minutes"),o())}function uh(t,i){t&1&&(l(0,"span"),s(1,"the last 15 minutes"),o())}function hh(t,i){t&1&&(l(0,"span"),s(1,"the last 30 minutes"),o())}function fh(t,i){t&1&&(l(0,"span"),s(1,"the last hour"),o())}function _h(t,i){t&1&&(l(0,"span"),s(1,"the last 6 hours"),o())}function gh(t,i){t&1&&(l(0,"span"),s(1,"the last 12 hours"),o())}function vh(t,i){t&1&&(l(0,"span"),s(1,"the last 24 hours"),o())}function yh(t,i){t&1&&(l(0,"span"),s(1,"the last 2 days"),o())}function Ch(t,i){t&1&&(l(0,"span"),s(1,"the last week"),o())}function xh(t,i){t&1&&(l(0,"span"),s(1,"the last 2 weeks"),o())}function bh(t,i){t&1&&(l(0,"span"),s(1,"the last month"),o())}function Sh(t,i){t&1&&(l(0,"span"),s(1,"the selected range"),o())}function wh(t,i){if(t&1&&(l(0,"span",14),s(1," There is no data for this chart in "),v(2,mh,2,0,"span")(3,dh,2,0,"span")(4,uh,2,0,"span")(5,hh,2,0,"span")(6,fh,2,0,"span")(7,_h,2,0,"span")(8,gh,2,0,"span")(9,vh,2,0,"span")(10,yh,2,0,"span")(11,Ch,2,0,"span")(12,xh,2,0,"span")(13,bh,2,0,"span")(14,Sh,2,0,"span"),o()),t&2){let e;p(2),x((e=i)==="PT1M"?2:e==="PT5M"?3:e==="PT15M"?4:e==="PT30M"?5:e==="PT1H"?6:e==="PT6H"?7:e==="PT12H"?8:e==="P1D"?9:e==="P2D"?10:e==="P1W"?11:e==="P2W"?12:e==="P1M"?13:14)}}function Th(t,i){if(t&1&&(l(0,"div",13),v(1,wh,15,1,"span",14),w(2,"async"),o()),t&2){let e,a=h(4);p(),x((e=D(2,1,a.range$))?1:-1,e)}}function Dh(t,i){if(t&1&&v(0,Th,3,3,"div",13),t&2){let e=h();x(e.samples.length===0?0:-1)}}function Ph(t,i){if(t&1&&(v(0,Dh,1,1),w(1,"async")),t&2){let e=h(2);x(D(1,1,e.dataSource.loading$)?-1:0)}}function Eh(t,i){if(t&1){let e=N();l(0,"div",1),v(1,ph,32,17,"div",2),w(2,"async"),o(),l(3,"div",3)(4,"app-parameter-plot",4,0),E("onVisibleRange",function(n){k(e);let r=h();return A(r.onVisibleRange(n))})("onManualRangeChange",function(){k(e);let n=h();return A(n.onManualRangeChange())}),b(6,"app-parameter-series",5),o(),l(7,"div",6)(8,"div",7)(9,"button",8),E("click",function(){k(e);let n=oe(5);return A(n.zoomIn())}),l(10,"mat-icon"),s(11,"add"),o()(),b(12,"span",9),l(13,"button",8),E("click",function(){k(e);let n=oe(5);return A(n.zoomOut())}),l(14,"mat-icon"),s(15,"remove"),o()()()(),v(16,Ph,2,3),w(17,"async"),o()}if(t&2){let e,a,n=h();p(),x((e=D(2,9,n.range$))?1:-1,e),p(3),C("xGrid",!0)("xAxisHeight",24)("dataSource",n.dataSource)("stop",n.missionTime)("removableSeries",!0),p(2),C("parameter",i.qualifiedName)("grid",!0),p(10),x((a=D(17,11,n.dataSource.data$))?16:-1,a)}}var Ir=class t{constructor(i,e,a,n,r,c){this.router=i;this.route=e;this.yamcs=a;this.dialog=n;this.synchronizer=r;this.configService=c;this.qualifiedName=Rt.required({alias:"parameter"});this.range$=new B("PT15M");this.customStart$=new B(null);this.customStop$=new B(null)}ngOnInit(){this.missionTime=this.yamcs.getMissionTime(),this.initializeOptions();let i=this.qualifiedName();this.dataSource=new ta(this.yamcs,this.synchronizer,this.configService),this.parameter$=this.yamcs.yamcsClient.getParameter(this.yamcs.instance,i),this.parameter$.then(e=>{if(e.qualifiedName=i,this.dataSource.addParameter(e),this.range$.value==="CUSTOM"){let n=this.customStart$.value,r=this.customStop$.value;this.dataSource.updateWindow(n,r,[null,null])}else{let n=this.yamcs.getMissionTime(),r=F.subtractDuration(n,this.range$.value);this.dataSource.updateWindow(r,n,[null,null])}this.timeSubscription=this.yamcs.time$.subscribe(()=>{if(this.range$.value!=="CUSTOM"){let n=this.yamcs.getMissionTime(),r=F.subtractDuration(n,this.range$.value);this.plot?.updateWindowOnly(r,n)}}),this.backfillSubscription=this.yamcs.yamcsClient.createBackfillingSubscription({instance:this.yamcs.instance},n=>{n.finished&&this.dataSource.reloadVisibleRange()})})}initializeOptions(){let i=this.route.snapshot.queryParamMap;i.has("interval")&&(this.range$.next(i.get("interval")),i.get("interval")==="CUSTOM"&&(this.customStart$.next(new Date(i.get("customStart"))),this.customStop$.next(new Date(i.get("customStop"))))),this.updateURL()}onVisibleRange(i){this.customStart$.next(i[0]),this.customStop$.next(i[1])}onManualRangeChange(){this.range$.next("CUSTOM")}loadLatest(i){this.range$.next(i);let e=this.yamcs.getMissionTime(),a=F.subtractDuration(e,i);this.updateURL(),this.dataSource.updateWindow(a,e,[null,null])}chooseRange(){let i=this.plot.getDateRange();i&&this.dialog.open(Rr,{width:"400px",data:{start:i[0],stop:i[1]}}).afterClosed().subscribe(a=>{a&&(this.range$.next("CUSTOM"),this.customStart$.next(a.start),this.customStop$.next(a.stop),this.updateURL(),this.dataSource.updateWindow(a.start,a.stop,[null,null]))})}compareParameter(){this.dialog.open(Mr,{width:"600px",data:{exclude:this.plot.getParameters()}}).afterClosed().subscribe(e=>{e&&this.yamcs.yamcsClient.getParameter(this.yamcs.instance,e.qualifiedName).then(a=>{let n=new Ai;n.parameter=e.qualifiedName,n.color=e.color,n.strokeWidth=e.thickness,a.qualifiedName=e.qualifiedName,this.plot.addParameter(a,n)})})}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.range$.value,customStart:this.range$.value==="CUSTOM"?this.customStart$.value:null,customStop:this.range$.value==="CUSTOM"?this.customStop$.value:null},queryParamsHandling:"merge"})}ngOnDestroy(){this.backfillSubscription?.cancel(),this.timeSubscription?.unsubscribe(),this.dataSource?.disconnect()}static{this.\u0275fac=function(e){return new(e||t)(T(Oe),T(we),T(q),T(Ne),T(Tt),T(ye))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],viewQuery:function(e,a){if(e&1&&fe(Ga,5),e&2){let n;ue(n=he())&&(a.plot=n.first)}},inputs:{qualifiedName:[1,"parameter","qualifiedName"]},decls:2,vars:3,consts:[["plot",""],[2,"padding-left","12px","padding-right","12px","padding-top","12px"],[1,"plot-top-actions"],[1,"plot-container"],["duration","",3,"onVisibleRange","onManualRangeChange","xGrid","xAxisHeight","dataSource","stop","removableSeries"],[3,"parameter","grid"],[1,"zoom-actions"],[1,"zoom-actions-inner","elevation-z1"],["mat-button","",3,"click"],[1,"separator"],["icon","add_circle_outline",3,"click"],["icon","date_range",3,"click","active"],[3,"click","active"],[1,"no-data-message"],[1,"mat-caption",2,"color","#777"]],template:function(e,a){if(e&1&&(v(0,Eh,18,13),w(1,"async")),e&2){let n;x((n=D(1,1,a.parameter$))?0:-1,n)}},dependencies:[Ga,Ai,G,J,zo,St,Zt,Pe],styles:[".plot-container[_ngcontent-%COMP%]{border-top:1px solid rgba(0,0,0,.12);position:absolute;inset:48px 0 0}.zoom-actions[_ngcontent-%COMP%]{position:absolute;bottom:35px;left:0;right:0;margin:0 auto;text-align:center}.zoom-actions-inner[_ngcontent-%COMP%]{display:inline-block;background-color:#fafafa}.zoom-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{line-height:inherit;min-width:0}.no-data-message[_ngcontent-%COMP%]{position:absolute;inset:50% 0 0;margin:0 auto;text-align:center;pointer-events:none}.plot-top-actions[_ngcontent-%COMP%]{height:24px;line-height:24px}.separator[_ngcontent-%COMP%]{border-right:1px solid rgba(0,0,0,.12)}"],changeDetection:0})}};var Lr=class t{constructor(i,e,a){this.dialogRef=i;this.yamcs=e;this.data=a;this.delimiterOptions=[{id:"COMMA",label:"Comma"},{id:"SEMICOLON",label:"Semicolon"},{id:"TAB",label:"Tab"}];this.downloadURL$=new B(null);this.form=new it({start:new ee(null),stop:new ee(null),delimiter:new ee(null,Ee.required),interval:new on(null)});let n=a.start,r=a.stop;(!n||!r)&&(r=e.getMissionTime(),n=F.subtractDuration(r,"PT1H")),this.form.setValue({start:a.start?F.toISOString(a.start):"",stop:a.stop?F.toISOString(a.stop):"",delimiter:"TAB",interval:""}),this.formChangeSubscription=this.form.valueChanges.subscribe(()=>{this.updateURL()}),this.updateURL()}closeDialog(){this.dialogRef.close(!0)}updateURL(){if(this.form.valid){let i={parameters:this.data.parameter,delimiter:this.form.value.delimiter};this.form.value.start&&(i.start=F.toISOString(this.form.value.start)),this.form.value.stop&&(i.stop=F.toISOString(this.form.value.stop)),this.form.value.interval&&(i.interval=this.form.value.interval);let e=this.yamcs.yamcsClient.getParameterValuesDownloadURL(this.yamcs.instance,i);this.downloadURL$.next(e)}else this.downloadURL$.next(null)}ngOnDestroy(){this.formChangeSubscription?.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(T(Ve),T(q),T(Qe))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],decls:33,vars:6,consts:[["mat-dialog-title",""],[1,"ya-form"],[3,"formGroup"],[1,"hint"],["formControlName","start"],["formControlName","stop"],["formControlName","delimiter",3,"options"],["formControlName","interval","type","text",1,"ya-input"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","link","disabled"]],template:function(e,a){e&1&&(l(0,"h2",0),s(1,"Export parameter data"),o(),l(2,"mat-dialog-content",1)(3,"form",2)(4,"label"),s(5," Start "),l(6,"span",3),s(7,"(optional)"),o(),b(8,"ya-date-time-input",4),o(),b(9,"br"),l(10,"label"),s(11," Stop "),l(12,"span",3),s(13,"(optional)"),o(),b(14,"ya-date-time-input",5),o(),b(15,"br"),l(16,"label"),s(17," CSV column delimiter "),b(18,"br")(19,"ya-select",6),o(),b(20,"br"),l(21,"label"),s(22," Interval (ms) "),l(23,"span",3),s(24,"(optional)"),o(),b(25,"br")(26,"input",7),o()()(),l(27,"mat-dialog-actions",8)(28,"ya-button",9),s(29,"CANCEL"),o(),l(30,"ya-download-button",10),w(31,"async"),E("click",function(){return a.closeDialog()}),s(32," DOWNLOAD "),o()()),e&2&&(p(3),C("formGroup",a.form),p(16),C("options",a.delimiterOptions),p(11),C("link",D(31,4,a.downloadURL$))("disabled",!a.form.valid))},dependencies:[G,J,Te,Ze,me,xe,be,De,Fe,mt,$e,Be,_e,_t,_n,Dt],encapsulation:2,changeDetection:0})}};function kh(t,i){t&1&&(l(0,"th",15),s(1,"Severity"),o())}function Ah(t,i){if(t&1&&b(0,"app-alarm-level",17),t&2){let e=h().$implicit;C("level",e.monitoringResult)}}function Mh(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function Rh(t,i){if(t&1&&(l(0,"td",16),v(1,Ah,1,1,"app-alarm-level",17)(2,Mh,2,0,"span"),o()),t&2){let e=i.$implicit;p(),x(e.monitoringResult?1:-1),p(),x(e.monitoringResult?-1:2)}}function Ih(t,i){t&1&&(l(0,"th",15),s(1,"Generation time"),o())}function Lh(t,i){if(t&1&&(l(0,"td",16),s(1),w(2,"datetime"),o()),t&2){let e,a=i.$implicit;p(),W((e=D(2,1,a.generationTime))!==null&&e!==void 0?e:"-")}}function Oh(t,i){t&1&&(l(0,"th",15),s(1,"Reception time"),o())}function Vh(t,i){if(t&1&&(l(0,"td",16),s(1),w(2,"datetime"),o()),t&2){let e,a=i.$implicit;p(),W((e=D(2,1,a.acquisitionTime))!==null&&e!==void 0?e:"-")}}function Nh(t,i){t&1&&(l(0,"th",15),s(1,"Raw"),o())}function Fh(t,i){if(t&1&&(l(0,"td",18),b(1,"ya-value",19),o()),t&2){let e=i.$implicit;p(),C("value",e.rawValue)}}function Bh(t,i){t&1&&(l(0,"th",15),s(1,"Eng"),o())}function $h(t,i){if(t&1&&(l(0,"td",18),b(1,"ya-value",19),o()),t&2){let e=i.$implicit;p(),C("value",e.engValue)}}function Hh(t,i){t&1&&(l(0,"th",15),s(1,"Range condition"),o())}function Yh(t,i){if(t&1&&(l(0,"td",16),s(1),o()),t&2){let e=i.$implicit;p(),W(e.rangeCondition||"-")}}function Gh(t,i){t&1&&(l(0,"th",15),s(1,"Acquisition status"),o())}function Uh(t,i){if(t&1&&(l(0,"td",16),s(1),o()),t&2){let e=i.$implicit;p(),W(e.acquisitionStatus||"-")}}function zh(t,i){t&1&&b(0,"th",20)}function Wh(t,i){t&1&&b(0,"td",16)}function jh(t,i){t&1&&b(0,"tr",21)}function qh(t,i){if(t&1){let e=N();l(0,"tr",22),w(1,"async"),E("click",function(){let n=k(e).$implicit,r=h(2);return A(r.selectValue(n))}),o()}if(t&2){let e=i.$implicit,a=h(2);pe("selected",D(1,2,a.selectedValue)===e)}}function Xh(t,i){if(t&1&&(l(0,"table",0),$(1,1),v(2,kh,2,0,"th",2)(3,Rh,3,2,"td",3),H(),$(4,4),v(5,Ih,2,0,"th",2)(6,Lh,3,3,"td",3),H(),$(7,5),v(8,Oh,2,0,"th",2)(9,Vh,3,3,"td",3),H(),$(10,6),v(11,Nh,2,0,"th",2)(12,Fh,2,1,"td",7),H(),$(13,8),v(14,Bh,2,0,"th",2)(15,$h,2,1,"td",7),H(),$(16,9),v(17,Hh,2,0,"th",2)(18,Yh,2,1,"td",3),H(),$(19,10),v(20,Gh,2,0,"th",2)(21,Uh,2,1,"td",3),H(),$(22,11),v(23,zh,1,0,"th",12)(24,Wh,1,0,"td",3),H(),v(25,jh,1,0,"tr",13)(26,qh,2,4,"tr",14),o()),t&2){let e=h();C("dataSource",e.dataSource),p(25),C("matHeaderRowDef",e.displayedColumns),p(),C("matRowDefColumns",e.displayedColumns)}}var Or=class t extends Wi{constructor(){super(...arguments);this.selectedValue=new tt;this.displayedColumns=["severity","generationTime","rawValue","engValue","rangeCondition","acquisitionStatus","actions"]}selectValue(e){this.selectedValue.emit(e),this.openDetailPane()}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=No(t)))(n||t)}})()}static{this.\u0275cmp=V({type:t,selectors:[["app-parameter-values-table"]],inputs:{dataSource:"dataSource"},outputs:{selectedValue:"selectedValue"},features:[Ii],decls:1,vars:1,consts:[["mat-table","",1,"ya-data-table","expand",3,"dataSource"],["matColumnDef","severity"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","generationTime"],["matColumnDef","receptionTime"],["matColumnDef","rawValue"],["mat-cell","","class","wrap200",4,"matCellDef"],["matColumnDef","engValue"],["matColumnDef","rangeCondition"],["matColumnDef","acquisitionStatus"],["matColumnDef","actions"],["mat-header-cell","","class","expand",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected","click",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"level"],["mat-cell","",1,"wrap200"],[3,"value"],["mat-header-cell","",1,"expand"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(a,n){a&1&&v(0,Xh,27,3,"table",0),a&2&&x(n.dataSource?0:-1)},dependencies:[Jt,G,J,He,ut,ht,at,dt,wt,Ye,Ge,Ue,ze,Zi,Pe],styles:["tr[_ngcontent-%COMP%]{cursor:pointer}"],changeDetection:0})}};var Vr=class extends Yt{constructor(e,a){super();this.yamcs=e;this.qualifiedName=a;this.pageSize=100;this.pvals$=new B([]);this.loading$=new B(!1)}connect(e){return this.pvals$}isEmpty(){return this.pvals$.value.length===0}loadParameterValues(e){return this.loading$.next(!0),this.loadPage(yt(et({},e),{limit:this.pageSize+1})).then(a=>{this.pvals$.next(a)}).finally(()=>this.loading$.next(!1))}hasMore(){return this.offscreenRecord!=null}loadPage(e){return this.yamcs.yamcsClient.getParameterValues(this.yamcs.instance,this.qualifiedName,e).then(a=>(a.length>this.pageSize?this.offscreenRecord=a.splice(a.length-1,1)[0]:this.offscreenRecord=null,a))}async loadMoreData(e){if(this.offscreenRecord)return this.loadPage(yt(et({},e),{stop:this.offscreenRecord.generationTime,limit:this.pageSize+1})).then(a=>{let n=this.pvals$.getValue().concat(a);this.pvals$.next(n)})}disconnect(){this.pvals$.complete(),this.loading$.complete()}};var Nr=t=>({value:t});function Zh(t,i){if(t&1&&b(0,"app-alarm-level",15),t&2){let e=h();C("level",e.monitoringResult)}}function Qh(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function Kh(t,i){t&1&&xa(0)}function Jh(t,i){t&1&&xa(0)}function ef(t,i){t&1&&xa(0)}function tf(t,i){t&1&&xa(0)}function af(t,i){if(t&1&&(l(0,"ya-detail-toolbar"),s(1,"Value detail"),o(),l(2,"div",12)(3,"div",13),s(4,"Severity"),o(),l(5,"div",14),v(6,Zh,1,1,"app-alarm-level",15)(7,Qh,2,0,"span"),o(),l(8,"div",13),s(9,"Generation time"),o(),l(10,"div",14),s(11),w(12,"datetime"),o(),l(13,"div",13),s(14,"Valid for"),o(),l(15,"div",14),s(16),w(17,"millisDuration"),o(),l(18,"div",13),s(19," Raw value "),v(20,Kh,1,0,"ng-container",16),o(),l(21,"div",14),v(22,Jh,1,0,"ng-container",16),o(),l(23,"div",13),s(24," Engineering value "),v(25,ef,1,0,"ng-container",16),o(),l(26,"div",14),v(27,tf,1,0,"ng-container",16),o(),l(28,"div",13),s(29,"Range condition"),o(),l(30,"div",14),s(31),o(),l(32,"div",13),s(33,"Acquisition status"),o(),l(34,"div",14),s(35),o()()),t&2){let e=i;h();let a=oe(28),n=oe(30);p(6),x(e.monitoringResult?6:-1),p(),x(e.monitoringResult?-1:7),p(4),L(" ",D(12,14,e.generationTime)," "),p(5),L(" ",D(17,16,e.expireMillis)||"-"," "),p(4),C("ngTemplateOutlet",a)("ngTemplateOutletContext",X(18,Nr,e.rawValue)),p(2),C("ngTemplateOutlet",n)("ngTemplateOutletContext",X(20,Nr,e.rawValue)),p(3),C("ngTemplateOutlet",a)("ngTemplateOutletContext",X(22,Nr,e.engValue)),p(2),C("ngTemplateOutlet",n)("ngTemplateOutletContext",X(24,Nr,e.engValue)),p(4),L(" ",e.rangeCondition||"-"," "),p(4),L(" ",e.acquisitionStatus||"-"," ")}}function nf(t,i){t&1&&(l(0,"ya-detail-toolbar"),s(1,"Select a value"),o())}function rf(t,i){if(t&1){let e=N();b(0,"ya-date-time-input",17)(1,"ya-date-time-input",18),l(2,"ya-button",19),E("click",function(){k(e);let n=h();return A(n.applyCustomDates())}),s(3,"Apply"),o()}if(t&2){let e=h();p(2),C("disabled",e.filterForm.invalid)}}function of(t,i){if(t&1){let e=N();l(0,"ya-button",20),E("click",function(){k(e);let n=h();return A(n.jumpToNow())}),s(1,"Jump to now"),o()}}function lf(t,i){t&1&&b(0,"ya-dots")}function sf(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"the last hour"),o(),s(4," ending at "),l(5,"b"),s(6),w(7,"datetime"),o(),s(8," (Mission Time) "),o()),t&2){let e=h();p(6),W(D(7,1,e.validStop))}}function cf(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"the last 6 hours"),o(),s(4," ending at "),l(5,"b"),s(6),w(7,"datetime"),o(),s(8," (Mission Time) "),o()),t&2){let e=h();p(6),W(D(7,1,e.validStop))}}function pf(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"the last 24 hours"),o(),s(4," ending at "),l(5,"b"),s(6),w(7,"datetime"),o(),s(8," (Mission Time) "),o()),t&2){let e=h();p(6),W(D(7,1,e.validStop))}}function mf(t,i){t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3,"all time"),o()())}function df(t,i){if(t&1&&(l(0,"span"),s(1," Showing data from "),l(2,"b"),s(3),w(4,"datetime"),o(),s(5," to "),l(6,"b"),s(7),w(8,"datetime"),o(),s(9," (Mission Time) "),o()),t&2){let e=h();p(3),W(D(4,2,e.validStart)),p(4),W(D(8,4,e.validStop))}}function uf(t,i){t&1&&(l(0,"ya-empty-message"),s(1," No records found matching current filter in the selected time range. "),o())}function hf(t,i){if(t&1){let e=N();l(0,"mat-toolbar"),b(1,"span",8),l(2,"ya-button",19),E("click",function(){k(e);let n=h();return A(n.loadMoreData())}),s(3,"Load more"),o(),b(4,"span",8),o()}if(t&2){let e=h();p(2),C("disabled",!e.dataSource.hasMore())}}function ff(t,i){if(t&1){let e=N();l(0,"ya-more",21)(1,"button",22),E("click",function(){k(e);let n=h().value,r=h();return A(r.copyHex(n.binaryValue))}),s(2,"Copy hex"),o(),l(3,"button",22),E("click",function(){k(e);let n=h().value,r=h();return A(r.copyBinary(n.binaryValue))}),s(4,"Copy binary"),o()()}}function _f(t,i){if(t&1&&v(0,ff,5,0,"ya-more",21),t&2){let e,a=i.value;x((e=a==null?null:a.type)==="BINARY"?0:-1)}}function gf(t,i){if(t&1&&b(0,"app-hex",23),t&2){let e=h().value;C("base64String",e.binaryValue)}}function vf(t,i){if(t&1&&b(0,"ya-value",24),t&2){let e=h().value;C("value",e)}}function yf(t,i){if(t&1&&v(0,gf,1,1,"app-hex",23)(1,vf,1,1,"ya-value",24),t&2){let e,a=i.value;x((e=a==null?null:a.type)==="BINARY"?0:1)}}var Ca="PT1H",Fr=class t{constructor(i,e,a,n,r,c,d){this.route=i;this.router=e;this.yamcs=a;this.dialog=n;this.clipboard=r;this.messageService=c;this.configService=d;this.qualifiedName=Rt.required({alias:"parameter"});this.intervalOptions=[{id:"PT1H",label:"Last hour"},{id:"PT6H",label:"Last 6 hours"},{id:"P1D",label:"Last 24 hours"},{id:"NO_LIMIT",label:"No limit"},{id:"CUSTOM",label:"Custom"}];this.filterForm=new it({interval:new ee(Ca),customStart:new ee(null),customStop:new ee(null)});this.downloadURL$=new B(null)}ngOnInit(){let i=this.qualifiedName();this.dataSource=new Vr(this.yamcs,i),this.validStop=this.yamcs.getMissionTime(),this.validStart=F.subtractDuration(this.validStop,Ca),this.appliedInterval=Ca,this.initializeOptions(),this.loadData(),this.filterForm.get("interval").valueChanges.forEach(e=>{if(e==="CUSTOM"){let a=this.validStart||this.yamcs.getMissionTime(),n=this.validStop||this.yamcs.getMissionTime();this.filterForm.get("customStart").setValue(F.toISOString(a)),this.filterForm.get("customStop").setValue(F.toISOString(n))}else e==="NO_LIMIT"?(this.validStart=null,this.validStop=null,this.appliedInterval=e,this.loadData()):(this.validStop=this.yamcs.getMissionTime(),this.validStart=F.subtractDuration(this.validStop,e),this.appliedInterval=e,this.loadData())})}initializeOptions(){let i=this.route.snapshot.queryParamMap;if(i.has("interval"))if(this.appliedInterval=i.get("interval"),this.filterForm.get("interval").setValue(this.appliedInterval),this.appliedInterval==="CUSTOM"){let e=i.get("customStart");this.filterForm.get("customStart").setValue(e),this.validStart=new Date(e);let a=i.get("customStop");this.filterForm.get("customStop").setValue(a),this.validStop=new Date(a)}else this.appliedInterval==="NO_LIMIT"?(this.validStart=null,this.validStop=null):(this.validStop=this.yamcs.getMissionTime(),this.validStart=F.subtractDuration(this.validStop,this.appliedInterval));else this.appliedInterval=Ca,this.validStop=this.yamcs.getMissionTime(),this.validStart=F.subtractDuration(this.validStop,Ca)}jumpToNow(){let i=this.filterForm.value.interval;i==="NO_LIMIT"?this.filterForm.get("interval").setValue(Ca):(this.validStop=this.yamcs.getMissionTime(),this.validStart=F.subtractDuration(this.validStop,i),this.loadData())}applyCustomDates(){this.validStart=F.toDate(this.filterForm.value.customStart),this.validStop=F.toDate(this.filterForm.value.customStop),this.appliedInterval="CUSTOM",this.loadData()}loadData(){this.updateURL();let i={source:this.configService.isParameterArchiveEnabled()?"ParameterArchive":"replay"};if(this.validStart){let e=new Date(this.validStart.getTime());e.setUTCMilliseconds(this.validStart.getUTCMilliseconds()-1),i.start=e.toISOString()}this.validStop&&(i.stop=this.validStop.toISOString()),this.dataSource.loadParameterValues(i).catch(e=>this.messageService.showError(e))}loadMoreData(){let i={source:this.configService.isParameterArchiveEnabled()?"ParameterArchive":"replay"};if(this.validStart){let e=new Date(this.validStart.getTime());e.setUTCMilliseconds(this.validStart.getUTCMilliseconds()-1),i.start=e.toISOString()}this.dataSource.loadMoreData(i).catch(e=>this.messageService.showError(e))}copyHex(i){let e=F.convertBase64ToHex(i);this.clipboard.copy(e)}copyBinary(i){let e=window.atob(i);this.clipboard.copy(e)}updateURL(){this.router.navigate([],{replaceUrl:!0,relativeTo:this.route,queryParams:{interval:this.appliedInterval,customStart:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStart:null,customStop:this.appliedInterval==="CUSTOM"?this.filterForm.value.customStop:null},queryParamsHandling:"merge"})}exportParameterData(){this.dialog.open(Lr,{width:"400px",data:{parameter:this.qualifiedName(),start:this.validStart,stop:this.validStop}})}ngOnDestroy(){this.dataSource?.disconnect()}static{this.\u0275fac=function(e){return new(e||t)(T(we),T(Oe),T(q),T(Ne),T(Ui),T(ft),T(ye))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],inputs:{qualifiedName:[1,"parameter","qualifiedName"]},decls:31,vars:16,consts:[["table",""],["valueActionsTemplate",""],["valueTemplate",""],[1,"table-wrapper"],[1,"panel-content"],[3,"formGroup"],[1,"filter-bar"],["icon","access_time","formControlName","interval",3,"options"],[2,"flex","1 1 auto"],["appearance","primary","icon","download",1,"no-margin",3,"click"],[1,"table-status"],[3,"dataSource"],[2,"padding","0 16px"],[1,"block-title"],[1,"block"],[3,"level"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["formControlName","customStart"],["formControlName","customStop"],[3,"click","disabled"],[3,"click"],["icon","more_horiz"],["mat-menu-item","",3,"click"],[3,"base64String"],[3,"value"]],template:function(e,a){if(e&1){let n=N();l(0,"ya-detail-pane"),v(1,af,36,26),w(2,"async"),v(3,nf,2,0,"ya-detail-toolbar"),o(),l(4,"div",3)(5,"div",4)(6,"form",5)(7,"div",6),b(8,"ya-select",7),v(9,rf,4,1)(10,of,2,0,"ya-button")(11,lf,1,0,"ya-dots"),w(12,"async"),b(13,"div",8),l(14,"ya-button",9),E("click",function(){return k(n),A(a.exportParameterData())}),s(15," Export CSV "),o()()(),l(16,"div",10),v(17,sf,9,3,"span")(18,cf,9,3,"span")(19,pf,9,3,"span")(20,mf,4,0,"span")(21,df,10,6,"span"),o(),b(22,"app-parameter-values-table",11,0),v(24,uf,2,0,"ya-empty-message")(25,hf,5,1,"mat-toolbar"),w(26,"async"),o()(),v(27,_f,1,1,"ng-template",null,1,fi)(29,yf,2,1,"ng-template",null,2,fi)}if(e&2){let n,r,c=oe(23);p(),x((n=D(2,10,c.selectedValue))?1:3,n),p(5),C("formGroup",a.filterForm),p(2),C("options",a.intervalOptions),p(),x(a.filterForm.value.interval==="CUSTOM"?9:-1),p(),x(a.filterForm.value.interval!=="CUSTOM"?10:-1),p(),x(D(12,12,a.dataSource.loading$)?11:-1),p(6),x((r=a.appliedInterval)==="PT1H"?17:r==="PT6H"?18:r==="P1D"?19:r==="NO_LIMIT"?20:r==="CUSTOM"?21:-1),p(5),C("dataSource",a.dataSource),p(2),x(a.dataSource.isEmpty()?24:-1),p(),x(!D(26,14,a.dataSource.loading$)&&!a.dataSource.isEmpty()?25:-1)}},dependencies:[Jt,Ji,Or,G,Yo,J,Te,me,xe,be,De,pt,Gi,_e,_t,qi,Xi,jt,qt,Ot,Dt,Zi,Pe,cl],styles:[".detail[_ngcontent-%COMP%]{background-color:#fcfcfc;float:right;height:100%;width:450px;overflow:auto;border-left:1px solid #d3d3d3;box-sizing:border-box}.table-wrapper[_ngcontent-%COMP%]{position:relative;overflow:auto;height:100%}.table-status[_ngcontent-%COMP%]{background-color:var(--y-background-color);height:24px;line-height:24px;font-size:12px;padding-left:6px}.table-status[_ngcontent-%COMP%]   .message-zone[_ngcontent-%COMP%]{float:right;height:24px;line-height:24px;font-size:12px;padding-right:6px}"],changeDetection:0})}};var Cf=["container"],Ft="http://www.w3.org/2000/svg",Br=class t{ngOnChanges(){this.pval&&this.indicator&&this.redraw()}ngAfterViewInit(){let i=this.container.nativeElement,e=document.createElementNS(Ft,"rect");e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("width","100"),e.setAttribute("height","50"),e.setAttribute("shape-rendering","crispEdges"),e.style.fill="#00ff00",i.appendChild(e),this.watchLowRange=document.createElementNS(Ft,"rect"),this.watchLowRange.setAttribute("x","0"),this.watchLowRange.setAttribute("y","0"),this.watchLowRange.setAttribute("width","0"),this.watchLowRange.setAttribute("height","50"),this.watchLowRange.setAttribute("shape-rendering","crispEdges"),this.watchLowRange.style.fill="#ffff98",i.appendChild(this.watchLowRange),this.watchHighRange=document.createElementNS(Ft,"rect"),this.watchHighRange.setAttribute("x","0"),this.watchHighRange.setAttribute("y","0"),this.watchHighRange.setAttribute("width","0"),this.watchHighRange.setAttribute("height","50"),this.watchHighRange.setAttribute("shape-rendering","crispEdges"),this.watchHighRange.style.fill="#ffff98",i.appendChild(this.watchHighRange),this.warningLowRange=document.createElementNS(Ft,"rect"),this.warningLowRange.setAttribute("x","0"),this.warningLowRange.setAttribute("y","0"),this.warningLowRange.setAttribute("width","0"),this.warningLowRange.setAttribute("height","50"),this.warningLowRange.setAttribute("shape-rendering","crispEdges"),this.warningLowRange.style.fill="#ffff00",i.appendChild(this.warningLowRange),this.warningHighRange=document.createElementNS(Ft,"rect"),this.warningHighRange.setAttribute("x","0"),this.warningHighRange.setAttribute("y","0"),this.warningHighRange.setAttribute("width","0"),this.warningHighRange.setAttribute("height","50"),this.warningHighRange.setAttribute("shape-rendering","crispEdges"),this.warningHighRange.style.fill="#ffff00",i.appendChild(this.warningHighRange),this.distressLowRange=document.createElementNS(Ft,"rect"),this.distressLowRange.setAttribute("x","0"),this.distressLowRange.setAttribute("y","0"),this.distressLowRange.setAttribute("width","0"),this.distressLowRange.setAttribute("height","50"),this.distressLowRange.setAttribute("shape-rendering","crispEdges"),this.distressLowRange.style.fill="#ff6600",i.appendChild(this.distressLowRange),this.distressHighRange=document.createElementNS(Ft,"rect"),this.distressHighRange.setAttribute("x","0"),this.distressHighRange.setAttribute("y","0"),this.distressHighRange.setAttribute("width","0"),this.distressHighRange.setAttribute("height","50"),this.distressHighRange.setAttribute("shape-rendering","crispEdges"),this.distressHighRange.style.fill="#ff6600",i.appendChild(this.distressHighRange),this.criticalLowRange=document.createElementNS(Ft,"rect"),this.criticalLowRange.setAttribute("x","0"),this.criticalLowRange.setAttribute("y","0"),this.criticalLowRange.setAttribute("width","0"),this.criticalLowRange.setAttribute("height","50"),this.criticalLowRange.setAttribute("shape-rendering","crispEdges"),this.criticalLowRange.style.fill="red",i.appendChild(this.criticalLowRange),this.criticalHighRange=document.createElementNS(Ft,"rect"),this.criticalHighRange.setAttribute("x","0"),this.criticalHighRange.setAttribute("y","0"),this.criticalHighRange.setAttribute("width","0"),this.criticalHighRange.setAttribute("height","50"),this.criticalHighRange.setAttribute("shape-rendering","crispEdges"),this.criticalHighRange.style.fill="red",i.appendChild(this.criticalHighRange),this.severeLowRange=document.createElementNS(Ft,"rect"),this.severeLowRange.setAttribute("x","0"),this.severeLowRange.setAttribute("y","0"),this.severeLowRange.setAttribute("width","0"),this.severeLowRange.setAttribute("height","50"),this.severeLowRange.setAttribute("shape-rendering","crispEdges"),this.severeLowRange.style.fill="#800000",i.appendChild(this.severeLowRange),this.severeHighRange=document.createElementNS(Ft,"rect"),this.severeHighRange.setAttribute("x","0"),this.severeHighRange.setAttribute("y","0"),this.severeHighRange.setAttribute("width","0"),this.severeHighRange.setAttribute("height","50"),this.severeHighRange.setAttribute("shape-rendering","crispEdges"),this.severeHighRange.style.fill="#800000",i.appendChild(this.severeHighRange),this.indicator=document.createElementNS(Ft,"polygon"),this.indicator.classList.add("indicator"),this.indicator.style.fill="black",this.indicator.style.visibility="hidden",i.appendChild(this.indicator),this.pval&&this.redraw()}redraw(){let i,e,a=new Map;if(this.pval.alarmRange)for(let n of this.pval.alarmRange)a.set(n.level,n),n.minInclusive!==void 0&&(i===void 0||n.minInclusive<i)&&(i=n.minInclusive),n.minExclusive!==void 0&&(i===void 0||n.minExclusive<i)&&(i=n.minExclusive),n.maxInclusive!==void 0&&(e===void 0||n.maxInclusive>e)&&(e=n.maxInclusive),n.maxExclusive!==void 0&&(e===void 0||n.maxExclusive>e)&&(e=n.maxExclusive);if(this.criticalHighRange.setAttribute("width","0"),this.criticalLowRange.setAttribute("width","0"),this.indicator.style.visibility="hidden",i!==void 0&&e!==void 0&&i!==e){let n=i-(e-i)/5,r=e+(e-i)/5,c=100/(r-n),d=a.get("WATCH");if(d){if(d.minInclusive){let _=(d.minInclusive-n)*c;this.watchLowRange.setAttribute("width",String(_))}else if(d.minExclusive){let _=(d.minExclusive-n)*c;this.watchLowRange.setAttribute("width",String(_))}if(d.maxInclusive){let _=(d.maxInclusive-n)*c;this.watchHighRange.setAttribute("x",String(_)),this.watchHighRange.setAttribute("width",String(100-_))}else if(d.maxExclusive){let _=(d.maxExclusive-n)*c;this.watchHighRange.setAttribute("x",String(_)),this.watchHighRange.setAttribute("width",String(100-_))}}let m=a.get("WARNING");if(m){if(m.minInclusive){let _=(m.minInclusive-n)*c;this.warningLowRange.setAttribute("width",String(_))}else if(m.minExclusive){let _=(m.minExclusive-n)*c;this.warningLowRange.setAttribute("width",String(_))}if(m.maxInclusive){let _=(m.maxInclusive-n)*c;this.warningHighRange.setAttribute("x",String(_)),this.warningHighRange.setAttribute("width",String(100-_))}else if(m.maxExclusive){let _=(m.maxExclusive-n)*c;this.warningHighRange.setAttribute("x",String(_)),this.warningHighRange.setAttribute("width",String(100-_))}}let u=a.get("DISTRESS");if(u){if(u.minInclusive){let _=(u.minInclusive-n)*c;this.distressLowRange.setAttribute("width",String(_))}else if(u.minExclusive){let _=(u.minExclusive-n)*c;this.distressLowRange.setAttribute("width",String(_))}if(u.maxInclusive){let _=(u.maxInclusive-n)*c;this.distressHighRange.setAttribute("x",String(_)),this.distressHighRange.setAttribute("width",String(100-_))}else if(u.maxExclusive){let _=(u.maxExclusive-n)*c;this.distressHighRange.setAttribute("x",String(_)),this.distressHighRange.setAttribute("width",String(100-_))}}let g=a.get("CRITICAL");if(g){if(g.minInclusive){let _=(g.minInclusive-n)*c;this.criticalLowRange.setAttribute("width",String(_))}else if(g.minExclusive){let _=(g.minExclusive-n)*c;this.criticalLowRange.setAttribute("width",String(_))}if(g.maxInclusive){let _=(g.maxInclusive-n)*c;this.criticalHighRange.setAttribute("x",String(_)),this.criticalHighRange.setAttribute("width",String(100-_))}else if(g.maxExclusive){let _=(g.maxExclusive-n)*c;this.criticalHighRange.setAttribute("x",String(_)),this.criticalHighRange.setAttribute("width",String(100-_))}}let f=a.get("SEVERE");if(f){if(f.minInclusive){let _=(f.minInclusive-n)*c;this.severeLowRange.setAttribute("width",String(_))}else if(f.minExclusive){let _=(f.minExclusive-n)*c;this.severeLowRange.setAttribute("width",String(_))}if(f.maxInclusive){let _=(f.maxInclusive-n)*c;this.severeHighRange.setAttribute("x",String(_)),this.severeHighRange.setAttribute("width",String(100-_))}else if(f.maxExclusive){let _=(f.maxExclusive-n)*c;this.severeHighRange.setAttribute("x",String(_)),this.severeHighRange.setAttribute("width",String(100-_))}}let y=this.getNumericValue(this.pval);if(y!==void 0){let S=(Math.min(Math.max(y,n),r)-n)*c;this.indicator.setAttribute("points",`${S},25 ${S-3.5},100 ${S+3.5},100`),this.indicator.style.visibility="visible"}else this.indicator.style.visibility="hidden"}}getNumericValue(i){let e=i.engValue;switch(e.type){case"FLOAT":return e.floatValue;case"DOUBLE":return e.doubleValue;case"UINT32":return e.uint32Value;case"SINT32":return e.sint32Value;case"UINT64":return e.uint64Value;case"SINT64":return e.sint64Value}}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-severity-meter"]],viewQuery:function(e,a){if(e&1&&fe(Cf,7),e&2){let n;ue(n=he())&&(a.container=n.first)}},inputs:{pval:"pval"},features:[Mt],decls:2,vars:0,consts:[["container",""],["width","100%","height","8px","viewBox","0 0 100 100","preserveAspectRatio","none",2,"overflow","visible"]],template:function(e,a){e&1&&(Xa(),b(0,"svg",1,0))},encapsulation:2,changeDetection:0})}};var Kl=(t,i)=>({c:t,system:i}),Hr=t=>({c:t}),xf=()=>[],bf=t=>["/mdb/parameters/",t];function Sf(t,i){if(t&1&&(l(0,"a",5),s(1),o()),t&2){let e=i,a=h(2);C("queryParams",hi(2,Kl,a.yamcs.context,e)),p(),L(" ",e," ")}}function wf(t,i){if(t&1&&(l(0,"dt"),s(1),o(),l(2,"dd"),s(3),o()),t&2){let e=i.$implicit;p(),W(e.namespace),p(2),W(e.name)}}function Tf(t,i){t&1&&(l(0,"span",2),s(1),o()),t&2&&(p(),L(" ",i," "))}function Df(t,i){t&1&&s(0," - ")}function Pf(t,i){if(t&1&&(l(0,"dt"),s(1,"Signed"),o(),l(2,"dd"),s(3),o()),t&2){let e=h();p(3),W(e.signed)}}function Ef(t,i){if(t&1&&(l(0,"dt"),s(1,"Size in bits"),o(),l(2,"dd"),s(3),o()),t&2){let e=h();p(3),W(e.sizeInBits)}}function kf(t,i){if(t&1&&v(0,Pf,4,1)(1,Ef,4,1),t&2){let e=i;x(e.signed!==void 0?0:-1),p(),x(e.sizeInBits!==void 0?1:-1)}}function Af(t,i){if(t&1&&(l(0,"dt"),s(1,"Description"),o(),l(2,"dd"),b(3,"app-markdown",6),o()),t&2){let e=h();p(3),C("text",e.longDescription)}}function Mf(t,i){if(t&1&&(l(0,"dt"),s(1,"Description"),o(),l(2,"dd"),s(3),o()),t&2){let e=h();p(3),L(" ",e.shortDescription||"-"," ")}}function Rf(t,i){if(t&1&&v(0,Af,4,1)(1,Mf,4,1),t&2){let e=i;x(e.longDescription?0:-1),p(),x(e.longDescription?-1:1)}}function If(t,i){t&1&&s(0," - ")}function Lf(t,i){if(t&1&&(l(0,"dl",0)(1,"dt"),s(2,"Entry"),o(),l(3,"dd"),s(4),w(5,"shortName"),o(),l(6,"dt"),s(7,"System"),o(),l(8,"dd"),v(9,Sf,2,5,"a",5),w(10,"spaceSystemName"),o(),ae(11,wf,4,2,null,null,ie),w(13,"async"),l(14,"dt"),s(15,"Type"),o(),l(16,"dd"),v(17,Tf,2,1,"span",2),w(18,"async"),v(19,Df,1,0),o(),v(20,kf,2,2),w(21,"async"),l(22,"dt"),s(23,"Source"),o(),l(24,"dd"),s(25),w(26,"titlecase"),o(),v(27,Rf,2,2),w(28,"async"),v(29,If,1,0),o()),t&2){let e,a,n,r,c,d=h();p(4),$t("",D(5,7,d.parameter.qualifiedName),"",d.offset,""),p(5),x((e=D(10,9,d.parameter.qualifiedName))?9:-1,e),p(2),ne((a=D(13,11,d.entry$))==null?null:a.alias),p(6),x((n=(n=D(18,13,d.ptype$))==null?null:n.engType)?17:19,n),p(3),x((r=D(21,15,d.ptype$))?20:-1,r),p(5),W(D(26,17,d.parameter.dataSource)||"-"),p(2),x((c=D(28,19,d.entry$))?27:29,c)}}function Of(t,i){if(t&1&&(l(0,"dt"),s(1,"Host Parameter"),o(),l(2,"dd")(3,"a",7),s(4),w(5,"shortName"),o()()),t&2){let e=h();p(3),C("routerLink","/telemetry/parameters"+e.parameter.qualifiedName)("queryParams",X(5,Hr,e.yamcs.context)),p(),L(" ",D(5,3,e.parameter.qualifiedName)," ")}}function Vf(t,i){if(t&1&&(l(0,"dt"),s(1,"Parameter"),o(),l(2,"dd"),s(3),w(4,"shortName"),o()),t&2){let e=h();p(3),W(D(4,1,e.parameter.qualifiedName))}}function Nf(t,i){if(t&1&&(l(0,"a",5),s(1),o()),t&2){let e=i,a=h(2);C("queryParams",hi(2,Kl,a.yamcs.context,e)),p(),L(" ",e," ")}}function Ff(t,i){if(t&1&&(l(0,"dt"),s(1,"System"),o(),l(2,"dd"),v(3,Nf,2,5,"a",5),w(4,"spaceSystemName"),o()),t&2){let e,a=h();p(3),x((e=D(4,1,a.parameter.qualifiedName))?3:-1,e)}}function Bf(t,i){if(t&1&&(l(0,"dt"),s(1),o(),l(2,"dd"),s(3),o()),t&2){let e=i.$implicit;p(),W(e.namespace),p(2),W(e.name)}}function $f(t,i){t&1&&(l(0,"span",2),s(1),o()),t&2&&(p(),L(" ",i," "))}function Hf(t,i){t&1&&s(0," - ")}function Yf(t,i){if(t&1&&(l(0,"dt"),s(1,"Signed"),o(),l(2,"dd"),s(3),o()),t&2){let e=h();p(3),W(e.parameter.type==null?null:e.parameter.type.signed)}}function Gf(t,i){if(t&1&&(l(0,"dt"),s(1,"Source"),o(),l(2,"dd"),s(3),w(4,"titlecase"),o()),t&2){let e=h();p(3),W(D(4,1,e.parameter.dataSource)||"-")}}function Uf(t,i){if(t&1&&(l(0,"dt"),s(1,"Description"),o(),l(2,"dd"),b(3,"app-markdown",6),o()),t&2){let e=h();p(3),C("text",e.parameter.longDescription)}}function zf(t,i){if(t&1&&(l(0,"dt"),s(1,"Description"),o(),l(2,"dd"),s(3),o()),t&2){let e=h();p(3),L(" ",e.parameter.shortDescription||"-"," ")}}function Wf(t,i){t&1&&(l(0,"span",2),s(1),o()),t&2&&(p(),L(" ",i," "))}function jf(t,i){t&1&&s(0," - ")}function qf(t,i){t&1&&(s(0),w(1,"units")),t&2&&L(" ",D(1,1,i)," ")}function Xf(t,i){if(t&1&&(l(0,"td")(1,"a",9),s(2),o()(),l(3,"td"),v(4,Wf,2,1,"span",2),w(5,"entryForOffset"),v(6,jf,1,0),o(),l(7,"td"),s(8),w(9,"entryForOffset"),o(),l(10,"td")(11,"ya-expirable",10),s(12),w(13,"value"),v(14,qf,2,3),w(15,"entryForOffset"),o()()),t&2){let e,a,n,r=i,c=h(),d=c.$implicit,m=c.$index,u=h(2),g=h();p(),C("routerLink","/telemetry/parameters"+g.parameter.qualifiedName+r)("queryParams",X(19,Hr,g.yamcs.context)),p(),L(" ",d," "),p(2),x((e=(e=We(5,8,g.parameter,r))==null||e.type==null?null:e.type.engType)?4:6,e),p(4),W(((a=We(9,11,g.parameter,r))==null?null:a.shortDescription)||"-"),p(3),C("pval",g.pval),p(),L(" ",D(13,14,u.aggregateValue.value[m])," "),p(2),x((n=(n=We(15,16,g.parameter,r))==null||n.type==null?null:n.type.unitSet)?14:-1,n)}}function Zf(t,i){if(t&1&&(l(0,"tr"),v(1,Xf,16,21),o()),t&2){let e,a=i.$implicit,n=h(3);p(),x((e=(n.offset||"")+"."+a)?1:-1,e)}}function Qf(t,i){if(t&1&&(l(0,"table",8)(1,"tr")(2,"th"),s(3,"Member"),o(),l(4,"th"),s(5,"Type"),o(),l(6,"th"),s(7,"Description"),o(),l(8,"th"),s(9,"Value"),o()(),ae(10,Zf,2,1,"tr",null,ie),o()),t&2){let e=h();p(10),ne(e.aggregateValue.name)}}function Kf(t,i){if(t&1&&(l(0,"tr")(1,"td")(2,"a",9),s(3),o()(),l(4,"td"),s(5),w(6,"value"),o()()),t&2){let e=i.$implicit,a=i.$index,n=h(3);p(2),C("routerLink","/telemetry/parameters"+n.parameter.qualifiedName+(n.offset||"")+"["+a+"]")("queryParams",X(6,Hr,n.yamcs.context)),p(),L(" ",a," "),p(2),W(D(6,4,e))}}function Jf(t,i){if(t&1&&(l(0,"table",8)(1,"tr")(2,"th"),s(3,"Index"),o(),l(4,"th"),s(5,"Value"),o()(),ae(6,Kf,7,8,"tr",null,ie),o()),t&2){let e=h();p(6),ne(e.arrayValue||Li(0,xf))}}function e_(t,i){if(t&1&&(b(0,"app-alarm-level",15),s(1," \xA0 ")),t&2){let e=h(3);C("level",e.pval==null?null:e.pval.monitoringResult)}}function t_(t,i){t&1&&(s(0),w(1,"units")),t&2&&L(" ",D(1,1,i)," ")}function i_(t,i){if(t&1&&b(0,"app-severity-meter",10),t&2){let e=h(3);C("pval",e.pval)}}function a_(t,i){if(t&1&&(l(0,"span",11)(1,"ya-expirable",12),v(2,e_,2,1),s(3),w(4,"value"),v(5,t_,2,3),w(6,"parameterTypeForPath"),o()(),b(7,"br"),l(8,"div",13),v(9,i_,1,1,"app-severity-meter",10),o(),l(10,"dl",14)(11,"dt"),s(12,"Generation time"),o(),l(13,"dd"),s(14),w(15,"datetime"),o(),l(16,"dt"),s(17,"Raw value"),o(),l(18,"dd"),s(19),w(20,"value"),o()()),t&2){let e,a,n=h(),r=h();p(),C("pval",r.pval),p(),x(r.pval!=null&&r.pval.monitoringResult?2:-1),p(),L(" ",D(4,7,n)," "),p(2),x((e=(e=D(6,9,r.parameter))==null?null:e.unitSet)?5:-1,e),p(4),x(r.pval!=null&&r.pval.monitoringResult&&(r.pval!=null&&r.pval.alarmRange)?9:-1),p(5),W(D(15,11,r.pval==null?null:r.pval.generationTime)),p(5),W((a=D(20,13,r.pval==null?null:r.pval.rawValue))!==null&&a!==void 0?a:"-")}}function n_(t,i){if(t&1&&v(0,Qf,12,0,"table",8)(1,Jf,8,1,"table",8)(2,a_,21,15),t&2){let e;x((e=i.type)==="AGGREGATE"?0:e==="ARRAY"?1:2)}}function r_(t,i){t&1&&(l(0,"span",4),s(1,"---"),o())}function o_(t,i){t&1&&s(0," , ")}function l_(t,i){if(t&1&&(v(0,o_,1,0),l(1,"a",19),s(2),o(),s(3),w(4,"operator")),t&2){let e=i.$implicit,a=i.$index,n=h(4);x(a!==0?0:-1),p(),C("routerLink",X(8,bf,e.parameter.qualifiedName))("queryParams",X(10,Hr,n.yamcs.context)),p(),L(" ",e.parameter.name," "),p(),$t(" ",D(4,6,e.operator)," ",e.value," ")}}function s_(t,i){if(t&1&&(l(0,"th"),ae(1,l_,5,12,null,null,ie),o()),t&2){let e=i.$implicit;p(),ne(e.comparison)}}function c_(t,i){if(t&1&&(b(0,"app-alarm-level",20),s(1)),t&2){let e=i;C("level",e)("grayscale",!0),p(),L(" ",e," ")}}function p_(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function m_(t,i){if(t&1&&(b(0,"app-alarm-level",20),s(1)),t&2){let e=i;C("level",e)("grayscale",!0),p(),L(" ",e," ")}}function d_(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function u_(t,i){if(t&1&&(l(0,"td"),v(1,m_,2,3)(2,d_,2,0,"span"),o()),t&2){let e,a=i.$implicit,n=h().$implicit,r=h(3);p(),x((e=r.getEnumerationAlarmLevel(a,n.label))?1:2,e)}}function h_(t,i){if(t&1&&(l(0,"tr")(1,"td",4),s(2),o(),l(3,"td",4),s(4),o(),l(5,"td"),s(6),o(),l(7,"td"),v(8,c_,2,3)(9,p_,2,0,"span"),o(),ae(10,u_,3,1,"td",null,ie),o()),t&2){let e,a=i.$implicit,n=h(2),r=h();p(2),W(a.value),p(2),W(a.label),p(2),W(a.description||"-"),p(2),x((e=r.getDefaultAlarmLevel(n.type,a.label))?8:9,e),p(2),ne(n.type.contextAlarm)}}function f_(t,i){if(t&1&&(b(0,"app-alarm-level",20),s(1)),t&2){let e=i;C("level",e)("grayscale",!0),p(),L(" ",e," ")}}function __(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function g_(t,i){if(t&1&&(b(0,"app-alarm-level",20),s(1)),t&2){let e=i;C("level",e)("grayscale",!0),p(),L(" ",e," ")}}function v_(t,i){t&1&&(l(0,"span"),s(1,"-"),o())}function y_(t,i){if(t&1&&(l(0,"td"),v(1,g_,2,3)(2,v_,2,0,"span"),o()),t&2){let e,a=i.$implicit,n=h().$implicit,r=h(3);p(),x((e=r.getEnumerationAlarmLevel(a,n.label))?1:2,e)}}function C_(t,i){if(t&1&&(l(0,"tr")(1,"td",4),b(2,"ya-interval",21),o(),l(3,"td",4),s(4),o(),l(5,"td"),s(6),o(),l(7,"td"),v(8,f_,2,3)(9,__,2,0,"span"),o(),ae(10,y_,3,1,"td",null,ie),o()),t&2){let e,a=i.$implicit,n=h(2),r=h();p(2),C("left",a.min)("right",a.max)("leftInclusive",a.minInclusive)("rightInclusive",a.maxInclusive),p(2),W(a.label),p(2),W(a.description||"-"),p(2),x((e=r.getDefaultAlarmLevel(n.type,a.label))?8:9,e),p(2),ne(n.type.contextAlarm)}}function x_(t,i){if(t&1&&(b(0,"app-alarm-level",20),s(1)),t&2){let e=i;C("level",e)("grayscale",!0),p(),L(" ",e," ")}}function b_(t,i){if(t&1&&(b(0,"app-alarm-level",20),s(1)),t&2){let e=i;C("level",e)("grayscale",!0),p(),L(" ",e," ")}}function S_(t,i){if(t&1&&(l(0,"td"),v(1,b_,2,3),o()),t&2){let e,a=i.$implicit;p(),x((e=a.alarm.defaultLevel)?1:-1,e)}}function w_(t,i){if(t&1&&(l(0,"div",3),b(1,"mat-divider"),o(),l(2,"h4"),s(3,"Enumeration"),o(),l(4,"table",8)(5,"tr")(6,"th",16),s(7,"Value"),o(),l(8,"th",17),s(9,"Label"),o(),l(10,"th",18),s(11,"Description"),o(),l(12,"th"),s(13,"Alarm level (default)"),o(),ae(14,s_,3,0,"th",null,ie),o(),ae(16,h_,12,4,"tr",null,ie),ae(18,C_,12,7,"tr",null,ie),l(20,"tr")(21,"td"),s(22,"Other"),o(),l(23,"td"),s(24,"UNDEF"),o(),l(25,"td"),s(26,"-"),o(),l(27,"td"),v(28,x_,2,3),o(),ae(29,S_,2,1,"td",null,ie),o()()),t&2){let e,a=h();p(14),ne(a.type==null?null:a.type.contextAlarm),p(2),ne(a.type.enumValues),p(2),ne(a.type.enumRanges),p(10),x((e=a.type.defaultAlarm==null?null:a.type.defaultAlarm.defaultLevel)?28:-1,e),p(),ne(a.type.contextAlarm)}}function T_(t,i){if(t&1&&v(0,w_,31,1),t&2){let e=i;x((e.type==null?null:e.type.engType)==="enumeration"?0:-1)}}var $r=class t{constructor(i){this.yamcs=i;this.entry$=new B(null);this.ptype$=new B(null)}ngOnChanges(){if(this.parameter){if(this.offset){let i=F.getEntryForOffset(this.parameter,this.offset);this.entry$.next(i)}else this.entry$.next(this.parameter);this.ptype$.next(F.getParameterTypeForPath(this.parameter)||null)}else this.entry$.next(null),this.ptype$.next(null)}getDefaultAlarmLevel(i,e){if(i&&i.defaultAlarm){let a=i.defaultAlarm;if(a.enumerationAlarms){for(let n of a.enumerationAlarms)if(n.label===e)return n.level}return a.defaultLevel}}getEnumerationAlarmLevel(i,e){let a=i.alarm;for(let n of a.enumerationAlarms)if(n.label===e)return n.level;return a.defaultLevel}static{this.\u0275fac=function(e){return new(e||t)(T(q))}}static{this.\u0275cmp=V({type:t,selectors:[["app-parameter-detail"]],inputs:{parameter:"parameter",offset:"offset",pval:"pval"},features:[Mt],decls:24,vars:16,consts:[[1,"dl-horizontal","no-lead","no-trail"],[1,"dl-horizontal","no-trail"],[1,"mono"],[1,"section-divider"],[2,"white-space","nowrap"],["routerLink","/telemetry/parameters",1,"ya-link",3,"queryParams"],[3,"text"],[1,"ya-link",3,"routerLink","queryParams"],["yaDataTable",""],[3,"routerLink","queryParams"],[3,"pval"],[1,"pval"],[2,"white-space","nowrap",3,"pval"],[1,"meter-size-constrainer"],[1,"dl-horizontal"],[3,"level"],[2,"width","50px"],[2,"width","100px"],[2,"width","300px"],[1,"secundary",3,"routerLink","queryParams"],[3,"level","grayscale"],[3,"left","right","leftInclusive","rightInclusive"]],template:function(e,a){if(e&1&&(v(0,Lf,30,21,"dl",0),l(1,"dl",1),v(2,Of,6,7)(3,Vf,5,3)(4,Ff,5,3),ae(5,Bf,4,2,null,null,ie),l(7,"dt"),s(8,"Type"),o(),l(9,"dd"),v(10,$f,2,1,"span",2)(11,Hf,1,0),o(),v(12,Yf,4,1)(13,Gf,5,3)(14,Uf,4,1)(15,zf,4,1),o(),l(16,"div",3),b(17,"mat-divider"),o(),l(18,"h4"),s(19,"Current value"),o(),v(20,n_,3,1)(21,r_,2,0,"span",4)(22,T_,1,1),w(23,"async")),e&2){let n,r,c;x(a.offset?0:-1),p(),pe("no-lead",!a.offset),p(),x(a.offset?2:-1),p(),x(a.offset?-1:3),p(),x(a.offset?-1:4),p(),ne(a.parameter.alias),p(5),x((n=a.parameter.type==null?null:a.parameter.type.engType)?10:11,n),p(2),x((a.parameter.type==null?null:a.parameter.type.signed)!==void 0?12:-1),p(),x(a.offset?-1:13),p(),x(a.parameter.longDescription?14:-1),p(),x(a.parameter.longDescription?-1:15),p(5),x((r=a.pval==null?null:a.pval.engValue)?20:-1,r),p(),x(a.pval!=null&&a.pval.engValue?-1:21),p(),x((c=D(23,14,a.entry$))?22:-1,c)}},dependencies:[Jt,vl,Br,G,J,Oi,Re,pi,zt,Xt,al,Pe,ll,pl,Ki,Cn,dl,Kt,Vt],styles:[".meter-size-constrainer[_ngcontent-%COMP%]{display:inline-block;width:160px;position:relative}.dl-horizontal[_ngcontent-%COMP%]   dt[_ngcontent-%COMP%]{text-align:left}span.pval[_ngcontent-%COMP%]{font-size:16px;line-height:20px;margin:-8px 0 16px;bottom:-5px;color:#000000fc;font-weight:400}.pval-frame[_ngcontent-%COMP%]{display:inline-block;min-width:412px;border:1px solid #e7e7e7;border-radius:2px;box-shadow:0 1px 3px #0000001f}.pval-frame[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{border-bottom:1px solid #d3d3d3;height:64px;line-height:64px;padding-left:24px;position:relative}.pval-frame[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{position:absolute;top:0;right:0}.pval-frame[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{padding:24px}.mat-icon.unchecked[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0})}};function D_(t,i){if(t&1&&(b(0,"app-parameter-detail",1),w(1,"async"),w(2,"async")),t&2){let e=h();C("parameter",i)("offset",D(1,3,e.offset$))("pval",D(2,5,e.pval$))}}var Yr=class t{constructor(i,e){this.yamcs=i;this.synchronizer=e;this.qualifiedName=Rt.required({alias:"parameter"});this.parameter$=new B(null);this.offset$=new B(null);this.parameterValue$=new B(null);this.dirty=!1;this.pval$=new B(null);this.syncSubscription=this.synchronizer.syncFast(()=>{this.dirty&&(this.pval$.next(this.parameterValue$.value),this.dirty=!1)})}ngOnChanges(){let i=this.qualifiedName();this.yamcs.yamcsClient.getParameter(this.yamcs.instance,i).then(e=>{this.parameter$.next(e),i!==e.qualifiedName?this.offset$.next(i.substring(e.qualifiedName.length)):this.offset$.next(null),this.parameterValueSubscription&&this.parameterValueSubscription.cancel(),this.parameterValue$.next(null),this.pval$.next(null),this.parameterValueSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:[{name:i}],abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},a=>{this.parameterValue$.next(a.values?a.values[0]:null),this.pval$.value==null?this.pval$.next(this.parameterValue$.value):this.dirty=!0})})}ngOnDestroy(){this.parameterValueSubscription?.cancel(),this.syncSubscription?.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(T(q),T(Tt))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],inputs:{qualifiedName:[1,"parameter","qualifiedName"]},features:[Mt],decls:3,vars:3,consts:[[1,"panel-content"],[3,"parameter","offset","pval"]],template:function(e,a){if(e&1&&(l(0,"div",0),v(1,D_,3,7,"app-parameter-detail",1),w(2,"async"),o()),e&2){let n;p(),x((n=D(2,1,a.parameter$))?1:-1,n)}},dependencies:[$r,G,J],encapsulation:2,changeDetection:0})}};function P_(t,i){if(t&1&&(l(0,"option",8),s(1),o()),t&2){let e=i.$implicit;C("value",e.label),p(),L(" ",e.label," ")}}function E_(t,i){if(t&1&&(l(0,"label")(1,"div",3)(2,"div",4),s(3),o()(),s(4),b(5,"ya-errors",5),l(6,"select",6)(7,"option",7),s(8,"-- select an option --"),o(),ae(9,P_,2,2,"option",8,ie),o()()),t&2){let e=h(),a=h();p(3),W(a.parameter.type==null?null:a.parameter.type.engType),p(),L(" ",a.parameter.name," "),p(),C("controlName",e),p(),C("formControlName",e),p(3),ne(a.parameter.type==null?null:a.parameter.type.enumValues)}}function k_(t,i){if(t&1&&(l(0,"label"),s(1),b(2,"ya-errors",5)(3,"br")(4,"input",9),s(5," true "),b(6,"br")(7,"input",10),s(8," false "),o()),t&2){let e=h(),a=h();p(),L(" ",a.parameter.name," "),p(),C("controlName",e),p(2),C("formControlName",e),p(3),C("formControlName",e)}}function A_(t,i){if(t&1&&(l(0,"label"),s(1),b(2,"ya-errors",5)(3,"ya-date-time-input",6),o()),t&2){let e=h(),a=h();p(),L(" ",a.parameter.name," "),p(),C("controlName",e),p(),C("formControlName",e)}}function M_(t,i){if(t&1&&(l(0,"label")(1,"div",3)(2,"div",4),w(3,"async"),s(4),o()(),s(5),b(6,"ya-errors",5,0)(8,"ya-binary-input",6),o()),t&2){let e=oe(7),a=h(),n=h();p(2),pe("error",D(3,6,e.invalid$)),p(2),L(" ",n.parameter.type==null?null:n.parameter.type.engType," "),p(),L(" ",n.parameter.name," "),p(),C("controlName",a),p(2),C("formControlName",a)}}function R_(t,i){if(t&1&&b(0,"app-parameter-form",12)(1,"br"),t&2){let e=i.$implicit,a=h(3);C("parameter",e)("formGroup",a.formGroup)("parent",a.parent?a.parent+"."+a.parameter.name:a.parameter.name)}}function I_(t,i){if(t&1&&(l(0,"label")(1,"div",3)(2,"div",4),s(3),o()(),s(4),l(5,"div",11),ae(6,R_,2,3,null,null,ie),o()()),t&2){let e=h(2);p(3),W(e.parameter.type==null?null:e.parameter.type.engType),p(),L(" ",e.parameter.name," "),p(2),ne(e.parameter.type==null?null:e.parameter.type.member)}}function L_(t,i){if(t&1&&(l(0,"div",4),s(1),w(2,"units"),o()),t&2){let e=h(3);p(),L(" ",D(2,1,e.parameter.type==null?null:e.parameter.type.unitSet)," ")}}function O_(t,i){t&1&&(l(0,"div",4),s(1,"unsigned"),o())}function V_(t,i){if(t&1&&(l(0,"div",2)(1,"div",3),w(2,"async"),v(3,L_,3,3,"div",4)(4,O_,2,0,"div",4),l(5,"div",4),s(6),o()(),s(7),b(8,"ya-errors",5,0)(10,"input",13),o()),t&2){let e=oe(9),a=h(),n=h();p(),pe("error",D(2,8,e.invalid$)),p(2),x(n.parameter.type!=null&&n.parameter.type.unitSet?3:-1),p(),x((n.parameter.type==null?null:n.parameter.type.signed)===!1?4:-1),p(2),W(n.parameter.type==null?null:n.parameter.type.engType),p(),L(" ",n.parameter.name," "),p(),C("controlName",a),p(2),C("formControlName",a)}}function N_(t,i){t&1&&s(0," Setting array values via this website is not yet supported. ")}function F_(t,i){t&1&&s(0," Setting array values via this website is not yet supported. ")}function B_(t,i){t&1&&s(0," Setting array values via this website is not yet supported. ")}function $_(t,i){t&1&&s(0," Setting array values via this website is not yet supported. ")}function H_(t,i){t&1&&s(0," Setting array values via this website is not yet supported. ")}function Y_(t,i){t&1&&s(0," Setting array values via this website is not yet supported. ")}function G_(t,i){t&1&&s(0," Setting array values via this website is not yet supported. ")}function U_(t,i){t&1&&s(0," Setting array values via this website is not yet supported. ")}function z_(t,i){t&1&&s(0," Setting array values via this website is not yet supported. ")}function W_(t,i){if(t&1&&(l(0,"div",4),s(1),w(2,"units"),o()),t&2){let e=h(3);p(),L(" ",D(2,1,e.parameter.type==null?null:e.parameter.type.unitSet)," ")}}function j_(t,i){if(t&1&&(l(0,"label")(1,"div",3),w(2,"async"),v(3,W_,3,3,"div",4),l(4,"div",4),s(5),o()(),s(6),b(7,"ya-errors",5,0)(9,"input",13),o()),t&2){let e=oe(8),a=h(),n=h();p(),pe("error",D(2,7,e.invalid$)),p(2),x(n.parameter.type!=null&&n.parameter.type.unitSet?3:-1),p(2),W(n.parameter.type==null?null:n.parameter.type.engType),p(),L(" ",n.parameter.name," "),p(),C("controlName",a),p(2),C("formControlName",a)}}function q_(t,i){if(t&1&&($(0,1),v(1,E_,11,4,"label")(2,k_,9,4,"label")(3,A_,4,3,"label")(4,M_,9,8,"label")(5,I_,8,2,"label")(6,V_,11,10,"div",2)(7,N_,1,0)(8,F_,1,0)(9,B_,1,0)(10,$_,1,0)(11,H_,1,0)(12,Y_,1,0)(13,G_,1,0)(14,U_,1,0)(15,z_,1,0)(16,j_,10,9,"label"),H()),t&2){let e,a=h();C("formGroup",a.formGroup),p(),x((e=a.parameter.type==null?null:a.parameter.type.engType)==="enumeration"?1:e==="boolean"?2:e==="time"?3:e==="binary"?4:e==="aggregate"?5:e==="integer"?6:e==="float[]"?7:e==="double[]"?8:e==="integer[]"?9:e==="enumeration[]"?10:e==="string[]"?11:e==="boolean[]"?12:e==="time[]"?13:e==="binary[]"?14:e==="aggregate[]"?15:16)}}var Gr=class t{constructor(){this.controlName$=new B(null)}ngOnInit(){this.parent?this.controlName$.next(this.parent+"."+this.parameter.name):this.controlName$.next(this.parameter.name)}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-parameter-form"]],inputs:{formGroup:"formGroup",parameter:"parameter",parent:"parent"},decls:2,vars:3,consts:[["err",""],[3,"formGroup"],[1,"label"],[1,"meta"],[1,"item"],[3,"controlName"],[3,"formControlName"],["hidden","","disabled","","selected","","value",""],[3,"value"],["type","radio","value","true",3,"formControlName"],["type","radio","value","false",3,"formControlName"],[1,"members"],[3,"parameter","formGroup","parent"],["type","text",3,"formControlName"]],template:function(e,a){if(e&1&&(v(0,q_,17,2,"ng-container",1),w(1,"async")),e&2){let n;x((n=D(1,1,a.controlName$))?0:-1,n)}},dependencies:[t,G,J,Fi,Bi,Ze,Ni,Wo,me,xe,be,De,Jo,_t,tl,Kt],styles:[".meta[_ngcontent-%COMP%]{position:absolute;top:0;right:0;display:flex}.meta[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:none;background-color:#eee;font-weight:400;font-family:Roboto Mono,monospace;color:#000000a7;padding-left:2px;padding-right:2px;margin-left:10px}.meta.error[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:var(--y-error-color);color:#fff}.members[_ngcontent-%COMP%]{margin-top:5px;padding-top:5px;padding-left:10px}"],changeDetection:0})}};var Ur=class t{constructor(i,e){this.dialogRef=i;this.data=e;this.form=new it({});this.parameter=e.parameter;let a=this.getValidatorsForType(this.parameter.type);this.parameter.type.engType==="aggregate"?this.addMemberControls(this.parameter.name+".",this.parameter.type.member||[]):this.form.addControl(this.parameter.name,new ee(null,a))}addMemberControls(i,e){for(let a of e)if(a.type.engType==="aggregate")this.addMemberControls(i+a.name+".",a.type.member||[]);else{let n=i+a.name,r=this.getValidatorsForType(a.type);this.form.addControl(n,new ee("",r))}}getValidatorsForType(i){let e=[Ee.required];return i.engType==="integer"?(e.push(un.requireInteger),i.signed===!1&&e.push(un.requireUnsigned)):i.engType==="float"&&e.push(un.requireFloat),e}setValue(){let i=this.toValue("",this.parameter);this.dialogRef.close(i)}toValue(i,e){let a=this.form.value[i+e.name];switch(e.type.engType){case"boolean":return{type:"BOOLEAN",booleanValue:a==="true"};case"float":return{type:"FLOAT",floatValue:a};case"double":return{type:"DOUBLE",doubleValue:a};case"enumeration":return{type:"STRING",stringValue:a};case"integer":return{type:"SINT32",sint32Value:a};case"string":return{type:"STRING",stringValue:a};case"time":return{type:"TIMESTAMP",stringValue:F.toISOString(a)};case"binary":return{type:"BINARY",binaryValue:F.convertHexToBase64(a)};case"aggregate":let n=[],r=[];for(let c of e.type.member||[])n.push(c.name),r.push(this.toValue(i+e.name+".",c));return{type:"AGGREGATE",aggregateValue:{name:n,value:r}};default:throw new Error(`Unexpected type: ${e.type.engType}`)}}static{this.\u0275fac=function(e){return new(e||t)(T(Ve),T(Qe))}}static{this.\u0275cmp=V({type:t,selectors:[["app-set-parameter-dialog"]],decls:10,vars:4,consts:[["mat-dialog-title",""],[1,"ya-form",3,"formGroup"],[3,"parameter","formGroup"],["align","end"],["mat-dialog-close",""],["appearance","primary",3,"click","disabled"]],template:function(e,a){e&1&&(l(0,"h2",0),s(1,"Set parameter value"),o(),l(2,"mat-dialog-content")(3,"form",1),b(4,"app-parameter-form",2),o()(),l(5,"mat-dialog-actions",3)(6,"ya-button",4),s(7,"CANCEL"),o(),l(8,"ya-button",5),E("click",function(){return a.setValue()}),s(9,"SET"),o()()),e&2&&(p(3),C("formGroup",a.form),p(),C("parameter",a.parameter)("formGroup",a.form),p(4),C("disabled",!a.form.valid))},dependencies:[Gr,G,Te,xe,be,Fe,mt,$e,Be,_e],encapsulation:2})}};var Ua=t=>({c:t}),X_=(t,i)=>({c:t,system:i}),Z_=t=>["/mdb/parameters",t];function Q_(t,i){if(t&1&&(l(0,"a",15),s(1),o()),t&2){let e=h().$implicit,a=h(2);C("queryParams",hi(2,X_,a.yamcs.context,e.path)),p(),L(" ",e.name," ")}}function K_(t,i){if(t&1&&(v(0,Q_,2,5,"a",15),s(1," / ")),t&2){let e=i.$index;x(e!==0?0:-1)}}function J_(t,i){if(t&1){let e=N();l(0,"ya-page-button",16),E("clicked",function(){k(e);let n=h(2);return A(n.setParameter())}),s(1,"Set value"),o()}}function eg(t,i){if(t&1&&(l(0,"ya-page-button",8),s(1," View in MDB "),o()),t&2){let e=h(),a=h();C("routerLink",X(2,Z_,e.qualifiedName))("queryParams",X(4,Ua,a.yamcs.context))}}function tg(t,i){if(t&1&&(l(0,"a",11,3),s(2," Chart "),o()),t&2){let e=oe(1),a=h(2);C("active",e.isActive)("queryParams",X(2,Ua,a.yamcs.context))}}function ig(t,i){if(t&1&&(l(0,"a",12,4),s(2," Alarm History "),o()),t&2){let e=oe(1),a=h(2);C("active",e.isActive)("queryParams",X(2,Ua,a.yamcs.context))}}function ag(t,i){if(t&1&&(l(0,"a",13,5),s(2," Historical Data "),o()),t&2){let e=oe(1),a=h(2);C("active",e.isActive)("queryParams",X(2,Ua,a.yamcs.context))}}function ng(t,i){if(t&1&&(l(0,"app-instance-page")(1,"app-instance-toolbar"),ae(2,K_,2,1,null,null,ie),w(4,"parents"),l(5,"span"),s(6),w(7,"shortName"),w(8,"async"),o(),b(9,"ya-title-copy",6),w(10,"async"),s(11," \xA0\xA0\xA0 "),v(12,J_,2,0,"ya-page-button",7),w(13,"async"),v(14,eg,2,6,"ya-page-button",8),o(),l(15,"nav",9,0)(17,"a",10,1),s(19," Summary "),o(),v(20,tg,3,4,"a",11)(21,ig,3,4,"a",12)(22,ag,3,4,"a",13),o(),l(23,"div",14)(24,"mat-tab-nav-panel",null,2),b(26,"router-outlet"),o()()()),t&2){let e=i,a=oe(16),n=oe(18),r=oe(25),c=h();p(2),ne(D(4,14,e.qualifiedName)),p(4),$t("",D(7,16,e.qualifiedName),"",D(8,18,c.offset$),""),p(3),C("text",e.qualifiedName+(D(10,20,c.offset$)||"")),p(3),x(c.isWritable()&&c.maySetParameter()&&!D(13,22,c.offset$)?12:-1),p(2),x(c.mayReadMissionDatabase()?14:-1),p(),C("mat-stretch-tabs",!1)("tabPanel",r),p(2),C("active",n.isActive)("queryParams",X(24,Ua,c.yamcs.context)),p(3),x(c.config.tmArchive?20:-1),p(),x(c.mayReadAlarms()?21:-1),p(),x(c.config.tmArchive?22:-1),p(),pe("noscroll",a.selectedIndex===1)}}var zr=class t{constructor(i,e,a,n,r,c,d){this.yamcs=i;this.authService=e;this.messageService=a;this.dialog=n;this.title=r;this.formatter=c;this.qualifiedName=Rt.required({alias:"parameter"});this.parameter$=new B(null);this.offset$=new B(null);this.parameterValue$=new B(null);this.config=d.getConfig()}ngOnChanges(){let i=this.qualifiedName();this.yamcs.yamcsClient.getParameter(this.yamcs.instance,i).then(e=>{this.parameter$.next(e),i!==e.qualifiedName?this.offset$.next(i.substring(e.qualifiedName.length)):this.offset$.next(null),this.updateTitle()}).catch(e=>{this.messageService.showError(e)}),this.parameterValueSubscription&&this.parameterValueSubscription.cancel(),this.parameterValueSubscription=this.yamcs.yamcsClient.createParameterSubscription({instance:this.yamcs.instance,processor:this.yamcs.processor,id:[{name:i}],abortOnInvalid:!1,sendFromCache:!0,updateOnExpiration:!0,action:"REPLACE"},e=>{this.parameterValue$.next(e.values?e.values[0]:null),this.updateTitle()})}updateTitle(){let i=this.parameter$.getValue(),e=this.offset$.getValue();if(i){let a=i.name;e&&(a+=e);let n=this.parameterValue$.getValue();n?.engValue&&(a+=": "+this.formatter.formatValue(n.engValue),i.type&&i.type.unitSet&&(a+=" "+F.getUnits(i.type.unitSet)),n.rangeCondition&&n.rangeCondition==="LOW"?a+=" \u2193":n.rangeCondition&&n.rangeCondition==="HIGH"&&(a+=" \u2191")),this.title.setTitle(a)}}isWritable(){let i=this.parameter$.value;return i?i.dataSource==="LOCAL"||i.dataSource==="EXTERNAL1"||i.dataSource==="EXTERNAL2"||i.dataSource==="EXTERNAL3":!1}maySetParameter(){let i=this.parameter$.value;return i?this.authService.getUser().hasObjectPrivilege("WriteParameter",i.qualifiedName):!1}mayReadAlarms(){return this.authService.getUser().hasSystemPrivilege("ReadAlarms")}mayReadMissionDatabase(){return this.authService.getUser().hasSystemPrivilege("GetMissionDatabase")}setParameter(){let i=this.parameter$.value;this.dialog.open(Ur,{width:"600px",data:{parameter:this.parameter$.value}}).afterClosed().subscribe(a=>{a&&this.yamcs.yamcsClient.setParameterValue(this.yamcs.instance,this.yamcs.processor,i.qualifiedName,a).catch(n=>this.messageService.showError(n))})}ngOnDestroy(){this.parameterValueSubscription?.cancel()}static{this.\u0275fac=function(e){return new(e||t)(T(q),T(gt),T(ft),T(Ne),T(bt),T(ji),T(ye))}}static{this.\u0275cmp=V({type:t,selectors:[["ng-component"]],inputs:{qualifiedName:[1,"parameter","qualifiedName"]},features:[Mt],decls:2,vars:3,consts:[["tabs",""],["rla","routerLinkActive"],["tabPanel",""],["rlb","routerLinkActive"],["rlc","routerLinkActive"],["rld","routerLinkActive"],[3,"text"],["icon","edit"],["icon","auto_stories",3,"routerLink","queryParams"],["mat-tab-nav-bar","",1,"secondary",3,"mat-stretch-tabs","tabPanel"],["mat-tab-link","","routerLink","-/summary","routerLinkActive","",3,"active","queryParams"],["mat-tab-link","","routerLink","-/chart","routerLinkActive","",3,"active","queryParams"],["mat-tab-link","","routerLink","-/alarms","routerLinkActive","",3,"active","queryParams"],["mat-tab-link","","routerLink","-/data","routerLinkActive","",3,"active","queryParams"],[1,"tab-content-wrapper"],["routerLink","/telemetry/parameters",1,"ya-link","ya-header-link",3,"queryParams"],["icon","edit",3,"clicked"]],template:function(e,a){if(e&1&&(v(0,ng,27,26,"app-instance-page"),w(1,"async")),e&2){let n;x((n=D(1,1,a.parameter$))?0:-1,n)}},dependencies:[Je,Ke,G,J,ri,Re,an,pn,dn,mn,nt,nl,ml,Cn],styles:[".tab-content-wrapper[_ngcontent-%COMP%]{position:absolute;inset:37px 0 0;overflow:auto}.tab-content-wrapper.noscroll[_ngcontent-%COMP%]{overflow:hidden}"],changeDetection:0})}};var rg=t=>{let i=t,e=t.findIndex(n=>n.path==="-");e!==-1&&(i=t.slice(0,e));let a="/"+i.map(n=>n.path).join("/");return{consumed:i,posParams:{packet:new qr(a,{})}}},og=t=>{let i=t,e=t.findIndex(n=>n.path==="-");e!==-1&&(i=t.slice(0,e));let a="/"+i.map(n=>n.path).join("/");return{consumed:i,posParams:{parameter:new qr(a,{})}}},QP=[{path:"",canActivate:[Jr,Kr],canActivateChild:[eo],runGuardsAndResolvers:"always",component:fl,children:[{path:"",pathMatch:"full",redirectTo:"home"},{path:"displays",pathMatch:"full",redirectTo:"displays/browse"},{path:"displays/browse",component:qn,children:[{path:"**",component:zn}]},{path:"displays/files",component:jn,providers:[wa],children:[{path:"**",component:$n,canDeactivate:[xl],data:{showRangeSelector:!0}}]},{path:"packets",children:[{path:"",pathMatch:"full",component:Kn},{matcher:rg,children:[{path:"-/log/:gentime/:seqno",component:Jn}]}]},{path:"parameters",children:[{path:"",pathMatch:"full",component:rr,title:"Parameters"},{matcher:og,component:zr,children:[{path:"",pathMatch:"full",redirectTo:"-/summary"},{path:"-/summary",component:Yr},{path:"-/chart",component:Ir},{path:"-/data",component:Fr},{path:"-/alarms",component:ur}]}]},{path:"parameter-lists",pathMatch:"full",component:ar},{path:"parameter-lists/create",pathMatch:"full",component:er},{path:"parameter-lists/:list",component:cr,children:[{path:"",pathMatch:"full",redirectTo:"realtime"},{path:"realtime",component:lr},{path:"data",component:ir}]},{path:"parameter-lists/:list/edit",pathMatch:"full",component:tr},{path:"ext",canActivate:[Jr,Kr],canActivateChild:[eo],runGuardsAndResolvers:"always",children:[{matcher:hl,component:ul}]}]}];export{QP as ROUTES};
